<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - total_coverage.info - src/bitcoin-cli.cpp</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="title">LCOV - code coverage report</td></tr>
            <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

            <tr>
              <td width="100%">
                <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="10%" class="headerValue"><a href="../index.html" title="Click to go to top-level">top level</a> - <a href="index.html" title="Click to go to directory src">src</a> - bitcoin-cli.cpp<span style="font-size: 80%;"> (source / <a href="bitcoin-cli.cpp.func-c.html" title="Click to go to function table">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="5%"></td>
            <td width="5%" class="headerCovTableHead">Coverage</td>
            <td width="5%" class="headerCovTableHead" title="Covered + Uncovered code">Total</td>
            <td width="5%" class="headerCovTableHead" title="Exercised code only">Hit</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">total_coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntryLo">58.1&nbsp;%</td>
            <td class="headerCovTableEntry">709</td>
            <td class="headerCovTableEntry">412</td>
          </tr>
          <tr>
            <td class="headerItem">Test Date:</td>
            <td class="headerValue">2024-10-28 14:00:11</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntryLo">57.6&nbsp;%</td>
            <td class="headerCovTableEntry">33</td>
            <td class="headerCovTableEntry">19</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntryLo">34.3&nbsp;%</td>
            <td class="headerCovTableEntry">2239</td>
            <td class="headerCovTableEntry">767</td>
          </tr>
                  <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
                </table>
              </td>
            </tr>

            <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
          </table>

          <table cellpadding=0 cellspacing=0 border=0>
            <tr>
              <td><br></td>
            </tr>
            <tr>
              <td>
<pre class="sourceHeading">             Branch data     Line data    Source code</pre>
<pre class="source">
<span id="L1"><span class="lineNum">       1</span>                 :             : // Copyright (c) 2009-2010 Satoshi Nakamoto</span>
<span id="L2"><span class="lineNum">       2</span>                 :             : // Copyright (c) 2009-2022 The Bitcoin Core developers</span>
<span id="L3"><span class="lineNum">       3</span>                 :             : // Distributed under the MIT software license, see the accompanying</span>
<span id="L4"><span class="lineNum">       4</span>                 :             : // file COPYING or http://www.opensource.org/licenses/mit-license.php.</span>
<span id="L5"><span class="lineNum">       5</span>                 :             : </span>
<span id="L6"><span class="lineNum">       6</span>                 :             : #include &lt;bitcoin-build-config.h&gt; // IWYU pragma: keep</span>
<span id="L7"><span class="lineNum">       7</span>                 :             : </span>
<span id="L8"><span class="lineNum">       8</span>                 :             : #include &lt;chainparamsbase.h&gt;</span>
<span id="L9"><span class="lineNum">       9</span>                 :             : #include &lt;clientversion.h&gt;</span>
<span id="L10"><span class="lineNum">      10</span>                 :             : #include &lt;common/args.h&gt;</span>
<span id="L11"><span class="lineNum">      11</span>                 :             : #include &lt;common/system.h&gt;</span>
<span id="L12"><span class="lineNum">      12</span>                 :             : #include &lt;compat/compat.h&gt;</span>
<span id="L13"><span class="lineNum">      13</span>                 :             : #include &lt;compat/stdin.h&gt;</span>
<span id="L14"><span class="lineNum">      14</span>                 :             : #include &lt;policy/feerate.h&gt;</span>
<span id="L15"><span class="lineNum">      15</span>                 :             : #include &lt;rpc/client.h&gt;</span>
<span id="L16"><span class="lineNum">      16</span>                 :             : #include &lt;rpc/mining.h&gt;</span>
<span id="L17"><span class="lineNum">      17</span>                 :             : #include &lt;rpc/protocol.h&gt;</span>
<span id="L18"><span class="lineNum">      18</span>                 :             : #include &lt;rpc/request.h&gt;</span>
<span id="L19"><span class="lineNum">      19</span>                 :             : #include &lt;tinyformat.h&gt;</span>
<span id="L20"><span class="lineNum">      20</span>                 :             : #include &lt;univalue.h&gt;</span>
<span id="L21"><span class="lineNum">      21</span>                 :             : #include &lt;util/chaintype.h&gt;</span>
<span id="L22"><span class="lineNum">      22</span>                 :             : #include &lt;util/exception.h&gt;</span>
<span id="L23"><span class="lineNum">      23</span>                 :             : #include &lt;util/strencodings.h&gt;</span>
<span id="L24"><span class="lineNum">      24</span>                 :             : #include &lt;util/time.h&gt;</span>
<span id="L25"><span class="lineNum">      25</span>                 :             : #include &lt;util/translation.h&gt;</span>
<span id="L26"><span class="lineNum">      26</span>                 :             : </span>
<span id="L27"><span class="lineNum">      27</span>                 :             : #include &lt;algorithm&gt;</span>
<span id="L28"><span class="lineNum">      28</span>                 :             : #include &lt;chrono&gt;</span>
<span id="L29"><span class="lineNum">      29</span>                 :             : #include &lt;cmath&gt;</span>
<span id="L30"><span class="lineNum">      30</span>                 :             : #include &lt;cstdio&gt;</span>
<span id="L31"><span class="lineNum">      31</span>                 :             : #include &lt;functional&gt;</span>
<span id="L32"><span class="lineNum">      32</span>                 :             : #include &lt;memory&gt;</span>
<span id="L33"><span class="lineNum">      33</span>                 :             : #include &lt;optional&gt;</span>
<span id="L34"><span class="lineNum">      34</span>                 :             : #include &lt;string&gt;</span>
<span id="L35"><span class="lineNum">      35</span>                 :             : #include &lt;tuple&gt;</span>
<span id="L36"><span class="lineNum">      36</span>                 :             : </span>
<span id="L37"><span class="lineNum">      37</span>                 :             : #ifndef WIN32</span>
<span id="L38"><span class="lineNum">      38</span>                 :             : #include &lt;unistd.h&gt;</span>
<span id="L39"><span class="lineNum">      39</span>                 :             : #endif</span>
<span id="L40"><span class="lineNum">      40</span>                 :             : </span>
<span id="L41"><span class="lineNum">      41</span>                 :             : #include &lt;event2/buffer.h&gt;</span>
<span id="L42"><span class="lineNum">      42</span>                 :             : #include &lt;event2/keyvalq_struct.h&gt;</span>
<span id="L43"><span class="lineNum">      43</span>                 :             : #include &lt;support/events.h&gt;</span>
<span id="L44"><span class="lineNum">      44</span>                 :             : </span>
<span id="L45"><span class="lineNum">      45</span>                 :             : using util::Join;</span>
<span id="L46"><span class="lineNum">      46</span>                 :             : using util::ToString;</span>
<span id="L47"><span class="lineNum">      47</span>                 :             : </span>
<span id="L48"><span class="lineNum">      48</span>                 :             : // The server returns time values from a mockable system clock, but it is not</span>
<span id="L49"><span class="lineNum">      49</span>                 :             : // trivial to get the mocked time from the server, nor is it needed for now, so</span>
<span id="L50"><span class="lineNum">      50</span>                 :             : // just use a plain system_clock.</span>
<span id="L51"><span class="lineNum">      51</span>                 :             : using CliClock = std::chrono::system_clock;</span>
<span id="L52"><span class="lineNum">      52</span>                 :             : </span>
<span id="L53"><span class="lineNum">      53</span>                 :             : const std::function&lt;std::string(const char*)&gt; G_TRANSLATION_FUN = nullptr;</span>
<span id="L54"><span class="lineNum">      54</span>                 :             : </span>
<span id="L55"><span class="lineNum">      55</span>                 :             : static const char DEFAULT_RPCCONNECT[] = &quot;127.0.0.1&quot;;</span>
<span id="L56"><span class="lineNum">      56</span>                 :             : static const int DEFAULT_HTTP_CLIENT_TIMEOUT=900;</span>
<span id="L57"><span class="lineNum">      57</span>                 :             : static constexpr int DEFAULT_WAIT_CLIENT_TIMEOUT = 0;</span>
<span id="L58"><span class="lineNum">      58</span>                 :             : static const bool DEFAULT_NAMED=false;</span>
<span id="L59"><span class="lineNum">      59</span>                 :             : static const int CONTINUE_EXECUTION=-1;</span>
<span id="L60"><span class="lineNum">      60</span>                 :             : static constexpr int8_t UNKNOWN_NETWORK{-1};</span>
<span id="L61"><span class="lineNum">      61</span>                 :             : // See GetNetworkName() in netbase.cpp</span>
<span id="L62"><span class="lineNum">      62</span>                 :             : static constexpr std::array NETWORKS{&quot;not_publicly_routable&quot;, &quot;ipv4&quot;, &quot;ipv6&quot;, &quot;onion&quot;, &quot;i2p&quot;, &quot;cjdns&quot;, &quot;internal&quot;};</span>
<span id="L63"><span class="lineNum">      63</span>                 :             : static constexpr std::array NETWORK_SHORT_NAMES{&quot;npr&quot;, &quot;ipv4&quot;, &quot;ipv6&quot;, &quot;onion&quot;, &quot;i2p&quot;, &quot;cjdns&quot;, &quot;int&quot;};</span>
<span id="L64"><span class="lineNum">      64</span>                 :             : static constexpr std::array UNREACHABLE_NETWORK_IDS{/*not_publicly_routable*/0, /*internal*/6};</span>
<span id="L65"><span class="lineNum">      65</span>                 :             : </span>
<span id="L66"><span class="lineNum">      66</span>                 :             : /** Default number of blocks to generate for RPC generatetoaddress. */</span>
<span id="L67"><span class="lineNum">      67</span>                 :             : static const std::string DEFAULT_NBLOCKS = &quot;1&quot;;</span>
<span id="L68"><span class="lineNum">      68</span>                 :             : </span>
<span id="L69"><span class="lineNum">      69</span>                 :             : /** Default -color setting. */</span>
<span id="L70"><span class="lineNum">      70</span>                 :             : static const std::string DEFAULT_COLOR_SETTING{&quot;auto&quot;};</span>
<span id="L71"><span class="lineNum">      71</span>                 :             : </span>
<span id="L72"><span class="lineNum">      72</span>                 :<span class="tlaGNC tlaBgGNC">         574 : static void SetupCliArgs(ArgsManager&amp; argsman)</span></span>
<span id="L73"><span class="lineNum">      73</span>                 :             : {</span>
<span id="L74"><span class="lineNum">      74</span>                 :<span class="tlaGNC">         574 :     SetupHelpOptions(argsman);</span></span>
<span id="L75"><span class="lineNum">      75</span>                 :             : </span>
<span id="L76"><span class="lineNum">      76</span>                 :<span class="tlaGNC">         574 :     const auto defaultBaseParams = CreateBaseChainParams(ChainType::MAIN);</span></span>
<span id="L77"><span class="lineNum">      77</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :     const auto testnetBaseParams = CreateBaseChainParams(ChainType::TESTNET);</span></span>
<span id="L78"><span class="lineNum">      78</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :     const auto testnet4BaseParams = CreateBaseChainParams(ChainType::TESTNET4);</span></span>
<span id="L79"><span class="lineNum">      79</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :     const auto signetBaseParams = CreateBaseChainParams(ChainType::SIGNET);</span></span>
<span id="L80"><span class="lineNum">      80</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :     const auto regtestBaseParams = CreateBaseChainParams(ChainType::REGTEST);</span></span>
<span id="L81"><span class="lineNum">      81</span>                 :             : </span>
<span id="L82"><span class="lineNum">      82</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-version&quot;, &quot;Print version and exit&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L83"><span class="lineNum">      83</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-conf=&lt;file&gt;&quot;, strprintf(&quot;Specify configuration file. Relative paths will be prefixed by datadir location. (default: %s)&quot;, BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L84"><span class="lineNum">      84</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-datadir=&lt;dir&gt;&quot;, &quot;Specify data directory&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L85"><span class="lineNum">      85</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-generate&quot;,</span></span>
<span id="L86"><span class="lineNum">      86</span>                 :<span class="tlaUNC tlaBgUNC">           0 :                    strprintf(&quot;Generate blocks, equivalent to RPC getnewaddress followed by RPC generatetoaddress. Optional positional integer &quot;</span></span>
<span id="L87"><span class="lineNum">      87</span>                 :             :                              &quot;arguments are number of blocks to generate (default: %s) and maximum iterations to try (default: %s), equivalent to &quot;</span>
<span id="L88"><span class="lineNum">      88</span>                 :             :                              &quot;RPC generatetoaddress nblocks and maxtries arguments. Example: bitcoin-cli -generate 4 1000&quot;,</span>
<span id="L89"><span class="lineNum">      89</span>                 :             :                              DEFAULT_NBLOCKS, DEFAULT_MAX_TRIES),</span>
<span id="L90"><span class="lineNum">      90</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         574 :                    ArgsManager::ALLOW_ANY, OptionsCategory::CLI_COMMANDS);</span></span>
<span id="L91"><span class="lineNum">      91</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-addrinfo&quot;, &quot;Get the number of addresses known to the node, per network and total, after filtering for quality and recency. The total number of addresses known to the node may be higher.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CLI_COMMANDS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L92"><span class="lineNum">      92</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-getinfo&quot;, &quot;Get general information from the remote server. Note that unlike server-side RPC calls, the output of -getinfo is the result of multiple non-atomic requests. Some entries in the output may represent results from different states (e.g. wallet balance may be as of a different block from the chain state reported)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CLI_COMMANDS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L93"><span class="lineNum">      93</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-netinfo&quot;, &quot;Get network peer connection information from the remote server. An optional integer argument from 0 to 4 can be passed for different peers listings (default: 0). Pass \&quot;help\&quot; for detailed help documentation.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CLI_COMMANDS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L94"><span class="lineNum">      94</span>                 :             : </span>
<span id="L95"><span class="lineNum">      95</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :     SetupChainParamsBaseOptions(argsman);</span></span>
<span id="L96"><span class="lineNum">      96</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-color=&lt;when&gt;&quot;, strprintf(&quot;Color setting for CLI output (default: %s). Valid values: always, auto (add color codes when standard output is connected to a terminal and OS is not WIN32), never.&quot;, DEFAULT_COLOR_SETTING), ArgsManager::ALLOW_ANY | ArgsManager::DISALLOW_NEGATION, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L97"><span class="lineNum">      97</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-named&quot;, strprintf(&quot;Pass named instead of positional arguments (default: %s)&quot;, DEFAULT_NAMED), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L98"><span class="lineNum">      98</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcclienttimeout=&lt;n&gt;&quot;, strprintf(&quot;Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)&quot;, DEFAULT_HTTP_CLIENT_TIMEOUT), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L99"><span class="lineNum">      99</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcconnect=&lt;ip&gt;&quot;, strprintf(&quot;Send commands to node running on &lt;ip&gt; (default: %s)&quot;, DEFAULT_RPCCONNECT), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L100"><span class="lineNum">     100</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpccookiefile=&lt;loc&gt;&quot;, &quot;Location of the auth cookie. Relative paths will be prefixed by a net-specific datadir location. (default: data dir)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L101"><span class="lineNum">     101</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcpassword=&lt;pw&gt;&quot;, &quot;Password for JSON-RPC connections&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L102"><span class="lineNum">     102</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcport=&lt;port&gt;&quot;, strprintf(&quot;Connect to JSON-RPC on &lt;port&gt; (default: %u, testnet: %u, testnet4: %u, signet: %u, regtest: %u)&quot;, defaultBaseParams-&gt;RPCPort(), testnetBaseParams-&gt;RPCPort(), testnet4BaseParams-&gt;RPCPort(), signetBaseParams-&gt;RPCPort(), regtestBaseParams-&gt;RPCPort()), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L103"><span class="lineNum">     103</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcuser=&lt;user&gt;&quot;, &quot;Username for JSON-RPC connections&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L104"><span class="lineNum">     104</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcwait&quot;, &quot;Wait for RPC server to start&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L105"><span class="lineNum">     105</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcwaittimeout=&lt;n&gt;&quot;, strprintf(&quot;Timeout in seconds to wait for the RPC server to start, or 0 for no timeout. (default: %d)&quot;, DEFAULT_WAIT_CLIENT_TIMEOUT), ArgsManager::ALLOW_ANY | ArgsManager::DISALLOW_NEGATION, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L106"><span class="lineNum">     106</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-rpcwallet=&lt;walletname&gt;&quot;, &quot;Send RPC for non-default wallet on RPC server (needs to exactly match corresponding -wallet option passed to bitcoind). This changes the RPC endpoint used, e.g. http://127.0.0.1:8332/wallet/&lt;walletname&gt;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L107"><span class="lineNum">     107</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-stdin&quot;, &quot;Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases). When combined with -stdinrpcpass, the first line from standard input is used for the RPC password.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L108"><span class="lineNum">     108</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-stdinrpcpass&quot;, &quot;Read RPC password from standard input as a single line. When combined with -stdin, the first line from standard input is used for the RPC password. When combined with -stdinwalletpassphrase, -stdinrpcpass consumes the first line, and -stdinwalletpassphrase consumes the second.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L109"><span class="lineNum">     109</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1148 :     argsman.AddArg(&quot;-stdinwalletpassphrase&quot;, &quot;Read wallet passphrase from standard input as a single line. When combined with -stdin, the first line from standard input is used for the wallet passphrase.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L110"><span class="lineNum">     110</span>                 :<span class="tlaGNC">         574 : }</span></span>
<span id="L111"><span class="lineNum">     111</span>                 :             : </span>
<span id="L112"><span class="lineNum">     112</span>                 :             : /** libevent event log callback */</span>
<span id="L113"><span class="lineNum">     113</span>                 :<span class="tlaUNC tlaBgUNC">           0 : static void libevent_log_cb(int severity, const char *msg)</span></span>
<span id="L114"><span class="lineNum">     114</span>                 :             : {</span>
<span id="L115"><span class="lineNum">     115</span>                 :             :     // Ignore everything other than errors</span>
<span id="L116"><span class="lineNum">     116</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (severity &gt;= EVENT_LOG_ERR) {</span></span>
<span id="L117"><span class="lineNum">     117</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         throw std::runtime_error(strprintf(&quot;libevent error: %s&quot;, msg));</span></span>
<span id="L118"><span class="lineNum">     118</span>                 :             :     }</span>
<span id="L119"><span class="lineNum">     119</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L120"><span class="lineNum">     120</span>                 :             : </span>
<span id="L121"><span class="lineNum">     121</span>                 :             : //</span>
<span id="L122"><span class="lineNum">     122</span>                 :             : // Exception thrown on connection error.  This error is used to determine</span>
<span id="L123"><span class="lineNum">     123</span>                 :             : // when to wait if -rpcwait is given.</span>
<span id="L124"><span class="lineNum">     124</span>                 :             : //</span>
<span id="L125"><span class="lineNum">     125</span>                 :             : class CConnectionFailed : public std::runtime_error</span>
<span id="L126"><span class="lineNum">     126</span>                 :             : {</span>
<span id="L127"><span class="lineNum">     127</span>                 :             : public:</span>
<span id="L128"><span class="lineNum">     128</span>                 :             : </span>
<span id="L129"><span class="lineNum">     129</span>                 :<span class="tlaGNC tlaBgGNC">          28 :     explicit inline CConnectionFailed(const std::string&amp; msg) :</span></span>
<span id="L130"><span class="lineNum">     130</span>   [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         std::runtime_error(msg)</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaUNC" title="Branch 6 was not taken"> - </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 18 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not taken"> - </span>]
<span id="L131"><span class="lineNum">     131</span>                 :             :     {}</span>
<span id="L132"><span class="lineNum">     132</span>                 :             : </span>
<span id="L133"><span class="lineNum">     133</span>                 :             : };</span>
<span id="L134"><span class="lineNum">     134</span>                 :             : </span>
<span id="L135"><span class="lineNum">     135</span>                 :             : //</span>
<span id="L136"><span class="lineNum">     136</span>                 :             : // This function returns either one of EXIT_ codes when it's expected to stop the process or</span>
<span id="L137"><span class="lineNum">     137</span>                 :             : // CONTINUE_EXECUTION when it's expected to continue further.</span>
<span id="L138"><span class="lineNum">     138</span>                 :             : //</span>
<span id="L139"><span class="lineNum">     139</span>                 :<span class="tlaGNC">         574 : static int AppInitRPC(int argc, char* argv[])</span></span>
<span id="L140"><span class="lineNum">     140</span>                 :             : {</span>
<span id="L141"><span class="lineNum">     141</span>                 :<span class="tlaGNC">         574 :     SetupCliArgs(gArgs);</span></span>
<span id="L142"><span class="lineNum">     142</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :     std::string error;</span></span>
<span id="L143"><span class="lineNum">     143</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 574 times"> + </span>]:<span class="tlaGNC">         574 :     if (!gArgs.ParseParameters(argc, argv, error)) {</span></span>
<span id="L144"><span class="lineNum">     144</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         tfm::format(std::cerr, &quot;Error parsing command line arguments: %s\n&quot;, error);</span></span>
<span id="L145"><span class="lineNum">     145</span>                 :             :         return EXIT_FAILURE;</span>
<span id="L146"><span class="lineNum">     146</span>                 :             :     }</span>
<span id="L147"><span class="lineNum">     147</span>   [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC tlaBgGNC">        1148 :     if (argc &lt; 2 || HelpRequested(gArgs) || gArgs.IsArgSet(&quot;-version&quot;)) {</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 574 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 572 times"> + </span><span class="tlaGBC" title="Branch 11 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 12 was taken 2 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaGBC" title="Branch 13 was taken 572 times"> + </span>]
<span id="L148"><span class="lineNum">     148</span>   [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">           4 :         std::string strUsage = PACKAGE_NAME &quot; RPC client version &quot; + FormatFullVersion() + &quot;\n&quot;;</span></span>
<span id="L149"><span class="lineNum">     149</span>                 :             : </span>
<span id="L150"><span class="lineNum">     150</span>   [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">           2 :         if (gArgs.IsArgSet(&quot;-version&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L151"><span class="lineNum">     151</span>   [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">           4 :             strUsage += FormatParagraph(LicenseInfo());</span></span>
<span id="L152"><span class="lineNum">     152</span>                 :             :         } else {</span>
<span id="L153"><span class="lineNum">     153</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             strUsage += &quot;\n&quot;</span></span>
<span id="L154"><span class="lineNum">     154</span>                 :             :                 &quot;Usage:  bitcoin-cli [options] &lt;command&gt; [params]  Send command to &quot; PACKAGE_NAME &quot;\n&quot;</span>
<span id="L155"><span class="lineNum">     155</span>                 :             :                 &quot;or:     bitcoin-cli [options] -named &lt;command&gt; [name=value]...  Send command to &quot; PACKAGE_NAME &quot; (with named arguments)\n&quot;</span>
<span id="L156"><span class="lineNum">     156</span>                 :             :                 &quot;or:     bitcoin-cli [options] help                List commands\n&quot;</span>
<span id="L157"><span class="lineNum">     157</span>                 :<span class="tlaUNC">           0 :                 &quot;or:     bitcoin-cli [options] help &lt;command&gt;      Get help for a command\n&quot;;</span></span>
<span id="L158"><span class="lineNum">     158</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             strUsage += &quot;\n&quot; + gArgs.GetHelpMessage();</span></span>
<span id="L159"><span class="lineNum">     159</span>                 :             :         }</span>
<span id="L160"><span class="lineNum">     160</span>                 :             : </span>
<span id="L161"><span class="lineNum">     161</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">           2 :         tfm::format(std::cout, &quot;%s&quot;, strUsage);</span></span>
<span id="L162"><span class="lineNum">     162</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span>]:<span class="tlaGNC">           2 :         if (argc &lt; 2) {</span></span>
<span id="L163"><span class="lineNum">     163</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             tfm::format(std::cerr, &quot;Error: too few parameters\n&quot;);</span></span>
<span id="L164"><span class="lineNum">     164</span>                 :             :             return EXIT_FAILURE;</span>
<span id="L165"><span class="lineNum">     165</span>                 :             :         }</span>
<span id="L166"><span class="lineNum">     166</span>                 :             :         return EXIT_SUCCESS;</span>
<span id="L167"><span class="lineNum">     167</span>                 :<span class="tlaGNC tlaBgGNC">           2 :     }</span></span>
<span id="L168"><span class="lineNum">     168</span>   [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 572 times"> + </span>]:<span class="tlaGNC">         572 :     if (!CheckDataDirOption(gArgs)) {</span></span>
<span id="L169"><span class="lineNum">     169</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC tlaBgUNC">           0 :         tfm::format(std::cerr, &quot;Error: Specified data directory \&quot;%s\&quot; does not exist.\n&quot;, gArgs.GetArg(&quot;-datadir&quot;, &quot;&quot;));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L170"><span class="lineNum">     170</span>                 :<span class="tlaUNC">           0 :         return EXIT_FAILURE;</span></span>
<span id="L171"><span class="lineNum">     171</span>                 :             :     }</span>
<span id="L172"><span class="lineNum">     172</span>   [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 572 times"> + </span>]:<span class="tlaGNC tlaBgGNC">         572 :     if (!gArgs.ReadConfigFiles(error, true)) {</span></span>
<span id="L173"><span class="lineNum">     173</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         tfm::format(std::cerr, &quot;Error reading configuration file: %s\n&quot;, error);</span></span>
<span id="L174"><span class="lineNum">     174</span>                 :             :         return EXIT_FAILURE;</span>
<span id="L175"><span class="lineNum">     175</span>                 :             :     }</span>
<span id="L176"><span class="lineNum">     176</span>                 :             :     // Check for chain settings (BaseParams() calls are only valid after this clause)</span>
<span id="L177"><span class="lineNum">     177</span>                 :<span class="tlaGNC tlaBgGNC">         572 :     try {</span></span>
<span id="L178"><span class="lineNum">     178</span>   [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         572 :         SelectBaseParams(gArgs.GetChainType());</span></span>
<span id="L179"><span class="lineNum">     179</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC tlaBgUNC">           0 :     } catch (const std::exception&amp; e) {</span></span>
<span id="L180"><span class="lineNum">     180</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         tfm::format(std::cerr, &quot;Error: %s\n&quot;, e.what());</span></span>
<span id="L181"><span class="lineNum">     181</span>                 :<span class="tlaUNC">           0 :         return EXIT_FAILURE;</span></span>
<span id="L182"><span class="lineNum">     182</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L183"><span class="lineNum">     183</span>                 :             :     return CONTINUE_EXECUTION;</span>
<span id="L184"><span class="lineNum">     184</span>                 :<span class="tlaGNC tlaBgGNC">         574 : }</span></span>
<span id="L185"><span class="lineNum">     185</span>                 :             : </span>
<span id="L186"><span class="lineNum">     186</span>                 :             : </span>
<span id="L187"><span class="lineNum">     187</span>                 :             : /** Reply structure for request_done to fill in */</span>
<span id="L188"><span class="lineNum">     188</span>                 :<span class="tlaGNC">         602 : struct HTTPReply</span></span>
<span id="L189"><span class="lineNum">     189</span>                 :             : {</span>
<span id="L190"><span class="lineNum">     190</span>                 :<span class="tlaGNC">         602 :     HTTPReply() = default;</span></span>
<span id="L191"><span class="lineNum">     191</span>                 :             : </span>
<span id="L192"><span class="lineNum">     192</span>                 :             :     int status{0};</span>
<span id="L193"><span class="lineNum">     193</span>                 :             :     int error{-1};</span>
<span id="L194"><span class="lineNum">     194</span>                 :             :     std::string body;</span>
<span id="L195"><span class="lineNum">     195</span>                 :             : };</span>
<span id="L196"><span class="lineNum">     196</span>                 :             : </span>
<span id="L197"><span class="lineNum">     197</span>                 :<span class="tlaUNC tlaBgUNC">           0 : static std::string http_errorstring(int code)</span></span>
<span id="L198"><span class="lineNum">     198</span>                 :             : {</span>
<span id="L199"><span class="lineNum">     199</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     switch(code) {</span></span>
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span>]
<span id="L200"><span class="lineNum">     200</span>                 :<span class="tlaUNC">           0 :     case EVREQ_HTTP_TIMEOUT:</span></span>
<span id="L201"><span class="lineNum">     201</span>                 :<span class="tlaUNC">           0 :         return &quot;timeout reached&quot;;</span></span>
<span id="L202"><span class="lineNum">     202</span>                 :<span class="tlaUNC">           0 :     case EVREQ_HTTP_EOF:</span></span>
<span id="L203"><span class="lineNum">     203</span>                 :<span class="tlaUNC">           0 :         return &quot;EOF reached&quot;;</span></span>
<span id="L204"><span class="lineNum">     204</span>                 :<span class="tlaUNC">           0 :     case EVREQ_HTTP_INVALID_HEADER:</span></span>
<span id="L205"><span class="lineNum">     205</span>                 :<span class="tlaUNC">           0 :         return &quot;error while reading header, or invalid header&quot;;</span></span>
<span id="L206"><span class="lineNum">     206</span>                 :<span class="tlaUNC">           0 :     case EVREQ_HTTP_BUFFER_ERROR:</span></span>
<span id="L207"><span class="lineNum">     207</span>                 :<span class="tlaUNC">           0 :         return &quot;error encountered while reading or writing&quot;;</span></span>
<span id="L208"><span class="lineNum">     208</span>                 :<span class="tlaUNC">           0 :     case EVREQ_HTTP_REQUEST_CANCEL:</span></span>
<span id="L209"><span class="lineNum">     209</span>                 :<span class="tlaUNC">           0 :         return &quot;request was canceled&quot;;</span></span>
<span id="L210"><span class="lineNum">     210</span>                 :<span class="tlaUNC">           0 :     case EVREQ_HTTP_DATA_TOO_LONG:</span></span>
<span id="L211"><span class="lineNum">     211</span>                 :<span class="tlaUNC">           0 :         return &quot;response body is larger than allowed&quot;;</span></span>
<span id="L212"><span class="lineNum">     212</span>                 :<span class="tlaUNC">           0 :     default:</span></span>
<span id="L213"><span class="lineNum">     213</span>                 :<span class="tlaUNC">           0 :         return &quot;unknown&quot;;</span></span>
<span id="L214"><span class="lineNum">     214</span>                 :             :     }</span>
<span id="L215"><span class="lineNum">     215</span>                 :             : }</span>
<span id="L216"><span class="lineNum">     216</span>                 :             : </span>
<span id="L217"><span class="lineNum">     217</span>                 :<span class="tlaGNC tlaBgGNC">         596 : static void http_request_done(struct evhttp_request *req, void *ctx)</span></span>
<span id="L218"><span class="lineNum">     218</span>                 :             : {</span>
<span id="L219"><span class="lineNum">     219</span>                 :<span class="tlaGNC">         596 :     HTTPReply *reply = static_cast&lt;HTTPReply*&gt;(ctx);</span></span>
<span id="L220"><span class="lineNum">     220</span>                 :             : </span>
<span id="L221"><span class="lineNum">     221</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 596 times"> + </span>]:<span class="tlaGNC">         596 :     if (req == nullptr) {</span></span>
<span id="L222"><span class="lineNum">     222</span>                 :             :         /* If req is nullptr, it means an error occurred while connecting: the</span>
<span id="L223"><span class="lineNum">     223</span>                 :             :          * error code will have been passed to http_error_cb.</span>
<span id="L224"><span class="lineNum">     224</span>                 :             :          */</span>
<span id="L225"><span class="lineNum">     225</span>                 :<span class="tlaUNC tlaBgUNC">           0 :         reply-&gt;status = 0;</span></span>
<span id="L226"><span class="lineNum">     226</span>                 :<span class="tlaUNC">           0 :         return;</span></span>
<span id="L227"><span class="lineNum">     227</span>                 :             :     }</span>
<span id="L228"><span class="lineNum">     228</span>                 :             : </span>
<span id="L229"><span class="lineNum">     229</span>                 :<span class="tlaGNC tlaBgGNC">         596 :     reply-&gt;status = evhttp_request_get_response_code(req);</span></span>
<span id="L230"><span class="lineNum">     230</span>                 :             : </span>
<span id="L231"><span class="lineNum">     231</span>                 :<span class="tlaGNC">         596 :     struct evbuffer *buf = evhttp_request_get_input_buffer(req);</span></span>
<span id="L232"><span class="lineNum">     232</span>         [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         596 :     if (buf)</span></span>
<span id="L233"><span class="lineNum">     233</span>                 :             :     {</span>
<span id="L234"><span class="lineNum">     234</span>                 :<span class="tlaGNC">         596 :         size_t size = evbuffer_get_length(buf);</span></span>
<span id="L235"><span class="lineNum">     235</span>                 :<span class="tlaGNC">         596 :         const char *data = (const char*)evbuffer_pullup(buf, size);</span></span>
<span id="L236"><span class="lineNum">     236</span>         [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 24 times"> + </span>]:<span class="tlaGNC">         596 :         if (data)</span></span>
<span id="L237"><span class="lineNum">     237</span>                 :<span class="tlaGNC">         572 :             reply-&gt;body = std::string(data, size);</span></span>
<span id="L238"><span class="lineNum">     238</span>                 :<span class="tlaGNC">         596 :         evbuffer_drain(buf, size);</span></span>
<span id="L239"><span class="lineNum">     239</span>                 :             :     }</span>
<span id="L240"><span class="lineNum">     240</span>                 :             : }</span>
<span id="L241"><span class="lineNum">     241</span>                 :             : </span>
<span id="L242"><span class="lineNum">     242</span>                 :<span class="tlaUNC tlaBgUNC">           0 : static void http_error_cb(enum evhttp_request_error err, void *ctx)</span></span>
<span id="L243"><span class="lineNum">     243</span>                 :             : {</span>
<span id="L244"><span class="lineNum">     244</span>                 :<span class="tlaUNC">           0 :     HTTPReply *reply = static_cast&lt;HTTPReply*&gt;(ctx);</span></span>
<span id="L245"><span class="lineNum">     245</span>                 :<span class="tlaUNC">           0 :     reply-&gt;error = err;</span></span>
<span id="L246"><span class="lineNum">     246</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L247"><span class="lineNum">     247</span>                 :             : </span>
<span id="L248"><span class="lineNum">     248</span>                 :             : /** Class that handles the conversion from a command-line to a JSON-RPC request,</span>
<span id="L249"><span class="lineNum">     249</span>                 :             :  * as well as converting back to a JSON object that can be shown as result.</span>
<span id="L250"><span class="lineNum">     250</span>                 :             :  */</span>
<span id="L251"><span class="lineNum">     251</span>                 :<span class="tlaGNC tlaBgGNC">         544 : class BaseRequestHandler</span></span>
<span id="L252"><span class="lineNum">     252</span>                 :             : {</span>
<span id="L253"><span class="lineNum">     253</span>                 :             : public:</span>
<span id="L254"><span class="lineNum">     254</span>                 :<span class="tlaGNC">          60 :     virtual ~BaseRequestHandler() = default;</span></span>
<span id="L255"><span class="lineNum">     255</span>                 :             :     virtual UniValue PrepareRequest(const std::string&amp; method, const std::vector&lt;std::string&gt;&amp; args) = 0;</span>
<span id="L256"><span class="lineNum">     256</span>                 :             :     virtual UniValue ProcessReply(const UniValue &amp;batch_in) = 0;</span>
<span id="L257"><span class="lineNum">     257</span>                 :             : };</span>
<span id="L258"><span class="lineNum">     258</span>                 :             : </span>
<span id="L259"><span class="lineNum">     259</span>                 :             : /** Process addrinfo requests */</span>
<span id="L260"><span class="lineNum">     260</span>                 :<span class="tlaUNC tlaBgUNC">           0 : class AddrinfoRequestHandler : public BaseRequestHandler</span></span>
<span id="L261"><span class="lineNum">     261</span>                 :             : {</span>
<span id="L262"><span class="lineNum">     262</span>                 :             : private:</span>
<span id="L263"><span class="lineNum">     263</span>                 :<span class="tlaUNC">           0 :     int8_t NetworkStringToId(const std::string&amp; str) const</span></span>
<span id="L264"><span class="lineNum">     264</span>                 :             :     {</span>
<span id="L265"><span class="lineNum">     265</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (size_t i = 0; i &lt; NETWORKS.size(); ++i) {</span></span>
<span id="L266"><span class="lineNum">     266</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (str == NETWORKS[i]) return i;</span></span>
<span id="L267"><span class="lineNum">     267</span>                 :             :         }</span>
<span id="L268"><span class="lineNum">     268</span>                 :             :         return UNKNOWN_NETWORK;</span>
<span id="L269"><span class="lineNum">     269</span>                 :             :     }</span>
<span id="L270"><span class="lineNum">     270</span>                 :             : </span>
<span id="L271"><span class="lineNum">     271</span>                 :             : public:</span>
<span id="L272"><span class="lineNum">     272</span>                 :<span class="tlaUNC">           0 :     UniValue PrepareRequest(const std::string&amp; method, const std::vector&lt;std::string&gt;&amp; args) override</span></span>
<span id="L273"><span class="lineNum">     273</span>                 :             :     {</span>
<span id="L274"><span class="lineNum">     274</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!args.empty()) {</span></span>
<span id="L275"><span class="lineNum">     275</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             throw std::runtime_error(&quot;-addrinfo takes no arguments&quot;);</span></span>
<span id="L276"><span class="lineNum">     276</span>                 :             :         }</span>
<span id="L277"><span class="lineNum">     277</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         UniValue params{RPCConvertValues(&quot;getnodeaddresses&quot;, std::vector&lt;std::string&gt;{{&quot;0&quot;}})};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L278"><span class="lineNum">     278</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return JSONRPCRequestObj(&quot;getnodeaddresses&quot;, params, 1);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L279"><span class="lineNum">     279</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L280"><span class="lineNum">     280</span>                 :             : </span>
<span id="L281"><span class="lineNum">     281</span>                 :<span class="tlaUNC">           0 :     UniValue ProcessReply(const UniValue&amp; reply) override</span></span>
<span id="L282"><span class="lineNum">     282</span>                 :             :     {</span>
<span id="L283"><span class="lineNum">     283</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!reply[&quot;error&quot;].isNull()) return reply;</span></span>
<span id="L284"><span class="lineNum">     284</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const std::vector&lt;UniValue&gt;&amp; nodes{reply[&quot;result&quot;].getValues()};</span></span>
<span id="L285"><span class="lineNum">     285</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!nodes.empty() &amp;&amp; nodes.at(0)[&quot;network&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L286"><span class="lineNum">     286</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             throw std::runtime_error(&quot;-addrinfo requires bitcoind server to be running v22.0 and up&quot;);</span></span>
<span id="L287"><span class="lineNum">     287</span>                 :             :         }</span>
<span id="L288"><span class="lineNum">     288</span>                 :             :         // Count the number of peers known to our node, by network.</span>
<span id="L289"><span class="lineNum">     289</span>                 :<span class="tlaUNC">           0 :         std::array&lt;uint64_t, NETWORKS.size()&gt; counts{{}};</span></span>
<span id="L290"><span class="lineNum">     290</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (const UniValue&amp; node : nodes) {</span></span>
<span id="L291"><span class="lineNum">     291</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             std::string network_name{node[&quot;network&quot;].get_str()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L292"><span class="lineNum">     292</span>                 :<span class="tlaUNC">           0 :             const int8_t network_id{NetworkStringToId(network_name)};</span></span>
<span id="L293"><span class="lineNum">     293</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (network_id == UNKNOWN_NETWORK) continue;</span></span>
<span id="L294"><span class="lineNum">     294</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             ++counts.at(network_id);</span></span>
<span id="L295"><span class="lineNum">     295</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L296"><span class="lineNum">     296</span>                 :             :         // Prepare result to return to user.</span>
<span id="L297"><span class="lineNum">     297</span>                 :<span class="tlaUNC">           0 :         UniValue result{UniValue::VOBJ}, addresses{UniValue::VOBJ};</span></span>
<span id="L298"><span class="lineNum">     298</span>                 :<span class="tlaUNC">           0 :         uint64_t total{0}; // Total address count</span></span>
<span id="L299"><span class="lineNum">     299</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (size_t i = 1; i &lt; NETWORKS.size() - 1; ++i) {</span></span>
<span id="L300"><span class="lineNum">     300</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             addresses.pushKV(NETWORKS[i], counts.at(i));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L301"><span class="lineNum">     301</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             total += counts.at(i);</span></span>
<span id="L302"><span class="lineNum">     302</span>                 :             :         }</span>
<span id="L303"><span class="lineNum">     303</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         addresses.pushKV(&quot;total&quot;, total);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L304"><span class="lineNum">     304</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         result.pushKV(&quot;addresses_known&quot;, std::move(addresses));</span></span>
<span id="L305"><span class="lineNum">     305</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return JSONRPCReplyObj(std::move(result), NullUniValue, /*id=*/1, JSONRPCVersion::V2);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L306"><span class="lineNum">     306</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L307"><span class="lineNum">     307</span>                 :             : };</span>
<span id="L308"><span class="lineNum">     308</span>                 :             : </span>
<span id="L309"><span class="lineNum">     309</span>                 :             : /** Process getinfo requests */</span>
<span id="L310"><span class="lineNum">     310</span>                 :<span class="tlaGNC tlaBgGNC">          30 : class GetinfoRequestHandler: public BaseRequestHandler</span></span>
<span id="L311"><span class="lineNum">     311</span>                 :             : {</span>
<span id="L312"><span class="lineNum">     312</span>                 :             : public:</span>
<span id="L313"><span class="lineNum">     313</span>                 :             :     const int ID_NETWORKINFO = 0;</span>
<span id="L314"><span class="lineNum">     314</span>                 :             :     const int ID_BLOCKCHAININFO = 1;</span>
<span id="L315"><span class="lineNum">     315</span>                 :             :     const int ID_WALLETINFO = 2;</span>
<span id="L316"><span class="lineNum">     316</span>                 :             :     const int ID_BALANCES = 3;</span>
<span id="L317"><span class="lineNum">     317</span>                 :             : </span>
<span id="L318"><span class="lineNum">     318</span>                 :             :     /** Create a simulated `getinfo` request. */</span>
<span id="L319"><span class="lineNum">     319</span>                 :<span class="tlaGNC">          30 :     UniValue PrepareRequest(const std::string&amp; method, const std::vector&lt;std::string&gt;&amp; args) override</span></span>
<span id="L320"><span class="lineNum">     320</span>                 :             :     {</span>
<span id="L321"><span class="lineNum">     321</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 28 times"> + </span>]:<span class="tlaGNC">          30 :         if (!args.empty()) {</span></span>
<span id="L322"><span class="lineNum">     322</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :             throw std::runtime_error(&quot;-getinfo takes no arguments&quot;);</span></span>
<span id="L323"><span class="lineNum">     323</span>                 :             :         }</span>
<span id="L324"><span class="lineNum">     324</span>                 :<span class="tlaGNC">          28 :         UniValue result(UniValue::VARR);</span></span>
<span id="L325"><span class="lineNum">     325</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result.push_back(JSONRPCRequestObj(&quot;getnetworkinfo&quot;, NullUniValue, ID_NETWORKINFO));</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L326"><span class="lineNum">     326</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result.push_back(JSONRPCRequestObj(&quot;getblockchaininfo&quot;, NullUniValue, ID_BLOCKCHAININFO));</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L327"><span class="lineNum">     327</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result.push_back(JSONRPCRequestObj(&quot;getwalletinfo&quot;, NullUniValue, ID_WALLETINFO));</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L328"><span class="lineNum">     328</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result.push_back(JSONRPCRequestObj(&quot;getbalances&quot;, NullUniValue, ID_BALANCES));</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L329"><span class="lineNum">     329</span>                 :<span class="tlaGNC">          28 :         return result;</span></span>
<span id="L330"><span class="lineNum">     330</span>                 :<span class="tlaUNC tlaBgUNC">           0 :     }</span></span>
<span id="L331"><span class="lineNum">     331</span>                 :             : </span>
<span id="L332"><span class="lineNum">     332</span>                 :             :     /** Collect values from the batch and form a simulated `getinfo` reply. */</span>
<span id="L333"><span class="lineNum">     333</span>                 :<span class="tlaGNC tlaBgGNC">          28 :     UniValue ProcessReply(const UniValue &amp;batch_in) override</span></span>
<span id="L334"><span class="lineNum">     334</span>                 :             :     {</span>
<span id="L335"><span class="lineNum">     335</span>                 :<span class="tlaGNC">          28 :         UniValue result(UniValue::VOBJ);</span></span>
<span id="L336"><span class="lineNum">     336</span>         [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          28 :         const std::vector&lt;UniValue&gt; batch = JSONRPCProcessBatchReply(batch_in);</span></span>
<span id="L337"><span class="lineNum">     337</span>                 :             :         // Errors in getnetworkinfo() and getblockchaininfo() are fatal, pass them on;</span>
<span id="L338"><span class="lineNum">     338</span>                 :             :         // getwalletinfo() and getbalances() are allowed to fail if there is no wallet.</span>
<span id="L339"><span class="lineNum">     339</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         if (!batch[ID_NETWORKINFO][&quot;error&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 28 times"> + </span>]
<span id="L340"><span class="lineNum">     340</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             return batch[ID_NETWORKINFO];</span></span>
<span id="L341"><span class="lineNum">     341</span>                 :             :         }</span>
<span id="L342"><span class="lineNum">     342</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC tlaBgGNC">          28 :         if (!batch[ID_BLOCKCHAININFO][&quot;error&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 28 times"> + </span>]
<span id="L343"><span class="lineNum">     343</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             return batch[ID_BLOCKCHAININFO];</span></span>
<span id="L344"><span class="lineNum">     344</span>                 :             :         }</span>
<span id="L345"><span class="lineNum">     345</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC tlaBgGNC">          56 :         result.pushKV(&quot;version&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;version&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L346"><span class="lineNum">     346</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;blocks&quot;, batch[ID_BLOCKCHAININFO][&quot;result&quot;][&quot;blocks&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L347"><span class="lineNum">     347</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;headers&quot;, batch[ID_BLOCKCHAININFO][&quot;result&quot;][&quot;headers&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L348"><span class="lineNum">     348</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;verificationprogress&quot;, batch[ID_BLOCKCHAININFO][&quot;result&quot;][&quot;verificationprogress&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L349"><span class="lineNum">     349</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;timeoffset&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;timeoffset&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L350"><span class="lineNum">     350</span>                 :             : </span>
<span id="L351"><span class="lineNum">     351</span>                 :<span class="tlaGNC">          28 :         UniValue connections(UniValue::VOBJ);</span></span>
<span id="L352"><span class="lineNum">     352</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         connections.pushKV(&quot;in&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;connections_in&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L353"><span class="lineNum">     353</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         connections.pushKV(&quot;out&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;connections_out&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L354"><span class="lineNum">     354</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         connections.pushKV(&quot;total&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;connections&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L355"><span class="lineNum">     355</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          56 :         result.pushKV(&quot;connections&quot;, std::move(connections));</span></span>
<span id="L356"><span class="lineNum">     356</span>                 :             : </span>
<span id="L357"><span class="lineNum">     357</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;networks&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;networks&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L358"><span class="lineNum">     358</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;difficulty&quot;, batch[ID_BLOCKCHAININFO][&quot;result&quot;][&quot;difficulty&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L359"><span class="lineNum">     359</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;chain&quot;, UniValue(batch[ID_BLOCKCHAININFO][&quot;result&quot;][&quot;chain&quot;]));</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L360"><span class="lineNum">     360</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         if (!batch[ID_WALLETINFO][&quot;result&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 14 times"> + </span>]
<span id="L361"><span class="lineNum">     361</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :             result.pushKV(&quot;has_wallet&quot;, true);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L362"><span class="lineNum">     362</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :             result.pushKV(&quot;keypoolsize&quot;, batch[ID_WALLETINFO][&quot;result&quot;][&quot;keypoolsize&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 14 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 14 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L363"><span class="lineNum">     363</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :             result.pushKV(&quot;walletname&quot;, batch[ID_WALLETINFO][&quot;result&quot;][&quot;walletname&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 14 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 14 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L364"><span class="lineNum">     364</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          14 :             if (!batch[ID_WALLETINFO][&quot;result&quot;][&quot;unlocked_until&quot;].isNull()) {</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 12 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaGBC" title="Branch 9 was taken 2 times"> + </span>]
<span id="L365"><span class="lineNum">     365</span>   [<span class="tlaGBC" title="Branch 0 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          24 :                 result.pushKV(&quot;unlocked_until&quot;, batch[ID_WALLETINFO][&quot;result&quot;][&quot;unlocked_until&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 12 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 12 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L366"><span class="lineNum">     366</span>                 :             :             }</span>
<span id="L367"><span class="lineNum">     367</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :             result.pushKV(&quot;paytxfee&quot;, batch[ID_WALLETINFO][&quot;result&quot;][&quot;paytxfee&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 14 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 14 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L368"><span class="lineNum">     368</span>                 :             :         }</span>
<span id="L369"><span class="lineNum">     369</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         if (!batch[ID_BALANCES][&quot;result&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 14 times"> + </span>]
<span id="L370"><span class="lineNum">     370</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :             result.pushKV(&quot;balance&quot;, batch[ID_BALANCES][&quot;result&quot;][&quot;mine&quot;][&quot;trusted&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 14 times"> + </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 14 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 15 was not taken"> - </span><span class="tlaGBC" title="Branch 16 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 17 was not taken"> - </span>]
<span id="L371"><span class="lineNum">     371</span>                 :             :         }</span>
<span id="L372"><span class="lineNum">     372</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;relayfee&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;relayfee&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L373"><span class="lineNum">     373</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          56 :         result.pushKV(&quot;warnings&quot;, batch[ID_NETWORKINFO][&quot;result&quot;][&quot;warnings&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 28 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 28 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L374"><span class="lineNum">     374</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         return JSONRPCReplyObj(std::move(result), NullUniValue,  /*id=*/1, JSONRPCVersion::V2);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L375"><span class="lineNum">     375</span>                 :<span class="tlaGNC">          28 :     }</span></span>
<span id="L376"><span class="lineNum">     376</span>                 :             : };</span>
<span id="L377"><span class="lineNum">     377</span>                 :             : </span>
<span id="L378"><span class="lineNum">     378</span>                 :             : /** Process netinfo requests */</span>
<span id="L379"><span class="lineNum">     379</span>                 :             : class NetinfoRequestHandler : public BaseRequestHandler</span>
<span id="L380"><span class="lineNum">     380</span>                 :             : {</span>
<span id="L381"><span class="lineNum">     381</span>                 :             : private:</span>
<span id="L382"><span class="lineNum">     382</span>                 :             :     static constexpr uint8_t MAX_DETAIL_LEVEL{4};</span>
<span id="L383"><span class="lineNum">     383</span>                 :             :     std::array&lt;std::array&lt;uint16_t, NETWORKS.size() + 1&gt;, 3&gt; m_counts{{{}}}; //!&lt; Peer counts by (in/out/total, networks/total)</span>
<span id="L384"><span class="lineNum">     384</span>                 :             :     uint8_t m_block_relay_peers_count{0};</span>
<span id="L385"><span class="lineNum">     385</span>                 :             :     uint8_t m_manual_peers_count{0};</span>
<span id="L386"><span class="lineNum">     386</span>                 :<span class="tlaUNC tlaBgUNC">           0 :     int8_t NetworkStringToId(const std::string&amp; str) const</span></span>
<span id="L387"><span class="lineNum">     387</span>                 :             :     {</span>
<span id="L388"><span class="lineNum">     388</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (size_t i = 0; i &lt; NETWORKS.size(); ++i) {</span></span>
<span id="L389"><span class="lineNum">     389</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (str == NETWORKS[i]) return i;</span></span>
<span id="L390"><span class="lineNum">     390</span>                 :             :         }</span>
<span id="L391"><span class="lineNum">     391</span>                 :             :         return UNKNOWN_NETWORK;</span>
<span id="L392"><span class="lineNum">     392</span>                 :             :     }</span>
<span id="L393"><span class="lineNum">     393</span>                 :             :     uint8_t m_details_level{0}; //!&lt; Optional user-supplied arg to set dashboard details level</span>
<span id="L394"><span class="lineNum">     394</span>                 :<span class="tlaUNC">           0 :     bool DetailsRequested() const { return m_details_level &gt; 0 &amp;&amp; m_details_level &lt; 5; }</span></span>
<span id="L395"><span class="lineNum">     395</span>                 :<span class="tlaUNC">           0 :     bool IsAddressSelected() const { return m_details_level == 2 || m_details_level == 4; }</span></span>
<span id="L396"><span class="lineNum">     396</span>                 :<span class="tlaUNC">           0 :     bool IsVersionSelected() const { return m_details_level == 3 || m_details_level == 4; }</span></span>
<span id="L397"><span class="lineNum">     397</span>                 :             :     bool m_is_asmap_on{false};</span>
<span id="L398"><span class="lineNum">     398</span>                 :             :     size_t m_max_addr_length{0};</span>
<span id="L399"><span class="lineNum">     399</span>                 :             :     size_t m_max_addr_processed_length{5};</span>
<span id="L400"><span class="lineNum">     400</span>                 :             :     size_t m_max_addr_rate_limited_length{6};</span>
<span id="L401"><span class="lineNum">     401</span>                 :             :     size_t m_max_age_length{5};</span>
<span id="L402"><span class="lineNum">     402</span>                 :             :     size_t m_max_id_length{2};</span>
<span id="L403"><span class="lineNum">     403</span>                 :             :     struct Peer {</span>
<span id="L404"><span class="lineNum">     404</span>                 :             :         std::string addr;</span>
<span id="L405"><span class="lineNum">     405</span>                 :             :         std::string sub_version;</span>
<span id="L406"><span class="lineNum">     406</span>                 :             :         std::string conn_type;</span>
<span id="L407"><span class="lineNum">     407</span>                 :             :         std::string network;</span>
<span id="L408"><span class="lineNum">     408</span>                 :             :         std::string age;</span>
<span id="L409"><span class="lineNum">     409</span>                 :             :         std::string transport_protocol_type;</span>
<span id="L410"><span class="lineNum">     410</span>                 :             :         double min_ping;</span>
<span id="L411"><span class="lineNum">     411</span>                 :             :         double ping;</span>
<span id="L412"><span class="lineNum">     412</span>                 :             :         int64_t addr_processed;</span>
<span id="L413"><span class="lineNum">     413</span>                 :             :         int64_t addr_rate_limited;</span>
<span id="L414"><span class="lineNum">     414</span>                 :             :         int64_t last_blck;</span>
<span id="L415"><span class="lineNum">     415</span>                 :             :         int64_t last_recv;</span>
<span id="L416"><span class="lineNum">     416</span>                 :             :         int64_t last_send;</span>
<span id="L417"><span class="lineNum">     417</span>                 :             :         int64_t last_trxn;</span>
<span id="L418"><span class="lineNum">     418</span>                 :             :         int id;</span>
<span id="L419"><span class="lineNum">     419</span>                 :             :         int mapped_as;</span>
<span id="L420"><span class="lineNum">     420</span>                 :             :         int version;</span>
<span id="L421"><span class="lineNum">     421</span>                 :             :         bool is_addr_relay_enabled;</span>
<span id="L422"><span class="lineNum">     422</span>                 :             :         bool is_bip152_hb_from;</span>
<span id="L423"><span class="lineNum">     423</span>                 :             :         bool is_bip152_hb_to;</span>
<span id="L424"><span class="lineNum">     424</span>                 :             :         bool is_outbound;</span>
<span id="L425"><span class="lineNum">     425</span>                 :             :         bool is_tx_relay;</span>
<span id="L426"><span class="lineNum">     426</span>                 :<span class="tlaUNC">           0 :         bool operator&lt;(const Peer&amp; rhs) const { return std::tie(is_outbound, min_ping) &lt; std::tie(rhs.is_outbound, rhs.min_ping); }</span></span>
<span id="L427"><span class="lineNum">     427</span>                 :             :     };</span>
<span id="L428"><span class="lineNum">     428</span>                 :             :     std::vector&lt;Peer&gt; m_peers;</span>
<span id="L429"><span class="lineNum">     429</span>                 :<span class="tlaUNC">           0 :     std::string ChainToString() const</span></span>
<span id="L430"><span class="lineNum">     430</span>                 :             :     {</span>
<span id="L431"><span class="lineNum">     431</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         switch (gArgs.GetChainType()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L432"><span class="lineNum">     432</span>                 :<span class="tlaUNC">           0 :         case ChainType::TESTNET4:</span></span>
<span id="L433"><span class="lineNum">     433</span>                 :<span class="tlaUNC">           0 :             return &quot; testnet4&quot;;</span></span>
<span id="L434"><span class="lineNum">     434</span>                 :<span class="tlaUNC">           0 :         case ChainType::TESTNET:</span></span>
<span id="L435"><span class="lineNum">     435</span>                 :<span class="tlaUNC">           0 :             return &quot; testnet&quot;;</span></span>
<span id="L436"><span class="lineNum">     436</span>                 :<span class="tlaUNC">           0 :         case ChainType::SIGNET:</span></span>
<span id="L437"><span class="lineNum">     437</span>                 :<span class="tlaUNC">           0 :             return &quot; signet&quot;;</span></span>
<span id="L438"><span class="lineNum">     438</span>                 :<span class="tlaUNC">           0 :         case ChainType::REGTEST:</span></span>
<span id="L439"><span class="lineNum">     439</span>                 :<span class="tlaUNC">           0 :             return &quot; regtest&quot;;</span></span>
<span id="L440"><span class="lineNum">     440</span>                 :<span class="tlaUNC">           0 :         case ChainType::MAIN:</span></span>
<span id="L441"><span class="lineNum">     441</span>                 :<span class="tlaUNC">           0 :             return &quot;&quot;;</span></span>
<span id="L442"><span class="lineNum">     442</span>                 :             :         }</span>
<span id="L443"><span class="lineNum">     443</span>                 :<span class="tlaUNC">           0 :         assert(false);</span></span>
<span id="L444"><span class="lineNum">     444</span>                 :             :     }</span>
<span id="L445"><span class="lineNum">     445</span>                 :<span class="tlaUNC">           0 :     std::string PingTimeToString(double seconds) const</span></span>
<span id="L446"><span class="lineNum">     446</span>                 :             :     {</span>
<span id="L447"><span class="lineNum">     447</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (seconds &lt; 0) return &quot;&quot;;</span></span>
<span id="L448"><span class="lineNum">     448</span>                 :<span class="tlaUNC">           0 :         const double milliseconds{round(1000 * seconds)};</span></span>
<span id="L449"><span class="lineNum">     449</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return milliseconds &gt; 999999 ? &quot;-&quot; : ToString(milliseconds);</span></span>
<span id="L450"><span class="lineNum">     450</span>                 :             :     }</span>
<span id="L451"><span class="lineNum">     451</span>                 :<span class="tlaUNC">           0 :     std::string ConnectionTypeForNetinfo(const std::string&amp; conn_type) const</span></span>
<span id="L452"><span class="lineNum">     452</span>                 :             :     {</span>
<span id="L453"><span class="lineNum">     453</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (conn_type == &quot;outbound-full-relay&quot;) return &quot;full&quot;;</span></span>
<span id="L454"><span class="lineNum">     454</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (conn_type == &quot;block-relay-only&quot;) return &quot;block&quot;;</span></span>
<span id="L455"><span class="lineNum">     455</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (conn_type == &quot;manual&quot; || conn_type == &quot;feeler&quot;) return conn_type;</span></span>
<span id="L456"><span class="lineNum">     456</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (conn_type == &quot;addr-fetch&quot;) return &quot;addr&quot;;</span></span>
<span id="L457"><span class="lineNum">     457</span>                 :<span class="tlaUNC">           0 :         return &quot;&quot;;</span></span>
<span id="L458"><span class="lineNum">     458</span>                 :             :     }</span>
<span id="L459"><span class="lineNum">     459</span>                 :             : </span>
<span id="L460"><span class="lineNum">     460</span>                 :             : public:</span>
<span id="L461"><span class="lineNum">     461</span>                 :             :     static constexpr int ID_PEERINFO = 0;</span>
<span id="L462"><span class="lineNum">     462</span>                 :             :     static constexpr int ID_NETWORKINFO = 1;</span>
<span id="L463"><span class="lineNum">     463</span>                 :             : </span>
<span id="L464"><span class="lineNum">     464</span>                 :<span class="tlaUNC">           0 :     UniValue PrepareRequest(const std::string&amp; method, const std::vector&lt;std::string&gt;&amp; args) override</span></span>
<span id="L465"><span class="lineNum">     465</span>                 :             :     {</span>
<span id="L466"><span class="lineNum">     466</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!args.empty()) {</span></span>
<span id="L467"><span class="lineNum">     467</span>                 :<span class="tlaUNC">           0 :             uint8_t n{0};</span></span>
<span id="L468"><span class="lineNum">     468</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (ParseUInt8(args.at(0), &amp;n)) {</span></span>
<span id="L469"><span class="lineNum">     469</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_details_level = std::min(n, MAX_DETAIL_LEVEL);</span></span>
<span id="L470"><span class="lineNum">     470</span>                 :             :             } else {</span>
<span id="L471"><span class="lineNum">     471</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 throw std::runtime_error(strprintf(&quot;invalid -netinfo argument: %s\nFor more information, run: bitcoin-cli -netinfo help&quot;, args.at(0)));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L472"><span class="lineNum">     472</span>                 :             :             }</span>
<span id="L473"><span class="lineNum">     473</span>                 :             :         }</span>
<span id="L474"><span class="lineNum">     474</span>                 :<span class="tlaUNC">           0 :         UniValue result(UniValue::VARR);</span></span>
<span id="L475"><span class="lineNum">     475</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         result.push_back(JSONRPCRequestObj(&quot;getpeerinfo&quot;, NullUniValue, ID_PEERINFO));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L476"><span class="lineNum">     476</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         result.push_back(JSONRPCRequestObj(&quot;getnetworkinfo&quot;, NullUniValue, ID_NETWORKINFO));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L477"><span class="lineNum">     477</span>                 :<span class="tlaUNC">           0 :         return result;</span></span>
<span id="L478"><span class="lineNum">     478</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L479"><span class="lineNum">     479</span>                 :             : </span>
<span id="L480"><span class="lineNum">     480</span>                 :<span class="tlaUNC">           0 :     UniValue ProcessReply(const UniValue&amp; batch_in) override</span></span>
<span id="L481"><span class="lineNum">     481</span>                 :             :     {</span>
<span id="L482"><span class="lineNum">     482</span>                 :<span class="tlaUNC">           0 :         const std::vector&lt;UniValue&gt; batch{JSONRPCProcessBatchReply(batch_in)};</span></span>
<span id="L483"><span class="lineNum">     483</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!batch[ID_PEERINFO][&quot;error&quot;].isNull()) return batch[ID_PEERINFO];</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L484"><span class="lineNum">     484</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!batch[ID_NETWORKINFO][&quot;error&quot;].isNull()) return batch[ID_NETWORKINFO];</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L485"><span class="lineNum">     485</span>                 :             : </span>
<span id="L486"><span class="lineNum">     486</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const UniValue&amp; networkinfo{batch[ID_NETWORKINFO][&quot;result&quot;]};</span></span>
<span id="L487"><span class="lineNum">     487</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (networkinfo[&quot;version&quot;].getInt&lt;int&gt;() &lt; 209900) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L488"><span class="lineNum">     488</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             throw std::runtime_error(&quot;-netinfo requires bitcoind server to be running v0.21.0 and up&quot;);</span></span>
<span id="L489"><span class="lineNum">     489</span>                 :             :         }</span>
<span id="L490"><span class="lineNum">     490</span>                 :<span class="tlaUNC">           0 :         const int64_t time_now{TicksSinceEpoch&lt;std::chrono::seconds&gt;(CliClock::now())};</span></span>
<span id="L491"><span class="lineNum">     491</span>                 :             : </span>
<span id="L492"><span class="lineNum">     492</span>                 :             :         // Count peer connection totals, and if DetailsRequested(), store peer data in a vector of structs.</span>
<span id="L493"><span class="lineNum">     493</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         for (const UniValue&amp; peer : batch[ID_PEERINFO][&quot;result&quot;].getValues()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L494"><span class="lineNum">     494</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             const std::string network{peer[&quot;network&quot;].get_str()};</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L495"><span class="lineNum">     495</span>                 :<span class="tlaUNC">           0 :             const int8_t network_id{NetworkStringToId(network)};</span></span>
<span id="L496"><span class="lineNum">     496</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (network_id == UNKNOWN_NETWORK) continue;</span></span>
<span id="L497"><span class="lineNum">     497</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             const bool is_outbound{!peer[&quot;inbound&quot;].get_bool()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L498"><span class="lineNum">     498</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             const bool is_tx_relay{peer[&quot;relaytxes&quot;].isNull() ? true : peer[&quot;relaytxes&quot;].get_bool()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L499"><span class="lineNum">     499</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             const std::string conn_type{peer[&quot;connection_type&quot;].get_str()};</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L500"><span class="lineNum">     500</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             ++m_counts.at(is_outbound).at(network_id);      // in/out by network</span></span>
<span id="L501"><span class="lineNum">     501</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             ++m_counts.at(is_outbound).at(NETWORKS.size()); // in/out overall</span></span>
<span id="L502"><span class="lineNum">     502</span>                 :<span class="tlaUNC">           0 :             ++m_counts.at(2).at(network_id);                // total by network</span></span>
<span id="L503"><span class="lineNum">     503</span>                 :<span class="tlaUNC">           0 :             ++m_counts.at(2).at(NETWORKS.size());           // total overall</span></span>
<span id="L504"><span class="lineNum">     504</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (conn_type == &quot;block-relay-only&quot;) ++m_block_relay_peers_count;</span></span>
<span id="L505"><span class="lineNum">     505</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (conn_type == &quot;manual&quot;) ++m_manual_peers_count;</span></span>
<span id="L506"><span class="lineNum">     506</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (DetailsRequested()) {</span></span>
<span id="L507"><span class="lineNum">     507</span>                 :             :                 // Push data for this peer to the peers vector.</span>
<span id="L508"><span class="lineNum">     508</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int peer_id{peer[&quot;id&quot;].getInt&lt;int&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L509"><span class="lineNum">     509</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int mapped_as{peer[&quot;mapped_as&quot;].isNull() ? 0 : peer[&quot;mapped_as&quot;].getInt&lt;int&gt;()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L510"><span class="lineNum">     510</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int version{peer[&quot;version&quot;].getInt&lt;int&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L511"><span class="lineNum">     511</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t addr_processed{peer[&quot;addr_processed&quot;].isNull() ? 0 : peer[&quot;addr_processed&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L512"><span class="lineNum">     512</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t addr_rate_limited{peer[&quot;addr_rate_limited&quot;].isNull() ? 0 : peer[&quot;addr_rate_limited&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L513"><span class="lineNum">     513</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t conn_time{peer[&quot;conntime&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L514"><span class="lineNum">     514</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t last_blck{peer[&quot;last_block&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L515"><span class="lineNum">     515</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t last_recv{peer[&quot;lastrecv&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L516"><span class="lineNum">     516</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t last_send{peer[&quot;lastsend&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L517"><span class="lineNum">     517</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const int64_t last_trxn{peer[&quot;last_transaction&quot;].getInt&lt;int64_t&gt;()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L518"><span class="lineNum">     518</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const double min_ping{peer[&quot;minping&quot;].isNull() ? -1 : peer[&quot;minping&quot;].get_real()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L519"><span class="lineNum">     519</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const double ping{peer[&quot;pingtime&quot;].isNull() ? -1 : peer[&quot;pingtime&quot;].get_real()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L520"><span class="lineNum">     520</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const std::string addr{peer[&quot;addr&quot;].get_str()};</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L521"><span class="lineNum">     521</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const std::string age{conn_time == 0 ? &quot;&quot; : ToString((time_now - conn_time) / 60)};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L522"><span class="lineNum">     522</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const std::string sub_version{peer[&quot;subver&quot;].get_str()};</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L523"><span class="lineNum">     523</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const std::string transport{peer[&quot;transport_protocol_type&quot;].isNull() ? &quot;v1&quot; : peer[&quot;transport_protocol_type&quot;].get_str()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span>]
<span id="L524"><span class="lineNum">     524</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const bool is_addr_relay_enabled{peer[&quot;addr_relay_enabled&quot;].isNull() ? false : peer[&quot;addr_relay_enabled&quot;].get_bool()};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L525"><span class="lineNum">     525</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const bool is_bip152_hb_from{peer[&quot;bip152_hb_from&quot;].get_bool()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L526"><span class="lineNum">     526</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const bool is_bip152_hb_to{peer[&quot;bip152_hb_to&quot;].get_bool()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L527"><span class="lineNum">     527</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_peers.push_back({addr, sub_version, conn_type, NETWORK_SHORT_NAMES[network_id], age, transport, min_ping, ping, addr_processed, addr_rate_limited, last_blck, last_recv, last_send, last_trxn, peer_id, mapped_as, version, is_addr_relay_enabled, is_bip152_hb_from, is_bip152_hb_to, is_outbound, is_tx_relay});</span></span>
<span id="L528"><span class="lineNum">     528</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_max_addr_length = std::max(addr.length() + 1, m_max_addr_length);</span></span>
<span id="L529"><span class="lineNum">     529</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_max_addr_processed_length = std::max(ToString(addr_processed).length(), m_max_addr_processed_length);</span></span>
<span id="L530"><span class="lineNum">     530</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_max_addr_rate_limited_length = std::max(ToString(addr_rate_limited).length(), m_max_addr_rate_limited_length);</span></span>
<span id="L531"><span class="lineNum">     531</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_max_age_length = std::max(age.length(), m_max_age_length);</span></span>
<span id="L532"><span class="lineNum">     532</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 m_max_id_length = std::max(ToString(peer_id).length(), m_max_id_length);</span></span>
<span id="L533"><span class="lineNum">     533</span>                 :<span class="tlaUNC">           0 :                 m_is_asmap_on |= (mapped_as != 0);</span></span>
<span id="L534"><span class="lineNum">     534</span>                 :<span class="tlaUNC">           0 :             }</span></span>
<span id="L535"><span class="lineNum">     535</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L536"><span class="lineNum">     536</span>                 :             : </span>
<span id="L537"><span class="lineNum">     537</span>                 :             :         // Generate report header.</span>
<span id="L538"><span class="lineNum">     538</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         std::string result{strprintf(&quot;%s client %s%s - server %i%s\n\n&quot;, PACKAGE_NAME, FormatFullVersion(), ChainToString(), networkinfo[&quot;protocolversion&quot;].getInt&lt;int&gt;(), networkinfo[&quot;subversion&quot;].get_str())};</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span>]
<span id="L539"><span class="lineNum">     539</span>                 :             : </span>
<span id="L540"><span class="lineNum">     540</span>                 :             :         // Report detailed peer connections list sorted by direction and minimum ping time.</span>
<span id="L541"><span class="lineNum">     541</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (DetailsRequested() &amp;&amp; !m_peers.empty()) {</span></span>
<span id="L542"><span class="lineNum">     542</span>                 :<span class="tlaUNC">           0 :             std::sort(m_peers.begin(), m_peers.end());</span></span>
<span id="L543"><span class="lineNum">     543</span>                 :<span class="tlaUNC">           0 :             result += strprintf(&quot;&lt;-&gt;   type   net  v  mping   ping send recv  txn  blk  hb %*s%*s%*s &quot;,</span></span>
<span id="L544"><span class="lineNum">     544</span>                 :<span class="tlaUNC">           0 :                                 m_max_addr_processed_length, &quot;addrp&quot;,</span></span>
<span id="L545"><span class="lineNum">     545</span>                 :<span class="tlaUNC">           0 :                                 m_max_addr_rate_limited_length, &quot;addrl&quot;,</span></span>
<span id="L546"><span class="lineNum">     546</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                                 m_max_age_length, &quot;age&quot;);</span></span>
<span id="L547"><span class="lineNum">     547</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (m_is_asmap_on) result += &quot; asmap &quot;;</span></span>
<span id="L548"><span class="lineNum">     548</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             result += strprintf(&quot;%*s %-*s%s\n&quot;, m_max_id_length, &quot;id&quot;, IsAddressSelected() ? m_max_addr_length : 0, IsAddressSelected() ? &quot;address&quot; : &quot;&quot;, IsVersionSelected() ? &quot;version&quot; : &quot;&quot;);</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L549"><span class="lineNum">     549</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             for (const Peer&amp; peer : m_peers) {</span></span>
<span id="L550"><span class="lineNum">     550</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 std::string version{ToString(peer.version) + peer.sub_version};</span></span>
<span id="L551"><span class="lineNum">     551</span>                 :<span class="tlaUNC">           0 :                 result += strprintf(</span></span>
<span id="L552"><span class="lineNum">     552</span>                 :             :                     &quot;%3s %6s %5s %2s%7s%7s%5s%5s%5s%5s  %2s %*s%*s%*s%*i %*s %-*s%s\n&quot;,</span>
<span id="L553"><span class="lineNum">     553</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     peer.is_outbound ? &quot;out&quot; : &quot;in&quot;,</span></span>
<span id="L554"><span class="lineNum">     554</span>                 :<span class="tlaUNC">           0 :                     ConnectionTypeForNetinfo(peer.conn_type),</span></span>
<span id="L555"><span class="lineNum">     555</span>                 :<span class="tlaUNC">           0 :                     peer.network,</span></span>
<span id="L556"><span class="lineNum">     556</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     (peer.transport_protocol_type.size() == 2 &amp;&amp; peer.transport_protocol_type[0] == 'v') ? peer.transport_protocol_type[1] : ' ',</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L557"><span class="lineNum">     557</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     PingTimeToString(peer.min_ping),</span></span>
<span id="L558"><span class="lineNum">     558</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     PingTimeToString(peer.ping),</span></span>
<span id="L559"><span class="lineNum">     559</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     peer.last_send ? ToString(time_now - peer.last_send) : &quot;&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L560"><span class="lineNum">     560</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     peer.last_recv ? ToString(time_now - peer.last_recv) : &quot;&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L561"><span class="lineNum">     561</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     peer.last_trxn ? ToString((time_now - peer.last_trxn) / 60) : peer.is_tx_relay ? &quot;&quot; : &quot;*&quot;,</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L562"><span class="lineNum">     562</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     peer.last_blck ? ToString((time_now - peer.last_blck) / 60) : &quot;&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L563"><span class="lineNum">     563</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     strprintf(&quot;%s%s&quot;, peer.is_bip152_hb_to ? &quot;.&quot; : &quot; &quot;, peer.is_bip152_hb_from ? &quot;*&quot; : &quot; &quot;),</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L564"><span class="lineNum">     564</span>                 :             :                     m_max_addr_processed_length, // variable spacing</span>
<span id="L565"><span class="lineNum">     565</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     peer.addr_processed ? ToString(peer.addr_processed) : peer.is_addr_relay_enabled ? &quot;&quot; : &quot;.&quot;,</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L566"><span class="lineNum">     566</span>                 :             :                     m_max_addr_rate_limited_length, // variable spacing</span>
<span id="L567"><span class="lineNum">     567</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     peer.addr_rate_limited ? ToString(peer.addr_rate_limited) : &quot;&quot;,</span></span>
<span id="L568"><span class="lineNum">     568</span>                 :             :                     m_max_age_length, // variable spacing</span>
<span id="L569"><span class="lineNum">     569</span>                 :<span class="tlaUNC">           0 :                     peer.age,</span></span>
<span id="L570"><span class="lineNum">     570</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     m_is_asmap_on ? 7 : 0, // variable spacing</span></span>
<span id="L571"><span class="lineNum">     571</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     m_is_asmap_on &amp;&amp; peer.mapped_as ? ToString(peer.mapped_as) : &quot;&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L572"><span class="lineNum">     572</span>                 :             :                     m_max_id_length, // variable spacing</span>
<span id="L573"><span class="lineNum">     573</span>                 :<span class="tlaUNC">           0 :                     peer.id,</span></span>
<span id="L574"><span class="lineNum">     574</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     IsAddressSelected() ? m_max_addr_length : 0, // variable spacing</span></span>
<span id="L575"><span class="lineNum">     575</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     IsAddressSelected() ? peer.addr : &quot;&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L576"><span class="lineNum">     576</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     IsVersionSelected() &amp;&amp; version != &quot;0&quot; ? version : &quot;&quot;);</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L577"><span class="lineNum">     577</span>                 :<span class="tlaUNC">           0 :             }</span></span>
<span id="L578"><span class="lineNum">     578</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             result += strprintf(&quot;                        ms     ms  sec  sec  min  min                %*s\n\n&quot;, m_max_age_length, &quot;min&quot;);</span></span>
<span id="L579"><span class="lineNum">     579</span>                 :             :         }</span>
<span id="L580"><span class="lineNum">     580</span>                 :             : </span>
<span id="L581"><span class="lineNum">     581</span>                 :             :         // Report peer connection totals by type.</span>
<span id="L582"><span class="lineNum">     582</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         result += &quot;     &quot;;</span></span>
<span id="L583"><span class="lineNum">     583</span>                 :<span class="tlaUNC">           0 :         std::vector&lt;int8_t&gt; reachable_networks;</span></span>
<span id="L584"><span class="lineNum">     584</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         for (const UniValue&amp; network : networkinfo[&quot;networks&quot;].getValues()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L585"><span class="lineNum">     585</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             if (network[&quot;reachable&quot;].get_bool()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L586"><span class="lineNum">     586</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 const std::string&amp; network_name{network[&quot;name&quot;].get_str()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L587"><span class="lineNum">     587</span>                 :<span class="tlaUNC">           0 :                 const int8_t network_id{NetworkStringToId(network_name)};</span></span>
<span id="L588"><span class="lineNum">     588</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 if (network_id == UNKNOWN_NETWORK) continue;</span></span>
<span id="L589"><span class="lineNum">     589</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 result += strprintf(&quot;%8s&quot;, network_name); // column header</span></span>
<span id="L590"><span class="lineNum">     590</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 reachable_networks.push_back(network_id);</span></span>
<span id="L591"><span class="lineNum">     591</span>                 :             :             }</span>
<span id="L592"><span class="lineNum">     592</span>                 :             :         };</span>
<span id="L593"><span class="lineNum">     593</span>                 :             : </span>
<span id="L594"><span class="lineNum">     594</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (const size_t network_id : UNREACHABLE_NETWORK_IDS) {</span></span>
<span id="L595"><span class="lineNum">     595</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (m_counts.at(2).at(network_id) == 0) continue;</span></span>
<span id="L596"><span class="lineNum">     596</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             result += strprintf(&quot;%8s&quot;, NETWORK_SHORT_NAMES.at(network_id)); // column header</span></span>
<span id="L597"><span class="lineNum">     597</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             reachable_networks.push_back(network_id);</span></span>
<span id="L598"><span class="lineNum">     598</span>                 :             :         }</span>
<span id="L599"><span class="lineNum">     599</span>                 :             : </span>
<span id="L600"><span class="lineNum">     600</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         result += &quot;   total   block&quot;;</span></span>
<span id="L601"><span class="lineNum">     601</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (m_manual_peers_count) result += &quot;  manual&quot;;</span></span>
<span id="L602"><span class="lineNum">     602</span>                 :             : </span>
<span id="L603"><span class="lineNum">     603</span>                 :<span class="tlaUNC">           0 :         const std::array rows{&quot;in&quot;, &quot;out&quot;, &quot;total&quot;};</span></span>
<span id="L604"><span class="lineNum">     604</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (size_t i = 0; i &lt; rows.size(); ++i) {</span></span>
<span id="L605"><span class="lineNum">     605</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             result += strprintf(&quot;\n%-5s&quot;, rows[i]); // row header</span></span>
<span id="L606"><span class="lineNum">     606</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             for (int8_t n : reachable_networks) {</span></span>
<span id="L607"><span class="lineNum">     607</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 result += strprintf(&quot;%8i&quot;, m_counts.at(i).at(n)); // network peers count</span></span>
<span id="L608"><span class="lineNum">     608</span>                 :             :             }</span>
<span id="L609"><span class="lineNum">     609</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             result += strprintf(&quot;   %5i&quot;, m_counts.at(i).at(NETWORKS.size())); // total peers count</span></span>
<span id="L610"><span class="lineNum">     610</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (i == 1) { // the outbound row has two extra columns for block relay and manual peer counts</span></span>
<span id="L611"><span class="lineNum">     611</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 result += strprintf(&quot;   %5i&quot;, m_block_relay_peers_count);</span></span>
<span id="L612"><span class="lineNum">     612</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 if (m_manual_peers_count) result += strprintf(&quot;   %5i&quot;, m_manual_peers_count);</span></span>
<span id="L613"><span class="lineNum">     613</span>                 :             :             }</span>
<span id="L614"><span class="lineNum">     614</span>                 :             :         }</span>
<span id="L615"><span class="lineNum">     615</span>                 :             : </span>
<span id="L616"><span class="lineNum">     616</span>                 :             :         // Report local addresses, ports, and scores.</span>
<span id="L617"><span class="lineNum">     617</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         result += &quot;\n\nLocal addresses&quot;;</span></span>
<span id="L618"><span class="lineNum">     618</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         const std::vector&lt;UniValue&gt;&amp; local_addrs{networkinfo[&quot;localaddresses&quot;].getValues()};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L619"><span class="lineNum">     619</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (local_addrs.empty()) {</span></span>
<span id="L620"><span class="lineNum">     620</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             result += &quot;: n/a\n&quot;;</span></span>
<span id="L621"><span class="lineNum">     621</span>                 :             :         } else {</span>
<span id="L622"><span class="lineNum">     622</span>                 :<span class="tlaUNC">           0 :             size_t max_addr_size{0};</span></span>
<span id="L623"><span class="lineNum">     623</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             for (const UniValue&amp; addr : local_addrs) {</span></span>
<span id="L624"><span class="lineNum">     624</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 max_addr_size = std::max(addr[&quot;address&quot;].get_str().length() + 1, max_addr_size);</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L625"><span class="lineNum">     625</span>                 :             :             }</span>
<span id="L626"><span class="lineNum">     626</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             for (const UniValue&amp; addr : local_addrs) {</span></span>
<span id="L627"><span class="lineNum">     627</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 result += strprintf(&quot;\n%-*s    port %6i    score %6i&quot;, max_addr_size, addr[&quot;address&quot;].get_str(), addr[&quot;port&quot;].getInt&lt;int&gt;(), addr[&quot;score&quot;].getInt&lt;int&gt;());</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 19 was not executed"> # </span>]
<span id="L628"><span class="lineNum">     628</span>                 :             :             }</span>
<span id="L629"><span class="lineNum">     629</span>                 :             :         }</span>
<span id="L630"><span class="lineNum">     630</span>                 :             : </span>
<span id="L631"><span class="lineNum">     631</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return JSONRPCReplyObj(UniValue{result}, NullUniValue, /*id=*/1, JSONRPCVersion::V2);</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L632"><span class="lineNum">     632</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     }</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 19 was not executed"> # </span><span class="tlaUNC" title="Branch 20 was not executed"> # </span><span class="tlaUNC" title="Branch 21 was not executed"> # </span>]
<span id="L633"><span class="lineNum">     633</span>                 :             : </span>
<span id="L634"><span class="lineNum">     634</span>                 :             :     const std::string m_help_doc{</span>
<span id="L635"><span class="lineNum">     635</span>                 :             :         &quot;-netinfo level|\&quot;help\&quot; \n\n&quot;</span>
<span id="L636"><span class="lineNum">     636</span>                 :             :         &quot;Returns a network peer connections dashboard with information from the remote server.\n&quot;</span>
<span id="L637"><span class="lineNum">     637</span>                 :             :         &quot;This human-readable interface will change regularly and is not intended to be a stable API.\n&quot;</span>
<span id="L638"><span class="lineNum">     638</span>                 :             :         &quot;Under the hood, -netinfo fetches the data by calling getpeerinfo and getnetworkinfo.\n&quot;</span>
<span id="L639"><span class="lineNum">     639</span>                 :             :         + strprintf(&quot;An optional integer argument from 0 to %d can be passed for different peers listings; %d to 255 are parsed as %d.\n&quot;, MAX_DETAIL_LEVEL, MAX_DETAIL_LEVEL, MAX_DETAIL_LEVEL) +</span>
<span id="L640"><span class="lineNum">     640</span>                 :             :         &quot;Pass \&quot;help\&quot; to see this detailed help documentation.\n&quot;</span>
<span id="L641"><span class="lineNum">     641</span>                 :             :         &quot;If more than one argument is passed, only the first one is read and parsed.\n&quot;</span>
<span id="L642"><span class="lineNum">     642</span>                 :             :         &quot;Suggestion: use with the Linux watch(1) command for a live dashboard; see example below.\n\n&quot;</span>
<span id="L643"><span class="lineNum">     643</span>                 :             :         &quot;Arguments:\n&quot;</span>
<span id="L644"><span class="lineNum">     644</span>                 :             :         + strprintf(&quot;1. level (integer 0-%d, optional)  Specify the info level of the peers dashboard (default 0):\n&quot;, MAX_DETAIL_LEVEL) +</span>
<span id="L645"><span class="lineNum">     645</span>                 :             :         &quot;                                  0 - Peer counts for each reachable network as well as for block relay peers\n&quot;</span>
<span id="L646"><span class="lineNum">     646</span>                 :             :         &quot;                                      and manual peers, and the list of local addresses and ports\n&quot;</span>
<span id="L647"><span class="lineNum">     647</span>                 :             :         &quot;                                  1 - Like 0 but preceded by a peers listing (without address and version columns)\n&quot;</span>
<span id="L648"><span class="lineNum">     648</span>                 :             :         &quot;                                  2 - Like 1 but with an address column\n&quot;</span>
<span id="L649"><span class="lineNum">     649</span>                 :             :         &quot;                                  3 - Like 1 but with a version column\n&quot;</span>
<span id="L650"><span class="lineNum">     650</span>                 :             :         &quot;                                  4 - Like 1 but with both address and version columns\n&quot;</span>
<span id="L651"><span class="lineNum">     651</span>                 :             :         &quot;2. help (string \&quot;help\&quot;, optional) Print this help documentation instead of the dashboard.\n\n&quot;</span>
<span id="L652"><span class="lineNum">     652</span>                 :             :         &quot;Result:\n\n&quot;</span>
<span id="L653"><span class="lineNum">     653</span>                 :             :         + strprintf(&quot;* The peers listing in levels 1-%d displays all of the peers sorted by direction and minimum ping time:\n\n&quot;, MAX_DETAIL_LEVEL) +</span>
<span id="L654"><span class="lineNum">     654</span>                 :             :         &quot;  Column   Description\n&quot;</span>
<span id="L655"><span class="lineNum">     655</span>                 :             :         &quot;  ------   -----------\n&quot;</span>
<span id="L656"><span class="lineNum">     656</span>                 :             :         &quot;  &lt;-&gt;      Direction\n&quot;</span>
<span id="L657"><span class="lineNum">     657</span>                 :             :         &quot;           \&quot;in\&quot;  - inbound connections are those initiated by the peer\n&quot;</span>
<span id="L658"><span class="lineNum">     658</span>                 :             :         &quot;           \&quot;out\&quot; - outbound connections are those initiated by us\n&quot;</span>
<span id="L659"><span class="lineNum">     659</span>                 :             :         &quot;  type     Type of peer connection\n&quot;</span>
<span id="L660"><span class="lineNum">     660</span>                 :             :         &quot;           \&quot;full\&quot;   - full relay, the default\n&quot;</span>
<span id="L661"><span class="lineNum">     661</span>                 :             :         &quot;           \&quot;block\&quot;  - block relay; like full relay but does not relay transactions or addresses\n&quot;</span>
<span id="L662"><span class="lineNum">     662</span>                 :             :         &quot;           \&quot;manual\&quot; - peer we manually added using RPC addnode or the -addnode/-connect config options\n&quot;</span>
<span id="L663"><span class="lineNum">     663</span>                 :             :         &quot;           \&quot;feeler\&quot; - short-lived connection for testing addresses\n&quot;</span>
<span id="L664"><span class="lineNum">     664</span>                 :             :         &quot;           \&quot;addr\&quot;   - address fetch; short-lived connection for requesting addresses\n&quot;</span>
<span id="L665"><span class="lineNum">     665</span>                 :             :         &quot;  net      Network the peer connected through (\&quot;ipv4\&quot;, \&quot;ipv6\&quot;, \&quot;onion\&quot;, \&quot;i2p\&quot;, \&quot;cjdns\&quot;, or \&quot;npr\&quot; (not publicly routable))\n&quot;</span>
<span id="L666"><span class="lineNum">     666</span>                 :             :         &quot;  v        Version of transport protocol used for the connection\n&quot;</span>
<span id="L667"><span class="lineNum">     667</span>                 :             :         &quot;  mping    Minimum observed ping time, in milliseconds (ms)\n&quot;</span>
<span id="L668"><span class="lineNum">     668</span>                 :             :         &quot;  ping     Last observed ping time, in milliseconds (ms)\n&quot;</span>
<span id="L669"><span class="lineNum">     669</span>                 :             :         &quot;  send     Time since last message sent to the peer, in seconds\n&quot;</span>
<span id="L670"><span class="lineNum">     670</span>                 :             :         &quot;  recv     Time since last message received from the peer, in seconds\n&quot;</span>
<span id="L671"><span class="lineNum">     671</span>                 :             :         &quot;  txn      Time since last novel transaction received from the peer and accepted into our mempool, in minutes\n&quot;</span>
<span id="L672"><span class="lineNum">     672</span>                 :             :         &quot;           \&quot;*\&quot; - we do not relay transactions to this peer (relaytxes is false)\n&quot;</span>
<span id="L673"><span class="lineNum">     673</span>                 :             :         &quot;  blk      Time since last novel block passing initial validity checks received from the peer, in minutes\n&quot;</span>
<span id="L674"><span class="lineNum">     674</span>                 :             :         &quot;  hb       High-bandwidth BIP152 compact block relay\n&quot;</span>
<span id="L675"><span class="lineNum">     675</span>                 :             :         &quot;           \&quot;.\&quot; (to)   - we selected the peer as a high-bandwidth peer\n&quot;</span>
<span id="L676"><span class="lineNum">     676</span>                 :             :         &quot;           \&quot;*\&quot; (from) - the peer selected us as a high-bandwidth peer\n&quot;</span>
<span id="L677"><span class="lineNum">     677</span>                 :             :         &quot;  addrp    Total number of addresses processed, excluding those dropped due to rate limiting\n&quot;</span>
<span id="L678"><span class="lineNum">     678</span>                 :             :         &quot;           \&quot;.\&quot; - we do not relay addresses to this peer (addr_relay_enabled is false)\n&quot;</span>
<span id="L679"><span class="lineNum">     679</span>                 :             :         &quot;  addrl    Total number of addresses dropped due to rate limiting\n&quot;</span>
<span id="L680"><span class="lineNum">     680</span>                 :             :         &quot;  age      Duration of connection to the peer, in minutes\n&quot;</span>
<span id="L681"><span class="lineNum">     681</span>                 :             :         &quot;  asmap    Mapped AS (Autonomous System) number at the end of the BGP route to the peer, used for diversifying\n&quot;</span>
<span id="L682"><span class="lineNum">     682</span>                 :             :         &quot;           peer selection (only displayed if the -asmap config option is set)\n&quot;</span>
<span id="L683"><span class="lineNum">     683</span>                 :             :         &quot;  id       Peer index, in increasing order of peer connections since node startup\n&quot;</span>
<span id="L684"><span class="lineNum">     684</span>                 :             :         &quot;  address  IP address and port of the peer\n&quot;</span>
<span id="L685"><span class="lineNum">     685</span>                 :             :         &quot;  version  Peer version and subversion concatenated, e.g. \&quot;70016/Satoshi:21.0.0/\&quot;\n\n&quot;</span>
<span id="L686"><span class="lineNum">     686</span>                 :             :         &quot;* The peer counts table displays the number of peers for each reachable network as well as\n&quot;</span>
<span id="L687"><span class="lineNum">     687</span>                 :             :         &quot;  the number of block relay peers and manual peers.\n\n&quot;</span>
<span id="L688"><span class="lineNum">     688</span>                 :             :         &quot;* The local addresses table lists each local address broadcast by the node, the port, and the score.\n\n&quot;</span>
<span id="L689"><span class="lineNum">     689</span>                 :             :         &quot;Examples:\n\n&quot;</span>
<span id="L690"><span class="lineNum">     690</span>                 :             :         &quot;Peer counts table of reachable networks and list of local addresses\n&quot;</span>
<span id="L691"><span class="lineNum">     691</span>                 :             :         &quot;&gt; bitcoin-cli -netinfo\n\n&quot;</span>
<span id="L692"><span class="lineNum">     692</span>                 :             :         &quot;The same, preceded by a peers listing without address and version columns\n&quot;</span>
<span id="L693"><span class="lineNum">     693</span>                 :             :         &quot;&gt; bitcoin-cli -netinfo 1\n\n&quot;</span>
<span id="L694"><span class="lineNum">     694</span>                 :             :         &quot;Full dashboard\n&quot;</span>
<span id="L695"><span class="lineNum">     695</span>                 :             :         + strprintf(&quot;&gt; bitcoin-cli -netinfo %d\n\n&quot;, MAX_DETAIL_LEVEL) +</span>
<span id="L696"><span class="lineNum">     696</span>                 :             :         &quot;Full live dashboard, adjust --interval or --no-title as needed (Linux)\n&quot;</span>
<span id="L697"><span class="lineNum">     697</span>                 :             :         + strprintf(&quot;&gt; watch --interval 1 --no-title bitcoin-cli -netinfo %d\n\n&quot;, MAX_DETAIL_LEVEL) +</span>
<span id="L698"><span class="lineNum">     698</span>                 :             :         &quot;See this help\n&quot;</span>
<span id="L699"><span class="lineNum">     699</span>                 :             :         &quot;&gt; bitcoin-cli -netinfo help\n&quot;};</span>
<span id="L700"><span class="lineNum">     700</span>                 :             : };</span>
<span id="L701"><span class="lineNum">     701</span>                 :             : </span>
<span id="L702"><span class="lineNum">     702</span>                 :             : /** Process RPC generatetoaddress request. */</span>
<span id="L703"><span class="lineNum">     703</span>                 :<span class="tlaGNC tlaBgGNC">          18 : class GenerateToAddressRequestHandler : public BaseRequestHandler</span></span>
<span id="L704"><span class="lineNum">     704</span>                 :             : {</span>
<span id="L705"><span class="lineNum">     705</span>                 :             : public:</span>
<span id="L706"><span class="lineNum">     706</span>                 :<span class="tlaGNC">          18 :     UniValue PrepareRequest(const std::string&amp; method, const std::vector&lt;std::string&gt;&amp; args) override</span></span>
<span id="L707"><span class="lineNum">     707</span>                 :             :     {</span>
<span id="L708"><span class="lineNum">     708</span>                 :<span class="tlaGNC">          18 :         address_str = args.at(1);</span></span>
<span id="L709"><span class="lineNum">     709</span>         [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 4 times"> + </span>]:<span class="tlaGNC">          22 :         UniValue params{RPCConvertValues(&quot;generatetoaddress&quot;, args)};</span></span>
<span id="L710"><span class="lineNum">     710</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          42 :         return JSONRPCRequestObj(&quot;generatetoaddress&quot;, params, 1);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L711"><span class="lineNum">     711</span>                 :<span class="tlaGNC">          14 :     }</span></span>
<span id="L712"><span class="lineNum">     712</span>                 :             : </span>
<span id="L713"><span class="lineNum">     713</span>                 :<span class="tlaGNC">          14 :     UniValue ProcessReply(const UniValue &amp;reply) override</span></span>
<span id="L714"><span class="lineNum">     714</span>                 :             :     {</span>
<span id="L715"><span class="lineNum">     715</span>                 :<span class="tlaGNC">          14 :         UniValue result(UniValue::VOBJ);</span></span>
<span id="L716"><span class="lineNum">     716</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result.pushKV(&quot;address&quot;, address_str);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L717"><span class="lineNum">     717</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result.pushKV(&quot;blocks&quot;, reply.get_obj()[&quot;result&quot;]);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 14 times"> + </span> 
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span>]
<span id="L718"><span class="lineNum">     718</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         return JSONRPCReplyObj(std::move(result), NullUniValue, /*id=*/1, JSONRPCVersion::V2);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L719"><span class="lineNum">     719</span>                 :<span class="tlaGNC">          14 :     }</span></span>
<span id="L720"><span class="lineNum">     720</span>                 :             : protected:</span>
<span id="L721"><span class="lineNum">     721</span>                 :             :     std::string address_str;</span>
<span id="L722"><span class="lineNum">     722</span>                 :             : };</span>
<span id="L723"><span class="lineNum">     723</span>                 :             : </span>
<span id="L724"><span class="lineNum">     724</span>                 :             : /** Process default single requests */</span>
<span id="L725"><span class="lineNum">     725</span>                 :<span class="tlaGNC">         556 : class DefaultRequestHandler: public BaseRequestHandler {</span></span>
<span id="L726"><span class="lineNum">     726</span>                 :             : public:</span>
<span id="L727"><span class="lineNum">     727</span>                 :<span class="tlaGNC">         554 :     UniValue PrepareRequest(const std::string&amp; method, const std::vector&lt;std::string&gt;&amp; args) override</span></span>
<span id="L728"><span class="lineNum">     728</span>                 :             :     {</span>
<span id="L729"><span class="lineNum">     729</span>         [<span class="tlaGBC" title="Branch 0 was taken 554 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         554 :         UniValue params;</span></span>
<span id="L730"><span class="lineNum">     730</span>   [<span class="tlaGBC" title="Branch 0 was taken 554 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 554 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         554 :         if(gArgs.GetBoolArg(&quot;-named&quot;, DEFAULT_NAMED)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 47 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 507 times"> + </span>]
<span id="L731"><span class="lineNum">     731</span>         [<span class="tlaGBC" title="Branch 0 was taken 47 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          47 :             params = RPCConvertNamedValues(method, args);</span></span>
<span id="L732"><span class="lineNum">     732</span>                 :             :         } else {</span>
<span id="L733"><span class="lineNum">     733</span>         [<span class="tlaGBC" title="Branch 0 was taken 507 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         507 :             params = RPCConvertValues(method, args);</span></span>
<span id="L734"><span class="lineNum">     734</span>                 :             :         }</span>
<span id="L735"><span class="lineNum">     735</span>   [<span class="tlaGBC" title="Branch 0 was taken 554 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 554 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1108 :         return JSONRPCRequestObj(method, params, 1);</span></span>
<span id="L736"><span class="lineNum">     736</span>                 :<span class="tlaGNC">         554 :     }</span></span>
<span id="L737"><span class="lineNum">     737</span>                 :             : </span>
<span id="L738"><span class="lineNum">     738</span>                 :<span class="tlaGNC">         529 :     UniValue ProcessReply(const UniValue &amp;reply) override</span></span>
<span id="L739"><span class="lineNum">     739</span>                 :             :     {</span>
<span id="L740"><span class="lineNum">     740</span>                 :<span class="tlaGNC">         529 :         return reply.get_obj();</span></span>
<span id="L741"><span class="lineNum">     741</span>                 :             :     }</span>
<span id="L742"><span class="lineNum">     742</span>                 :             : };</span>
<span id="L743"><span class="lineNum">     743</span>                 :             : </span>
<span id="L744"><span class="lineNum">     744</span>                 :<span class="tlaGNC">         626 : static UniValue CallRPC(BaseRequestHandler* rh, const std::string&amp; strMethod, const std::vector&lt;std::string&gt;&amp; args, const std::optional&lt;std::string&gt;&amp; rpcwallet = {})</span></span>
<span id="L745"><span class="lineNum">     745</span>                 :             : {</span>
<span id="L746"><span class="lineNum">     746</span>         [<span class="tlaGBC" title="Branch 0 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         626 :     std::string host;</span></span>
<span id="L747"><span class="lineNum">     747</span>                 :             :     // In preference order, we choose the following for the port:</span>
<span id="L748"><span class="lineNum">     748</span>                 :             :     //     1. -rpcport</span>
<span id="L749"><span class="lineNum">     749</span>                 :             :     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)</span>
<span id="L750"><span class="lineNum">     750</span>                 :             :     //     3. default port for chain</span>
<span id="L751"><span class="lineNum">     751</span>   [<span class="tlaGBC" title="Branch 0 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         626 :     uint16_t port{BaseParams().RPCPort()};</span></span>
<span id="L752"><span class="lineNum">     752</span>                 :<span class="tlaGNC">         626 :     {</span></span>
<span id="L753"><span class="lineNum">     753</span>                 :<span class="tlaGNC">         626 :         uint16_t rpcconnect_port{0};</span></span>
<span id="L754"><span class="lineNum">     754</span>   [<span class="tlaGBC" title="Branch 0 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1252 :         const std::string rpcconnect_str = gArgs.GetArg(&quot;-rpcconnect&quot;, DEFAULT_RPCCONNECT);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L755"><span class="lineNum">     755</span>   [<span class="tlaGBC" title="Branch 0 was taken 626 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 16 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 610 times"> + </span>]:<span class="tlaGNC">         626 :         if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {</span></span>
<span id="L756"><span class="lineNum">     756</span>                 :             :             // Uses argument provided as-is</span>
<span id="L757"><span class="lineNum">     757</span>                 :             :             // (rather than value parsed)</span>
<span id="L758"><span class="lineNum">     758</span>                 :             :             // to aid the user in troubleshooting</span>
<span id="L759"><span class="lineNum">     759</span>   [<span class="tlaGBC" title="Branch 0 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          32 :             throw std::runtime_error(strprintf(&quot;Invalid port provided in -rpcconnect: %s&quot;, rpcconnect_str));</span></span>
<span id="L760"><span class="lineNum">     760</span>                 :             :         } else {</span>
<span id="L761"><span class="lineNum">     761</span>         [<span class="tlaGBC" title="Branch 0 was taken 12 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 598 times"> + </span>]:<span class="tlaGNC">         610 :             if (rpcconnect_port != 0) {</span></span>
<span id="L762"><span class="lineNum">     762</span>                 :             :                 // Use the valid port provided in rpcconnect</span>
<span id="L763"><span class="lineNum">     763</span>                 :<span class="tlaGNC">          12 :                 port = rpcconnect_port;</span></span>
<span id="L764"><span class="lineNum">     764</span>                 :             :             } // else, no port was provided in rpcconnect (continue using default one)</span>
<span id="L765"><span class="lineNum">     765</span>                 :             :         }</span>
<span id="L766"><span class="lineNum">     766</span>                 :             : </span>
<span id="L767"><span class="lineNum">     767</span>   [<span class="tlaGBC" title="Branch 0 was taken 610 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 610 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1220 :         if (std::optional&lt;std::string&gt; rpcport_arg = gArgs.GetArg(&quot;-rpcport&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 606 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 4 times"> + </span>]
<span id="L768"><span class="lineNum">     768</span>                 :             :             // -rpcport was specified</span>
<span id="L769"><span class="lineNum">     769</span>         [<span class="tlaGBC" title="Branch 0 was taken 600 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 6 times"> + </span>]:<span class="tlaGNC">         606 :             const uint16_t rpcport_int{ToIntegral&lt;uint16_t&gt;(rpcport_arg.value()).value_or(0)};</span></span>
<span id="L770"><span class="lineNum">     770</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 598 times"> + </span>]:<span class="tlaGNC">         600 :             if (rpcport_int == 0) {</span></span>
<span id="L771"><span class="lineNum">     771</span>                 :             :                 // Uses argument provided as-is</span>
<span id="L772"><span class="lineNum">     772</span>                 :             :                 // (rather than value parsed)</span>
<span id="L773"><span class="lineNum">     773</span>                 :             :                 // to aid the user in troubleshooting</span>
<span id="L774"><span class="lineNum">     774</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          16 :                 throw std::runtime_error(strprintf(&quot;Invalid port provided in -rpcport: %s&quot;, rpcport_arg.value()));</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L775"><span class="lineNum">     775</span>                 :             :             }</span>
<span id="L776"><span class="lineNum">     776</span>                 :             : </span>
<span id="L777"><span class="lineNum">     777</span>                 :             :             // Use the valid port provided</span>
<span id="L778"><span class="lineNum">     778</span>                 :<span class="tlaGNC">         598 :             port = rpcport_int;</span></span>
<span id="L779"><span class="lineNum">     779</span>                 :             : </span>
<span id="L780"><span class="lineNum">     780</span>                 :             :             // If there was a valid port provided in rpcconnect,</span>
<span id="L781"><span class="lineNum">     781</span>                 :             :             // rpcconnect_port is non-zero.</span>
<span id="L782"><span class="lineNum">     782</span>         [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 590 times"> + </span>]:<span class="tlaGNC">         598 :             if (rpcconnect_port != 0) {</span></span>
<span id="L783"><span class="lineNum">     783</span>         [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           8 :                 tfm::format(std::cerr, &quot;Warning: Port specified in both -rpcconnect and -rpcport. Using -rpcport %u\n&quot;, port);</span></span>
<span id="L784"><span class="lineNum">     784</span>                 :             :             }</span>
<span id="L785"><span class="lineNum">     785</span>                 :<span class="tlaGNC">         610 :         }</span></span>
<span id="L786"><span class="lineNum">     786</span>                 :<span class="tlaGNC">          24 :     }</span></span>
<span id="L787"><span class="lineNum">     787</span>                 :             : </span>
<span id="L788"><span class="lineNum">     788</span>                 :             :     // Obtain event base</span>
<span id="L789"><span class="lineNum">     789</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     raii_event_base base = obtain_event_base();</span></span>
<span id="L790"><span class="lineNum">     790</span>                 :             : </span>
<span id="L791"><span class="lineNum">     791</span>                 :             :     // Synchronously look up hostname</span>
<span id="L792"><span class="lineNum">     792</span>   [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         602 :     raii_evhttp_connection evcon = obtain_evhttp_connection_base(base.get(), host, port);</span></span>
<span id="L793"><span class="lineNum">     793</span>                 :             : </span>
<span id="L794"><span class="lineNum">     794</span>                 :             :     // Set connection timeout</span>
<span id="L795"><span class="lineNum">     795</span>                 :<span class="tlaGNC">         602 :     {</span></span>
<span id="L796"><span class="lineNum">     796</span>   [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         602 :         const int timeout = gArgs.GetIntArg(&quot;-rpcclienttimeout&quot;, DEFAULT_HTTP_CLIENT_TIMEOUT);</span></span>
<span id="L797"><span class="lineNum">     797</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :         if (timeout &gt; 0) {</span></span>
<span id="L798"><span class="lineNum">     798</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :             evhttp_connection_set_timeout(evcon.get(), timeout);</span></span>
<span id="L799"><span class="lineNum">     799</span>                 :             :         } else {</span>
<span id="L800"><span class="lineNum">     800</span>                 :             :             // Indefinite request timeouts are not possible in libevent-http, so we</span>
<span id="L801"><span class="lineNum">     801</span>                 :             :             // set the timeout to a very long time period instead.</span>
<span id="L802"><span class="lineNum">     802</span>                 :             : </span>
<span id="L803"><span class="lineNum">     803</span>                 :<span class="tlaUNC tlaBgUNC">           0 :             constexpr int YEAR_IN_SECONDS = 31556952; // Average length of year in Gregorian calendar</span></span>
<span id="L804"><span class="lineNum">     804</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             evhttp_connection_set_timeout(evcon.get(), 5 * YEAR_IN_SECONDS);</span></span>
<span id="L805"><span class="lineNum">     805</span>                 :             :         }</span>
<span id="L806"><span class="lineNum">     806</span>                 :             :     }</span>
<span id="L807"><span class="lineNum">     807</span>                 :             : </span>
<span id="L808"><span class="lineNum">     808</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         602 :     HTTPReply response;</span></span>
<span id="L809"><span class="lineNum">     809</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     raii_evhttp_request req = obtain_evhttp_request(http_request_done, (void*)&amp;response);</span></span>
<span id="L810"><span class="lineNum">     810</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 602 times"> + </span>]:<span class="tlaGNC">         602 :     if (req == nullptr) {</span></span>
<span id="L811"><span class="lineNum">     811</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         throw std::runtime_error(&quot;create http request failed&quot;);</span></span>
<span id="L812"><span class="lineNum">     812</span>                 :             :     }</span>
<span id="L813"><span class="lineNum">     813</span>                 :             : </span>
<span id="L814"><span class="lineNum">     814</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         602 :     evhttp_request_set_error_cb(req.get(), http_error_cb);</span></span>
<span id="L815"><span class="lineNum">     815</span>                 :             : </span>
<span id="L816"><span class="lineNum">     816</span>                 :             :     // Get credentials</span>
<span id="L817"><span class="lineNum">     817</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     std::string strRPCUserColonPass;</span></span>
<span id="L818"><span class="lineNum">     818</span>                 :<span class="tlaGNC">         602 :     bool failedToGetAuthCookie = false;</span></span>
<span id="L819"><span class="lineNum">     819</span>   [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         602 :     if (gArgs.GetArg(&quot;-rpcpassword&quot;, &quot;&quot;) == &quot;&quot;) {</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 594 times"> + </span><span class="tlaGBC" title="Branch 7 was taken 8 times"> + </span>]
<span id="L820"><span class="lineNum">     820</span>                 :             :         // Try fall back to cookie-based authentication if no password is provided</span>
<span id="L821"><span class="lineNum">     821</span>   [<span class="tlaGBC" title="Branch 0 was taken 594 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 580 times"> + </span>]:<span class="tlaGNC">         594 :         if (!GetAuthCookie(&amp;strRPCUserColonPass)) {</span></span>
<span id="L822"><span class="lineNum">     822</span>                 :<span class="tlaGNC">          14 :             failedToGetAuthCookie = true;</span></span>
<span id="L823"><span class="lineNum">     823</span>                 :             :         }</span>
<span id="L824"><span class="lineNum">     824</span>                 :             :     } else {</span>
<span id="L825"><span class="lineNum">     825</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          16 :         strRPCUserColonPass = gArgs.GetArg(&quot;-rpcuser&quot;, &quot;&quot;) + &quot;:&quot; + gArgs.GetArg(&quot;-rpcpassword&quot;, &quot;&quot;);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 8 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 8 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L826"><span class="lineNum">     826</span>                 :             :     }</span>
<span id="L827"><span class="lineNum">     827</span>                 :             : </span>
<span id="L828"><span class="lineNum">     828</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     struct evkeyvalq* output_headers = evhttp_request_get_output_headers(req.get());</span></span>
<span id="L829"><span class="lineNum">     829</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 602 times"> + </span>]:<span class="tlaGNC">         602 :     assert(output_headers);</span></span>
<span id="L830"><span class="lineNum">     830</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     evhttp_add_header(output_headers, &quot;Host&quot;, host.c_str());</span></span>
<span id="L831"><span class="lineNum">     831</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     evhttp_add_header(output_headers, &quot;Connection&quot;, &quot;close&quot;);</span></span>
<span id="L832"><span class="lineNum">     832</span>         [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         602 :     evhttp_add_header(output_headers, &quot;Content-Type&quot;, &quot;application/json&quot;);</span></span>
<span id="L833"><span class="lineNum">     833</span>   [<span class="tlaGBC" title="Branch 0 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1204 :     evhttp_add_header(output_headers, &quot;Authorization&quot;, (std::string(&quot;Basic &quot;) + EncodeBase64(strRPCUserColonPass)).c_str());</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 602 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L834"><span class="lineNum">     834</span>                 :             : </span>
<span id="L835"><span class="lineNum">     835</span>                 :             :     // Attach request data</span>
<span id="L836"><span class="lineNum">     836</span>   [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 6 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1198 :     std::string strRequest = rh-&gt;PrepareRequest(strMethod, args).write() + &quot;\n&quot;;</span></span>
<span id="L837"><span class="lineNum">     837</span>         [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         596 :     struct evbuffer* output_buffer = evhttp_request_get_output_buffer(req.get());</span></span>
<span id="L838"><span class="lineNum">     838</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 596 times"> + </span>]:<span class="tlaGNC">         596 :     assert(output_buffer);</span></span>
<span id="L839"><span class="lineNum">     839</span>         [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         596 :     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());</span></span>
<span id="L840"><span class="lineNum">     840</span>                 :             : </span>
<span id="L841"><span class="lineNum">     841</span>                 :             :     // check if we should use a special wallet endpoint</span>
<span id="L842"><span class="lineNum">     842</span>         [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         596 :     std::string endpoint = &quot;/&quot;;</span></span>
<span id="L843"><span class="lineNum">     843</span>         [<span class="tlaGBC" title="Branch 0 was taken 224 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 372 times"> + </span>]:<span class="tlaGNC">         596 :     if (rpcwallet) {</span></span>
<span id="L844"><span class="lineNum">     844</span>         [<span class="tlaGBC" title="Branch 0 was taken 224 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         224 :         char* encodedURI = evhttp_uriencode(rpcwallet-&gt;data(), rpcwallet-&gt;size(), false);</span></span>
<span id="L845"><span class="lineNum">     845</span>         [<span class="tlaGBC" title="Branch 0 was taken 224 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         224 :         if (encodedURI) {</span></span>
<span id="L846"><span class="lineNum">     846</span>   [<span class="tlaGBC" title="Branch 0 was taken 224 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 224 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         224 :             endpoint = &quot;/wallet/&quot; + std::string(encodedURI);</span></span>
<span id="L847"><span class="lineNum">     847</span>                 :<span class="tlaGNC">         224 :             free(encodedURI);</span></span>
<span id="L848"><span class="lineNum">     848</span>                 :             :         } else {</span>
<span id="L849"><span class="lineNum">     849</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             throw CConnectionFailed(&quot;uri-encode failed&quot;);</span></span>
<span id="L850"><span class="lineNum">     850</span>                 :             :         }</span>
<span id="L851"><span class="lineNum">     851</span>                 :             :     }</span>
<span id="L852"><span class="lineNum">     852</span>         [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         596 :     int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, endpoint.c_str());</span></span>
<span id="L853"><span class="lineNum">     853</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 596 times"> + </span>]:<span class="tlaGNC">         596 :     req.release(); // ownership moved to evcon in above call</span></span>
<span id="L854"><span class="lineNum">     854</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 596 times"> + </span>]:<span class="tlaGNC">         596 :     if (r != 0) {</span></span>
<span id="L855"><span class="lineNum">     855</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         throw CConnectionFailed(&quot;send http request failed&quot;);</span></span>
<span id="L856"><span class="lineNum">     856</span>                 :             :     }</span>
<span id="L857"><span class="lineNum">     857</span>                 :             : </span>
<span id="L858"><span class="lineNum">     858</span>         [<span class="tlaGBC" title="Branch 0 was taken 596 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         596 :     event_base_dispatch(base.get());</span></span>
<span id="L859"><span class="lineNum">     859</span>                 :             : </span>
<span id="L860"><span class="lineNum">     860</span>         [<span class="tlaGBC" title="Branch 0 was taken 18 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 578 times"> + </span>]:<span class="tlaGNC">         596 :     if (response.status == 0) {</span></span>
<span id="L861"><span class="lineNum">     861</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 18 times"> + </span>]:<span class="tlaGNC">          18 :         std::string responseErrorMessage;</span></span>
<span id="L862"><span class="lineNum">     862</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 18 times"> + </span>]:<span class="tlaGNC">          18 :         if (response.error != -1) {</span></span>
<span id="L863"><span class="lineNum">     863</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             responseErrorMessage = strprintf(&quot; (error code %d - \&quot;%s\&quot;)&quot;, response.error, http_errorstring(response.error));</span></span>
<span id="L864"><span class="lineNum">     864</span>                 :             :         }</span>
<span id="L865"><span class="lineNum">     865</span>         [<span class="tlaGBC" title="Branch 0 was taken 18 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">          18 :         throw CConnectionFailed(strprintf(&quot;Could not connect to the server %s:%d%s\n\n&quot;</span></span>
<span id="L866"><span class="lineNum">     866</span>                 :             :                     &quot;Make sure the bitcoind server is running and that you are connecting to the correct RPC port.\n&quot;</span>
<span id="L867"><span class="lineNum">     867</span>                 :             :                     &quot;Use \&quot;bitcoin-cli -help\&quot; for more info.&quot;,</span>
<span id="L868"><span class="lineNum">     868</span>                 :<span class="tlaGNC">          36 :                     host, port, responseErrorMessage));</span></span>
<span id="L869"><span class="lineNum">     869</span>         [<span class="tlaGBC" title="Branch 0 was taken 6 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 572 times"> + </span>]:<span class="tlaGNC">         596 :     } else if (response.status == HTTP_UNAUTHORIZED) {</span></span>
<span id="L870"><span class="lineNum">     870</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 4 times"> + </span>]:<span class="tlaGNC">           6 :         if (failedToGetAuthCookie) {</span></span>
<span id="L871"><span class="lineNum">     871</span>                 :<span class="tlaGNC">           2 :             throw std::runtime_error(strprintf(</span></span>
<span id="L872"><span class="lineNum">     872</span>                 :             :                 &quot;Could not locate RPC credentials. No authentication cookie could be found, and RPC password is not set.  See -rpcpassword and -stdinrpcpass.  Configuration file: (%s)&quot;,</span>
<span id="L873"><span class="lineNum">     873</span>   [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">           8 :                 fs::PathToString(gArgs.GetConfigFilePath())));</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L874"><span class="lineNum">     874</span>                 :             :         } else {</span>
<span id="L875"><span class="lineNum">     875</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           4 :             throw std::runtime_error(&quot;Authorization failed: Incorrect rpcuser or rpcpassword&quot;);</span></span>
<span id="L876"><span class="lineNum">     876</span>                 :             :         }</span>
<span id="L877"><span class="lineNum">     877</span>         [<span class="tlaGBC" title="Branch 0 was taken 1 time"> + </span><span class="tlaGBC" title="Branch 1 was taken 571 times"> + </span>]:<span class="tlaGNC">         572 :     } else if (response.status == HTTP_SERVICE_UNAVAILABLE) {</span></span>
<span id="L878"><span class="lineNum">     878</span>   [<span class="tlaGBC" title="Branch 0 was taken 1 time"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1 time"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">           2 :         throw std::runtime_error(strprintf(&quot;Server response: %s&quot;, response.body));</span></span>
<span id="L879"><span class="lineNum">     879</span>   [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 571 times"> + </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         571 :     } else if (response.status &gt;= 400 &amp;&amp; response.status != HTTP_BAD_REQUEST &amp;&amp; response.status != HTTP_NOT_FOUND &amp;&amp; response.status != HTTP_INTERNAL_SERVER_ERROR)</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L880"><span class="lineNum">     880</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         throw std::runtime_error(strprintf(&quot;server returned HTTP error %d&quot;, response.status));</span></span>
<span id="L881"><span class="lineNum">     881</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 571 times"> + </span>]:<span class="tlaGNC tlaBgGNC">         571 :     else if (response.body.empty())</span></span>
<span id="L882"><span class="lineNum">     882</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         throw std::runtime_error(&quot;no response from server&quot;);</span></span>
<span id="L883"><span class="lineNum">     883</span>                 :             : </span>
<span id="L884"><span class="lineNum">     884</span>                 :             :     // Parse reply</span>
<span id="L885"><span class="lineNum">     885</span>                 :<span class="tlaGNC tlaBgGNC">         571 :     UniValue valReply(UniValue::VSTR);</span></span>
<span id="L886"><span class="lineNum">     886</span>   [<span class="tlaGBC" title="Branch 0 was taken 571 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 571 times"> + </span>]:<span class="tlaGNC">         571 :     if (!valReply.read(response.body))</span></span>
<span id="L887"><span class="lineNum">     887</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         throw std::runtime_error(&quot;couldn't parse reply from server&quot;);</span></span>
<span id="L888"><span class="lineNum">     888</span>         [<span class="tlaGBC" title="Branch 0 was taken 571 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         571 :     UniValue reply = rh-&gt;ProcessReply(valReply);</span></span>
<span id="L889"><span class="lineNum">     889</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 571 times"> + </span>]:<span class="tlaGNC">         571 :     if (reply.empty())</span></span>
<span id="L890"><span class="lineNum">     890</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         throw std::runtime_error(&quot;expected reply to have result, error and id properties&quot;);</span></span>
<span id="L891"><span class="lineNum">     891</span>                 :             : </span>
<span id="L892"><span class="lineNum">     892</span>                 :<span class="tlaGNC tlaBgGNC">        1142 :     return reply;</span></span>
<span id="L893"><span class="lineNum">     893</span>   [<span class="tlaGBC" title="Branch 0 was taken 571 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 571 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1918 : }</span></span>
<span id="L894"><span class="lineNum">     894</span>                 :             : </span>
<span id="L895"><span class="lineNum">     895</span>                 :             : /**</span>
<span id="L896"><span class="lineNum">     896</span>                 :             :  * ConnectAndCallRPC wraps CallRPC with -rpcwait and an exception handler.</span>
<span id="L897"><span class="lineNum">     897</span>                 :             :  *</span>
<span id="L898"><span class="lineNum">     898</span>                 :             :  * @param[in] rh         Pointer to RequestHandler.</span>
<span id="L899"><span class="lineNum">     899</span>                 :             :  * @param[in] strMethod  Reference to const string method to forward to CallRPC.</span>
<span id="L900"><span class="lineNum">     900</span>                 :             :  * @param[in] rpcwallet  Reference to const optional string wallet name to forward to CallRPC.</span>
<span id="L901"><span class="lineNum">     901</span>                 :             :  * @returns the RPC response as a UniValue object.</span>
<span id="L902"><span class="lineNum">     902</span>                 :             :  * @throws a CConnectionFailed std::runtime_error if connection failed or RPC server still in warmup.</span>
<span id="L903"><span class="lineNum">     903</span>                 :             :  */</span>
<span id="L904"><span class="lineNum">     904</span>                 :<span class="tlaGNC">         614 : static UniValue ConnectAndCallRPC(BaseRequestHandler* rh, const std::string&amp; strMethod, const std::vector&lt;std::string&gt;&amp; args, const std::optional&lt;std::string&gt;&amp; rpcwallet = {})</span></span>
<span id="L905"><span class="lineNum">     905</span>                 :             : {</span>
<span id="L906"><span class="lineNum">     906</span>                 :<span class="tlaGNC">         614 :     UniValue response(UniValue::VOBJ);</span></span>
<span id="L907"><span class="lineNum">     907</span>                 :             :     // Execute and handle connection failures with -rpcwait.</span>
<span id="L908"><span class="lineNum">     908</span>   [<span class="tlaGBC" title="Branch 0 was taken 614 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 614 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         614 :     const bool fWait = gArgs.GetBoolArg(&quot;-rpcwait&quot;, false);</span></span>
<span id="L909"><span class="lineNum">     909</span>   [<span class="tlaGBC" title="Branch 0 was taken 614 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 614 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         614 :     const int timeout = gArgs.GetIntArg(&quot;-rpcwaittimeout&quot;, DEFAULT_WAIT_CLIENT_TIMEOUT);</span></span>
<span id="L910"><span class="lineNum">     910</span>                 :<span class="tlaGNC">         614 :     const auto deadline{std::chrono::steady_clock::now() + 1s * timeout};</span></span>
<span id="L911"><span class="lineNum">     911</span>                 :             : </span>
<span id="L912"><span class="lineNum">     912</span>                 :<span class="tlaGNC">         626 :     do {</span></span>
<span id="L913"><span class="lineNum">     913</span>                 :<span class="tlaGNC">         626 :         try {</span></span>
<span id="L914"><span class="lineNum">     914</span>         [<span class="tlaGBC" title="Branch 0 was taken 571 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 55 times"> + </span>]:<span class="tlaGNC">         626 :             response = CallRPC(rh, strMethod, args, rpcwallet);</span></span>
<span id="L915"><span class="lineNum">     915</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 567 times"> + </span>]:<span class="tlaGNC">         571 :             if (fWait) {</span></span>
<span id="L916"><span class="lineNum">     916</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           4 :                 const UniValue&amp; error = response.find_value(&quot;error&quot;);</span></span>
<span id="L917"><span class="lineNum">     917</span>   [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">           6 :                 if (!error.isNull() &amp;&amp; error[&quot;code&quot;].getInt&lt;int&gt;() == RPC_IN_WARMUP) {</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 11 was taken 2 times"> + </span>]
<span id="L918"><span class="lineNum">     918</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           4 :                     throw CConnectionFailed(&quot;server in warmup&quot;);</span></span>
<span id="L919"><span class="lineNum">     919</span>                 :             :                 }</span>
<span id="L920"><span class="lineNum">     920</span>                 :             :             }</span>
<span id="L921"><span class="lineNum">     921</span>                 :             :             break; // Connection succeeded, no need to retry.</span>
<span id="L922"><span class="lineNum">     922</span>         [<span class="tlaGBC" title="Branch 0 was taken 37 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 20 times"> + </span>]:<span class="tlaGNC">          57 :         } catch (const CConnectionFailed&amp; e) {</span></span>
<span id="L923"><span class="lineNum">     923</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 6 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 12 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 2 times"> + </span> :<span class="tlaGNC">          20 :             if (fWait &amp;&amp; (timeout &lt;= 0 || std::chrono::steady_clock::now() &lt; deadline)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 2 times"> + </span>]
<span id="L924"><span class="lineNum">     924</span>         [<span class="tlaGBC" title="Branch 0 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          12 :                 UninterruptibleSleep(1s);</span></span>
<span id="L925"><span class="lineNum">     925</span>                 :             :             } else {</span>
<span id="L926"><span class="lineNum">     926</span>         [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          16 :                 throw CConnectionFailed(strprintf(&quot;timeout on transient error: %s&quot;, e.what()));</span></span>
<span id="L927"><span class="lineNum">     927</span>                 :             :             }</span>
<span id="L928"><span class="lineNum">     928</span>                 :<span class="tlaGNC">           8 :         }</span></span>
<span id="L929"><span class="lineNum">     929</span>                 :<span class="tlaGNC">          12 :     } while (fWait);</span></span>
<span id="L930"><span class="lineNum">     930</span>                 :<span class="tlaGNC">         569 :     return response;</span></span>
<span id="L931"><span class="lineNum">     931</span>                 :<span class="tlaGNC">          45 : }</span></span>
<span id="L932"><span class="lineNum">     932</span>                 :             : </span>
<span id="L933"><span class="lineNum">     933</span>                 :             : /** Parse UniValue result to update the message to print to std::cout. */</span>
<span id="L934"><span class="lineNum">     934</span>                 :<span class="tlaGNC">         430 : static void ParseResult(const UniValue&amp; result, std::string&amp; strPrint)</span></span>
<span id="L935"><span class="lineNum">     935</span>                 :             : {</span>
<span id="L936"><span class="lineNum">     936</span>         [<span class="tlaGBC" title="Branch 0 was taken 398 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 32 times"> + </span>]:<span class="tlaGNC">         430 :     if (result.isNull()) return;</span></span>
<span id="L937"><span class="lineNum">     937</span>         [<span class="tlaGBC" title="Branch 0 was taken 87 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 311 times"> + </span>]:<span class="tlaGNC">         796 :     strPrint = result.isStr() ? result.get_str() : result.write(2);</span></span>
<span id="L938"><span class="lineNum">     938</span>                 :             : }</span>
<span id="L939"><span class="lineNum">     939</span>                 :             : </span>
<span id="L940"><span class="lineNum">     940</span>                 :             : /** Parse UniValue error to update the message to print to std::cerr and the code to return. */</span>
<span id="L941"><span class="lineNum">     941</span>                 :<span class="tlaGNC">          85 : static void ParseError(const UniValue&amp; error, std::string&amp; strPrint, int&amp; nRet)</span></span>
<span id="L942"><span class="lineNum">     942</span>                 :             : {</span>
<span id="L943"><span class="lineNum">     943</span>         [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          85 :     if (error.isObject()) {</span></span>
<span id="L944"><span class="lineNum">     944</span>                 :<span class="tlaGNC">          85 :         const UniValue&amp; err_code = error.find_value(&quot;code&quot;);</span></span>
<span id="L945"><span class="lineNum">     945</span>                 :<span class="tlaGNC">          85 :         const UniValue&amp; err_msg = error.find_value(&quot;message&quot;);</span></span>
<span id="L946"><span class="lineNum">     946</span>         [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          85 :         if (!err_code.isNull()) {</span></span>
<span id="L947"><span class="lineNum">     947</span>         [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         170 :             strPrint = &quot;error code: &quot; + err_code.getValStr() + &quot;\n&quot;;</span></span>
<span id="L948"><span class="lineNum">     948</span>                 :             :         }</span>
<span id="L949"><span class="lineNum">     949</span>         [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          85 :         if (err_msg.isStr()) {</span></span>
<span id="L950"><span class="lineNum">     950</span>         [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         170 :             strPrint += (&quot;error message:\n&quot; + err_msg.get_str());</span></span>
<span id="L951"><span class="lineNum">     951</span>                 :             :         }</span>
<span id="L952"><span class="lineNum">     952</span>   [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 75 times"> + </span>]:<span class="tlaGNC">          85 :         if (err_code.isNum() &amp;&amp; err_code.getInt&lt;int&gt;() == RPC_WALLET_NOT_SPECIFIED) {</span></span>
<span id="L953"><span class="lineNum">     953</span>                 :<span class="tlaGNC">          10 :             strPrint += &quot; Or for the CLI, specify the \&quot;-rpcwallet=&lt;walletname&gt;\&quot; option before the command&quot;;</span></span>
<span id="L954"><span class="lineNum">     954</span>                 :<span class="tlaGNC">          10 :             strPrint += &quot; (run \&quot;bitcoin-cli -h\&quot; for help or \&quot;bitcoin-cli listwallets\&quot; to see which wallets are currently loaded).&quot;;</span></span>
<span id="L955"><span class="lineNum">     955</span>                 :             :         }</span>
<span id="L956"><span class="lineNum">     956</span>                 :             :     } else {</span>
<span id="L957"><span class="lineNum">     957</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :         strPrint = &quot;error: &quot; + error.write();</span></span>
<span id="L958"><span class="lineNum">     958</span>                 :             :     }</span>
<span id="L959"><span class="lineNum">     959</span>   [<span class="tlaGBC" title="Branch 0 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 85 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">          85 :     nRet = abs(error[&quot;code&quot;].getInt&lt;int&gt;());</span></span>
<span id="L960"><span class="lineNum">     960</span>                 :<span class="tlaGNC">          85 : }</span></span>
<span id="L961"><span class="lineNum">     961</span>                 :             : </span>
<span id="L962"><span class="lineNum">     962</span>                 :             : /**</span>
<span id="L963"><span class="lineNum">     963</span>                 :             :  * GetWalletBalances calls listwallets; if more than one wallet is loaded, it then</span>
<span id="L964"><span class="lineNum">     964</span>                 :             :  * fetches mine.trusted balances for each loaded wallet and pushes them to `result`.</span>
<span id="L965"><span class="lineNum">     965</span>                 :             :  *</span>
<span id="L966"><span class="lineNum">     966</span>                 :             :  * @param result  Reference to UniValue object the wallet names and balances are pushed to.</span>
<span id="L967"><span class="lineNum">     967</span>                 :             :  */</span>
<span id="L968"><span class="lineNum">     968</span>                 :<span class="tlaGNC">          16 : static void GetWalletBalances(UniValue&amp; result)</span></span>
<span id="L969"><span class="lineNum">     969</span>                 :             : {</span>
<span id="L970"><span class="lineNum">     970</span>                 :<span class="tlaGNC">          16 :     DefaultRequestHandler rh;</span></span>
<span id="L971"><span class="lineNum">     971</span>   [<span class="tlaGBC" title="Branch 0 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          32 :     const UniValue listwallets = ConnectAndCallRPC(&amp;rh, &quot;listwallets&quot;, /* args=*/{});</span></span>
<span id="L972"><span class="lineNum">     972</span>   [<span class="tlaGBC" title="Branch 0 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          16 :     if (!listwallets.find_value(&quot;error&quot;).isNull()) return;</span></span>
<span id="L973"><span class="lineNum">     973</span>         [<span class="tlaGBC" title="Branch 0 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          16 :     const UniValue&amp; wallets = listwallets.find_value(&quot;result&quot;);</span></span>
<span id="L974"><span class="lineNum">     974</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 12 times"> + </span>]:<span class="tlaGNC">          16 :     if (wallets.size() &lt;= 1) return;</span></span>
<span id="L975"><span class="lineNum">     975</span>                 :             : </span>
<span id="L976"><span class="lineNum">     976</span>                 :<span class="tlaGNC">           4 :     UniValue balances(UniValue::VOBJ);</span></span>
<span id="L977"><span class="lineNum">     977</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 4 times"> + </span>]:<span class="tlaGNC">          14 :     for (const UniValue&amp; wallet : wallets.getValues()) {</span></span>
<span id="L978"><span class="lineNum">     978</span>         [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          10 :         const std::string&amp; wallet_name = wallet.get_str();</span></span>
<span id="L979"><span class="lineNum">     979</span>   [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          20 :         const UniValue getbalances = ConnectAndCallRPC(&amp;rh, &quot;getbalances&quot;, /* args=*/{}, wallet_name);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L980"><span class="lineNum">     980</span>   [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          10 :         const UniValue&amp; balance = getbalances.find_value(&quot;result&quot;)[&quot;mine&quot;][&quot;trusted&quot;];</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 10 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not taken"> - </span>]
<span id="L981"><span class="lineNum">     981</span>   [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          20 :         balances.pushKV(wallet_name, balance);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L982"><span class="lineNum">     982</span>                 :<span class="tlaGNC">          10 :     }</span></span>
<span id="L983"><span class="lineNum">     983</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">           8 :     result.pushKV(&quot;balances&quot;, std::move(balances));</span></span>
<span id="L984"><span class="lineNum">     984</span>                 :<span class="tlaGNC">          16 : }</span></span>
<span id="L985"><span class="lineNum">     985</span>                 :             : </span>
<span id="L986"><span class="lineNum">     986</span>                 :             : /**</span>
<span id="L987"><span class="lineNum">     987</span>                 :             :  * GetProgressBar constructs a progress bar with 5% intervals.</span>
<span id="L988"><span class="lineNum">     988</span>                 :             :  *</span>
<span id="L989"><span class="lineNum">     989</span>                 :             :  * @param[in]   progress      The proportion of the progress bar to be filled between 0 and 1.</span>
<span id="L990"><span class="lineNum">     990</span>                 :             :  * @param[out]  progress_bar  String representation of the progress bar.</span>
<span id="L991"><span class="lineNum">     991</span>                 :             :  */</span>
<span id="L992"><span class="lineNum">     992</span>                 :<span class="tlaUNC tlaBgUNC">           0 : static void GetProgressBar(double progress, std::string&amp; progress_bar)</span></span>
<span id="L993"><span class="lineNum">     993</span>                 :             : {</span>
<span id="L994"><span class="lineNum">     994</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (progress &lt; 0 || progress &gt; 1) return;</span></span>
<span id="L995"><span class="lineNum">     995</span>                 :             : </span>
<span id="L996"><span class="lineNum">     996</span>                 :<span class="tlaUNC">           0 :     static constexpr double INCREMENT{0.05};</span></span>
<span id="L997"><span class="lineNum">     997</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     static const std::string COMPLETE_BAR{&quot;\u2592&quot;};</span></span>
<span id="L998"><span class="lineNum">     998</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     static const std::string INCOMPLETE_BAR{&quot;\u2591&quot;};</span></span>
<span id="L999"><span class="lineNum">     999</span>                 :             : </span>
<span id="L1000"><span class="lineNum">    1000</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (int i = 0; i &lt; progress / INCREMENT; ++i) {</span></span>
<span id="L1001"><span class="lineNum">    1001</span>                 :<span class="tlaUNC">           0 :         progress_bar += COMPLETE_BAR;</span></span>
<span id="L1002"><span class="lineNum">    1002</span>                 :             :     }</span>
<span id="L1003"><span class="lineNum">    1003</span>                 :             : </span>
<span id="L1004"><span class="lineNum">    1004</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (int i = 0; i &lt; (1 - progress) / INCREMENT; ++i) {</span></span>
<span id="L1005"><span class="lineNum">    1005</span>                 :<span class="tlaUNC">           0 :         progress_bar += INCOMPLETE_BAR;</span></span>
<span id="L1006"><span class="lineNum">    1006</span>                 :             :     }</span>
<span id="L1007"><span class="lineNum">    1007</span>                 :             : }</span>
<span id="L1008"><span class="lineNum">    1008</span>                 :             : </span>
<span id="L1009"><span class="lineNum">    1009</span>                 :             : /**</span>
<span id="L1010"><span class="lineNum">    1010</span>                 :             :  * ParseGetInfoResult takes in -getinfo result in UniValue object and parses it</span>
<span id="L1011"><span class="lineNum">    1011</span>                 :             :  * into a user friendly UniValue string to be printed on the console.</span>
<span id="L1012"><span class="lineNum">    1012</span>                 :             :  * @param[out] result  Reference to UniValue result containing the -getinfo output.</span>
<span id="L1013"><span class="lineNum">    1013</span>                 :             :  */</span>
<span id="L1014"><span class="lineNum">    1014</span>                 :<span class="tlaGNC tlaBgGNC">          28 : static void ParseGetInfoResult(UniValue&amp; result)</span></span>
<span id="L1015"><span class="lineNum">    1015</span>                 :             : {</span>
<span id="L1016"><span class="lineNum">    1016</span>         [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          28 :     if (!result.find_value(&quot;error&quot;).isNull()) return;</span></span>
<span id="L1017"><span class="lineNum">    1017</span>                 :             : </span>
<span id="L1018"><span class="lineNum">    1018</span>                 :<span class="tlaGNC">          28 :     std::string RESET, GREEN, BLUE, YELLOW, MAGENTA, CYAN;</span></span>
<span id="L1019"><span class="lineNum">    1019</span>                 :<span class="tlaGNC">          28 :     bool should_colorize = false;</span></span>
<span id="L1020"><span class="lineNum">    1020</span>                 :             : </span>
<span id="L1021"><span class="lineNum">    1021</span>                 :             : #ifndef WIN32</span>
<span id="L1022"><span class="lineNum">    1022</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 28 times"> + </span>]:<span class="tlaGNC">          28 :     if (isatty(fileno(stdout))) {</span></span>
<span id="L1023"><span class="lineNum">    1023</span>                 :             :         // By default, only print colored text if OS is not WIN32 and stdout is connected to a terminal.</span>
<span id="L1024"><span class="lineNum">    1024</span>                 :<span class="tlaUNC tlaBgUNC">           0 :         should_colorize = true;</span></span>
<span id="L1025"><span class="lineNum">    1025</span>                 :             :     }</span>
<span id="L1026"><span class="lineNum">    1026</span>                 :             : #endif</span>
<span id="L1027"><span class="lineNum">    1027</span>                 :             : </span>
<span id="L1028"><span class="lineNum">    1028</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC tlaBgGNC">          28 :     if (gArgs.IsArgSet(&quot;-color&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 6 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 22 times"> + </span>]
<span id="L1029"><span class="lineNum">    1029</span>   [<span class="tlaGBC" title="Branch 0 was taken 6 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 6 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">           6 :         const std::string color{gArgs.GetArg(&quot;-color&quot;, DEFAULT_COLOR_SETTING)};</span></span>
<span id="L1030"><span class="lineNum">    1030</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span>]:<span class="tlaGNC">           6 :         if (color == &quot;always&quot;) {</span></span>
<span id="L1031"><span class="lineNum">    1031</span>                 :             :             should_colorize = true;</span>
<span id="L1032"><span class="lineNum">    1032</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span>]:<span class="tlaGNC">           4 :         } else if (color == &quot;never&quot;) {</span></span>
<span id="L1033"><span class="lineNum">    1033</span>                 :             :             should_colorize = false;</span>
<span id="L1034"><span class="lineNum">    1034</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         } else if (color != &quot;auto&quot;) {</span></span>
<span id="L1035"><span class="lineNum">    1035</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :             throw std::runtime_error(&quot;Invalid value for -color option. Valid values: always, auto, never.&quot;);</span></span>
<span id="L1036"><span class="lineNum">    1036</span>                 :             :         }</span>
<span id="L1037"><span class="lineNum">    1037</span>                 :<span class="tlaGNC">           6 :     }</span></span>
<span id="L1038"><span class="lineNum">    1038</span>                 :             : </span>
<span id="L1039"><span class="lineNum">    1039</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 24 times"> + </span>]:<span class="tlaGNC">          26 :     if (should_colorize) {</span></span>
<span id="L1040"><span class="lineNum">    1040</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         RESET = &quot;\x1B[0m&quot;;</span></span>
<span id="L1041"><span class="lineNum">    1041</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         GREEN = &quot;\x1B[32m&quot;;</span></span>
<span id="L1042"><span class="lineNum">    1042</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         BLUE = &quot;\x1B[34m&quot;;</span></span>
<span id="L1043"><span class="lineNum">    1043</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         YELLOW = &quot;\x1B[33m&quot;;</span></span>
<span id="L1044"><span class="lineNum">    1044</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         MAGENTA = &quot;\x1B[35m&quot;;</span></span>
<span id="L1045"><span class="lineNum">    1045</span>         [<span class="tlaGBC" title="Branch 0 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           2 :         CYAN = &quot;\x1B[36m&quot;;</span></span>
<span id="L1046"><span class="lineNum">    1046</span>                 :             :     }</span>
<span id="L1047"><span class="lineNum">    1047</span>                 :             : </span>
<span id="L1048"><span class="lineNum">    1048</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :     std::string result_string = strprintf(&quot;%sChain: %s%s\n&quot;, BLUE, result[&quot;chain&quot;].getValStr(), RESET);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1049"><span class="lineNum">    1049</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Blocks: %s\n&quot;, result[&quot;blocks&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1050"><span class="lineNum">    1050</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Headers: %s\n&quot;, result[&quot;headers&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1051"><span class="lineNum">    1051</span>                 :             : </span>
<span id="L1052"><span class="lineNum">    1052</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :     const double ibd_progress{result[&quot;verificationprogress&quot;].get_real()};</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1053"><span class="lineNum">    1053</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 26 times"> + </span>]:<span class="tlaGNC">          26 :     std::string ibd_progress_bar;</span></span>
<span id="L1054"><span class="lineNum">    1054</span>                 :             :     // Display the progress bar only if IBD progress is less than 99%</span>
<span id="L1055"><span class="lineNum">    1055</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 26 times"> + </span>]:<span class="tlaGNC">          26 :     if (ibd_progress &lt; 0.99) {</span></span>
<span id="L1056"><span class="lineNum">    1056</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :       GetProgressBar(ibd_progress, ibd_progress_bar);</span></span>
<span id="L1057"><span class="lineNum">    1057</span>                 :             :       // Add padding between progress bar and IBD progress</span>
<span id="L1058"><span class="lineNum">    1058</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :       ibd_progress_bar += &quot; &quot;;</span></span>
<span id="L1059"><span class="lineNum">    1059</span>                 :             :     }</span>
<span id="L1060"><span class="lineNum">    1060</span>                 :             : </span>
<span id="L1061"><span class="lineNum">    1061</span>         [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">          52 :     result_string += strprintf(&quot;Verification progress: %s%.4f%%\n&quot;, ibd_progress_bar, ibd_progress * 100);</span></span>
<span id="L1062"><span class="lineNum">    1062</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Difficulty: %s\n\n&quot;, result[&quot;difficulty&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1063"><span class="lineNum">    1063</span>                 :             : </span>
<span id="L1064"><span class="lineNum">    1064</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          78 :     result_string += strprintf(</span></span>
<span id="L1065"><span class="lineNum">    1065</span>                 :             :         &quot;%sNetwork: in %s, out %s, total %s%s\n&quot;,</span>
<span id="L1066"><span class="lineNum">    1066</span>                 :             :         GREEN,</span>
<span id="L1067"><span class="lineNum">    1067</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :         result[&quot;connections&quot;][&quot;in&quot;].getValStr(),</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 26 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not taken"> - </span>]
<span id="L1068"><span class="lineNum">    1068</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :         result[&quot;connections&quot;][&quot;out&quot;].getValStr(),</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 26 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not taken"> - </span>]
<span id="L1069"><span class="lineNum">    1069</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :         result[&quot;connections&quot;][&quot;total&quot;].getValStr(),</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 26 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not taken"> - </span>]
<span id="L1070"><span class="lineNum">    1070</span>                 :<span class="tlaGNC">          26 :         RESET);</span></span>
<span id="L1071"><span class="lineNum">    1071</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Version: %s\n&quot;, result[&quot;version&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1072"><span class="lineNum">    1072</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Time offset (s): %s\n&quot;, result[&quot;timeoffset&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1073"><span class="lineNum">    1073</span>                 :             : </span>
<span id="L1074"><span class="lineNum">    1074</span>                 :             :     // proxies</span>
<span id="L1075"><span class="lineNum">    1075</span>         [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          26 :     std::map&lt;std::string, std::vector&lt;std::string&gt;&gt; proxy_networks;</span></span>
<span id="L1076"><span class="lineNum">    1076</span>                 :<span class="tlaGNC">          26 :     std::vector&lt;std::string&gt; ordered_proxies;</span></span>
<span id="L1077"><span class="lineNum">    1077</span>                 :             : </span>
<span id="L1078"><span class="lineNum">    1078</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         156 :     for (const UniValue&amp; network : result[&quot;networks&quot;].getValues()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 130 times"> + </span><span class="tlaGBC" title="Branch 7 was taken 26 times"> + </span>]
<span id="L1079"><span class="lineNum">    1079</span>   [<span class="tlaGBC" title="Branch 0 was taken 130 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 130 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         130 :         const std::string proxy = network[&quot;proxy&quot;].getValStr();</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 130 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1080"><span class="lineNum">    1080</span>         [<span class="tlaGBC" title="Branch 0 was taken 120 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 10 times"> + </span>]:<span class="tlaGNC">         130 :         if (proxy.empty()) continue;</span></span>
<span id="L1081"><span class="lineNum">    1081</span>                 :             :         // Add proxy to ordered_proxy if has not been processed</span>
<span id="L1082"><span class="lineNum">    1082</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 6 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          10 :         if (proxy_networks.find(proxy) == proxy_networks.end()) ordered_proxies.push_back(proxy);</span></span>
<span id="L1083"><span class="lineNum">    1083</span>                 :             : </span>
<span id="L1084"><span class="lineNum">    1084</span>   [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          20 :         proxy_networks[proxy].push_back(network[&quot;name&quot;].getValStr());</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1085"><span class="lineNum">    1085</span>                 :<span class="tlaGNC">         130 :     }</span></span>
<span id="L1086"><span class="lineNum">    1086</span>                 :             : </span>
<span id="L1087"><span class="lineNum">    1087</span>                 :<span class="tlaGNC">          26 :     std::vector&lt;std::string&gt; formatted_proxies;</span></span>
<span id="L1088"><span class="lineNum">    1088</span>         [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          26 :     formatted_proxies.reserve(ordered_proxies.size());</span></span>
<span id="L1089"><span class="lineNum">    1089</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 26 times"> + </span>]:<span class="tlaGNC">          30 :     for (const std::string&amp; proxy : ordered_proxies) {</span></span>
<span id="L1090"><span class="lineNum">    1090</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">           8 :         formatted_proxies.emplace_back(strprintf(&quot;%s (%s)&quot;, proxy, Join(proxy_networks.find(proxy)-&gt;second, &quot;, &quot;)));</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1091"><span class="lineNum">    1091</span>                 :             :     }</span>
<span id="L1092"><span class="lineNum">    1092</span>   [<span class="tlaGBC" title="Branch 0 was taken 24 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 24 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Proxies: %s\n&quot;, formatted_proxies.empty() ? &quot;n/a&quot; : Join(formatted_proxies, &quot;, &quot;));</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 2 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1093"><span class="lineNum">    1093</span>                 :             : </span>
<span id="L1094"><span class="lineNum">    1094</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;Min tx relay fee rate (%s/kvB): %s\n\n&quot;, CURRENCY_UNIT, result[&quot;relayfee&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1095"><span class="lineNum">    1095</span>                 :             : </span>
<span id="L1096"><span class="lineNum">    1096</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :     if (!result[&quot;has_wallet&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 12 times"> + </span>]
<span id="L1097"><span class="lineNum">    1097</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          14 :         const std::string walletname = result[&quot;walletname&quot;].getValStr();</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1098"><span class="lineNum">    1098</span>   [<span class="tlaGBC" title="Branch 0 was taken 3 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 11 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 3 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result_string += strprintf(&quot;%sWallet: %s%s\n&quot;, MAGENTA, walletname.empty() ? &quot;\&quot;\&quot;&quot; : walletname, RESET);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 11 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1099"><span class="lineNum">    1099</span>                 :             : </span>
<span id="L1100"><span class="lineNum">    1100</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result_string += strprintf(&quot;Keypool size: %s\n&quot;, result[&quot;keypoolsize&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1101"><span class="lineNum">    1101</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          14 :         if (!result[&quot;unlocked_until&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 12 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 2 times"> + </span>]
<span id="L1102"><span class="lineNum">    1102</span>   [<span class="tlaGBC" title="Branch 0 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          24 :             result_string += strprintf(&quot;Unlocked until: %s\n&quot;, result[&quot;unlocked_until&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1103"><span class="lineNum">    1103</span>                 :             :         }</span>
<span id="L1104"><span class="lineNum">    1104</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result_string += strprintf(&quot;Transaction fee rate (-paytxfee) (%s/kvB): %s\n\n&quot;, CURRENCY_UNIT, result[&quot;paytxfee&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1105"><span class="lineNum">    1105</span>                 :<span class="tlaGNC">          14 :     }</span></span>
<span id="L1106"><span class="lineNum">    1106</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :     if (!result[&quot;balance&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 12 times"> + </span>]
<span id="L1107"><span class="lineNum">    1107</span>   [<span class="tlaGBC" title="Branch 0 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :         result_string += strprintf(&quot;%sBalance:%s %s\n\n&quot;, CYAN, RESET, result[&quot;balance&quot;].getValStr());</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 14 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1108"><span class="lineNum">    1108</span>                 :             :     }</span>
<span id="L1109"><span class="lineNum">    1109</span>                 :             : </span>
<span id="L1110"><span class="lineNum">    1110</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :     if (!result[&quot;balances&quot;].isNull()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 22 times"> + </span>]
<span id="L1111"><span class="lineNum">    1111</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           8 :         result_string += strprintf(&quot;%sBalances%s\n&quot;, CYAN, RESET);</span></span>
<span id="L1112"><span class="lineNum">    1112</span>                 :             : </span>
<span id="L1113"><span class="lineNum">    1113</span>                 :<span class="tlaGNC">           4 :         size_t max_balance_length{10};</span></span>
<span id="L1114"><span class="lineNum">    1114</span>                 :             : </span>
<span id="L1115"><span class="lineNum">    1115</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          14 :         for (const std::string&amp; wallet : result[&quot;balances&quot;].getKeys()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 10 times"> + </span><span class="tlaGBC" title="Branch 7 was taken 4 times"> + </span>]
<span id="L1116"><span class="lineNum">    1116</span>   [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          18 :             max_balance_length = std::max(result[&quot;balances&quot;][wallet].getValStr().length(), max_balance_length);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 8 times"> + </span><span class="tlaGBC" title="Branch 7 was taken 2 times"> + </span>]
<span id="L1117"><span class="lineNum">    1117</span>                 :             :         }</span>
<span id="L1118"><span class="lineNum">    1118</span>                 :             : </span>
<span id="L1119"><span class="lineNum">    1119</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          14 :         for (const std::string&amp; wallet : result[&quot;balances&quot;].getKeys()) {</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 10 times"> + </span><span class="tlaGBC" title="Branch 7 was taken 4 times"> + </span>]
<span id="L1120"><span class="lineNum">    1120</span>   [<span class="tlaGBC" title="Branch 0 was taken 1 time"> + </span><span class="tlaGBC" title="Branch 1 was taken 9 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          30 :             result_string += strprintf(&quot;%*s %s\n&quot;,</span></span>
<span id="L1121"><span class="lineNum">    1121</span>                 :             :                                        max_balance_length,</span>
<span id="L1122"><span class="lineNum">    1122</span>   [<span class="tlaGBC" title="Branch 0 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          20 :                                        result[&quot;balances&quot;][wallet].getValStr(),</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 10 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1123"><span class="lineNum">    1123</span>   [<span class="tlaGBC" title="Branch 0 was taken 1 time"> + </span><span class="tlaGBC" title="Branch 1 was taken 9 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 1 time"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          30 :                                        wallet.empty() ? &quot;\&quot;\&quot;&quot; : wallet);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 9 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1124"><span class="lineNum">    1124</span>                 :             :         }</span>
<span id="L1125"><span class="lineNum">    1125</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           4 :         result_string += &quot;\n&quot;;</span></span>
<span id="L1126"><span class="lineNum">    1126</span>                 :             :     }</span>
<span id="L1127"><span class="lineNum">    1127</span>                 :             : </span>
<span id="L1128"><span class="lineNum">    1128</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :     const std::string warnings{result[&quot;warnings&quot;].getValStr()};</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1129"><span class="lineNum">    1129</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          52 :     result_string += strprintf(&quot;%sWarnings:%s %s&quot;, YELLOW, RESET, warnings.empty() ? &quot;(none)&quot; : warnings);</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1130"><span class="lineNum">    1130</span>                 :             : </span>
<span id="L1131"><span class="lineNum">    1131</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          52 :     result.setStr(result_string);</span></span>
<span id="L1132"><span class="lineNum">    1132</span>                 :<span class="tlaGNC">          36 : }</span></span>
<span id="L1133"><span class="lineNum">    1133</span>                 :             : </span>
<span id="L1134"><span class="lineNum">    1134</span>                 :             : /**</span>
<span id="L1135"><span class="lineNum">    1135</span>                 :             :  * Call RPC getnewaddress.</span>
<span id="L1136"><span class="lineNum">    1136</span>                 :             :  * @returns getnewaddress response as a UniValue object.</span>
<span id="L1137"><span class="lineNum">    1137</span>                 :             :  */</span>
<span id="L1138"><span class="lineNum">    1138</span>                 :<span class="tlaGNC">          44 : static UniValue GetNewAddress()</span></span>
<span id="L1139"><span class="lineNum">    1139</span>                 :             : {</span>
<span id="L1140"><span class="lineNum">    1140</span>                 :<span class="tlaGNC">          44 :     std::optional&lt;std::string&gt; wallet_name{};</span></span>
<span id="L1141"><span class="lineNum">    1141</span>   [<span class="tlaGBC" title="Branch 0 was taken 44 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 44 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          44 :     if (gArgs.IsArgSet(&quot;-rpcwallet&quot;)) wallet_name = gArgs.GetArg(&quot;-rpcwallet&quot;, &quot;&quot;);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 24 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 20 times"> + </span><span class="tlaGBC" title="Branch 6 was taken 24 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 24 times"> + </span> 
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 24 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span>]
<span id="L1142"><span class="lineNum">    1142</span>                 :<span class="tlaGNC">          44 :     DefaultRequestHandler rh;</span></span>
<span id="L1143"><span class="lineNum">    1143</span>   [<span class="tlaGBC" title="Branch 0 was taken 44 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 44 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          88 :     return ConnectAndCallRPC(&amp;rh, &quot;getnewaddress&quot;, /* args=*/{}, wallet_name);</span></span>
<span id="L1144"><span class="lineNum">    1144</span>                 :<span class="tlaGNC">          44 : }</span></span>
<span id="L1145"><span class="lineNum">    1145</span>                 :             : </span>
<span id="L1146"><span class="lineNum">    1146</span>                 :             : /**</span>
<span id="L1147"><span class="lineNum">    1147</span>                 :             :  * Check bounds and set up args for RPC generatetoaddress params: nblocks, address, maxtries.</span>
<span id="L1148"><span class="lineNum">    1148</span>                 :             :  * @param[in] address  Reference to const string address to insert into the args.</span>
<span id="L1149"><span class="lineNum">    1149</span>                 :             :  * @param     args     Reference to vector of string args to modify.</span>
<span id="L1150"><span class="lineNum">    1150</span>                 :             :  */</span>
<span id="L1151"><span class="lineNum">    1151</span>                 :<span class="tlaGNC">          26 : static void SetGenerateToAddressArgs(const std::string&amp; address, std::vector&lt;std::string&gt;&amp; args)</span></span>
<span id="L1152"><span class="lineNum">    1152</span>                 :             : {</span>
<span id="L1153"><span class="lineNum">    1153</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 22 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          26 :     if (args.size() &gt; 2) throw std::runtime_error(&quot;too many arguments (maximum 2 for nblocks and maxtries)&quot;);</span></span>
<span id="L1154"><span class="lineNum">    1154</span>         [<span class="tlaGBC" title="Branch 0 was taken 6 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 16 times"> + </span>]:<span class="tlaGNC">          22 :     if (args.size() == 0) {</span></span>
<span id="L1155"><span class="lineNum">    1155</span>                 :<span class="tlaGNC">           6 :         args.emplace_back(DEFAULT_NBLOCKS);</span></span>
<span id="L1156"><span class="lineNum">    1156</span>         [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 12 times"> + </span>]:<span class="tlaGNC">          16 :     } else if (args.at(0) == &quot;0&quot;) {</span></span>
<span id="L1157"><span class="lineNum">    1157</span>   [<span class="tlaGBC" title="Branch 0 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 4 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">          12 :         throw std::runtime_error(&quot;the first argument (number of blocks to generate, default: &quot; + DEFAULT_NBLOCKS + &quot;) must be an integer value greater than zero&quot;);</span></span>
<span id="L1158"><span class="lineNum">    1158</span>                 :             :     }</span>
<span id="L1159"><span class="lineNum">    1159</span>                 :<span class="tlaGNC">          18 :     args.emplace(args.begin() + 1, address);</span></span>
<span id="L1160"><span class="lineNum">    1160</span>                 :<span class="tlaGNC">          18 : }</span></span>
<span id="L1161"><span class="lineNum">    1161</span>                 :             : </span>
<span id="L1162"><span class="lineNum">    1162</span>                 :<span class="tlaGNC">         572 : static int CommandLineRPC(int argc, char *argv[])</span></span>
<span id="L1163"><span class="lineNum">    1163</span>                 :             : {</span>
<span id="L1164"><span class="lineNum">    1164</span>                 :<span class="tlaGNC">         572 :     std::string strPrint;</span></span>
<span id="L1165"><span class="lineNum">    1165</span>                 :<span class="tlaGNC">         572 :     int nRet = 0;</span></span>
<span id="L1166"><span class="lineNum">    1166</span>                 :<span class="tlaGNC">         572 :     try {</span></span>
<span id="L1167"><span class="lineNum">    1167</span>                 :             :         // Skip switches</span>
<span id="L1168"><span class="lineNum">    1168</span>   [<span class="tlaGBC" title="Branch 0 was taken 1539 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 36 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 1003 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 536 times"> + </span>]:<span class="tlaGNC">        1575 :         while (argc &gt; 1 &amp;&amp; IsSwitchChar(argv[1][0])) {</span></span>
<span id="L1169"><span class="lineNum">    1169</span>                 :<span class="tlaGNC">        1003 :             argc--;</span></span>
<span id="L1170"><span class="lineNum">    1170</span>                 :<span class="tlaGNC">        1003 :             argv++;</span></span>
<span id="L1171"><span class="lineNum">    1171</span>                 :             :         }</span>
<span id="L1172"><span class="lineNum">    1172</span>         [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         572 :         std::string rpcPass;</span></span>
<span id="L1173"><span class="lineNum">    1173</span>   [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         572 :         if (gArgs.GetBoolArg(&quot;-stdinrpcpass&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 8 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 564 times"> + </span>]
<span id="L1174"><span class="lineNum">    1174</span>         [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">           8 :             NO_STDIN_ECHO();</span></span>
<span id="L1175"><span class="lineNum">    1175</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 8 times"> + </span>]:<span class="tlaGNC">           8 :             if (!StdinReady()) {</span></span>
<span id="L1176"><span class="lineNum">    1176</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :                 fputs(&quot;RPC password&gt; &quot;, stderr);</span></span>
<span id="L1177"><span class="lineNum">    1177</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 fflush(stderr);</span></span>
<span id="L1178"><span class="lineNum">    1178</span>                 :             :             }</span>
<span id="L1179"><span class="lineNum">    1179</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 8 times"> + </span>]:<span class="tlaGNC tlaBgGNC">           8 :             if (!std::getline(std::cin, rpcPass)) {</span></span>
<span id="L1180"><span class="lineNum">    1180</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :                 throw std::runtime_error(&quot;-stdinrpcpass specified but failed to read from standard input&quot;);</span></span>
<span id="L1181"><span class="lineNum">    1181</span>                 :             :             }</span>
<span id="L1182"><span class="lineNum">    1182</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 8 times"> + </span>]:<span class="tlaGNC tlaBgGNC">           8 :             if (StdinTerminal()) {</span></span>
<span id="L1183"><span class="lineNum">    1183</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :                 fputc('\n', stdout);</span></span>
<span id="L1184"><span class="lineNum">    1184</span>                 :             :             }</span>
<span id="L1185"><span class="lineNum">    1185</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">           8 :             gArgs.ForceSetArg(&quot;-rpcpassword&quot;, rpcPass);</span></span>
<span id="L1186"><span class="lineNum">    1186</span>                 :<span class="tlaGNC">           8 :         }</span></span>
<span id="L1187"><span class="lineNum">    1187</span>         [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         572 :         std::vector&lt;std::string&gt; args = std::vector&lt;std::string&gt;(&amp;argv[1], &amp;argv[argc]);</span></span>
<span id="L1188"><span class="lineNum">    1188</span>   [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         572 :         if (gArgs.GetBoolArg(&quot;-stdinwalletpassphrase&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 572 times"> + </span>]
<span id="L1189"><span class="lineNum">    1189</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             NO_STDIN_ECHO();</span></span>
<span id="L1190"><span class="lineNum">    1190</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             std::string walletPass;</span></span>
<span id="L1191"><span class="lineNum">    1191</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             if (args.size() &lt; 1 || args[0].substr(0, 16) != &quot;walletpassphrase&quot;) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1192"><span class="lineNum">    1192</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 throw std::runtime_error(&quot;-stdinwalletpassphrase is only applicable for walletpassphrase(change)&quot;);</span></span>
<span id="L1193"><span class="lineNum">    1193</span>                 :             :             }</span>
<span id="L1194"><span class="lineNum">    1194</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!StdinReady()) {</span></span>
<span id="L1195"><span class="lineNum">    1195</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 fputs(&quot;Wallet passphrase&gt; &quot;, stderr);</span></span>
<span id="L1196"><span class="lineNum">    1196</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 fflush(stderr);</span></span>
<span id="L1197"><span class="lineNum">    1197</span>                 :             :             }</span>
<span id="L1198"><span class="lineNum">    1198</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!std::getline(std::cin, walletPass)) {</span></span>
<span id="L1199"><span class="lineNum">    1199</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 throw std::runtime_error(&quot;-stdinwalletpassphrase specified but failed to read from standard input&quot;);</span></span>
<span id="L1200"><span class="lineNum">    1200</span>                 :             :             }</span>
<span id="L1201"><span class="lineNum">    1201</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (StdinTerminal()) {</span></span>
<span id="L1202"><span class="lineNum">    1202</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 fputc('\n', stdout);</span></span>
<span id="L1203"><span class="lineNum">    1203</span>                 :             :             }</span>
<span id="L1204"><span class="lineNum">    1204</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             args.insert(args.begin() + 1, walletPass);</span></span>
<span id="L1205"><span class="lineNum">    1205</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L1206"><span class="lineNum">    1206</span>   [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC tlaBgGNC">         572 :         if (gArgs.GetBoolArg(&quot;-stdin&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 8 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 564 times"> + </span>]
<span id="L1207"><span class="lineNum">    1207</span>                 :             :             // Read one arg per line from stdin and append</span>
<span id="L1208"><span class="lineNum">    1208</span>                 :<span class="tlaGNC">           8 :             std::string line;</span></span>
<span id="L1209"><span class="lineNum">    1209</span>   [<span class="tlaGBC" title="Branch 0 was taken 20 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 12 times"> + </span><span class="tlaGBC" title="Branch 3 was taken 8 times"> + </span>]:<span class="tlaGNC">          20 :             while (std::getline(std::cin, line)) {</span></span>
<span id="L1210"><span class="lineNum">    1210</span>         [<span class="tlaGBC" title="Branch 0 was taken 12 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          12 :                 args.push_back(line);</span></span>
<span id="L1211"><span class="lineNum">    1211</span>                 :             :             }</span>
<span id="L1212"><span class="lineNum">    1212</span>   [<span class="tlaGBC" title="Branch 0 was taken 8 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 8 times"> + </span>]:<span class="tlaGNC">           8 :             if (StdinTerminal()) {</span></span>
<span id="L1213"><span class="lineNum">    1213</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :                 fputc('\n', stdout);</span></span>
<span id="L1214"><span class="lineNum">    1214</span>                 :             :             }</span>
<span id="L1215"><span class="lineNum">    1215</span>                 :<span class="tlaGNC tlaBgGNC">           8 :         }</span></span>
<span id="L1216"><span class="lineNum">    1216</span>         [<span class="tlaGBC" title="Branch 0 was taken 570 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span>]:<span class="tlaGNC">         572 :         gArgs.CheckMultipleCLIArgs();</span></span>
<span id="L1217"><span class="lineNum">    1217</span>                 :<span class="tlaGNC">         570 :         std::unique_ptr&lt;BaseRequestHandler&gt; rh;</span></span>
<span id="L1218"><span class="lineNum">    1218</span>         [<span class="tlaGBC" title="Branch 0 was taken 570 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         570 :         std::string method;</span></span>
<span id="L1219"><span class="lineNum">    1219</span>   [<span class="tlaGBC" title="Branch 0 was taken 570 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 570 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         570 :         if (gArgs.IsArgSet(&quot;-getinfo&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 30 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 540 times"> + </span>]
<span id="L1220"><span class="lineNum">    1220</span>   [<span class="tlaGBC" title="Branch 0 was taken 30 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 30 times"> + </span>]:<span class="tlaGNC">          30 :             rh.reset(new GetinfoRequestHandler());</span></span>
<span id="L1221"><span class="lineNum">    1221</span>   [<span class="tlaGBC" title="Branch 0 was taken 540 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 540 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         540 :         } else if (gArgs.GetBoolArg(&quot;-netinfo&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 540 times"> + </span>]
<span id="L1222"><span class="lineNum">    1222</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             if (!args.empty() &amp;&amp; args.at(0) == &quot;help&quot;) {</span></span>
<span id="L1223"><span class="lineNum">    1223</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 tfm::format(std::cout, &quot;%s\n&quot;, NetinfoRequestHandler().m_help_doc);</span></span>
<span id="L1224"><span class="lineNum">    1224</span>                 :<span class="tlaUNC">           0 :                 return 0;</span></span>
<span id="L1225"><span class="lineNum">    1225</span>                 :             :             }</span>
<span id="L1226"><span class="lineNum">    1226</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             rh.reset(new NetinfoRequestHandler());</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1227"><span class="lineNum">    1227</span>   [<span class="tlaGBC" title="Branch 0 was taken 540 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 540 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC tlaBgGNC">         540 :         } else if (gArgs.GetBoolArg(&quot;-generate&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 44 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 496 times"> + </span>]
<span id="L1228"><span class="lineNum">    1228</span>         [<span class="tlaGBC" title="Branch 0 was taken 44 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          44 :             const UniValue getnewaddress{GetNewAddress()};</span></span>
<span id="L1229"><span class="lineNum">    1229</span>         [<span class="tlaGBC" title="Branch 0 was taken 44 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          44 :             const UniValue&amp; error{getnewaddress.find_value(&quot;error&quot;)};</span></span>
<span id="L1230"><span class="lineNum">    1230</span>         [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 18 times"> + </span>]:<span class="tlaGNC">          44 :             if (error.isNull()) {</span></span>
<span id="L1231"><span class="lineNum">    1231</span>   [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 26 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          26 :                 SetGenerateToAddressArgs(getnewaddress.find_value(&quot;result&quot;).get_str(), args);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 18 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 8 times"> + </span>]
<span id="L1232"><span class="lineNum">    1232</span>   [<span class="tlaGBC" title="Branch 0 was taken 18 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 18 times"> + </span>]:<span class="tlaGNC">          18 :                 rh.reset(new GenerateToAddressRequestHandler());</span></span>
<span id="L1233"><span class="lineNum">    1233</span>                 :             :             } else {</span>
<span id="L1234"><span class="lineNum">    1234</span>         [<span class="tlaGBC" title="Branch 0 was taken 18 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          18 :                 ParseError(error, strPrint, nRet);</span></span>
<span id="L1235"><span class="lineNum">    1235</span>                 :             :             }</span>
<span id="L1236"><span class="lineNum">    1236</span>   [<span class="tlaGBC" title="Branch 0 was taken 496 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 496 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         540 :         } else if (gArgs.GetBoolArg(&quot;-addrinfo&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 496 times"> + </span>]
<span id="L1237"><span class="lineNum">    1237</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :             rh.reset(new AddrinfoRequestHandler());</span></span>
<span id="L1238"><span class="lineNum">    1238</span>                 :             :         } else {</span>
<span id="L1239"><span class="lineNum">    1239</span>   [<span class="tlaGBC" title="Branch 0 was taken 496 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 496 times"> + </span>]:<span class="tlaGNC tlaBgGNC">         496 :             rh.reset(new DefaultRequestHandler());</span></span>
<span id="L1240"><span class="lineNum">    1240</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 496 times"> + </span>]:<span class="tlaGNC">         496 :             if (args.size() &lt; 1) {</span></span>
<span id="L1241"><span class="lineNum">    1241</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC tlaBgUNC">           0 :                 throw std::runtime_error(&quot;too few parameters (need at least command)&quot;);</span></span>
<span id="L1242"><span class="lineNum">    1242</span>                 :             :             }</span>
<span id="L1243"><span class="lineNum">    1243</span>         [<span class="tlaGBC" title="Branch 0 was taken 496 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC tlaBgGNC">         496 :             method = args[0];</span></span>
<span id="L1244"><span class="lineNum">    1244</span>                 :<span class="tlaGNC">         496 :             args.erase(args.begin()); // Remove trailing method name from arguments vector</span></span>
<span id="L1245"><span class="lineNum">    1245</span>                 :             :         }</span>
<span id="L1246"><span class="lineNum">    1246</span>         [<span class="tlaGBC" title="Branch 0 was taken 544 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 18 times"> + </span>]:<span class="tlaGNC">         562 :         if (nRet == 0) {</span></span>
<span id="L1247"><span class="lineNum">    1247</span>                 :             :             // Perform RPC call</span>
<span id="L1248"><span class="lineNum">    1248</span>                 :<span class="tlaGNC">         544 :             std::optional&lt;std::string&gt; wallet_name{};</span></span>
<span id="L1249"><span class="lineNum">    1249</span>   [<span class="tlaGBC" title="Branch 0 was taken 544 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 544 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         544 :             if (gArgs.IsArgSet(&quot;-rpcwallet&quot;)) wallet_name = gArgs.GetArg(&quot;-rpcwallet&quot;, &quot;&quot;);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 192 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 352 times"> + </span><span class="tlaGBC" title="Branch 6 was taken 192 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 192 times"> + </span> 
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 192 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span>]
<span id="L1250"><span class="lineNum">    1250</span>         [<span class="tlaGBC" title="Branch 0 was taken 499 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 45 times"> + </span>]:<span class="tlaGNC">         544 :             const UniValue reply = ConnectAndCallRPC(rh.get(), method, args, wallet_name);</span></span>
<span id="L1251"><span class="lineNum">    1251</span>                 :             : </span>
<span id="L1252"><span class="lineNum">    1252</span>                 :             :             // Parse reply</span>
<span id="L1253"><span class="lineNum">    1253</span>   [<span class="tlaGBC" title="Branch 0 was taken 499 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 499 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         499 :             UniValue result = reply.find_value(&quot;result&quot;);</span></span>
<span id="L1254"><span class="lineNum">    1254</span>         [<span class="tlaGBC" title="Branch 0 was taken 499 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         499 :             const UniValue&amp; error = reply.find_value(&quot;error&quot;);</span></span>
<span id="L1255"><span class="lineNum">    1255</span>         [<span class="tlaGBC" title="Branch 0 was taken 432 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 67 times"> + </span>]:<span class="tlaGNC">         499 :             if (error.isNull()) {</span></span>
<span id="L1256"><span class="lineNum">    1256</span>   [<span class="tlaGBC" title="Branch 0 was taken 432 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 432 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">         432 :                 if (gArgs.GetBoolArg(&quot;-getinfo&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 28 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 404 times"> + </span>]
<span id="L1257"><span class="lineNum">    1257</span>   [<span class="tlaGBC" title="Branch 0 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 28 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">          28 :                     if (!gArgs.IsArgSet(&quot;-rpcwallet&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 16 times"> + </span><span class="tlaGBC" title="Branch 5 was taken 12 times"> + </span>]
<span id="L1258"><span class="lineNum">    1258</span>         [<span class="tlaGBC" title="Branch 0 was taken 16 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          16 :                         GetWalletBalances(result); // fetch multiwallet balances and append to result</span></span>
<span id="L1259"><span class="lineNum">    1259</span>                 :             :                     }</span>
<span id="L1260"><span class="lineNum">    1260</span>         [<span class="tlaGBC" title="Branch 0 was taken 26 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span>]:<span class="tlaGNC">          28 :                     ParseGetInfoResult(result);</span></span>
<span id="L1261"><span class="lineNum">    1261</span>                 :             :                 }</span>
<span id="L1262"><span class="lineNum">    1262</span>                 :             : </span>
<span id="L1263"><span class="lineNum">    1263</span>         [<span class="tlaGBC" title="Branch 0 was taken 430 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         430 :                 ParseResult(result, strPrint);</span></span>
<span id="L1264"><span class="lineNum">    1264</span>                 :             :             } else {</span>
<span id="L1265"><span class="lineNum">    1265</span>         [<span class="tlaGBC" title="Branch 0 was taken 67 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">          67 :                 ParseError(error, strPrint, nRet);</span></span>
<span id="L1266"><span class="lineNum">    1266</span>                 :             :             }</span>
<span id="L1267"><span class="lineNum">    1267</span>                 :<span class="tlaGNC">         548 :         }</span></span>
<span id="L1268"><span class="lineNum">    1268</span>         [<span class="tlaGBC" title="Branch 0 was taken 57 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         684 :     } catch (const std::exception&amp; e) {</span></span>
<span id="L1269"><span class="lineNum">    1269</span>         [<span class="tlaGBC" title="Branch 0 was taken 57 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         114 :         strPrint = std::string(&quot;error: &quot;) + e.what();</span></span>
<span id="L1270"><span class="lineNum">    1270</span>                 :<span class="tlaGNC">          57 :         nRet = EXIT_FAILURE;</span></span>
<span id="L1271"><span class="lineNum">    1271</span>                 :<span class="tlaGNC">          57 :     } catch (...) {</span></span>
<span id="L1272"><span class="lineNum">    1272</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC tlaBgUNC">           0 :         PrintExceptionContinue(nullptr, &quot;CommandLineRPC()&quot;);</span></span>
<span id="L1273"><span class="lineNum">    1273</span>                 :<span class="tlaUNC">           0 :         throw;</span></span>
<span id="L1274"><span class="lineNum">    1274</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1275"><span class="lineNum">    1275</span>                 :             : </span>
<span id="L1276"><span class="lineNum">    1276</span>         [<span class="tlaGBC" title="Branch 0 was taken 540 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 32 times"> + </span>]:<span class="tlaGNC tlaBgGNC">         572 :     if (strPrint != &quot;&quot;) {</span></span>
<span id="L1277"><span class="lineNum">    1277</span>   [<span class="tlaGBC" title="Branch 0 was taken 142 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 398 times"> + </span><span class="tlaGBC" title="Branch 2 was taken 540 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">         682 :         tfm::format(nRet == 0 ? std::cout : std::cerr, &quot;%s\n&quot;, strPrint);</span></span>
<span id="L1278"><span class="lineNum">    1278</span>                 :             :     }</span>
<span id="L1279"><span class="lineNum">    1279</span>                 :<span class="tlaGNC">         572 :     return nRet;</span></span>
<span id="L1280"><span class="lineNum">    1280</span>                 :<span class="tlaGNC">         572 : }</span></span>
<span id="L1281"><span class="lineNum">    1281</span>                 :             : </span>
<span id="L1282"><span class="lineNum">    1282</span>                 :<span class="tlaGNC">         574 : MAIN_FUNCTION</span></span>
<span id="L1283"><span class="lineNum">    1283</span>                 :             : {</span>
<span id="L1284"><span class="lineNum">    1284</span>                 :             : #ifdef WIN32</span>
<span id="L1285"><span class="lineNum">    1285</span>                 :             :     common::WinCmdLineArgs winArgs;</span>
<span id="L1286"><span class="lineNum">    1286</span>                 :             :     std::tie(argc, argv) = winArgs.get();</span>
<span id="L1287"><span class="lineNum">    1287</span>                 :             : #endif</span>
<span id="L1288"><span class="lineNum">    1288</span>                 :<span class="tlaGNC">         574 :     SetupEnvironment();</span></span>
<span id="L1289"><span class="lineNum">    1289</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 574 times"> + </span>]:<span class="tlaGNC">         574 :     if (!SetupNetworking()) {</span></span>
<span id="L1290"><span class="lineNum">    1290</span>                 :<span class="tlaUNC tlaBgUNC">           0 :         tfm::format(std::cerr, &quot;Error: Initializing networking failed\n&quot;);</span></span>
<span id="L1291"><span class="lineNum">    1291</span>                 :<span class="tlaUNC">           0 :         return EXIT_FAILURE;</span></span>
<span id="L1292"><span class="lineNum">    1292</span>                 :             :     }</span>
<span id="L1293"><span class="lineNum">    1293</span>                 :<span class="tlaGNC tlaBgGNC">         574 :     event_set_log_callback(&amp;libevent_log_cb);</span></span>
<span id="L1294"><span class="lineNum">    1294</span>                 :             : </span>
<span id="L1295"><span class="lineNum">    1295</span>                 :<span class="tlaGNC">         574 :     try {</span></span>
<span id="L1296"><span class="lineNum">    1296</span>         [<span class="tlaGBC" title="Branch 0 was taken 574 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         574 :         int ret = AppInitRPC(argc, argv);</span></span>
<span id="L1297"><span class="lineNum">    1297</span>         [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaGBC" title="Branch 1 was taken 2 times"> + </span>]:<span class="tlaGNC">         574 :         if (ret != CONTINUE_EXECUTION)</span></span>
<span id="L1298"><span class="lineNum">    1298</span>                 :             :             return ret;</span>
<span id="L1299"><span class="lineNum">    1299</span>                 :             :     }</span>
<span id="L1300"><span class="lineNum">    1300</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC tlaBgUNC">           0 :     catch (const std::exception&amp; e) {</span></span>
<span id="L1301"><span class="lineNum">    1301</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         PrintExceptionContinue(&amp;e, &quot;AppInitRPC()&quot;);</span></span>
<span id="L1302"><span class="lineNum">    1302</span>                 :<span class="tlaUNC">           0 :         return EXIT_FAILURE;</span></span>
<span id="L1303"><span class="lineNum">    1303</span>                 :<span class="tlaUNC">           0 :     } catch (...) {</span></span>
<span id="L1304"><span class="lineNum">    1304</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         PrintExceptionContinue(nullptr, &quot;AppInitRPC()&quot;);</span></span>
<span id="L1305"><span class="lineNum">    1305</span>                 :<span class="tlaUNC">           0 :         return EXIT_FAILURE;</span></span>
<span id="L1306"><span class="lineNum">    1306</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1307"><span class="lineNum">    1307</span>                 :             : </span>
<span id="L1308"><span class="lineNum">    1308</span>                 :<span class="tlaGNC tlaBgGNC">         572 :     int ret = EXIT_FAILURE;</span></span>
<span id="L1309"><span class="lineNum">    1309</span>                 :<span class="tlaGNC">         572 :     try {</span></span>
<span id="L1310"><span class="lineNum">    1310</span>         [<span class="tlaGBC" title="Branch 0 was taken 572 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">         572 :         ret = CommandLineRPC(argc, argv);</span></span>
<span id="L1311"><span class="lineNum">    1311</span>                 :             :     }</span>
<span id="L1312"><span class="lineNum">    1312</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC tlaBgUNC">           0 :     catch (const std::exception&amp; e) {</span></span>
<span id="L1313"><span class="lineNum">    1313</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         PrintExceptionContinue(&amp;e, &quot;CommandLineRPC()&quot;);</span></span>
<span id="L1314"><span class="lineNum">    1314</span>                 :<span class="tlaUNC">           0 :     } catch (...) {</span></span>
<span id="L1315"><span class="lineNum">    1315</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         PrintExceptionContinue(nullptr, &quot;CommandLineRPC()&quot;);</span></span>
<span id="L1316"><span class="lineNum">    1316</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1317"><span class="lineNum">    1317</span>                 :             :     return ret;</span>
<span id="L1318"><span class="lineNum">    1318</span>                 :             : }</span>
        </pre>
              </td>
            </tr>
          </table>
          <br>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
            <tr><td class="versionInfo">Generated by: <a href="https://github.com//linux-test-project/lcov" target="_parent">LCOV version 2.0-1</a></td></tr>
          </table>
          <br>

</body>
</html>
