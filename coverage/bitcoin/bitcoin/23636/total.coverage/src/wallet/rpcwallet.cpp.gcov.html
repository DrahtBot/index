<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - total_coverage.info - src/wallet/rpcwallet.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">src/wallet</a> - rpcwallet.cpp<span style="font-size: 80%;"> (source / <a href="rpcwallet.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">total_coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">2465</td>
            <td class="headerCovTableEntry">2601</td>
            <td class="headerCovTableEntryHi">94.8 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2000-01-01 12:00:00</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">133</td>
            <td class="headerCovTableEntry">136</td>
            <td class="headerCovTableEntryHi">97.8 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">6305</td>
            <td class="headerCovTableEntry">12231</td>
            <td class="headerCovTableEntryLo">51.5 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : // Copyright (c) 2010 Satoshi Nakamoto</a>
<a name="2"><span class="lineNum">       2 </span>                :            : // Copyright (c) 2009-2020 The Bitcoin Core developers</a>
<a name="3"><span class="lineNum">       3 </span>                :            : // Distributed under the MIT software license, see the accompanying</a>
<a name="4"><span class="lineNum">       4 </span>                :            : // file COPYING or http://www.opensource.org/licenses/mit-license.php.</a>
<a name="5"><span class="lineNum">       5 </span>                :            : </a>
<a name="6"><span class="lineNum">       6 </span>                :            : #include &lt;consensus/amount.h&gt;</a>
<a name="7"><span class="lineNum">       7 </span>                :            : #include &lt;core_io.h&gt;</a>
<a name="8"><span class="lineNum">       8 </span>                :            : #include &lt;interfaces/chain.h&gt;</a>
<a name="9"><span class="lineNum">       9 </span>                :            : #include &lt;key_io.h&gt;</a>
<a name="10"><span class="lineNum">      10 </span>                :            : #include &lt;node/context.h&gt;</a>
<a name="11"><span class="lineNum">      11 </span>                :            : #include &lt;outputtype.h&gt;</a>
<a name="12"><span class="lineNum">      12 </span>                :            : #include &lt;policy/feerate.h&gt;</a>
<a name="13"><span class="lineNum">      13 </span>                :            : #include &lt;policy/fees.h&gt;</a>
<a name="14"><span class="lineNum">      14 </span>                :            : #include &lt;policy/policy.h&gt;</a>
<a name="15"><span class="lineNum">      15 </span>                :            : #include &lt;policy/rbf.h&gt;</a>
<a name="16"><span class="lineNum">      16 </span>                :            : #include &lt;rpc/rawtransaction_util.h&gt;</a>
<a name="17"><span class="lineNum">      17 </span>                :            : #include &lt;rpc/server.h&gt;</a>
<a name="18"><span class="lineNum">      18 </span>                :            : #include &lt;rpc/util.h&gt;</a>
<a name="19"><span class="lineNum">      19 </span>                :            : #include &lt;script/descriptor.h&gt;</a>
<a name="20"><span class="lineNum">      20 </span>                :            : #include &lt;script/sign.h&gt;</a>
<a name="21"><span class="lineNum">      21 </span>                :            : #include &lt;util/bip32.h&gt;</a>
<a name="22"><span class="lineNum">      22 </span>                :            : #include &lt;util/fees.h&gt;</a>
<a name="23"><span class="lineNum">      23 </span>                :            : #include &lt;util/moneystr.h&gt;</a>
<a name="24"><span class="lineNum">      24 </span>                :            : #include &lt;util/string.h&gt;</a>
<a name="25"><span class="lineNum">      25 </span>                :            : #include &lt;util/system.h&gt;</a>
<a name="26"><span class="lineNum">      26 </span>                :            : #include &lt;util/translation.h&gt;</a>
<a name="27"><span class="lineNum">      27 </span>                :            : #include &lt;util/url.h&gt;</a>
<a name="28"><span class="lineNum">      28 </span>                :            : #include &lt;util/vector.h&gt;</a>
<a name="29"><span class="lineNum">      29 </span>                :            : #include &lt;wallet/coincontrol.h&gt;</a>
<a name="30"><span class="lineNum">      30 </span>                :            : #include &lt;wallet/context.h&gt;</a>
<a name="31"><span class="lineNum">      31 </span>                :            : #include &lt;wallet/feebumper.h&gt;</a>
<a name="32"><span class="lineNum">      32 </span>                :            : #include &lt;wallet/load.h&gt;</a>
<a name="33"><span class="lineNum">      33 </span>                :            : #include &lt;wallet/receive.h&gt;</a>
<a name="34"><span class="lineNum">      34 </span>                :            : #include &lt;wallet/rpcwallet.h&gt;</a>
<a name="35"><span class="lineNum">      35 </span>                :            : #include &lt;wallet/spend.h&gt;</a>
<a name="36"><span class="lineNum">      36 </span>                :            : #include &lt;wallet/wallet.h&gt;</a>
<a name="37"><span class="lineNum">      37 </span>                :            : #include &lt;wallet/walletdb.h&gt;</a>
<a name="38"><span class="lineNum">      38 </span>                :            : #include &lt;wallet/walletutil.h&gt;</a>
<a name="39"><span class="lineNum">      39 </span>                :            : </a>
<a name="40"><span class="lineNum">      40 </span>                :            : #include &lt;optional&gt;</a>
<a name="41"><span class="lineNum">      41 </span>                :            : #include &lt;stdint.h&gt;</a>
<a name="42"><span class="lineNum">      42 </span>                :            : </a>
<a name="43"><span class="lineNum">      43 </span>                :            : #include &lt;univalue.h&gt;</a>
<a name="44"><span class="lineNum">      44 </span>                :            : </a>
<a name="45"><span class="lineNum">      45 </span>                :            : #include &lt;map&gt;</a>
<a name="46"><span class="lineNum">      46 </span>                :            : </a>
<a name="47"><span class="lineNum">      47 </span>                :            : using interfaces::FoundBlock;</a>
<a name="48"><span class="lineNum">      48 </span>                :            : </a>
<a name="49"><span class="lineNum">      49 </span>                :            : static const std::string WALLET_ENDPOINT_BASE = &quot;/wallet/&quot;;</a>
<a name="50"><span class="lineNum">      50 </span>                :            : const std::string HELP_REQUIRING_PASSPHRASE{&quot;\nRequires wallet passphrase to be set with walletpassphrase call if wallet is encrypted.\n&quot;};</a>
<a name="51"><span class="lineNum">      51 </span>                :            : </a>
<a name="52"><span class="lineNum">      52 </span>                :<span class="lineCov">       2568 : static inline bool GetAvoidReuseFlag(const CWallet&amp; wallet, const UniValue&amp; param) {</span></a>
<a name="53"><span class="lineNum">      53 </span>                :<span class="lineCov">       2568 :     bool can_avoid_reuse = wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);</span></a>
<a name="54"><span class="lineNum">      54 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchCov" title="Branch 1 was taken 2516 times"> + </span>]:<span class="lineCov">       2568 :     bool avoid_reuse = param.isNull() ? can_avoid_reuse : param.get_bool();</span></a>
<a name="55"><span class="lineNum">      55 </span>                :            : </a>
<a name="56"><span class="lineNum">      56 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2568 times"> + </span>]:<span class="lineCov">       2568 :     if (avoid_reuse &amp;&amp; !can_avoid_reuse) {</span></a>
<a name="57"><span class="lineNum">      57 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;wallet does not have the \&quot;avoid reuse\&quot; feature enabled&quot;);</span></a>
<a name="58"><span class="lineNum">      58 </span>                :            :     }</a>
<a name="59"><span class="lineNum">      59 </span>                :            : </a>
<a name="60"><span class="lineNum">      60 </span>                :<span class="lineCov">       2568 :     return avoid_reuse;</span></a>
<a name="61"><span class="lineNum">      61 </span>                :            : }</a>
<a name="62"><span class="lineNum">      62 </span>                :            : </a>
<a name="63"><span class="lineNum">      63 </span>                :            : </a>
<a name="64"><span class="lineNum">      64 </span>                :            : /** Used by RPC commands that have an include_watchonly parameter.</a>
<a name="65"><span class="lineNum">      65 </span>                :            :  *  We default to true for watchonly wallets if include_watchonly isn't</a>
<a name="66"><span class="lineNum">      66 </span>                :            :  *  explicitly set.</a>
<a name="67"><span class="lineNum">      67 </span>                :            :  */</a>
<a name="68"><span class="lineNum">      68 </span>                :<span class="lineCov">       2562 : static bool ParseIncludeWatchonly(const UniValue&amp; include_watchonly, const CWallet&amp; wallet)</span></a>
<a name="69"><span class="lineNum">      69 </span>                :            : {</a>
<a name="70"><span class="lineNum">      70 </span>        [<span class="branchCov" title="Branch 0 was taken 1841 times"> + </span><span class="branchCov" title="Branch 1 was taken 721 times"> + </span>]:<span class="lineCov">       2562 :     if (include_watchonly.isNull()) {</span></a>
<a name="71"><span class="lineNum">      71 </span>                :            :         // if include_watchonly isn't explicitly set, then check if we have a watchonly wallet</a>
<a name="72"><span class="lineNum">      72 </span>                :<span class="lineCov">       1841 :         return wallet.IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS);</span></a>
<a name="73"><span class="lineNum">      73 </span>                :            :     }</a>
<a name="74"><span class="lineNum">      74 </span>                :            : </a>
<a name="75"><span class="lineNum">      75 </span>                :            :     // otherwise return whatever include_watchonly was set to</a>
<a name="76"><span class="lineNum">      76 </span>                :<span class="lineCov">        721 :     return include_watchonly.get_bool();</span></a>
<a name="77"><span class="lineNum">      77 </span>                :            : }</a>
<a name="78"><span class="lineNum">      78 </span>                :            : </a>
<a name="79"><span class="lineNum">      79 </span>                :            : </a>
<a name="80"><span class="lineNum">      80 </span>                :            : /** Checks if a CKey is in the given CWallet compressed or otherwise*/</a>
<a name="81"><span class="lineNum">      81 </span>                :<span class="lineCov">          8 : bool HaveKey(const SigningProvider&amp; wallet, const CKey&amp; key)</span></a>
<a name="82"><span class="lineNum">      82 </span>                :            : {</a>
<a name="83"><span class="lineNum">      83 </span>                :<span class="lineCov">          8 :     CKey key2;</span></a>
<a name="84"><span class="lineNum">      84 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :     key2.Set(key.begin(), key.end(), !key.IsCompressed());</span></a>
<a name="85"><span class="lineNum">      85 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :     return wallet.HaveKey(key.GetPubKey().GetID()) || wallet.HaveKey(key2.GetPubKey().GetID());</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchCov" title="Branch 7 was taken 2 times"> + </span><span class="branchCov" title="Branch 8 was taken 6 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 14 was not taken"> - </span><span class="branchCov" title="Branch 15 was taken 6 times"> + </span>]
<a name="86"><span class="lineNum">      86 </span>                :            : }</a>
<a name="87"><span class="lineNum">      87 </span>                :            : </a>
<a name="88"><span class="lineNum">      88 </span>                :<span class="lineCov">      25684 : bool GetWalletNameFromJSONRPCRequest(const JSONRPCRequest&amp; request, std::string&amp; wallet_name)</span></a>
<a name="89"><span class="lineNum">      89 </span>                :            : {</a>
<a name="90"><span class="lineNum">      90 </span>  [<span class="branchCov" title="Branch 0 was taken 25681 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span><span class="branchCov" title="Branch 2 was taken 18189 times"> + </span><span class="branchCov" title="Branch 3 was taken 7492 times"> + </span> :<span class="lineCov">      51365 :     if (URL_DECODE &amp;&amp; request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 18189 times"> + </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span><span class="branchCov" title="Branch 6 was taken 7492 times"> + </span><span class="branchCov" title="Branch 7 was taken 18192 times"> + </span>]
<a name="91"><span class="lineNum">      91 </span>                :            :         // wallet endpoint was used</a>
<a name="92"><span class="lineNum">      92 </span>        [<span class="branchCov" title="Branch 0 was taken 7492 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7492 :         wallet_name = URL_DECODE(request.URI.substr(WALLET_ENDPOINT_BASE.size()));</span></a>
<a name="93"><span class="lineNum">      93 </span>                :<span class="lineCov">       7492 :         return true;</span></a>
<a name="94"><span class="lineNum">      94 </span>                :            :     }</a>
<a name="95"><span class="lineNum">      95 </span>                :            :     return false;</a>
<a name="96"><span class="lineNum">      96 </span>                :            : }</a>
<a name="97"><span class="lineNum">      97 </span>                :            : </a>
<a name="98"><span class="lineNum">      98 </span>                :<span class="lineCov">      25501 : std::shared_ptr&lt;CWallet&gt; GetWalletForJSONRPCRequest(const JSONRPCRequest&amp; request)</span></a>
<a name="99"><span class="lineNum">      99 </span>                :            : {</a>
<a name="100"><span class="lineNum">     100 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 25501 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      25501 :     CHECK_NONFATAL(request.mode == JSONRPCRequest::EXECUTE);</span></a>
<a name="101"><span class="lineNum">     101 </span>                :<span class="lineCov">      25501 :     WalletContext&amp; context = EnsureWalletContext(request.context);</span></a>
<a name="102"><span class="lineNum">     102 </span>                :            : </a>
<a name="103"><span class="lineNum">     103 </span>        [<span class="branchCov" title="Branch 0 was taken 25501 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      50970 :     std::string wallet_name;</span></a>
<a name="104"><span class="lineNum">     104 </span>  [<span class="branchCov" title="Branch 0 was taken 25501 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 7441 times"> + </span><span class="branchCov" title="Branch 3 was taken 18060 times"> + </span>]:<span class="lineCov">      25501 :     if (GetWalletNameFromJSONRPCRequest(request, wallet_name)) {</span></a>
<a name="105"><span class="lineNum">     105 </span>        [<span class="branchCov" title="Branch 0 was taken 7441 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      32921 :         const std::shared_ptr&lt;CWallet&gt; pwallet = GetWallet(context, wallet_name);</span></a>
<a name="106"><span class="lineNum">     106 </span>  [<span class="branchCov" title="Branch 0 was taken 11 times"> + </span><span class="branchCov" title="Branch 1 was taken 7430 times"> + </span><span class="branchCov" title="Branch 2 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7452 :         if (!pwallet) throw JSONRPCError(RPC_WALLET_NOT_FOUND, &quot;Requested wallet does not exist or is not loaded&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="107"><span class="lineNum">     107 </span>  [<span class="branchCov" title="Branch 0 was taken 7430 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 7430 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      14860 :         return pwallet;</span></a>
<a name="108"><span class="lineNum">     108 </span>                :            :     }</a>
<a name="109"><span class="lineNum">     109 </span>                :            : </a>
<a name="110"><span class="lineNum">     110 </span>        [<span class="branchCov" title="Branch 0 was taken 18060 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      18081 :     std::vector&lt;std::shared_ptr&lt;CWallet&gt;&gt; wallets = GetWallets(context);</span></a>
<a name="111"><span class="lineNum">     111 </span>        [<span class="branchCov" title="Branch 0 was taken 18039 times"> + </span><span class="branchCov" title="Branch 1 was taken 21 times"> + </span>]:<span class="lineCov">      18060 :     if (wallets.size() == 1) {</span></a>
<a name="112"><span class="lineNum">     112 </span>        [<span class="branchCov" title="Branch 0 was taken 18039 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      36078 :         return wallets[0];</span></a>
<a name="113"><span class="lineNum">     113 </span>                :            :     }</a>
<a name="114"><span class="lineNum">     114 </span>                :            : </a>
<a name="115"><span class="lineNum">     115 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchCov" title="Branch 1 was taken 14 times"> + </span>]:<span class="lineCov">         21 :     if (wallets.empty()) {</span></a>
<a name="116"><span class="lineNum">     116 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          7 :         throw JSONRPCError(</span></a>
<a name="117"><span class="lineNum">     117 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :             RPC_WALLET_NOT_FOUND, &quot;No wallet is loaded. Load a wallet using loadwallet or create a new one with createwallet. (Note: A default wallet is no longer automatically created)&quot;);</span></a>
<a name="118"><span class="lineNum">     118 </span>                :            :     }</a>
<a name="119"><span class="lineNum">     119 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :     throw JSONRPCError(RPC_WALLET_NOT_SPECIFIED,</span></a>
<a name="120"><span class="lineNum">     120 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         28 :         &quot;Wallet file not specified (must request wallet RPC through /wallet/&lt;filename&gt; uri-path).&quot;);</span></a>
<a name="121"><span class="lineNum">     121 </span>                :            : }</a>
<a name="122"><span class="lineNum">     122 </span>                :            : </a>
<a name="123"><span class="lineNum">     123 </span>                :<span class="lineCov">       6660 : void EnsureWalletIsUnlocked(const CWallet&amp; wallet)</span></a>
<a name="124"><span class="lineNum">     124 </span>                :            : {</a>
<a name="125"><span class="lineNum">     125 </span>        [<span class="branchCov" title="Branch 0 was taken 21 times"> + </span><span class="branchCov" title="Branch 1 was taken 6639 times"> + </span>]:<span class="lineCov">       6660 :     if (wallet.IsLocked()) {</span></a>
<a name="126"><span class="lineNum">     126 </span>  [<span class="branchCov" title="Branch 0 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 21 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         42 :         throw JSONRPCError(RPC_WALLET_UNLOCK_NEEDED, &quot;Error: Please enter the wallet passphrase with walletpassphrase first.&quot;);</span></a>
<a name="127"><span class="lineNum">     127 </span>                :            :     }</a>
<a name="128"><span class="lineNum">     128 </span>                :<span class="lineCov">       6639 : }</span></a>
<a name="129"><span class="lineNum">     129 </span>                :            : </a>
<a name="130"><span class="lineNum">     130 </span>                :<span class="lineCov">      26487 : WalletContext&amp; EnsureWalletContext(const std::any&amp; context)</span></a>
<a name="131"><span class="lineNum">     131 </span>                :            : {</a>
<a name="132"><span class="lineNum">     132 </span>                :<span class="lineCov">      26487 :     auto wallet_context = util::AnyPtr&lt;WalletContext&gt;(context);</span></a>
<a name="133"><span class="lineNum">     133 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 26487 times"> + </span>]:<span class="lineCov">      26487 :     if (!wallet_context) {</span></a>
<a name="134"><span class="lineNum">     134 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INTERNAL_ERROR, &quot;Wallet context not found&quot;);</span></a>
<a name="135"><span class="lineNum">     135 </span>                :            :     }</a>
<a name="136"><span class="lineNum">     136 </span>                :<span class="lineCov">      26487 :     return *wallet_context;</span></a>
<a name="137"><span class="lineNum">     137 </span>                :            : }</a>
<a name="138"><span class="lineNum">     138 </span>                :            : </a>
<a name="139"><span class="lineNum">     139 </span>                :            : // also_create should only be set to true only when the RPC is expected to add things to a blank wallet and make it no longer blank</a>
<a name="140"><span class="lineNum">     140 </span>                :<span class="lineCov">        656 : LegacyScriptPubKeyMan&amp; EnsureLegacyScriptPubKeyMan(CWallet&amp; wallet, bool also_create)</span></a>
<a name="141"><span class="lineNum">     141 </span>                :            : {</a>
<a name="142"><span class="lineNum">     142 </span>                :<span class="lineCov">        656 :     LegacyScriptPubKeyMan* spk_man = wallet.GetLegacyScriptPubKeyMan();</span></a>
<a name="143"><span class="lineNum">     143 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchCov" title="Branch 1 was taken 649 times"> + </span>]:<span class="lineCov">        656 :     if (!spk_man &amp;&amp; also_create) {</span></a>
<a name="144"><span class="lineNum">     144 </span>                :<span class="lineCov">          7 :         spk_man = wallet.GetOrCreateLegacyScriptPubKeyMan();</span></a>
<a name="145"><span class="lineNum">     145 </span>                :            :     }</a>
<a name="146"><span class="lineNum">     146 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchCov" title="Branch 1 was taken 649 times"> + </span>]:<span class="lineCov">        656 :     if (!spk_man) {</span></a>
<a name="147"><span class="lineNum">     147 </span>  [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         14 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;This type of wallet does not support this command&quot;);</span></a>
<a name="148"><span class="lineNum">     148 </span>                :            :     }</a>
<a name="149"><span class="lineNum">     149 </span>                :<span class="lineCov">        649 :     return *spk_man;</span></a>
<a name="150"><span class="lineNum">     150 </span>                :            : }</a>
<a name="151"><span class="lineNum">     151 </span>                :            : </a>
<a name="152"><span class="lineNum">     152 </span>                :<span class="lineCov">        233 : const LegacyScriptPubKeyMan&amp; EnsureConstLegacyScriptPubKeyMan(const CWallet&amp; wallet)</span></a>
<a name="153"><span class="lineNum">     153 </span>                :            : {</a>
<a name="154"><span class="lineNum">     154 </span>                :<span class="lineCov">        233 :     const LegacyScriptPubKeyMan* spk_man = wallet.GetLegacyScriptPubKeyMan();</span></a>
<a name="155"><span class="lineNum">     155 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 231 times"> + </span>]:<span class="lineCov">        233 :     if (!spk_man) {</span></a>
<a name="156"><span class="lineNum">     156 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;This type of wallet does not support this command&quot;);</span></a>
<a name="157"><span class="lineNum">     157 </span>                :            :     }</a>
<a name="158"><span class="lineNum">     158 </span>                :<span class="lineCov">        231 :     return *spk_man;</span></a>
<a name="159"><span class="lineNum">     159 </span>                :            : }</a>
<a name="160"><span class="lineNum">     160 </span>                :            : </a>
<a name="161"><span class="lineNum">     161 </span>                :<span class="lineCov">       3757 : static void WalletTxToJSON(const CWallet&amp; wallet, const CWalletTx&amp; wtx, UniValue&amp; entry)</span></a>
<a name="162"><span class="lineNum">     162 </span>                :            : {</a>
<a name="163"><span class="lineNum">     163 </span>                :<span class="lineCov">       3757 :     interfaces::Chain&amp; chain = wallet.chain();</span></a>
<a name="164"><span class="lineNum">     164 </span>                :<span class="lineCov">       3757 :     int confirms = wallet.GetTxDepthInMainChain(wtx);</span></a>
<a name="165"><span class="lineNum">     165 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2381 times"> + </span><span class="branchCov" title="Branch 3 was taken 1376 times"> + </span>]:<span class="lineCov">       7514 :     entry.pushKV(&quot;confirmations&quot;, confirms);</span></a>
<a name="166"><span class="lineNum">     166 </span>        [<span class="branchCov" title="Branch 0 was taken 2381 times"> + </span><span class="branchCov" title="Branch 1 was taken 1376 times"> + </span>]:<span class="lineCov">       3757 :     if (wtx.IsCoinBase())</span></a>
<a name="167"><span class="lineNum">     167 </span>  [<span class="branchCov" title="Branch 0 was taken 2381 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6138 :         entry.pushKV(&quot;generated&quot;, true);</span></a>
<a name="168"><span class="lineNum">     168 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6444 :     if (auto* conf = wtx.state&lt;TxStateConfirmed&gt;())</span></a>
<a name="169"><span class="lineNum">     169 </span>                :            :     {</a>
<a name="170"><span class="lineNum">     170 </span>  [<span class="branchCov" title="Branch 0 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       5374 :         entry.pushKV(&quot;blockhash&quot;, conf-&gt;confirmed_block_hash.GetHex());</span></a>
<a name="171"><span class="lineNum">     171 </span>        [<span class="branchCov" title="Branch 0 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       5374 :         entry.pushKV(&quot;blockheight&quot;, conf-&gt;confirmed_block_height);</span></a>
<a name="172"><span class="lineNum">     172 </span>        [<span class="branchCov" title="Branch 0 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       5374 :         entry.pushKV(&quot;blockindex&quot;, conf-&gt;position_in_block);</span></a>
<a name="173"><span class="lineNum">     173 </span>                :<span class="lineCov">       2687 :         int64_t block_time;</span></a>
<a name="174"><span class="lineNum">     174 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2687 :         CHECK_NONFATAL(chain.findBlock(conf-&gt;confirmed_block_hash, FoundBlock().time(block_time)));</span></a>
<a name="175"><span class="lineNum">     175 </span>        [<span class="branchCov" title="Branch 0 was taken 2687 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2687 :         entry.pushKV(&quot;blocktime&quot;, block_time);</span></a>
<a name="176"><span class="lineNum">     176 </span>                :            :     } else {</a>
<a name="177"><span class="lineNum">     177 </span>        [<span class="branchCov" title="Branch 0 was taken 1070 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4827 :         entry.pushKV(&quot;trusted&quot;, CachedTxIsTrusted(wallet, wtx));</span></a>
<a name="178"><span class="lineNum">     178 </span>                :            :     }</a>
<a name="179"><span class="lineNum">     179 </span>                :<span class="lineCov">       3757 :     uint256 hash = wtx.GetHash();</span></a>
<a name="180"><span class="lineNum">     180 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       7514 :     entry.pushKV(&quot;txid&quot;, hash.GetHex());</span></a>
<a name="181"><span class="lineNum">     181 </span>        [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3757 :     UniValue conflicts(UniValue::VARR);</span></a>
<a name="182"><span class="lineNum">     182 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 182 times"> + </span><span class="branchCov" title="Branch 3 was taken 3757 times"> + </span>]:<span class="lineCov">       3939 :     for (const uint256&amp; conflict : wallet.GetTxConflicts(wtx))</span></a>
<a name="183"><span class="lineNum">     183 </span>  [<span class="branchCov" title="Branch 0 was taken 182 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 182 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        364 :         conflicts.push_back(conflict.GetHex());</span></a>
<a name="184"><span class="lineNum">     184 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7514 :     entry.pushKV(&quot;walletconflicts&quot;, conflicts);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="185"><span class="lineNum">     185 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7514 :     entry.pushKV(&quot;time&quot;, wtx.GetTxTime());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="186"><span class="lineNum">     186 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7514 :     entry.pushKV(&quot;timereceived&quot;, (int64_t)wtx.nTimeReceived);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="187"><span class="lineNum">     187 </span>                :            : </a>
<a name="188"><span class="lineNum">     188 </span>                :            :     // Add opt-in RBF status</a>
<a name="189"><span class="lineNum">     189 </span>        [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7514 :     std::string rbfStatus = &quot;no&quot;;</span></a>
<a name="190"><span class="lineNum">     190 </span>        [<span class="branchCov" title="Branch 0 was taken 1070 times"> + </span><span class="branchCov" title="Branch 1 was taken 2687 times"> + </span>]:<span class="lineCov">       3757 :     if (confirms &lt;= 0) {</span></a>
<a name="191"><span class="lineNum">     191 </span>        [<span class="branchCov" title="Branch 0 was taken 1070 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1070 :         RBFTransactionState rbfState = chain.isRBFOptIn(*wtx.tx);</span></a>
<a name="192"><span class="lineNum">     192 </span>        [<span class="branchCov" title="Branch 0 was taken 467 times"> + </span><span class="branchCov" title="Branch 1 was taken 603 times"> + </span>]:<span class="lineCov">       1070 :         if (rbfState == RBFTransactionState::UNKNOWN)</span></a>
<a name="193"><span class="lineNum">     193 </span>        [<span class="branchCov" title="Branch 0 was taken 467 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        467 :             rbfStatus = &quot;unknown&quot;;</span></a>
<a name="194"><span class="lineNum">     194 </span>        [<span class="branchCov" title="Branch 0 was taken 140 times"> + </span><span class="branchCov" title="Branch 1 was taken 463 times"> + </span>]:<span class="lineCov">        603 :         else if (rbfState == RBFTransactionState::REPLACEABLE_BIP125)</span></a>
<a name="195"><span class="lineNum">     195 </span>        [<span class="branchCov" title="Branch 0 was taken 140 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        140 :             rbfStatus = &quot;yes&quot;;</span></a>
<a name="196"><span class="lineNum">     196 </span>                :            :     }</a>
<a name="197"><span class="lineNum">     197 </span>  [<span class="branchCov" title="Branch 0 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3757 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       7514 :     entry.pushKV(&quot;bip125-replaceable&quot;, rbfStatus);</span></a>
<a name="198"><span class="lineNum">     198 </span>                :            : </a>
<a name="199"><span class="lineNum">     199 </span>        [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchCov" title="Branch 1 was taken 3757 times"> + </span>]:<span class="lineCov">       3782 :     for (const std::pair&lt;const std::string, std::string&gt;&amp; item : wtx.mapValue)</span></a>
<a name="200"><span class="lineNum">     200 </span>        [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         25 :         entry.pushKV(item.first, item.second);</span></a>
<a name="201"><span class="lineNum">     201 </span>                :<span class="lineCov">       3757 : }</span></a>
<a name="202"><span class="lineNum">     202 </span>                :            : </a>
<a name="203"><span class="lineNum">     203 </span>                :<span class="lineCov">        427 : static std::string LabelFromValue(const UniValue&amp; value)</span></a>
<a name="204"><span class="lineNum">     204 </span>                :            : {</a>
<a name="205"><span class="lineNum">     205 </span>                :<span class="lineCov">        427 :     std::string label = value.get_str();</span></a>
<a name="206"><span class="lineNum">     206 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 427 times"> + </span>]:<span class="lineCov">        427 :     if (label == &quot;*&quot;)</span></a>
<a name="207"><span class="lineNum">     207 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_INVALID_LABEL_NAME, &quot;Invalid label name&quot;);</span></a>
<a name="208"><span class="lineNum">     208 </span>                :<span class="lineCov">        427 :     return label;</span></a>
<a name="209"><span class="lineNum">     209 </span>                :            : }</a>
<a name="210"><span class="lineNum">     210 </span>                :            : </a>
<a name="211"><span class="lineNum">     211 </span>                :            : /**</a>
<a name="212"><span class="lineNum">     212 </span>                :            :  * Update coin control with fee estimation based on the given parameters</a>
<a name="213"><span class="lineNum">     213 </span>                :            :  *</a>
<a name="214"><span class="lineNum">     214 </span>                :            :  * @param[in]     wallet            Wallet reference</a>
<a name="215"><span class="lineNum">     215 </span>                :            :  * @param[in,out] cc                Coin control to be updated</a>
<a name="216"><span class="lineNum">     216 </span>                :            :  * @param[in]     conf_target       UniValue integer; confirmation target in blocks, values between 1 and 1008 are valid per policy/fees.h;</a>
<a name="217"><span class="lineNum">     217 </span>                :            :  * @param[in]     estimate_mode     UniValue string; fee estimation mode, valid values are &quot;unset&quot;, &quot;economical&quot; or &quot;conservative&quot;;</a>
<a name="218"><span class="lineNum">     218 </span>                :            :  * @param[in]     fee_rate          UniValue real; fee rate in sat/vB;</a>
<a name="219"><span class="lineNum">     219 </span>                :            :  *                                      if present, both conf_target and estimate_mode must either be null, or &quot;unset&quot;</a>
<a name="220"><span class="lineNum">     220 </span>                :            :  * @param[in]     override_min_fee  bool; whether to set fOverrideFeeRate to true to disable minimum fee rate checks and instead</a>
<a name="221"><span class="lineNum">     221 </span>                :            :  *                                      verify only that fee_rate is greater than 0</a>
<a name="222"><span class="lineNum">     222 </span>                :            :  * @throws a JSONRPCError if conf_target, estimate_mode, or fee_rate contain invalid values or are in conflict</a>
<a name="223"><span class="lineNum">     223 </span>                :            :  */</a>
<a name="224"><span class="lineNum">     224 </span>                :<span class="lineCov">       2867 : static void SetFeeEstimateMode(const CWallet&amp; wallet, CCoinControl&amp; cc, const UniValue&amp; conf_target, const UniValue&amp; estimate_mode, const UniValue&amp; fee_rate, bool override_min_fee)</span></a>
<a name="225"><span class="lineNum">     225 </span>                :            : {</a>
<a name="226"><span class="lineNum">     226 </span>        [<span class="branchCov" title="Branch 0 was taken 384 times"> + </span><span class="branchCov" title="Branch 1 was taken 2483 times"> + </span>]:<span class="lineCov">       2867 :     if (!fee_rate.isNull()) {</span></a>
<a name="227"><span class="lineNum">     227 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 378 times"> + </span>]:<span class="lineCov">        384 :         if (!conf_target.isNull()) {</span></a>
<a name="228"><span class="lineNum">     228 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot specify both conf_target and fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.&quot;);</span></a>
<a name="229"><span class="lineNum">     229 </span>                :            :         }</a>
<a name="230"><span class="lineNum">     230 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 370 times"> + </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">        378 :         if (!estimate_mode.isNull() &amp;&amp; estimate_mode.get_str() != &quot;unset&quot;) {</span></a>
<a name="231"><span class="lineNum">     231 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot specify both estimate_mode and fee_rate&quot;);</span></a>
<a name="232"><span class="lineNum">     232 </span>                :            :         }</a>
<a name="233"><span class="lineNum">     233 </span>                :            :         // Fee rates in sat/vB cannot represent more than 3 significant digits.</a>
<a name="234"><span class="lineNum">     234 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 155 times"> + </span>]:<span class="lineCov">        372 :         cc.m_feerate = CFeeRate{AmountFromValue(fee_rate, /* decimals */ 3)};</span></a>
<a name="235"><span class="lineNum">     235 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchCov" title="Branch 1 was taken 103 times"> + </span>]:<span class="lineCov">        155 :         if (override_min_fee) cc.fOverrideFeeRate = true;</span></a>
<a name="236"><span class="lineNum">     236 </span>                :            :         // Default RBF to true for explicit fee_rate, if unset.</a>
<a name="237"><span class="lineNum">     237 </span>        [<span class="branchCov" title="Branch 0 was taken 119 times"> + </span><span class="branchCov" title="Branch 1 was taken 36 times"> + </span>]:<span class="lineCov">        155 :         if (!cc.m_signal_bip125_rbf) cc.m_signal_bip125_rbf = true;</span></a>
<a name="238"><span class="lineNum">     238 </span>                :<span class="lineCov">        155 :         return;</span></a>
<a name="239"><span class="lineNum">     239 </span>                :            :     }</a>
<a name="240"><span class="lineNum">     240 </span>  [<span class="branchCov" title="Branch 0 was taken 128 times"> + </span><span class="branchCov" title="Branch 1 was taken 2355 times"> + </span><span class="branchCov" title="Branch 2 was taken 70 times"> + </span><span class="branchCov" title="Branch 3 was taken 58 times"> + </span>]:<span class="lineCov">       2483 :     if (!estimate_mode.isNull() &amp;&amp; !FeeModeFromString(estimate_mode.get_str(), cc.m_fee_mode)) {</span></a>
<a name="241"><span class="lineNum">     241 </span>  [<span class="branchCov" title="Branch 0 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        116 :         throw JSONRPCError(RPC_INVALID_PARAMETER, InvalidEstimateModeErrorMessage());</span></a>
<a name="242"><span class="lineNum">     242 </span>                :            :     }</a>
<a name="243"><span class="lineNum">     243 </span>        [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchCov" title="Branch 1 was taken 2355 times"> + </span>]:<span class="lineCov">       2425 :     if (!conf_target.isNull()) {</span></a>
<a name="244"><span class="lineNum">     244 </span>                :<span class="lineCov">         70 :         cc.m_confirm_target = ParseConfirmTarget(conf_target, wallet.chain().estimateMaxBlocks());</span></a>
<a name="245"><span class="lineNum">     245 </span>                :            :     }</a>
<a name="246"><span class="lineNum">     246 </span>                :            : }</a>
<a name="247"><span class="lineNum">     247 </span>                :            : </a>
<a name="248"><span class="lineNum">     248 </span>                :<span class="lineCov">      14546 : static RPCHelpMan getnewaddress()</span></a>
<a name="249"><span class="lineNum">     249 </span>                :            : {</a>
<a name="250"><span class="lineNum">     250 </span>                :<span class="lineCov">      14546 :     return RPCHelpMan{&quot;getnewaddress&quot;,</span></a>
<a name="251"><span class="lineNum">     251 </span>                :            :                 &quot;\nReturns a new Bitcoin address for receiving payments.\n&quot;</a>
<a name="252"><span class="lineNum">     252 </span>                :            :                 &quot;If 'label' is specified, it is added to the address book \n&quot;</a>
<a name="253"><span class="lineNum">     253 </span>                :            :                 &quot;so payments received with the address will be associated with 'label'.\n&quot;,</a>
<a name="254"><span class="lineNum">     254 </span>                :            :                 {</a>
<a name="255"><span class="lineNum">     255 </span>        [<span class="branchCov" title="Branch 0 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      29092 :                     {&quot;label&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;&quot;}, &quot;The label name for the address to be linked to. It can also be set to the empty string \&quot;\&quot; to represent the default label. The label does not need to exist, it will be created if there is no label by the given name.&quot;},</span></a>
<a name="256"><span class="lineNum">     256 </span>        [<span class="branchCov" title="Branch 0 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      29092 :                     {&quot;address_type&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;set by -addresstype&quot;}, &quot;The address type to use. Options are \&quot;legacy\&quot;, \&quot;p2sh-segwit\&quot;, and \&quot;bech32\&quot;.&quot;},</span></a>
<a name="257"><span class="lineNum">     257 </span>                :            :                 },</a>
<a name="258"><span class="lineNum">     258 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="259"><span class="lineNum">     259 </span>                :            :                     RPCResult::Type::STR, &quot;address&quot;, &quot;The new bitcoin address&quot;</a>
<a name="260"><span class="lineNum">     260 </span>  [<span class="branchCov" title="Branch 0 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      29092 :                 },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="261"><span class="lineNum">     261 </span>                :<span class="lineCov">      14546 :                 RPCExamples{</span></a>
<a name="262"><span class="lineNum">     262 </span>  [<span class="branchCov" title="Branch 0 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      29092 :                     HelpExampleCli(&quot;getnewaddress&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="263"><span class="lineNum">     263 </span>  [<span class="branchCov" title="Branch 0 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      58184 :             + HelpExampleRpc(&quot;getnewaddress&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="264"><span class="lineNum">     264 </span>                :<span class="lineCov">      14546 :                 },</span></a>
<a name="265"><span class="lineNum">     265 </span>                :<span class="lineCov">      13072 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="266"><span class="lineNum">     266 </span>                :            : {</a>
<a name="267"><span class="lineNum">     267 </span>                :<span class="lineCov">      26096 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="268"><span class="lineNum">     268 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 13064 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      13064 :     if (!pwallet) return NullUniValue;</span></a>
<a name="269"><span class="lineNum">     269 </span>                :            : </a>
<a name="270"><span class="lineNum">     270 </span>  [<span class="branchCov" title="Branch 0 was taken 13064 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      26128 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="271"><span class="lineNum">     271 </span>                :            : </a>
<a name="272"><span class="lineNum">     272 </span>  [<span class="branchCov" title="Branch 0 was taken 13064 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30 times"> + </span><span class="branchCov" title="Branch 3 was taken 13034 times"> + </span>]:<span class="lineCov">      13064 :     if (!pwallet-&gt;CanGetAddresses()) {</span></a>
<a name="273"><span class="lineNum">     273 </span>  [<span class="branchCov" title="Branch 0 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         60 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error: This wallet has no available keys&quot;);</span></a>
<a name="274"><span class="lineNum">     274 </span>                :            :     }</a>
<a name="275"><span class="lineNum">     275 </span>                :            : </a>
<a name="276"><span class="lineNum">     276 </span>                :            :     // Parse the label first so we don't generate a key if there's an error</a>
<a name="277"><span class="lineNum">     277 </span>  [<span class="branchCov" title="Branch 0 was taken 13034 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      26068 :     std::string label;</span></a>
<a name="278"><span class="lineNum">     278 </span>  [<span class="branchCov" title="Branch 0 was taken 13034 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 264 times"> + </span><span class="branchCov" title="Branch 3 was taken 12770 times"> + </span>]:<span class="lineCov">      13034 :     if (!request.params[0].isNull())</span></a>
<a name="279"><span class="lineNum">     279 </span>  [<span class="branchCov" title="Branch 0 was taken 264 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 264 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        264 :         label = LabelFromValue(request.params[0]);</span></a>
<a name="280"><span class="lineNum">     280 </span>                :            : </a>
<a name="281"><span class="lineNum">     281 </span>        [<span class="branchCov" title="Branch 0 was taken 13034 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      13034 :     OutputType output_type = pwallet-&gt;m_default_address_type;</span></a>
<a name="282"><span class="lineNum">     282 </span>  [<span class="branchCov" title="Branch 0 was taken 13034 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2168 times"> + </span><span class="branchCov" title="Branch 3 was taken 10866 times"> + </span>]:<span class="lineCov">      13034 :     if (!request.params[1].isNull()) {</span></a>
<a name="283"><span class="lineNum">     283 </span>  [<span class="branchCov" title="Branch 0 was taken 2168 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2168 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2168 :         std::optional&lt;OutputType&gt; parsed = ParseOutputType(request.params[1].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2168 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="284"><span class="lineNum">     284 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2166 times"> + </span>]:<span class="lineCov">       2168 :         if (!parsed) {</span></a>
<a name="285"><span class="lineNum">     285 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;Unknown address type '%s'&quot;, request.params[1].get_str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="286"><span class="lineNum">     286 </span>  [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchCov" title="Branch 1 was taken 2056 times"> + </span><span class="branchCov" title="Branch 2 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2166 :         } else if (parsed.value() == OutputType::BECH32M &amp;&amp; pwallet-&gt;GetLegacyScriptPubKeyMan()) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchCov" title="Branch 5 was taken 109 times"> + </span>]
<a name="287"><span class="lineNum">     287 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Legacy wallets cannot provide bech32m addresses&quot;);</span></a>
<a name="288"><span class="lineNum">     288 </span>                :            :         }</a>
<a name="289"><span class="lineNum">     289 </span>                :<span class="lineCov">      13031 :         output_type = parsed.value();</span></a>
<a name="290"><span class="lineNum">     290 </span>                :            :     }</a>
<a name="291"><span class="lineNum">     291 </span>                :            : </a>
<a name="292"><span class="lineNum">     292 </span>                :<span class="lineCov">      13031 :     CTxDestination dest;</span></a>
<a name="293"><span class="lineNum">     293 </span>        [<span class="branchCov" title="Branch 0 was taken 13031 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      26062 :     bilingual_str error;</span></a>
<a name="294"><span class="lineNum">     294 </span>  [<span class="branchCov" title="Branch 0 was taken 13031 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13031 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      13031 :     if (!pwallet-&gt;GetNewDestination(output_type, label, dest, error)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchCov" title="Branch 5 was taken 13024 times"> + </span>]
<a name="295"><span class="lineNum">     295 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          7 :         throw JSONRPCError(RPC_WALLET_KEYPOOL_RAN_OUT, error.original);</span></a>
<a name="296"><span class="lineNum">     296 </span>                :            :     }</a>
<a name="297"><span class="lineNum">     297 </span>                :            : </a>
<a name="298"><span class="lineNum">     298 </span>  [<span class="branchCov" title="Branch 0 was taken 13024 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      26048 :     return EncodeDestination(dest);</span></a>
<a name="299"><span class="lineNum">     299 </span>                :            : },</a>
<a name="300"><span class="lineNum">     300 </span>  [<span class="branchCov" title="Branch 0 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">     174552 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 14546 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 14546 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 29092 times"> + </span><span class="branchCov" title="Branch 25 was taken 14546 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="301"><span class="lineNum">     301 </span>                :            : }</a>
<a name="302"><span class="lineNum">     302 </span>                :            : </a>
<a name="303"><span class="lineNum">     303 </span>                :<span class="lineCov">       1742 : static RPCHelpMan getrawchangeaddress()</span></a>
<a name="304"><span class="lineNum">     304 </span>                :            : {</a>
<a name="305"><span class="lineNum">     305 </span>                :<span class="lineCov">       1742 :     return RPCHelpMan{&quot;getrawchangeaddress&quot;,</span></a>
<a name="306"><span class="lineNum">     306 </span>                :            :                 &quot;\nReturns a new Bitcoin address, for receiving change.\n&quot;</a>
<a name="307"><span class="lineNum">     307 </span>                :            :                 &quot;This is for use with raw transactions, NOT normal use.\n&quot;,</a>
<a name="308"><span class="lineNum">     308 </span>                :            :                 {</a>
<a name="309"><span class="lineNum">     309 </span>        [<span class="branchCov" title="Branch 0 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3484 :                     {&quot;address_type&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;set by -changetype&quot;}, &quot;The address type to use. Options are \&quot;legacy\&quot;, \&quot;p2sh-segwit\&quot;, and \&quot;bech32\&quot;.&quot;},</span></a>
<a name="310"><span class="lineNum">     310 </span>                :            :                 },</a>
<a name="311"><span class="lineNum">     311 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="312"><span class="lineNum">     312 </span>                :            :                     RPCResult::Type::STR, &quot;address&quot;, &quot;The address&quot;</a>
<a name="313"><span class="lineNum">     313 </span>  [<span class="branchCov" title="Branch 0 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3484 :                 },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="314"><span class="lineNum">     314 </span>                :<span class="lineCov">       1742 :                 RPCExamples{</span></a>
<a name="315"><span class="lineNum">     315 </span>  [<span class="branchCov" title="Branch 0 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3484 :                     HelpExampleCli(&quot;getrawchangeaddress&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="316"><span class="lineNum">     316 </span>  [<span class="branchCov" title="Branch 0 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6968 :             + HelpExampleRpc(&quot;getrawchangeaddress&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="317"><span class="lineNum">     317 </span>                :<span class="lineCov">       1742 :                 },</span></a>
<a name="318"><span class="lineNum">     318 </span>                :<span class="lineCov">        270 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="319"><span class="lineNum">     319 </span>                :            : {</a>
<a name="320"><span class="lineNum">     320 </span>                :<span class="lineCov">        500 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="321"><span class="lineNum">     321 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 270 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        270 :     if (!pwallet) return NullUniValue;</span></a>
<a name="322"><span class="lineNum">     322 </span>                :            : </a>
<a name="323"><span class="lineNum">     323 </span>  [<span class="branchCov" title="Branch 0 was taken 270 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        540 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="324"><span class="lineNum">     324 </span>                :            : </a>
<a name="325"><span class="lineNum">     325 </span>  [<span class="branchCov" title="Branch 0 was taken 270 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 33 times"> + </span><span class="branchCov" title="Branch 3 was taken 237 times"> + </span>]:<span class="lineCov">        270 :     if (!pwallet-&gt;CanGetAddresses(true)) {</span></a>
<a name="326"><span class="lineNum">     326 </span>  [<span class="branchCov" title="Branch 0 was taken 33 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 33 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         66 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error: This wallet has no available keys&quot;);</span></a>
<a name="327"><span class="lineNum">     327 </span>                :            :     }</a>
<a name="328"><span class="lineNum">     328 </span>                :            : </a>
<a name="329"><span class="lineNum">     329 </span>        [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchCov" title="Branch 1 was taken 224 times"> + </span>]:<span class="lineCov">        237 :     OutputType output_type = pwallet-&gt;m_default_change_type.value_or(pwallet-&gt;m_default_address_type);</span></a>
<a name="330"><span class="lineNum">     330 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 118 times"> + </span><span class="branchCov" title="Branch 3 was taken 119 times"> + </span>]:<span class="lineCov">        237 :     if (!request.params[0].isNull()) {</span></a>
<a name="331"><span class="lineNum">     331 </span>  [<span class="branchCov" title="Branch 0 was taken 118 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 118 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        118 :         std::optional&lt;OutputType&gt; parsed = ParseOutputType(request.params[0].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 118 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="332"><span class="lineNum">     332 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 114 times"> + </span>]:<span class="lineCov">        118 :         if (!parsed) {</span></a>
<a name="333"><span class="lineNum">     333 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;Unknown address type '%s'&quot;, request.params[0].get_str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="334"><span class="lineNum">     334 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 112 times"> + </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        114 :         } else if (parsed.value() == OutputType::BECH32M &amp;&amp; pwallet-&gt;GetLegacyScriptPubKeyMan()) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchCov" title="Branch 5 was taken 1 time"> + </span>]
<a name="335"><span class="lineNum">     335 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Legacy wallets cannot provide bech32m addresses&quot;);</span></a>
<a name="336"><span class="lineNum">     336 </span>                :            :         }</a>
<a name="337"><span class="lineNum">     337 </span>                :<span class="lineCov">        232 :         output_type = parsed.value();</span></a>
<a name="338"><span class="lineNum">     338 </span>                :            :     }</a>
<a name="339"><span class="lineNum">     339 </span>                :            : </a>
<a name="340"><span class="lineNum">     340 </span>                :<span class="lineCov">        232 :     CTxDestination dest;</span></a>
<a name="341"><span class="lineNum">     341 </span>  [<span class="branchCov" title="Branch 0 was taken 232 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        464 :     bilingual_str error;</span></a>
<a name="342"><span class="lineNum">     342 </span>  [<span class="branchCov" title="Branch 0 was taken 232 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 230 times"> + </span>]:<span class="lineCov">        232 :     if (!pwallet-&gt;GetNewChangeDestination(output_type, dest, error)) {</span></a>
<a name="343"><span class="lineNum">     343 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          2 :         throw JSONRPCError(RPC_WALLET_KEYPOOL_RAN_OUT, error.original);</span></a>
<a name="344"><span class="lineNum">     344 </span>                :            :     }</a>
<a name="345"><span class="lineNum">     345 </span>  [<span class="branchCov" title="Branch 0 was taken 230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        460 :     return EncodeDestination(dest);</span></a>
<a name="346"><span class="lineNum">     346 </span>                :            : },</a>
<a name="347"><span class="lineNum">     347 </span>  [<span class="branchCov" title="Branch 0 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15678 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1742 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1742 times"> + </span><span class="branchCov" title="Branch 17 was taken 1742 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="348"><span class="lineNum">     348 </span>                :            : }</a>
<a name="349"><span class="lineNum">     349 </span>                :            : </a>
<a name="350"><span class="lineNum">     350 </span>                :            : </a>
<a name="351"><span class="lineNum">     351 </span>                :<span class="lineCov">       1501 : static RPCHelpMan setlabel()</span></a>
<a name="352"><span class="lineNum">     352 </span>                :            : {</a>
<a name="353"><span class="lineNum">     353 </span>                :<span class="lineCov">       1501 :     return RPCHelpMan{&quot;setlabel&quot;,</span></a>
<a name="354"><span class="lineNum">     354 </span>                :            :                 &quot;\nSets the label associated with the given address.\n&quot;,</a>
<a name="355"><span class="lineNum">     355 </span>                :            :                 {</a>
<a name="356"><span class="lineNum">     356 </span>                :<span class="lineCov">       1501 :                     {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The bitcoin address to be associated with a label.&quot;},</span></a>
<a name="357"><span class="lineNum">     357 </span>                :<span class="lineCov">       1501 :                     {&quot;label&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The label to assign to the address.&quot;},</span></a>
<a name="358"><span class="lineNum">     358 </span>                :            :                 },</a>
<a name="359"><span class="lineNum">     359 </span>  [<span class="branchCov" title="Branch 0 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3002 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="360"><span class="lineNum">     360 </span>                :<span class="lineCov">       1501 :                 RPCExamples{</span></a>
<a name="361"><span class="lineNum">     361 </span>  [<span class="branchCov" title="Branch 0 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3002 :                     HelpExampleCli(&quot;setlabel&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; \&quot;tabby\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="362"><span class="lineNum">     362 </span>  [<span class="branchCov" title="Branch 0 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6004 :             + HelpExampleRpc(&quot;setlabel&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;, \&quot;tabby\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1501 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="363"><span class="lineNum">     363 </span>                :<span class="lineCov">       1501 :                 },</span></a>
<a name="364"><span class="lineNum">     364 </span>                :<span class="lineCov">         29 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="365"><span class="lineNum">     365 </span>                :            : {</a>
<a name="366"><span class="lineNum">     366 </span>                :<span class="lineCov">         57 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="367"><span class="lineNum">     367 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         29 :     if (!pwallet) return NullUniValue;</span></a>
<a name="368"><span class="lineNum">     368 </span>                :            : </a>
<a name="369"><span class="lineNum">     369 </span>  [<span class="branchCov" title="Branch 0 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         58 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="370"><span class="lineNum">     370 </span>                :            : </a>
<a name="371"><span class="lineNum">     371 </span>  [<span class="branchCov" title="Branch 0 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         29 :     CTxDestination dest = DecodeDestination(request.params[0].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="372"><span class="lineNum">     372 </span>  [<span class="branchCov" title="Branch 0 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchCov" title="Branch 3 was taken 28 times"> + </span>]:<span class="lineCov">         29 :     if (!IsValidDestination(dest)) {</span></a>
<a name="373"><span class="lineNum">     373 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid Bitcoin address&quot;);</span></a>
<a name="374"><span class="lineNum">     374 </span>                :            :     }</a>
<a name="375"><span class="lineNum">     375 </span>                :            : </a>
<a name="376"><span class="lineNum">     376 </span>  [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         56 :     std::string label = LabelFromValue(request.params[1]);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="377"><span class="lineNum">     377 </span>                :            : </a>
<a name="378"><span class="lineNum">     378 </span>  [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         28 :     if (pwallet-&gt;IsMine(dest)) {</span></a>
<a name="379"><span class="lineNum">     379 </span>  [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         28 :         pwallet-&gt;SetAddressBook(dest, label, &quot;receive&quot;);</span></a>
<a name="380"><span class="lineNum">     380 </span>                :            :     } else {</a>
<a name="381"><span class="lineNum">     381 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         28 :         pwallet-&gt;SetAddressBook(dest, label, &quot;send&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="382"><span class="lineNum">     382 </span>                :            :     }</a>
<a name="383"><span class="lineNum">     383 </span>                :            : </a>
<a name="384"><span class="lineNum">     384 </span>        [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         28 :     return NullUniValue;</span></a>
<a name="385"><span class="lineNum">     385 </span>                :            : },</a>
<a name="386"><span class="lineNum">     386 </span>  [<span class="branchCov" title="Branch 0 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15010 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1501 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1501 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 3002 times"> + </span><span class="branchCov" title="Branch 25 was taken 1501 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="387"><span class="lineNum">     387 </span>                :            : }</a>
<a name="388"><span class="lineNum">     388 </span>                :            : </a>
<a name="389"><span class="lineNum">     389 </span>                :<span class="lineCov">       2123 : void ParseRecipients(const UniValue&amp; address_amounts, const UniValue&amp; subtract_fee_outputs, std::vector&lt;CRecipient&gt; &amp;recipients) {</span></a>
<a name="390"><span class="lineNum">     390 </span>        [<span class="branchCov" title="Branch 0 was taken 2123 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2123 :     std::set&lt;CTxDestination&gt; destinations;</span></a>
<a name="391"><span class="lineNum">     391 </span>                :<span class="lineCov">       2123 :     int i = 0;</span></a>
<a name="392"><span class="lineNum">     392 </span>  [<span class="branchCov" title="Branch 0 was taken 2123 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8549 times"> + </span><span class="branchCov" title="Branch 3 was taken 2119 times"> + </span>]:<span class="lineCov">      10668 :     for (const std::string&amp; address: address_amounts.getKeys()) {</span></a>
<a name="393"><span class="lineNum">     393 </span>        [<span class="branchCov" title="Branch 0 was taken 8549 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       8549 :         CTxDestination dest = DecodeDestination(address);</span></a>
<a name="394"><span class="lineNum">     394 </span>  [<span class="branchCov" title="Branch 0 was taken 8549 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 8549 times"> + </span>]:<span class="lineCov">       8549 :         if (!IsValidDestination(dest)) {</span></a>
<a name="395"><span class="lineNum">     395 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, std::string(&quot;Invalid Bitcoin address: &quot;) + address);</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="396"><span class="lineNum">     396 </span>                :            :         }</a>
<a name="397"><span class="lineNum">     397 </span>                :            : </a>
<a name="398"><span class="lineNum">     398 </span>  [<span class="branchCov" title="Branch 0 was taken 8549 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 8549 times"> + </span>]:<span class="lineCov">       8549 :         if (destinations.count(dest)) {</span></a>
<a name="399"><span class="lineNum">     399 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, std::string(&quot;Invalid parameter, duplicated address: &quot;) + address);</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="400"><span class="lineNum">     400 </span>                :            :         }</a>
<a name="401"><span class="lineNum">     401 </span>        [<span class="branchCov" title="Branch 0 was taken 8549 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       8549 :         destinations.insert(dest);</span></a>
<a name="402"><span class="lineNum">     402 </span>                :            : </a>
<a name="403"><span class="lineNum">     403 </span>        [<span class="branchCov" title="Branch 0 was taken 8549 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      17098 :         CScript script_pub_key = GetScriptForDestination(dest);</span></a>
<a name="404"><span class="lineNum">     404 </span>  [<span class="branchCov" title="Branch 0 was taken 8549 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8545 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span>]:<span class="lineCov">       8549 :         CAmount amount = AmountFromValue(address_amounts[i++]);</span></a>
<a name="405"><span class="lineNum">     405 </span>                :            : </a>
<a name="406"><span class="lineNum">     406 </span>                :            :         bool subtract_fee = false;</a>
<a name="407"><span class="lineNum">     407 </span>        [<span class="branchCov" title="Branch 0 was taken 145 times"> + </span><span class="branchCov" title="Branch 1 was taken 8545 times"> + </span>]:<span class="lineCov">       8690 :         for (unsigned int idx = 0; idx &lt; subtract_fee_outputs.size(); idx++) {</span></a>
<a name="408"><span class="lineNum">     408 </span>        [<span class="branchCov" title="Branch 0 was taken 145 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        145 :             const UniValue&amp; addr = subtract_fee_outputs[idx];</span></a>
<a name="409"><span class="lineNum">     409 </span>  [<span class="branchCov" title="Branch 0 was taken 145 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 145 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        145 :             if (addr.get_str() == address) {</span></a>
<a name="410"><span class="lineNum">     410 </span>                :<span class="lineCov">        145 :                 subtract_fee = true;</span></a>
<a name="411"><span class="lineNum">     411 </span>                :            :             }</a>
<a name="412"><span class="lineNum">     412 </span>                :            :         }</a>
<a name="413"><span class="lineNum">     413 </span>                :            : </a>
<a name="414"><span class="lineNum">     414 </span>                :<span class="lineCov">      17090 :         CRecipient recipient = {script_pub_key, amount, subtract_fee};</span></a>
<a name="415"><span class="lineNum">     415 </span>        [<span class="branchCov" title="Branch 0 was taken 8545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       8545 :         recipients.push_back(recipient);</span></a>
<a name="416"><span class="lineNum">     416 </span>                :            :     }</a>
<a name="417"><span class="lineNum">     417 </span>                :<span class="lineCov">       2119 : }</span></a>
<a name="418"><span class="lineNum">     418 </span>                :            : </a>
<a name="419"><span class="lineNum">     419 </span>                :<span class="lineCov">       2119 : UniValue SendMoney(CWallet&amp; wallet, const CCoinControl &amp;coin_control, std::vector&lt;CRecipient&gt; &amp;recipients, mapValue_t map_value, bool verbose)</span></a>
<a name="420"><span class="lineNum">     420 </span>                :            : {</a>
<a name="421"><span class="lineNum">     421 </span>                :<span class="lineCov">       2119 :     EnsureWalletIsUnlocked(wallet);</span></a>
<a name="422"><span class="lineNum">     422 </span>                :            : </a>
<a name="423"><span class="lineNum">     423 </span>                :            :     // This function is only used by sendtoaddress and sendmany.</a>
<a name="424"><span class="lineNum">     424 </span>                :            :     // This should always try to sign, if we don't have private keys, don't try to do anything here.</a>
<a name="425"><span class="lineNum">     425 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 2115 times"> + </span>]:<span class="lineCov">       2119 :     if (wallet.IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<a name="426"><span class="lineNum">     426 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error: Private keys are disabled for this wallet&quot;);</span></a>
<a name="427"><span class="lineNum">     427 </span>                :            :     }</a>
<a name="428"><span class="lineNum">     428 </span>                :            : </a>
<a name="429"><span class="lineNum">     429 </span>                :            :     // Shuffle recipient list</a>
<a name="430"><span class="lineNum">     430 </span>                :<span class="lineCov">       2115 :     std::shuffle(recipients.begin(), recipients.end(), FastRandomContext());</span></a>
<a name="431"><span class="lineNum">     431 </span>                :            : </a>
<a name="432"><span class="lineNum">     432 </span>                :            :     // Send</a>
<a name="433"><span class="lineNum">     433 </span>                :<span class="lineCov">       2115 :     CAmount nFeeRequired = 0;</span></a>
<a name="434"><span class="lineNum">     434 </span>                :<span class="lineCov">       2115 :     int nChangePosRet = -1;</span></a>
<a name="435"><span class="lineNum">     435 </span>        [<span class="branchCov" title="Branch 0 was taken 2115 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4190 :     bilingual_str error;</span></a>
<a name="436"><span class="lineNum">     436 </span>                :<span class="lineCov">       2115 :     CTransactionRef tx;</span></a>
<a name="437"><span class="lineNum">     437 </span>                :<span class="lineCov">       2115 :     FeeCalculation fee_calc_out;</span></a>
<a name="438"><span class="lineNum">     438 </span>        [<span class="branchCov" title="Branch 0 was taken 2115 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2115 :     const bool fCreated = CreateTransaction(wallet, recipients, tx, nFeeRequired, nChangePosRet, error, coin_control, fee_calc_out, true);</span></a>
<a name="439"><span class="lineNum">     439 </span>        [<span class="branchCov" title="Branch 0 was taken 40 times"> + </span><span class="branchCov" title="Branch 1 was taken 2075 times"> + </span>]:<span class="lineCov">       2115 :     if (!fCreated) {</span></a>
<a name="440"><span class="lineNum">     440 </span>        [<span class="branchCov" title="Branch 0 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         40 :         throw JSONRPCError(RPC_WALLET_INSUFFICIENT_FUNDS, error.original);</span></a>
<a name="441"><span class="lineNum">     441 </span>                :            :     }</a>
<a name="442"><span class="lineNum">     442 </span>  [<span class="branchCov" title="Branch 0 was taken 2075 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2075 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6225 :     wallet.CommitTransaction(tx, std::move(map_value), {} /* orderForm */);</span></a>
<a name="443"><span class="lineNum">     443 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 2071 times"> + </span>]:<span class="lineCov">       2075 :     if (verbose) {</span></a>
<a name="444"><span class="lineNum">     444 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :         UniValue entry(UniValue::VOBJ);</span></a>
<a name="445"><span class="lineNum">     445 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :         entry.pushKV(&quot;txid&quot;, tx-&gt;GetHash().GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="446"><span class="lineNum">     446 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :         entry.pushKV(&quot;fee_reason&quot;, StringForFeeReason(fee_calc_out.reason));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="447"><span class="lineNum">     447 </span>                :<span class="lineCov">          4 :         return entry;</span></a>
<a name="448"><span class="lineNum">     448 </span>                :            :     }</a>
<a name="449"><span class="lineNum">     449 </span>  [<span class="branchCov" title="Branch 0 was taken 2071 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2071 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4146 :     return tx-&gt;GetHash().GetHex();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2075 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="450"><span class="lineNum">     450 </span>                :            : }</a>
<a name="451"><span class="lineNum">     451 </span>                :            : </a>
<a name="452"><span class="lineNum">     452 </span>                :<span class="lineCov">       3525 : static RPCHelpMan sendtoaddress()</span></a>
<a name="453"><span class="lineNum">     453 </span>                :            : {</a>
<a name="454"><span class="lineNum">     454 </span>                :<span class="lineCov">       3525 :     return RPCHelpMan{&quot;sendtoaddress&quot;,</span></a>
<a name="455"><span class="lineNum">     455 </span>                :<span class="lineCov">       3525 :                 &quot;\nSend an amount to a given address.&quot; +</span></a>
<a name="456"><span class="lineNum">     456 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3525 :         HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="457"><span class="lineNum">     457 </span>                :            :                 {</a>
<a name="458"><span class="lineNum">     458 </span>                :<span class="lineCov">       3525 :                     {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The bitcoin address to send to.&quot;},</span></a>
<a name="459"><span class="lineNum">     459 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      10575 :                     {&quot;amount&quot;, RPCArg::Type::AMOUNT, RPCArg::Optional::NO, &quot;The amount in &quot; + CURRENCY_UNIT + &quot; to send. eg 0.1&quot;},</span></a>
<a name="460"><span class="lineNum">     460 </span>                :<span class="lineCov">       3525 :                     {&quot;comment&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;A comment used to store what the transaction is for.\n&quot;</span></a>
<a name="461"><span class="lineNum">     461 </span>                :            :                                          &quot;This is not part of the transaction, just kept in your wallet.&quot;},</a>
<a name="462"><span class="lineNum">     462 </span>                :<span class="lineCov">       3525 :                     {&quot;comment_to&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;A comment to store the name of the person or organization\n&quot;</span></a>
<a name="463"><span class="lineNum">     463 </span>                :            :                                          &quot;to which you're sending the transaction. This is not part of the \n&quot;</a>
<a name="464"><span class="lineNum">     464 </span>                :            :                                          &quot;transaction, just kept in your wallet.&quot;},</a>
<a name="465"><span class="lineNum">     465 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7050 :                     {&quot;subtractfeefromamount&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;The fee will be deducted from the amount being sent.\n&quot;</span></a>
<a name="466"><span class="lineNum">     466 </span>                :            :                                          &quot;The recipient will receive less bitcoins than you enter in the amount field.&quot;},</a>
<a name="467"><span class="lineNum">     467 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7050 :                     {&quot;replaceable&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;wallet default&quot;}, &quot;Allow this transaction to be replaced by a transaction with higher fees via BIP 125&quot;},</span></a>
<a name="468"><span class="lineNum">     468 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7050 :                     {&quot;conf_target&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;wallet -txconfirmtarget&quot;}, &quot;Confirmation target in blocks&quot;},</span></a>
<a name="469"><span class="lineNum">     469 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      10575 :                     {&quot;estimate_mode&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;unset&quot;}, std::string() + &quot;The fee estimate mode, must be one of (case insensitive):\n&quot;</span></a>
<a name="470"><span class="lineNum">     470 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10575 :             &quot;       \&quot;&quot; + FeeModes(&quot;\&quot;\n\&quot;&quot;) + &quot;\&quot;&quot;},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="471"><span class="lineNum">     471 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7050 :                     {&quot;avoid_reuse&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;(only available if avoid_reuse wallet flag is set) Avoid spending from dirty addresses; addresses are considered\n&quot;</span></a>
<a name="472"><span class="lineNum">     472 </span>                :            :                                          &quot;dirty if they have previously been used in a transaction. If true, this also activates avoidpartialspends, grouping outputs by their addresses.&quot;},</a>
<a name="473"><span class="lineNum">     473 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="474"><span class="lineNum">     474 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7050 :                     {&quot;verbose&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;If true, return extra information about the transaction.&quot;},</span></a>
<a name="475"><span class="lineNum">     475 </span>                :            :                 },</a>
<a name="476"><span class="lineNum">     476 </span>                :            :                 {</a>
<a name="477"><span class="lineNum">     477 </span>                :            :                     RPCResult{&quot;if verbose is not set or set to false&quot;,</a>
<a name="478"><span class="lineNum">     478 </span>                :            :                         RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id.&quot;</a>
<a name="479"><span class="lineNum">     479 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7050 :                     },</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="480"><span class="lineNum">     480 </span>                :            :                     RPCResult{&quot;if verbose is set to true&quot;,</a>
<a name="481"><span class="lineNum">     481 </span>                :            :                         RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="482"><span class="lineNum">     482 </span>                :            :                         {</a>
<a name="483"><span class="lineNum">     483 </span>                :            :                             {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id.&quot;},</a>
<a name="484"><span class="lineNum">     484 </span>                :            :                             {RPCResult::Type::STR, &quot;fee_reason&quot;, &quot;The transaction fee reason.&quot;}</a>
<a name="485"><span class="lineNum">     485 </span>                :            :                         },</a>
<a name="486"><span class="lineNum">     486 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 7050 times"> + </span><span class="branchCov" title="Branch 21 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="487"><span class="lineNum">     487 </span>                :            :                 },</a>
<a name="488"><span class="lineNum">     488 </span>                :<span class="lineCov">       3525 :                 RPCExamples{</span></a>
<a name="489"><span class="lineNum">     489 </span>                :            :                     &quot;\nSend 0.1 BTC\n&quot;</a>
<a name="490"><span class="lineNum">     490 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7050 :                     + HelpExampleCli(&quot;sendtoaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; 0.1&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="491"><span class="lineNum">     491 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3525 :                     &quot;\nSend 0.1 BTC with a confirmation target of 6 blocks in economical fee estimate mode using positional arguments\n&quot;</span></a>
<a name="492"><span class="lineNum">     492 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     + HelpExampleCli(&quot;sendtoaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; 0.1 \&quot;donation\&quot; \&quot;sean's outpost\&quot; false true 6 economical&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="493"><span class="lineNum">     493 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7050 :                     &quot;\nSend 0.1 BTC with a fee rate of 1.1 &quot; + CURRENCY_ATOM + &quot;/vB, subtract fee from amount, BIP125-replaceable, using positional arguments\n&quot;</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="494"><span class="lineNum">     494 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     + HelpExampleCli(&quot;sendtoaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; 0.1 \&quot;drinks\&quot; \&quot;room77\&quot; true true null \&quot;unset\&quot; null 1.1&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="495"><span class="lineNum">     495 </span>        [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3525 :                     &quot;\nSend 0.2 BTC with a confirmation target of 6 blocks in economical fee estimate mode using named arguments\n&quot;</span></a>
<a name="496"><span class="lineNum">     496 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     + HelpExampleCli(&quot;-named sendtoaddress&quot;, &quot;address=\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; amount=0.2 conf_target=6 estimate_mode=\&quot;economical\&quot;&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="497"><span class="lineNum">     497 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7050 :                     &quot;\nSend 0.5 BTC with a fee rate of 25 &quot; + CURRENCY_ATOM + &quot;/vB using named arguments\n&quot;</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="498"><span class="lineNum">     498 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     + HelpExampleCli(&quot;-named sendtoaddress&quot;, &quot;address=\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; amount=0.5 fee_rate=25&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="499"><span class="lineNum">     499 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14100 :                     + HelpExampleCli(&quot;-named sendtoaddress&quot;, &quot;address=\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; amount=0.5 fee_rate=25 subtractfeefromamount=false replaceable=true avoid_reuse=true comment=\&quot;2 pizzas\&quot; comment_to=\&quot;jeremy\&quot; verbose=true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="500"><span class="lineNum">     500 </span>                :<span class="lineCov">       3525 :                 },</span></a>
<a name="501"><span class="lineNum">     501 </span>                :<span class="lineCov">       2053 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="502"><span class="lineNum">     502 </span>                :            : {</a>
<a name="503"><span class="lineNum">     503 </span>                :<span class="lineCov">       4055 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="504"><span class="lineNum">     504 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2053 :     if (!pwallet) return NullUniValue;</span></a>
<a name="505"><span class="lineNum">     505 </span>                :            : </a>
<a name="506"><span class="lineNum">     506 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="507"><span class="lineNum">     507 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="508"><span class="lineNum">     508 </span>        [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2053 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="509"><span class="lineNum">     509 </span>                :            : </a>
<a name="510"><span class="lineNum">     510 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2002 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4106 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="511"><span class="lineNum">     511 </span>                :            : </a>
<a name="512"><span class="lineNum">     512 </span>                :            :     // Wallet comments</a>
<a name="513"><span class="lineNum">     513 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2002 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4106 :     mapValue_t mapValue;</span></a>
<a name="514"><span class="lineNum">     514 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 15 times"> + </span><span class="branchCov" title="Branch 3 was taken 2038 times"> + </span> :<span class="lineCov">       2053 :     if (!request.params[2].isNull() &amp;&amp; !request.params[2].get_str().empty())</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 13 times"> + </span>]
<a name="515"><span class="lineNum">     515 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2057 :         mapValue[&quot;comment&quot;] = request.params[2].get_str();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="516"><span class="lineNum">     516 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 15 times"> + </span><span class="branchCov" title="Branch 3 was taken 2038 times"> + </span> :<span class="lineCov">       2053 :     if (!request.params[3].isNull() &amp;&amp; !request.params[3].get_str().empty())</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 15 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 13 times"> + </span>]
<a name="517"><span class="lineNum">     517 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2057 :         mapValue[&quot;to&quot;] = request.params[3].get_str();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="518"><span class="lineNum">     518 </span>                :            : </a>
<a name="519"><span class="lineNum">     519 </span>                :<span class="lineCov">       2053 :     bool fSubtractFeeFromAmount = false;</span></a>
<a name="520"><span class="lineNum">     520 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 143 times"> + </span><span class="branchCov" title="Branch 3 was taken 1910 times"> + </span>]:<span class="lineCov">       2053 :     if (!request.params[4].isNull()) {</span></a>
<a name="521"><span class="lineNum">     521 </span>  [<span class="branchCov" title="Branch 0 was taken 143 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 143 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        143 :         fSubtractFeeFromAmount = request.params[4].get_bool();</span></a>
<a name="522"><span class="lineNum">     522 </span>                :            :     }</a>
<a name="523"><span class="lineNum">     523 </span>                :            : </a>
<a name="524"><span class="lineNum">     524 </span>        [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4106 :     CCoinControl coin_control;</span></a>
<a name="525"><span class="lineNum">     525 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchCov" title="Branch 3 was taken 2037 times"> + </span>]:<span class="lineCov">       2053 :     if (!request.params[5].isNull()) {</span></a>
<a name="526"><span class="lineNum">     526 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :         coin_control.m_signal_bip125_rbf = request.params[5].get_bool();</span></a>
<a name="527"><span class="lineNum">     527 </span>                :            :     }</a>
<a name="528"><span class="lineNum">     528 </span>                :            : </a>
<a name="529"><span class="lineNum">     529 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2053 :     coin_control.m_avoid_address_reuse = GetAvoidReuseFlag(*pwallet, request.params[8]);</span></a>
<a name="530"><span class="lineNum">     530 </span>                :            :     // We also enable partial spend avoidance if reuse avoidance is set.</a>
<a name="531"><span class="lineNum">     531 </span>                :<span class="lineCov">       2053 :     coin_control.m_avoid_partial_spends |= coin_control.m_avoid_address_reuse;</span></a>
<a name="532"><span class="lineNum">     532 </span>                :            : </a>
<a name="533"><span class="lineNum">     533 </span>  [<span class="branchCov" title="Branch 0 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2053 :     SetFeeEstimateMode(*pwallet, coin_control, /* conf_target */ request.params[6], /* estimate_mode */ request.params[7], /* fee_rate */ request.params[9], /* override_min_fee */ false);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2053 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2026 times"> + </span><span class="branchCov" title="Branch 7 was taken 27 times"> + </span>]
<a name="534"><span class="lineNum">     534 </span>                :            : </a>
<a name="535"><span class="lineNum">     535 </span>        [<span class="branchCov" title="Branch 0 was taken 2024 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">       2026 :     EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="536"><span class="lineNum">     536 </span>                :            : </a>
<a name="537"><span class="lineNum">     537 </span>  [<span class="branchCov" title="Branch 0 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2046 :     UniValue address_amounts(UniValue::VOBJ);</span></a>
<a name="538"><span class="lineNum">     538 </span>  [<span class="branchCov" title="Branch 0 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4048 :     const std::string address = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="539"><span class="lineNum">     539 </span>  [<span class="branchCov" title="Branch 0 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2024 :     address_amounts.pushKV(address, request.params[1]);</span></a>
<a name="540"><span class="lineNum">     540 </span>  [<span class="branchCov" title="Branch 0 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2024 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4048 :     UniValue subtractFeeFromAmount(UniValue::VARR);</span></a>
<a name="541"><span class="lineNum">     541 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchCov" title="Branch 1 was taken 1883 times"> + </span>]:<span class="lineCov">       2024 :     if (fSubtractFeeFromAmount) {</span></a>
<a name="542"><span class="lineNum">     542 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        141 :         subtractFeeFromAmount.push_back(address);</span></a>
<a name="543"><span class="lineNum">     543 </span>                :            :     }</a>
<a name="544"><span class="lineNum">     544 </span>                :            : </a>
<a name="545"><span class="lineNum">     545 </span>        [<span class="branchCov" title="Branch 0 was taken 2020 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">       2042 :     std::vector&lt;CRecipient&gt; recipients;</span></a>
<a name="546"><span class="lineNum">     546 </span>        [<span class="branchCov" title="Branch 0 was taken 2020 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">       2024 :     ParseRecipients(address_amounts, subtractFeeFromAmount, recipients);</span></a>
<a name="547"><span class="lineNum">     547 </span>  [<span class="branchCov" title="Branch 0 was taken 2020 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 2016 times"> + </span> :<span class="lineCov">       2020 :     const bool verbose{request.params[10].isNull() ? false : request.params[10].get_bool()};</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="548"><span class="lineNum">     548 </span>                :            : </a>
<a name="549"><span class="lineNum">     549 </span>  [<span class="branchCov" title="Branch 0 was taken 2020 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2002 times"> + </span><span class="branchCov" title="Branch 3 was taken 18 times"> + </span>]:<span class="lineCov">       4040 :     return SendMoney(*pwallet, coin_control, recipients, mapValue, verbose);</span></a>
<a name="550"><span class="lineNum">     550 </span>                :            : },</a>
<a name="551"><span class="lineNum">     551 </span>  [<span class="branchCov" title="Branch 0 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">     165675 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 3525 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 7050 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 99 was taken 3525 times"> + </span><span class="branchCov" title="Branch 100 was taken 38775 times"> + </span><span class="branchCov" title="Branch 101 was taken 3525 times"> + </span><span class="branchNoCov" title="Branch 102 was not taken"> - </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 104 was not taken"> - </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span>]
<a name="552"><span class="lineNum">     552 </span>                :            : }</a>
<a name="553"><span class="lineNum">     553 </span>                :            : </a>
<a name="554"><span class="lineNum">     554 </span>                :<span class="lineCov">       1476 : static RPCHelpMan listaddressgroupings()</span></a>
<a name="555"><span class="lineNum">     555 </span>                :            : {</a>
<a name="556"><span class="lineNum">     556 </span>                :<span class="lineCov">       1476 :     return RPCHelpMan{&quot;listaddressgroupings&quot;,</span></a>
<a name="557"><span class="lineNum">     557 </span>                :            :                 &quot;\nLists groups of addresses which have had their common ownership\n&quot;</a>
<a name="558"><span class="lineNum">     558 </span>                :            :                 &quot;made public by common use as inputs or as the resulting change\n&quot;</a>
<a name="559"><span class="lineNum">     559 </span>                :            :                 &quot;in past transactions\n&quot;,</a>
<a name="560"><span class="lineNum">     560 </span>                :            :                 {},</a>
<a name="561"><span class="lineNum">     561 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="562"><span class="lineNum">     562 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="563"><span class="lineNum">     563 </span>                :            :                     {</a>
<a name="564"><span class="lineNum">     564 </span>                :            :                         {RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="565"><span class="lineNum">     565 </span>                :            :                         {</a>
<a name="566"><span class="lineNum">     566 </span>                :            :                             {RPCResult::Type::ARR_FIXED, &quot;&quot;, &quot;&quot;,</a>
<a name="567"><span class="lineNum">     567 </span>                :            :                             {</a>
<a name="568"><span class="lineNum">     568 </span>                :            :                                 {RPCResult::Type::STR, &quot;address&quot;, &quot;The bitcoin address&quot;},</a>
<a name="569"><span class="lineNum">     569 </span>        [<span class="branchCov" title="Branch 0 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2952 :                                 {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT},</span></a>
<a name="570"><span class="lineNum">     570 </span>                :            :                                 {RPCResult::Type::STR, &quot;label&quot;, /* optional */ true, &quot;The label&quot;},</a>
<a name="571"><span class="lineNum">     571 </span>                :            :                             }},</a>
<a name="572"><span class="lineNum">     572 </span>                :            :                         }},</a>
<a name="573"><span class="lineNum">     573 </span>                :            :                     }</a>
<a name="574"><span class="lineNum">     574 </span>  [<span class="branchCov" title="Branch 0 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      13284 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1476 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1476 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1476 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1476 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1476 times"> + </span><span class="branchCov" title="Branch 41 was taken 1476 times"> + </span><span class="branchCov" title="Branch 42 was taken 1476 times"> + </span><span class="branchCov" title="Branch 43 was taken 1476 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 4428 times"> + </span><span class="branchCov" title="Branch 45 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchNoCov" title="Branch 48 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span>]
<a name="575"><span class="lineNum">     575 </span>                :<span class="lineCov">       1476 :                 RPCExamples{</span></a>
<a name="576"><span class="lineNum">     576 </span>  [<span class="branchCov" title="Branch 0 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2952 :                     HelpExampleCli(&quot;listaddressgroupings&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="577"><span class="lineNum">     577 </span>  [<span class="branchCov" title="Branch 0 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5904 :             + HelpExampleRpc(&quot;listaddressgroupings&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="578"><span class="lineNum">     578 </span>                :<span class="lineCov">       1476 :                 },</span></a>
<a name="579"><span class="lineNum">     579 </span>                :<span class="lineCov">          4 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="580"><span class="lineNum">     580 </span>                :            : {</a>
<a name="581"><span class="lineNum">     581 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">          8 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="582"><span class="lineNum">     582 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :     if (!pwallet) return NullUniValue;</span></a>
<a name="583"><span class="lineNum">     583 </span>                :            : </a>
<a name="584"><span class="lineNum">     584 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="585"><span class="lineNum">     585 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="586"><span class="lineNum">     586 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="587"><span class="lineNum">     587 </span>                :            : </a>
<a name="588"><span class="lineNum">     588 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="589"><span class="lineNum">     589 </span>                :            : </a>
<a name="590"><span class="lineNum">     590 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :     UniValue jsonGroupings(UniValue::VARR);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="591"><span class="lineNum">     591 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :     std::map&lt;CTxDestination, CAmount&gt; balances = GetAddressBalances(*pwallet);</span></a>
<a name="592"><span class="lineNum">     592 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span>]:<span class="lineCov">         10 :     for (const std::set&lt;CTxDestination&gt;&amp; grouping : GetAddressGroupings(*pwallet)) {</span></a>
<a name="593"><span class="lineNum">     593 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         UniValue jsonGrouping(UniValue::VARR);</span></a>
<a name="594"><span class="lineNum">     594 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">         14 :         for (const CTxDestination&amp; address : grouping)</span></a>
<a name="595"><span class="lineNum">     595 </span>                :            :         {</a>
<a name="596"><span class="lineNum">     596 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :             UniValue addressInfo(UniValue::VARR);</span></a>
<a name="597"><span class="lineNum">     597 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :             addressInfo.push_back(EncodeDestination(address));</span></a>
<a name="598"><span class="lineNum">     598 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :             addressInfo.push_back(ValueFromAmount(balances[address]));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="599"><span class="lineNum">     599 </span>                :<span class="lineCov">          8 :             {</span></a>
<a name="600"><span class="lineNum">     600 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :                 const auto* address_book_entry = pwallet-&gt;FindAddressBookEntry(address);</span></a>
<a name="601"><span class="lineNum">     601 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :                 if (address_book_entry) {</span></a>
<a name="602"><span class="lineNum">     602 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :                     addressInfo.push_back(address_book_entry-&gt;GetLabel());</span></a>
<a name="603"><span class="lineNum">     603 </span>                :            :                 }</a>
<a name="604"><span class="lineNum">     604 </span>                :            :             }</a>
<a name="605"><span class="lineNum">     605 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :             jsonGrouping.push_back(addressInfo);</span></a>
<a name="606"><span class="lineNum">     606 </span>                :            :         }</a>
<a name="607"><span class="lineNum">     607 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :         jsonGroupings.push_back(jsonGrouping);</span></a>
<a name="608"><span class="lineNum">     608 </span>                :            :     }</a>
<a name="609"><span class="lineNum">     609 </span>                :<span class="lineCov">          4 :     return jsonGroupings;</span></a>
<a name="610"><span class="lineNum">     610 </span>                :            : },</a>
<a name="611"><span class="lineNum">     611 </span>  [<span class="branchCov" title="Branch 0 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8856 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1476 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="612"><span class="lineNum">     612 </span>                :            : }</a>
<a name="613"><span class="lineNum">     613 </span>                :            : </a>
<a name="614"><span class="lineNum">     614 </span>                :<span class="lineCov">         49 : static CAmount GetReceived(const CWallet&amp; wallet, const UniValue&amp; params, bool by_label) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)</span></a>
<a name="615"><span class="lineNum">     615 </span>                :            : {</a>
<a name="616"><span class="lineNum">     616 </span>        [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         49 :     std::set&lt;CTxDestination&gt; address_set;</span></a>
<a name="617"><span class="lineNum">     617 </span>                :            : </a>
<a name="618"><span class="lineNum">     618 </span>        [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         49 :     if (by_label) {</span></a>
<a name="619"><span class="lineNum">     619 </span>                :            :         // Get the set of addresses assigned to label</a>
<a name="620"><span class="lineNum">     620 </span>  [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         31 :         std::string label = LabelFromValue(params[0]);</span></a>
<a name="621"><span class="lineNum">     621 </span>        [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         62 :         address_set = wallet.GetLabelAddresses(label);</span></a>
<a name="622"><span class="lineNum">     622 </span>                :            :     } else {</a>
<a name="623"><span class="lineNum">     623 </span>                :            :         // Get the address</a>
<a name="624"><span class="lineNum">     624 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         18 :         CTxDestination dest = DecodeDestination(params[0].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="625"><span class="lineNum">     625 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 18 times"> + </span>]:<span class="lineCov">         18 :         if (!IsValidDestination(dest)) {</span></a>
<a name="626"><span class="lineNum">     626 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid Bitcoin address&quot;);</span></a>
<a name="627"><span class="lineNum">     627 </span>                :            :         }</a>
<a name="628"><span class="lineNum">     628 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         20 :         CScript script_pub_key = GetScriptForDestination(dest);</span></a>
<a name="629"><span class="lineNum">     629 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 16 times"> + </span>]:<span class="lineCov">         18 :         if (!wallet.IsMine(script_pub_key)) {</span></a>
<a name="630"><span class="lineNum">     630 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Address not found in wallet&quot;);</span></a>
<a name="631"><span class="lineNum">     631 </span>                :            :         }</a>
<a name="632"><span class="lineNum">     632 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :         address_set.insert(dest);</span></a>
<a name="633"><span class="lineNum">     633 </span>                :            :     }</a>
<a name="634"><span class="lineNum">     634 </span>                :            : </a>
<a name="635"><span class="lineNum">     635 </span>                :            :     // Minimum confirmations</a>
<a name="636"><span class="lineNum">     636 </span>                :<span class="lineCov">         47 :     int min_depth = 1;</span></a>
<a name="637"><span class="lineNum">     637 </span>  [<span class="branchCov" title="Branch 0 was taken 47 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 45 times"> + </span>]:<span class="lineCov">         47 :     if (!params[1].isNull())</span></a>
<a name="638"><span class="lineNum">     638 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :         min_depth = params[1].get_int();</span></a>
<a name="639"><span class="lineNum">     639 </span>                :            : </a>
<a name="640"><span class="lineNum">     640 </span>                :            :     // Tally</a>
<a name="641"><span class="lineNum">     641 </span>                :<span class="lineCov">         47 :     CAmount amount = 0;</span></a>
<a name="642"><span class="lineNum">     642 </span>        [<span class="branchCov" title="Branch 0 was taken 4394 times"> + </span><span class="branchCov" title="Branch 1 was taken 47 times"> + </span>]:<span class="lineCov">       4441 :     for (const std::pair&lt;const uint256, CWalletTx&gt;&amp; wtx_pair : wallet.mapWallet) {</span></a>
<a name="643"><span class="lineNum">     643 </span>                :<span class="lineCov">       4394 :         const CWalletTx&amp; wtx = wtx_pair.second;</span></a>
<a name="644"><span class="lineNum">     644 </span>  [<span class="branchCov" title="Branch 0 was taken 278 times"> + </span><span class="branchCov" title="Branch 1 was taken 4116 times"> + </span><span class="branchCov" title="Branch 2 was taken 278 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4394 :         if (wtx.IsCoinBase() || !wallet.chain().checkFinalTx(*wtx.tx) || wallet.GetTxDepthInMainChain(wtx) &lt; min_depth) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 278 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 278 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 4 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 274 times"> + </span>]
<a name="645"><span class="lineNum">     645 </span>                :<span class="lineCov">       4120 :             continue;</span></a>
<a name="646"><span class="lineNum">     646 </span>                :            :         }</a>
<a name="647"><span class="lineNum">     647 </span>                :            : </a>
<a name="648"><span class="lineNum">     648 </span>        [<span class="branchCov" title="Branch 0 was taken 518 times"> + </span><span class="branchCov" title="Branch 1 was taken 274 times"> + </span>]:<span class="lineCov">        792 :         for (const CTxOut&amp; txout : wtx.tx-&gt;vout) {</span></a>
<a name="649"><span class="lineNum">     649 </span>                :<span class="lineCov">        518 :             CTxDestination address;</span></a>
<a name="650"><span class="lineNum">     650 </span>  [<span class="branchCov" title="Branch 0 was taken 518 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 518 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        518 :             if (ExtractDestination(txout.scriptPubKey, address) &amp;&amp; wallet.IsMine(address) &amp;&amp; address_set.count(address)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 518 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 444 times"> + </span><span class="branchCov" title="Branch 7 was taken 74 times"> + </span><span class="branchCov" title="Branch 8 was taken 444 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 64 times"> + </span><span class="branchCov" title="Branch 11 was taken 380 times"> + </span>]
<a name="651"><span class="lineNum">     651 </span>                :<span class="lineCov">         64 :                 amount += txout.nValue;</span></a>
<a name="652"><span class="lineNum">     652 </span>                :            :             }</a>
<a name="653"><span class="lineNum">     653 </span>                :            :         }</a>
<a name="654"><span class="lineNum">     654 </span>                :            :     }</a>
<a name="655"><span class="lineNum">     655 </span>                :            : </a>
<a name="656"><span class="lineNum">     656 </span>                :<span class="lineCov">         47 :     return amount;</span></a>
<a name="657"><span class="lineNum">     657 </span>                :            : }</a>
<a name="658"><span class="lineNum">     658 </span>                :            : </a>
<a name="659"><span class="lineNum">     659 </span>                :            : </a>
<a name="660"><span class="lineNum">     660 </span>                :<span class="lineCov">       1490 : static RPCHelpMan getreceivedbyaddress()</span></a>
<a name="661"><span class="lineNum">     661 </span>                :            : {</a>
<a name="662"><span class="lineNum">     662 </span>                :<span class="lineCov">       1490 :     return RPCHelpMan{&quot;getreceivedbyaddress&quot;,</span></a>
<a name="663"><span class="lineNum">     663 </span>                :            :                 &quot;\nReturns the total amount received by the given address in transactions with at least minconf confirmations.\n&quot;,</a>
<a name="664"><span class="lineNum">     664 </span>                :            :                 {</a>
<a name="665"><span class="lineNum">     665 </span>                :<span class="lineCov">       1490 :                     {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The bitcoin address for transactions.&quot;},</span></a>
<a name="666"><span class="lineNum">     666 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2980 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;Only include transactions confirmed at least this many times.&quot;},</span></a>
<a name="667"><span class="lineNum">     667 </span>                :            :                 },</a>
<a name="668"><span class="lineNum">     668 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="669"><span class="lineNum">     669 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2980 :                     RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount in &quot; + CURRENCY_UNIT + &quot; received at this address.&quot;</span></a>
<a name="670"><span class="lineNum">     670 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       5960 :                 },</span></a>
<a name="671"><span class="lineNum">     671 </span>                :<span class="lineCov">       1490 :                 RPCExamples{</span></a>
<a name="672"><span class="lineNum">     672 </span>                :            :             &quot;\nThe amount from transactions with at least 1 confirmation\n&quot;</a>
<a name="673"><span class="lineNum">     673 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2980 :             + HelpExampleCli(&quot;getreceivedbyaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1490 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="674"><span class="lineNum">     674 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nThe amount including unconfirmed transactions, zero confirmations\n&quot;</span></a>
<a name="675"><span class="lineNum">     675 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleCli(&quot;getreceivedbyaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; 0&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1490 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="676"><span class="lineNum">     676 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nThe amount with at least 6 confirmations\n&quot;</span></a>
<a name="677"><span class="lineNum">     677 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleCli(&quot;getreceivedbyaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; 6&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1490 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="678"><span class="lineNum">     678 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="679"><span class="lineNum">     679 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleRpc(&quot;getreceivedbyaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;, 6&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1490 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="680"><span class="lineNum">     680 </span>                :<span class="lineCov">       1490 :                 },</span></a>
<a name="681"><span class="lineNum">     681 </span>                :<span class="lineCov">         18 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="682"><span class="lineNum">     682 </span>                :            : {</a>
<a name="683"><span class="lineNum">     683 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         34 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="684"><span class="lineNum">     684 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         18 :     if (!pwallet) return NullUniValue;</span></a>
<a name="685"><span class="lineNum">     685 </span>                :            : </a>
<a name="686"><span class="lineNum">     686 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="687"><span class="lineNum">     687 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="688"><span class="lineNum">     688 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         18 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="689"><span class="lineNum">     689 </span>                :            : </a>
<a name="690"><span class="lineNum">     690 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         36 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="691"><span class="lineNum">     691 </span>                :            : </a>
<a name="692"><span class="lineNum">     692 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         18 :     return ValueFromAmount(GetReceived(*pwallet, request.params, /* by_label */ false));</span></a>
<a name="693"><span class="lineNum">     693 </span>                :            : },</a>
<a name="694"><span class="lineNum">     694 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      16390 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1490 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1490 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 2980 times"> + </span><span class="branchCov" title="Branch 25 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="695"><span class="lineNum">     695 </span>                :            : }</a>
<a name="696"><span class="lineNum">     696 </span>                :            : </a>
<a name="697"><span class="lineNum">     697 </span>                :            : </a>
<a name="698"><span class="lineNum">     698 </span>                :<span class="lineCov">       1503 : static RPCHelpMan getreceivedbylabel()</span></a>
<a name="699"><span class="lineNum">     699 </span>                :            : {</a>
<a name="700"><span class="lineNum">     700 </span>                :<span class="lineCov">       1503 :     return RPCHelpMan{&quot;getreceivedbylabel&quot;,</span></a>
<a name="701"><span class="lineNum">     701 </span>                :            :                 &quot;\nReturns the total amount received by addresses with &lt;label&gt; in transactions with at least [minconf] confirmations.\n&quot;,</a>
<a name="702"><span class="lineNum">     702 </span>                :            :                 {</a>
<a name="703"><span class="lineNum">     703 </span>                :<span class="lineCov">       1503 :                     {&quot;label&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The selected label, may be the default label using \&quot;\&quot;.&quot;},</span></a>
<a name="704"><span class="lineNum">     704 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3006 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;Only include transactions confirmed at least this many times.&quot;},</span></a>
<a name="705"><span class="lineNum">     705 </span>                :            :                 },</a>
<a name="706"><span class="lineNum">     706 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="707"><span class="lineNum">     707 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3006 :                     RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount in &quot; + CURRENCY_UNIT + &quot; received for this label.&quot;</span></a>
<a name="708"><span class="lineNum">     708 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6012 :                 },</span></a>
<a name="709"><span class="lineNum">     709 </span>                :<span class="lineCov">       1503 :                 RPCExamples{</span></a>
<a name="710"><span class="lineNum">     710 </span>                :            :             &quot;\nAmount received by the default label with at least 1 confirmation\n&quot;</a>
<a name="711"><span class="lineNum">     711 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3006 :             + HelpExampleCli(&quot;getreceivedbylabel&quot;, &quot;\&quot;\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="712"><span class="lineNum">     712 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1503 :             &quot;\nAmount received at the tabby label including unconfirmed amounts with zero confirmations\n&quot;</span></a>
<a name="713"><span class="lineNum">     713 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6012 :             + HelpExampleCli(&quot;getreceivedbylabel&quot;, &quot;\&quot;tabby\&quot; 0&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="714"><span class="lineNum">     714 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1503 :             &quot;\nThe amount with at least 6 confirmations\n&quot;</span></a>
<a name="715"><span class="lineNum">     715 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6012 :             + HelpExampleCli(&quot;getreceivedbylabel&quot;, &quot;\&quot;tabby\&quot; 6&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="716"><span class="lineNum">     716 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1503 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="717"><span class="lineNum">     717 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6012 :             + HelpExampleRpc(&quot;getreceivedbylabel&quot;, &quot;\&quot;tabby\&quot;, 6&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="718"><span class="lineNum">     718 </span>                :<span class="lineCov">       1503 :                 },</span></a>
<a name="719"><span class="lineNum">     719 </span>                :<span class="lineCov">         31 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="720"><span class="lineNum">     720 </span>                :            : {</a>
<a name="721"><span class="lineNum">     721 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 31 times"> + </span>]:<span class="lineCov">         62 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="722"><span class="lineNum">     722 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         31 :     if (!pwallet) return NullUniValue;</span></a>
<a name="723"><span class="lineNum">     723 </span>                :            : </a>
<a name="724"><span class="lineNum">     724 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="725"><span class="lineNum">     725 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="726"><span class="lineNum">     726 </span>        [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         31 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="727"><span class="lineNum">     727 </span>                :            : </a>
<a name="728"><span class="lineNum">     728 </span>  [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         62 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="729"><span class="lineNum">     729 </span>                :            : </a>
<a name="730"><span class="lineNum">     730 </span>  [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         31 :     return ValueFromAmount(GetReceived(*pwallet, request.params, /* by_label */ true));</span></a>
<a name="731"><span class="lineNum">     731 </span>                :            : },</a>
<a name="732"><span class="lineNum">     732 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      16533 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1503 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1503 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 3006 times"> + </span><span class="branchCov" title="Branch 25 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="733"><span class="lineNum">     733 </span>                :            : }</a>
<a name="734"><span class="lineNum">     734 </span>                :            : </a>
<a name="735"><span class="lineNum">     735 </span>                :            : </a>
<a name="736"><span class="lineNum">     736 </span>                :<span class="lineCov">       1989 : static RPCHelpMan getbalance()</span></a>
<a name="737"><span class="lineNum">     737 </span>                :            : {</a>
<a name="738"><span class="lineNum">     738 </span>                :<span class="lineCov">       1989 :     return RPCHelpMan{&quot;getbalance&quot;,</span></a>
<a name="739"><span class="lineNum">     739 </span>                :            :                 &quot;\nReturns the total available balance.\n&quot;</a>
<a name="740"><span class="lineNum">     740 </span>                :            :                 &quot;The available balance is what the wallet considers currently spendable, and is\n&quot;</a>
<a name="741"><span class="lineNum">     741 </span>                :            :                 &quot;thus affected by options which limit spendability such as -spendzeroconfchange.\n&quot;,</a>
<a name="742"><span class="lineNum">     742 </span>                :            :                 {</a>
<a name="743"><span class="lineNum">     743 </span>                :<span class="lineCov">       1989 :                     {&quot;dummy&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Remains for backward compatibility. Must be excluded or set to \&quot;*\&quot;.&quot;},</span></a>
<a name="744"><span class="lineNum">     744 </span>        [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3978 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;Only include transactions confirmed at least this many times.&quot;},</span></a>
<a name="745"><span class="lineNum">     745 </span>        [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3978 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Also include balance in watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="746"><span class="lineNum">     746 </span>        [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3978 :                     {&quot;avoid_reuse&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;(only available if avoid_reuse wallet flag is set) Do not include balance in dirty outputs; addresses are considered dirty if they have previously been used in a transaction.&quot;},</span></a>
<a name="747"><span class="lineNum">     747 </span>                :            :                 },</a>
<a name="748"><span class="lineNum">     748 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="749"><span class="lineNum">     749 </span>  [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3978 :                     RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount in &quot; + CURRENCY_UNIT + &quot; received for this wallet.&quot;</span></a>
<a name="750"><span class="lineNum">     750 </span>  [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       7956 :                 },</span></a>
<a name="751"><span class="lineNum">     751 </span>                :<span class="lineCov">       1989 :                 RPCExamples{</span></a>
<a name="752"><span class="lineNum">     752 </span>                :            :             &quot;\nThe total amount in the wallet with 0 or more confirmations\n&quot;</a>
<a name="753"><span class="lineNum">     753 </span>  [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3978 :             + HelpExampleCli(&quot;getbalance&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="754"><span class="lineNum">     754 </span>        [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1989 :             &quot;\nThe total amount in the wallet with at least 6 confirmations\n&quot;</span></a>
<a name="755"><span class="lineNum">     755 </span>  [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7956 :             + HelpExampleCli(&quot;getbalance&quot;, &quot;\&quot;*\&quot; 6&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="756"><span class="lineNum">     756 </span>        [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1989 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="757"><span class="lineNum">     757 </span>  [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7956 :             + HelpExampleRpc(&quot;getbalance&quot;, &quot;\&quot;*\&quot;, 6&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="758"><span class="lineNum">     758 </span>                :<span class="lineCov">       1989 :                 },</span></a>
<a name="759"><span class="lineNum">     759 </span>                :<span class="lineCov">        517 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="760"><span class="lineNum">     760 </span>                :            : {</a>
<a name="761"><span class="lineNum">     761 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 517 times"> + </span>]:<span class="lineCov">       1032 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="762"><span class="lineNum">     762 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 517 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        517 :     if (!pwallet) return NullUniValue;</span></a>
<a name="763"><span class="lineNum">     763 </span>                :            : </a>
<a name="764"><span class="lineNum">     764 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="765"><span class="lineNum">     765 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="766"><span class="lineNum">     766 </span>        [<span class="branchCov" title="Branch 0 was taken 517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        517 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="767"><span class="lineNum">     767 </span>                :            : </a>
<a name="768"><span class="lineNum">     768 </span>  [<span class="branchCov" title="Branch 0 was taken 517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1034 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="769"><span class="lineNum">     769 </span>                :            : </a>
<a name="770"><span class="lineNum">     770 </span>        [<span class="branchCov" title="Branch 0 was taken 517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        517 :     const UniValue&amp; dummy_value = request.params[0];</span></a>
<a name="771"><span class="lineNum">     771 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 509 times"> + </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        517 :     if (!dummy_value.isNull() &amp;&amp; dummy_value.get_str() != &quot;*&quot;) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 6 times"> + </span>]
<a name="772"><span class="lineNum">     772 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_METHOD_DEPRECATED, &quot;dummy first argument must be excluded or set to \&quot;*\&quot;.&quot;);</span></a>
<a name="773"><span class="lineNum">     773 </span>                :            :     }</a>
<a name="774"><span class="lineNum">     774 </span>                :            : </a>
<a name="775"><span class="lineNum">     775 </span>                :<span class="lineCov">        515 :     int min_depth = 0;</span></a>
<a name="776"><span class="lineNum">     776 </span>  [<span class="branchCov" title="Branch 0 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 40 times"> + </span><span class="branchCov" title="Branch 3 was taken 475 times"> + </span>]:<span class="lineCov">        515 :     if (!request.params[1].isNull()) {</span></a>
<a name="777"><span class="lineNum">     777 </span>  [<span class="branchCov" title="Branch 0 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         40 :         min_depth = request.params[1].get_int();</span></a>
<a name="778"><span class="lineNum">     778 </span>                :            :     }</a>
<a name="779"><span class="lineNum">     779 </span>                :            : </a>
<a name="780"><span class="lineNum">     780 </span>  [<span class="branchCov" title="Branch 0 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        515 :     bool include_watchonly = ParseIncludeWatchonly(request.params[2], *pwallet);</span></a>
<a name="781"><span class="lineNum">     781 </span>                :            : </a>
<a name="782"><span class="lineNum">     782 </span>  [<span class="branchCov" title="Branch 0 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        515 :     bool avoid_reuse = GetAvoidReuseFlag(*pwallet, request.params[3]);</span></a>
<a name="783"><span class="lineNum">     783 </span>                :            : </a>
<a name="784"><span class="lineNum">     784 </span>        [<span class="branchCov" title="Branch 0 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        515 :     const auto bal = GetBalance(*pwallet, min_depth, avoid_reuse);</span></a>
<a name="785"><span class="lineNum">     785 </span>                :            : </a>
<a name="786"><span class="lineNum">     786 </span>  [<span class="branchCov" title="Branch 0 was taken 56 times"> + </span><span class="branchCov" title="Branch 1 was taken 459 times"> + </span><span class="branchCov" title="Branch 2 was taken 515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        515 :     return ValueFromAmount(bal.m_mine_trusted + (include_watchonly ? bal.m_watchonly_trusted : 0));</span></a>
<a name="787"><span class="lineNum">     787 </span>                :            : },</a>
<a name="788"><span class="lineNum">     788 </span>  [<span class="branchCov" title="Branch 0 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      33813 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1989 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1989 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1989 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1989 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 7956 times"> + </span><span class="branchCov" title="Branch 41 was taken 1989 times"> + </span><span class="branchNoCov" title="Branch 42 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 43 was not taken"> - </span>]
<a name="789"><span class="lineNum">     789 </span>                :            : }</a>
<a name="790"><span class="lineNum">     790 </span>                :            : </a>
<a name="791"><span class="lineNum">     791 </span>                :<span class="lineCov">       1480 : static RPCHelpMan getunconfirmedbalance()</span></a>
<a name="792"><span class="lineNum">     792 </span>                :            : {</a>
<a name="793"><span class="lineNum">     793 </span>                :<span class="lineCov">       1480 :     return RPCHelpMan{&quot;getunconfirmedbalance&quot;,</span></a>
<a name="794"><span class="lineNum">     794 </span>                :            :                 &quot;DEPRECATED\nIdentical to getbalances().mine.untrusted_pending\n&quot;,</a>
<a name="795"><span class="lineNum">     795 </span>                :            :                 {},</a>
<a name="796"><span class="lineNum">     796 </span>  [<span class="branchCov" title="Branch 0 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2960 :                 RPCResult{RPCResult::Type::NUM, &quot;&quot;, &quot;The balance&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="797"><span class="lineNum">     797 </span>        [<span class="branchCov" title="Branch 0 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2960 :                 RPCExamples{&quot;&quot;},</span></a>
<a name="798"><span class="lineNum">     798 </span>                :<span class="lineCov">          8 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="799"><span class="lineNum">     799 </span>                :            : {</a>
<a name="800"><span class="lineNum">     800 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 8 times"> + </span>]:<span class="lineCov">         16 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="801"><span class="lineNum">     801 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :     if (!pwallet) return NullUniValue;</span></a>
<a name="802"><span class="lineNum">     802 </span>                :            : </a>
<a name="803"><span class="lineNum">     803 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="804"><span class="lineNum">     804 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="805"><span class="lineNum">     805 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="806"><span class="lineNum">     806 </span>                :            : </a>
<a name="807"><span class="lineNum">     807 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="808"><span class="lineNum">     808 </span>                :            : </a>
<a name="809"><span class="lineNum">     809 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :     return ValueFromAmount(GetBalance(*pwallet).m_mine_untrusted_pending);</span></a>
<a name="810"><span class="lineNum">     810 </span>                :            : },</a>
<a name="811"><span class="lineNum">     811 </span>  [<span class="branchCov" title="Branch 0 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8880 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1480 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="812"><span class="lineNum">     812 </span>                :            : }</a>
<a name="813"><span class="lineNum">     813 </span>                :            : </a>
<a name="814"><span class="lineNum">     814 </span>                :            : </a>
<a name="815"><span class="lineNum">     815 </span>                :<span class="lineCov">       1625 : static RPCHelpMan sendmany()</span></a>
<a name="816"><span class="lineNum">     816 </span>                :            : {</a>
<a name="817"><span class="lineNum">     817 </span>                :<span class="lineCov">       1625 :     return RPCHelpMan{&quot;sendmany&quot;,</span></a>
<a name="818"><span class="lineNum">     818 </span>                :<span class="lineCov">       1625 :                 &quot;\nSend multiple times. Amounts are double-precision floating point numbers.&quot; +</span></a>
<a name="819"><span class="lineNum">     819 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1625 :         HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="820"><span class="lineNum">     820 </span>                :            :                 {</a>
<a name="821"><span class="lineNum">     821 </span>                :<span class="lineCov">       1625 :                     {&quot;dummy&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;Must be set to \&quot;\&quot; for backwards compatibility.&quot;, &quot;\&quot;\&quot;&quot;},</span></a>
<a name="822"><span class="lineNum">     822 </span>                :<span class="lineCov">       1625 :                     {&quot;amounts&quot;, RPCArg::Type::OBJ_USER_KEYS, RPCArg::Optional::NO, &quot;The addresses and amounts&quot;,</span></a>
<a name="823"><span class="lineNum">     823 </span>                :            :                         {</a>
<a name="824"><span class="lineNum">     824 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4875 :                             {&quot;address&quot;, RPCArg::Type::AMOUNT, RPCArg::Optional::NO, &quot;The bitcoin address is the key, the numeric amount (can be string) in &quot; + CURRENCY_UNIT + &quot; is the value&quot;},</span></a>
<a name="825"><span class="lineNum">     825 </span>                :            :                         },</a>
<a name="826"><span class="lineNum">     826 </span>                :            :                     },</a>
<a name="827"><span class="lineNum">     827 </span>                :<span class="lineCov">       1625 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Ignored dummy value&quot;},</span></a>
<a name="828"><span class="lineNum">     828 </span>                :<span class="lineCov">       1625 :                     {&quot;comment&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;A comment&quot;},</span></a>
<a name="829"><span class="lineNum">     829 </span>                :<span class="lineCov">       1625 :                     {&quot;subtractfeefrom&quot;, RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;The addresses.\n&quot;</span></a>
<a name="830"><span class="lineNum">     830 </span>                :            :                                        &quot;The fee will be equally deducted from the amount of each selected address.\n&quot;</a>
<a name="831"><span class="lineNum">     831 </span>                :            :                                        &quot;Those recipients will receive less bitcoins than you enter in their corresponding amount field.\n&quot;</a>
<a name="832"><span class="lineNum">     832 </span>                :            :                                        &quot;If no addresses are specified here, the sender pays the fee.&quot;,</a>
<a name="833"><span class="lineNum">     833 </span>                :            :                         {</a>
<a name="834"><span class="lineNum">     834 </span>                :<span class="lineCov">       1625 :                             {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;Subtract fee from this address&quot;},</span></a>
<a name="835"><span class="lineNum">     835 </span>                :            :                         },</a>
<a name="836"><span class="lineNum">     836 </span>                :            :                     },</a>
<a name="837"><span class="lineNum">     837 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3250 :                     {&quot;replaceable&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;wallet default&quot;}, &quot;Allow this transaction to be replaced by a transaction with higher fees via BIP 125&quot;},</span></a>
<a name="838"><span class="lineNum">     838 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3250 :                     {&quot;conf_target&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;wallet -txconfirmtarget&quot;}, &quot;Confirmation target in blocks&quot;},</span></a>
<a name="839"><span class="lineNum">     839 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4875 :                     {&quot;estimate_mode&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;unset&quot;}, std::string() + &quot;The fee estimate mode, must be one of (case insensitive):\n&quot;</span></a>
<a name="840"><span class="lineNum">     840 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4875 :             &quot;       \&quot;&quot; + FeeModes(&quot;\&quot;\n\&quot;&quot;) + &quot;\&quot;&quot;},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="841"><span class="lineNum">     841 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6500 :                     {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="842"><span class="lineNum">     842 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3250 :                     {&quot;verbose&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;If true, return extra infomration about the transaction.&quot;},</span></a>
<a name="843"><span class="lineNum">     843 </span>                :            :                 },</a>
<a name="844"><span class="lineNum">     844 </span>                :            :                 {</a>
<a name="845"><span class="lineNum">     845 </span>                :            :                     RPCResult{&quot;if verbose is not set or set to false&quot;,</a>
<a name="846"><span class="lineNum">     846 </span>                :            :                         RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id for the send. Only 1 transaction is created regardless of\n&quot;</a>
<a name="847"><span class="lineNum">     847 </span>                :            :                 &quot;the number of addresses.&quot;</a>
<a name="848"><span class="lineNum">     848 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3250 :                     },</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="849"><span class="lineNum">     849 </span>                :            :                     RPCResult{&quot;if verbose is set to true&quot;,</a>
<a name="850"><span class="lineNum">     850 </span>                :            :                         RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="851"><span class="lineNum">     851 </span>                :            :                         {</a>
<a name="852"><span class="lineNum">     852 </span>                :            :                             {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id for the send. Only 1 transaction is created regardless of\n&quot;</a>
<a name="853"><span class="lineNum">     853 </span>                :            :                 &quot;the number of addresses.&quot;},</a>
<a name="854"><span class="lineNum">     854 </span>                :            :                             {RPCResult::Type::STR, &quot;fee_reason&quot;, &quot;The transaction fee reason.&quot;}</a>
<a name="855"><span class="lineNum">     855 </span>                :            :                         },</a>
<a name="856"><span class="lineNum">     856 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6500 :                     },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3250 times"> + </span><span class="branchCov" title="Branch 21 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="857"><span class="lineNum">     857 </span>                :            :                 },</a>
<a name="858"><span class="lineNum">     858 </span>                :<span class="lineCov">       1625 :                 RPCExamples{</span></a>
<a name="859"><span class="lineNum">     859 </span>                :            :             &quot;\nSend two amounts to two different addresses:\n&quot;</a>
<a name="860"><span class="lineNum">     860 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3250 :             + HelpExampleCli(&quot;sendmany&quot;, &quot;\&quot;\&quot; \&quot;{\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;:0.01,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;:0.02}\&quot;&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="861"><span class="lineNum">     861 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1625 :             &quot;\nSend two amounts to two different addresses setting the confirmation and comment:\n&quot;</span></a>
<a name="862"><span class="lineNum">     862 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6500 :             + HelpExampleCli(&quot;sendmany&quot;, &quot;\&quot;\&quot; \&quot;{\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;:0.01,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;:0.02}\&quot; 6 \&quot;testing\&quot;&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="863"><span class="lineNum">     863 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1625 :             &quot;\nSend two amounts to two different addresses, subtract fee from amount:\n&quot;</span></a>
<a name="864"><span class="lineNum">     864 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6500 :             + HelpExampleCli(&quot;sendmany&quot;, &quot;\&quot;\&quot; \&quot;{\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;:0.01,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;:0.02}\&quot; 1 \&quot;\&quot; \&quot;[\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;]\&quot;&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<a name="865"><span class="lineNum">     865 </span>        [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1625 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="866"><span class="lineNum">     866 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6500 :             + HelpExampleRpc(&quot;sendmany&quot;, &quot;\&quot;\&quot;, {\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;:0.01,\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\&quot;:0.02}, 6, \&quot;testing\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="867"><span class="lineNum">     867 </span>                :<span class="lineCov">       1625 :                 },</span></a>
<a name="868"><span class="lineNum">     868 </span>                :<span class="lineCov">        153 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="869"><span class="lineNum">     869 </span>                :            : {</a>
<a name="870"><span class="lineNum">     870 </span>                :<span class="lineCov">        226 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="871"><span class="lineNum">     871 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        153 :     if (!pwallet) return NullUniValue;</span></a>
<a name="872"><span class="lineNum">     872 </span>                :            : </a>
<a name="873"><span class="lineNum">     873 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="874"><span class="lineNum">     874 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="875"><span class="lineNum">     875 </span>        [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        153 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="876"><span class="lineNum">     876 </span>                :            : </a>
<a name="877"><span class="lineNum">     877 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        306 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="878"><span class="lineNum">     878 </span>                :            : </a>
<a name="879"><span class="lineNum">     879 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 77 times"> + </span><span class="branchCov" title="Branch 3 was taken 76 times"> + </span> :<span class="lineCov">        153 :     if (!request.params[0].isNull() &amp;&amp; !request.params[0].get_str().empty()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 77 times"> + </span>]
<a name="880"><span class="lineNum">     880 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Dummy value must be set to \&quot;\&quot;&quot;);</span></a>
<a name="881"><span class="lineNum">     881 </span>                :            :     }</a>
<a name="882"><span class="lineNum">     882 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        306 :     UniValue sendTo = request.params[1].get_obj();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="883"><span class="lineNum">     883 </span>                :            : </a>
<a name="884"><span class="lineNum">     884 </span>        [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        306 :     mapValue_t mapValue;</span></a>
<a name="885"><span class="lineNum">     885 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 149 times"> + </span> :<span class="lineCov">        153 :     if (!request.params[3].isNull() &amp;&amp; !request.params[3].get_str().empty())</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 4 times"> + </span>]
<a name="886"><span class="lineNum">     886 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        153 :         mapValue[&quot;comment&quot;] = request.params[3].get_str();</span></a>
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="887"><span class="lineNum">     887 </span>                :            : </a>
<a name="888"><span class="lineNum">     888 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        306 :     UniValue subtractFeeFromAmount(UniValue::VARR);</span></a>
<a name="889"><span class="lineNum">     889 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 147 times"> + </span>]:<span class="lineCov">        153 :     if (!request.params[4].isNull())</span></a>
<a name="890"><span class="lineNum">     890 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          6 :         subtractFeeFromAmount = request.params[4].get_array();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="891"><span class="lineNum">     891 </span>                :            : </a>
<a name="892"><span class="lineNum">     892 </span>        [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        306 :     CCoinControl coin_control;</span></a>
<a name="893"><span class="lineNum">     893 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 153 times"> + </span>]:<span class="lineCov">        153 :     if (!request.params[5].isNull()) {</span></a>
<a name="894"><span class="lineNum">     894 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         coin_control.m_signal_bip125_rbf = request.params[5].get_bool();</span></a>
<a name="895"><span class="lineNum">     895 </span>                :            :     }</a>
<a name="896"><span class="lineNum">     896 </span>                :            : </a>
<a name="897"><span class="lineNum">     897 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        153 :     SetFeeEstimateMode(*pwallet, coin_control, /* conf_target */ request.params[6], /* estimate_mode */ request.params[7], /* fee_rate */ request.params[8], /* override_min_fee */ false);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 99 times"> + </span><span class="branchCov" title="Branch 7 was taken 54 times"> + </span>]
<a name="898"><span class="lineNum">     898 </span>                :            : </a>
<a name="899"><span class="lineNum">     899 </span>        [<span class="branchCov" title="Branch 0 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        125 :     std::vector&lt;CRecipient&gt; recipients;</span></a>
<a name="900"><span class="lineNum">     900 </span>        [<span class="branchCov" title="Branch 0 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         99 :     ParseRecipients(sendTo, subtractFeeFromAmount, recipients);</span></a>
<a name="901"><span class="lineNum">     901 </span>  [<span class="branchCov" title="Branch 0 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 95 times"> + </span> :<span class="lineCov">         99 :     const bool verbose{request.params[9].isNull() ? false : request.params[9].get_bool()};</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="902"><span class="lineNum">     902 </span>                :            : </a>
<a name="903"><span class="lineNum">     903 </span>        [<span class="branchCov" title="Branch 0 was taken 73 times"> + </span><span class="branchCov" title="Branch 1 was taken 26 times"> + </span>]:<span class="lineCov">        198 :     return SendMoney(*pwallet, coin_control, recipients, std::move(mapValue), verbose);</span></a>
<a name="904"><span class="lineNum">     904 </span>                :            : },</a>
<a name="905"><span class="lineNum">     905 </span>  [<span class="branchCov" title="Branch 0 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      76375 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 3250 times"> + </span><span class="branchCov" title="Branch 111 was taken 1625 times"> + </span><span class="branchCov" title="Branch 112 was taken 16250 times"> + </span><span class="branchCov" title="Branch 113 was taken 1625 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 1625 times"> + </span><span class="branchCov" title="Branch 115 was taken 1625 times"> + </span><span class="branchCov" title="Branch 116 was taken 1625 times"> + </span><span class="branchCov" title="Branch 117 was taken 1625 times"> + </span><span class="branchNoCov" title="Branch 118 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchNoCov" title="Branch 120 was not taken"> - </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span><span class="branchNoCov" title="Branch 122 was not taken"> - </span><span class="branchNoCov" title="Branch 123 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 124 was not taken"> - </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span>]
<a name="906"><span class="lineNum">     906 </span>                :            : }</a>
<a name="907"><span class="lineNum">     907 </span>                :            : </a>
<a name="908"><span class="lineNum">     908 </span>                :            : </a>
<a name="909"><span class="lineNum">     909 </span>                :<span class="lineCov">       1583 : static RPCHelpMan addmultisigaddress()</span></a>
<a name="910"><span class="lineNum">     910 </span>                :            : {</a>
<a name="911"><span class="lineNum">     911 </span>                :<span class="lineCov">       1583 :     return RPCHelpMan{&quot;addmultisigaddress&quot;,</span></a>
<a name="912"><span class="lineNum">     912 </span>                :            :                 &quot;\nAdd an nrequired-to-sign multisignature address to the wallet. Requires a new wallet backup.\n&quot;</a>
<a name="913"><span class="lineNum">     913 </span>                :            :                 &quot;Each key is a Bitcoin address or hex-encoded public key.\n&quot;</a>
<a name="914"><span class="lineNum">     914 </span>                :            :                 &quot;This functionality is only intended for use with non-watchonly addresses.\n&quot;</a>
<a name="915"><span class="lineNum">     915 </span>                :            :                 &quot;See `importaddress` for watchonly p2sh address support.\n&quot;</a>
<a name="916"><span class="lineNum">     916 </span>                :            :                 &quot;If 'label' is specified, assign address to that label.\n&quot;,</a>
<a name="917"><span class="lineNum">     917 </span>                :            :                 {</a>
<a name="918"><span class="lineNum">     918 </span>                :<span class="lineCov">       1583 :                     {&quot;nrequired&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The number of required signatures out of the n keys or addresses.&quot;},</span></a>
<a name="919"><span class="lineNum">     919 </span>                :<span class="lineCov">       1583 :                     {&quot;keys&quot;, RPCArg::Type::ARR, RPCArg::Optional::NO, &quot;The bitcoin addresses or hex-encoded public keys&quot;,</span></a>
<a name="920"><span class="lineNum">     920 </span>                :            :                         {</a>
<a name="921"><span class="lineNum">     921 </span>                :<span class="lineCov">       1583 :                             {&quot;key&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;bitcoin address or hex-encoded public key&quot;},</span></a>
<a name="922"><span class="lineNum">     922 </span>                :            :                         },</a>
<a name="923"><span class="lineNum">     923 </span>                :            :                         },</a>
<a name="924"><span class="lineNum">     924 </span>                :<span class="lineCov">       1583 :                     {&quot;label&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;A label to assign the addresses to.&quot;},</span></a>
<a name="925"><span class="lineNum">     925 </span>        [<span class="branchCov" title="Branch 0 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3166 :                     {&quot;address_type&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;set by -addresstype&quot;}, &quot;The address type to use. Options are \&quot;legacy\&quot;, \&quot;p2sh-segwit\&quot;, and \&quot;bech32\&quot;.&quot;},</span></a>
<a name="926"><span class="lineNum">     926 </span>                :            :                 },</a>
<a name="927"><span class="lineNum">     927 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="928"><span class="lineNum">     928 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="929"><span class="lineNum">     929 </span>                :            :                     {</a>
<a name="930"><span class="lineNum">     930 </span>                :            :                         {RPCResult::Type::STR, &quot;address&quot;, &quot;The value of the new multisig address&quot;},</a>
<a name="931"><span class="lineNum">     931 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;redeemScript&quot;, &quot;The string value of the hex-encoded redemption script&quot;},</a>
<a name="932"><span class="lineNum">     932 </span>                :            :                         {RPCResult::Type::STR, &quot;descriptor&quot;, &quot;The descriptor for this multisig&quot;},</a>
<a name="933"><span class="lineNum">     933 </span>                :            :                     }</a>
<a name="934"><span class="lineNum">     934 </span>  [<span class="branchCov" title="Branch 0 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7915 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 4749 times"> + </span><span class="branchCov" title="Branch 27 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<a name="935"><span class="lineNum">     935 </span>                :<span class="lineCov">       1583 :                 RPCExamples{</span></a>
<a name="936"><span class="lineNum">     936 </span>                :            :             &quot;\nAdd a multisig address from 2 addresses\n&quot;</a>
<a name="937"><span class="lineNum">     937 </span>  [<span class="branchCov" title="Branch 0 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3166 :             + HelpExampleCli(&quot;addmultisigaddress&quot;, &quot;2 \&quot;[\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;]\&quot;&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1583 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1583 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="938"><span class="lineNum">     938 </span>        [<span class="branchCov" title="Branch 0 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1583 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="939"><span class="lineNum">     939 </span>  [<span class="branchCov" title="Branch 0 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6332 :             + HelpExampleRpc(&quot;addmultisigaddress&quot;, &quot;2, \&quot;[\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;]\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1583 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1583 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="940"><span class="lineNum">     940 </span>                :<span class="lineCov">       1583 :                 },</span></a>
<a name="941"><span class="lineNum">     941 </span>                :<span class="lineCov">        111 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="942"><span class="lineNum">     942 </span>                :            : {</a>
<a name="943"><span class="lineNum">     943 </span>                :<span class="lineCov">        217 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="944"><span class="lineNum">     944 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 111 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        111 :     if (!pwallet) return NullUniValue;</span></a>
<a name="945"><span class="lineNum">     945 </span>                :            : </a>
<a name="946"><span class="lineNum">     946 </span>        [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">        111 :     LegacyScriptPubKeyMan&amp; spk_man = EnsureLegacyScriptPubKeyMan(*pwallet);</span></a>
<a name="947"><span class="lineNum">     947 </span>                :            : </a>
<a name="948"><span class="lineNum">     948 </span>  [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        330 :     LOCK2(pwallet-&gt;cs_wallet, spk_man.cs_KeyStore);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="949"><span class="lineNum">     949 </span>                :            : </a>
<a name="950"><span class="lineNum">     950 </span>  [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        220 :     std::string label;</span></a>
<a name="951"><span class="lineNum">     951 </span>  [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchCov" title="Branch 3 was taken 82 times"> + </span>]:<span class="lineCov">        110 :     if (!request.params[2].isNull())</span></a>
<a name="952"><span class="lineNum">     952 </span>  [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         28 :         label = LabelFromValue(request.params[2]);</span></a>
<a name="953"><span class="lineNum">     953 </span>                :            : </a>
<a name="954"><span class="lineNum">     954 </span>  [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        110 :     int required = request.params[0].get_int();</span></a>
<a name="955"><span class="lineNum">     955 </span>                :            : </a>
<a name="956"><span class="lineNum">     956 </span>                :            :     // Get the public keys</a>
<a name="957"><span class="lineNum">     957 </span>  [<span class="branchCov" title="Branch 0 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 110 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        110 :     const UniValue&amp; keys_or_addrs = request.params[1].get_array();</span></a>
<a name="958"><span class="lineNum">     958 </span>                :<span class="lineCov">        220 :     std::vector&lt;CPubKey&gt; pubkeys;</span></a>
<a name="959"><span class="lineNum">     959 </span>        [<span class="branchCov" title="Branch 0 was taken 301 times"> + </span><span class="branchCov" title="Branch 1 was taken 108 times"> + </span>]:<span class="lineCov">        409 :     for (unsigned int i = 0; i &lt; keys_or_addrs.size(); ++i) {</span></a>
<a name="960"><span class="lineNum">     960 </span>  [<span class="branchCov" title="Branch 0 was taken 301 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 301 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        301 :         if (IsHex(keys_or_addrs[i].get_str()) &amp;&amp; (keys_or_addrs[i].get_str().length() == 66 || keys_or_addrs[i].get_str().length() == 130)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 301 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 161 times"> + </span><span class="branchCov" title="Branch 7 was taken 140 times"> + </span><span class="branchCov" title="Branch 8 was taken 161 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 161 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 34 times"> + </span><span class="branchCov" title="Branch 13 was taken 127 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 34 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 34 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 34 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="961"><span class="lineNum">     961 </span>  [<span class="branchCov" title="Branch 0 was taken 161 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 161 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        161 :             pubkeys.push_back(HexToPubKey(keys_or_addrs[i].get_str()));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 161 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="962"><span class="lineNum">     962 </span>                :            :         } else {</a>
<a name="963"><span class="lineNum">     963 </span>  [<span class="branchCov" title="Branch 0 was taken 140 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 140 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        439 :             pubkeys.push_back(AddrToPubKey(spk_man, keys_or_addrs[i].get_str()));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 138 times"> + </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span>]
<a name="964"><span class="lineNum">     964 </span>                :            :         }</a>
<a name="965"><span class="lineNum">     965 </span>                :            :     }</a>
<a name="966"><span class="lineNum">     966 </span>                :            : </a>
<a name="967"><span class="lineNum">     967 </span>        [<span class="branchCov" title="Branch 0 was taken 108 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        108 :     OutputType output_type = pwallet-&gt;m_default_address_type;</span></a>
<a name="968"><span class="lineNum">     968 </span>  [<span class="branchCov" title="Branch 0 was taken 108 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchCov" title="Branch 3 was taken 72 times"> + </span>]:<span class="lineCov">        108 :     if (!request.params[3].isNull()) {</span></a>
<a name="969"><span class="lineNum">     969 </span>  [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         36 :         std::optional&lt;OutputType&gt; parsed = ParseOutputType(request.params[3].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="970"><span class="lineNum">     970 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 35 times"> + </span>]:<span class="lineCov">         36 :         if (!parsed) {</span></a>
<a name="971"><span class="lineNum">     971 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          2 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;Unknown address type '%s'&quot;, request.params[3].get_str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="972"><span class="lineNum">     972 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 34 times"> + </span>]:<span class="lineCov">         35 :         } else if (parsed.value() == OutputType::BECH32M) {</span></a>
<a name="973"><span class="lineNum">     973 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Bech32m multisig addresses cannot be created with legacy wallets&quot;);</span></a>
<a name="974"><span class="lineNum">     974 </span>                :            :         }</a>
<a name="975"><span class="lineNum">     975 </span>                :<span class="lineCov">        106 :         output_type = parsed.value();</span></a>
<a name="976"><span class="lineNum">     976 </span>                :            :     }</a>
<a name="977"><span class="lineNum">     977 </span>                :            : </a>
<a name="978"><span class="lineNum">     978 </span>                :            :     // Construct using pay-to-script-hash:</a>
<a name="979"><span class="lineNum">     979 </span>        [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        212 :     CScript inner;</span></a>
<a name="980"><span class="lineNum">     980 </span>        [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        106 :     CTxDestination dest = AddAndGetMultisigDestination(required, pubkeys, output_type, spk_man, inner);</span></a>
<a name="981"><span class="lineNum">     981 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        212 :     pwallet-&gt;SetAddressBook(dest, label, &quot;send&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="982"><span class="lineNum">     982 </span>                :            : </a>
<a name="983"><span class="lineNum">     983 </span>                :            :     // Make the descriptor</a>
<a name="984"><span class="lineNum">     984 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        212 :     std::unique_ptr&lt;Descriptor&gt; descriptor = InferDescriptor(GetScriptForDestination(dest), spk_man);</span></a>
<a name="985"><span class="lineNum">     985 </span>                :            : </a>
<a name="986"><span class="lineNum">     986 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        212 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="987"><span class="lineNum">     987 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        212 :     result.pushKV(&quot;address&quot;, EncodeDestination(dest));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="988"><span class="lineNum">     988 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        318 :     result.pushKV(&quot;redeemScript&quot;, HexStr(inner));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="989"><span class="lineNum">     989 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        212 :     result.pushKV(&quot;descriptor&quot;, descriptor-&gt;ToString());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="990"><span class="lineNum">     990 </span>                :<span class="lineCov">        106 :     return result;</span></a>
<a name="991"><span class="lineNum">     991 </span>                :            : },</a>
<a name="992"><span class="lineNum">     992 </span>  [<span class="branchCov" title="Branch 0 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      26911 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1583 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1583 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 6332 times"> + </span><span class="branchCov" title="Branch 51 was taken 1583 times"> + </span><span class="branchCov" title="Branch 52 was taken 1583 times"> + </span><span class="branchCov" title="Branch 53 was taken 1583 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 54 was not taken"> - </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchNoCov" title="Branch 56 was not taken"> - </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span>]
<a name="993"><span class="lineNum">     993 </span>                :            : }</a>
<a name="994"><span class="lineNum">     994 </span>                :            : </a>
<a name="995"><span class="lineNum">     995 </span>                :<span class="lineCov">        278 : struct tallyitem</span></a>
<a name="996"><span class="lineNum">     996 </span>                :            : {</a>
<a name="997"><span class="lineNum">     997 </span>                :            :     CAmount nAmount{0};</a>
<a name="998"><span class="lineNum">     998 </span>                :            :     int nConf{std::numeric_limits&lt;int&gt;::max()};</a>
<a name="999"><span class="lineNum">     999 </span>                :            :     std::vector&lt;uint256&gt; txids;</a>
<a name="1000"><span class="lineNum">    1000 </span>                :            :     bool fIsWatchonly{false};</a>
<a name="1001"><span class="lineNum">    1001 </span>                :<span class="lineCov">        278 :     tallyitem()</span></a>
<a name="1002"><span class="lineNum">    1002 </span>                :<span class="lineCov">        278 :     {</span></a>
<a name="1003"><span class="lineNum">    1003 </span>                :            :     }</a>
<a name="1004"><span class="lineNum">    1004 </span>                :            : };</a>
<a name="1005"><span class="lineNum">    1005 </span>                :            : </a>
<a name="1006"><span class="lineNum">    1006 </span>                :<span class="lineCov">        368 : static UniValue ListReceived(const CWallet&amp; wallet, const UniValue&amp; params, bool by_label) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)</span></a>
<a name="1007"><span class="lineNum">    1007 </span>                :            : {</a>
<a name="1008"><span class="lineNum">    1008 </span>                :            :     // Minimum confirmations</a>
<a name="1009"><span class="lineNum">    1009 </span>                :<span class="lineCov">        368 :     int nMinDepth = 1;</span></a>
<a name="1010"><span class="lineNum">    1010 </span>        [<span class="branchCov" title="Branch 0 was taken 350 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">        368 :     if (!params[0].isNull())</span></a>
<a name="1011"><span class="lineNum">    1011 </span>                :<span class="lineCov">        350 :         nMinDepth = params[0].get_int();</span></a>
<a name="1012"><span class="lineNum">    1012 </span>                :            : </a>
<a name="1013"><span class="lineNum">    1013 </span>                :            :     // Whether to include empty labels</a>
<a name="1014"><span class="lineNum">    1014 </span>                :<span class="lineCov">        368 :     bool fIncludeEmpty = false;</span></a>
<a name="1015"><span class="lineNum">    1015 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchCov" title="Branch 1 was taken 346 times"> + </span>]:<span class="lineCov">        368 :     if (!params[1].isNull())</span></a>
<a name="1016"><span class="lineNum">    1016 </span>                :<span class="lineCov">         22 :         fIncludeEmpty = params[1].get_bool();</span></a>
<a name="1017"><span class="lineNum">    1017 </span>                :            : </a>
<a name="1018"><span class="lineNum">    1018 </span>                :<span class="lineCov">        368 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="1019"><span class="lineNum">    1019 </span>                :            : </a>
<a name="1020"><span class="lineNum">    1020 </span>        [<span class="branchCov" title="Branch 0 was taken 346 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">        368 :     if (ParseIncludeWatchonly(params[2], wallet)) {</span></a>
<a name="1021"><span class="lineNum">    1021 </span>                :<span class="lineCov">        346 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="1022"><span class="lineNum">    1022 </span>                :            :     }</a>
<a name="1023"><span class="lineNum">    1023 </span>                :            : </a>
<a name="1024"><span class="lineNum">    1024 </span>                :<span class="lineCov">        368 :     bool has_filtered_address = false;</span></a>
<a name="1025"><span class="lineNum">    1025 </span>                :<span class="lineCov">        368 :     CTxDestination filtered_address = CNoDestination();</span></a>
<a name="1026"><span class="lineNum">    1026 </span>  [<span class="branchCov" title="Branch 0 was taken 356 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchCov" title="Branch 2 was taken 336 times"> + </span><span class="branchCov" title="Branch 3 was taken 20 times"> + </span>]:<span class="lineCov">        368 :     if (!by_label &amp;&amp; params.size() &gt; 3) {</span></a>
<a name="1027"><span class="lineNum">    1027 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 334 times"> + </span>]:<span class="lineCov">        336 :         if (!IsValidDestinationString(params[3].get_str())) {</span></a>
<a name="1028"><span class="lineNum">    1028 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;address_filter parameter was invalid&quot;);</span></a>
<a name="1029"><span class="lineNum">    1029 </span>                :            :         }</a>
<a name="1030"><span class="lineNum">    1030 </span>                :<span class="lineCov">        334 :         filtered_address = DecodeDestination(params[3].get_str());</span></a>
<a name="1031"><span class="lineNum">    1031 </span>                :<span class="lineCov">        334 :         has_filtered_address = true;</span></a>
<a name="1032"><span class="lineNum">    1032 </span>                :            :     }</a>
<a name="1033"><span class="lineNum">    1033 </span>                :            : </a>
<a name="1034"><span class="lineNum">    1034 </span>                :            :     // Tally</a>
<a name="1035"><span class="lineNum">    1035 </span>                :<span class="lineCov">        366 :     std::map&lt;CTxDestination, tallyitem&gt; mapTally;</span></a>
<a name="1036"><span class="lineNum">    1036 </span>        [<span class="branchCov" title="Branch 0 was taken 17094 times"> + </span><span class="branchCov" title="Branch 1 was taken 366 times"> + </span>]:<span class="lineCov">      17460 :     for (const std::pair&lt;const uint256, CWalletTx&gt;&amp; pairWtx : wallet.mapWallet) {</span></a>
<a name="1037"><span class="lineNum">    1037 </span>                :<span class="lineCov">      17094 :         const CWalletTx&amp; wtx = pairWtx.second;</span></a>
<a name="1038"><span class="lineNum">    1038 </span>                :            : </a>
<a name="1039"><span class="lineNum">    1039 </span>  [<span class="branchCov" title="Branch 0 was taken 9574 times"> + </span><span class="branchCov" title="Branch 1 was taken 7520 times"> + </span><span class="branchCov" title="Branch 2 was taken 9574 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      17094 :         if (wtx.IsCoinBase() || !wallet.chain().checkFinalTx(*wtx.tx)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 9574 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1040"><span class="lineNum">    1040 </span>                :<span class="lineCov">       7520 :             continue;</span></a>
<a name="1041"><span class="lineNum">    1041 </span>                :            :         }</a>
<a name="1042"><span class="lineNum">    1042 </span>                :            : </a>
<a name="1043"><span class="lineNum">    1043 </span>        [<span class="branchCov" title="Branch 0 was taken 9574 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       9574 :         int nDepth = wallet.GetTxDepthInMainChain(wtx);</span></a>
<a name="1044"><span class="lineNum">    1044 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 9568 times"> + </span>]:<span class="lineCov">       9574 :         if (nDepth &lt; nMinDepth)</span></a>
<a name="1045"><span class="lineNum">    1045 </span>                :<span class="lineCov">          6 :             continue;</span></a>
<a name="1046"><span class="lineNum">    1046 </span>                :            : </a>
<a name="1047"><span class="lineNum">    1047 </span>        [<span class="branchCov" title="Branch 0 was taken 19136 times"> + </span><span class="branchCov" title="Branch 1 was taken 9568 times"> + </span>]:<span class="lineCov">      28704 :         for (const CTxOut&amp; txout : wtx.tx-&gt;vout)</span></a>
<a name="1048"><span class="lineNum">    1048 </span>                :            :         {</a>
<a name="1049"><span class="lineNum">    1049 </span>                :<span class="lineCov">      19136 :             CTxDestination address;</span></a>
<a name="1050"><span class="lineNum">    1050 </span>  [<span class="branchCov" title="Branch 0 was taken 19136 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 19136 times"> + </span>]:<span class="lineCov">      19136 :             if (!ExtractDestination(txout.scriptPubKey, address))</span></a>
<a name="1051"><span class="lineNum">    1051 </span>                :<span class="lineNoCov">          0 :                 continue;</span></a>
<a name="1052"><span class="lineNum">    1052 </span>                :            : </a>
<a name="1053"><span class="lineNum">    1053 </span>  [<span class="branchCov" title="Branch 0 was taken 19040 times"> + </span><span class="branchCov" title="Branch 1 was taken 96 times"> + </span><span class="branchCov" title="Branch 2 was taken 19040 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      19136 :             if (has_filtered_address &amp;&amp; !(filtered_address == address)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 278 times"> + </span><span class="branchCov" title="Branch 5 was taken 18762 times"> + </span>]
<a name="1054"><span class="lineNum">    1054 </span>                :<span class="lineCov">      18762 :                 continue;</span></a>
<a name="1055"><span class="lineNum">    1055 </span>                :            :             }</a>
<a name="1056"><span class="lineNum">    1056 </span>                :            : </a>
<a name="1057"><span class="lineNum">    1057 </span>        [<span class="branchCov" title="Branch 0 was taken 374 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        374 :             isminefilter mine = wallet.IsMine(address);</span></a>
<a name="1058"><span class="lineNum">    1058 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchCov" title="Branch 1 was taken 322 times"> + </span>]:<span class="lineCov">        374 :             if(!(mine &amp; filter))</span></a>
<a name="1059"><span class="lineNum">    1059 </span>                :<span class="lineCov">         52 :                 continue;</span></a>
<a name="1060"><span class="lineNum">    1060 </span>                :            : </a>
<a name="1061"><span class="lineNum">    1061 </span>        [<span class="branchCov" title="Branch 0 was taken 322 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        322 :             tallyitem&amp; item = mapTally[address];</span></a>
<a name="1062"><span class="lineNum">    1062 </span>                :<span class="lineCov">        322 :             item.nAmount += txout.nValue;</span></a>
<a name="1063"><span class="lineNum">    1063 </span>        [<span class="branchCov" title="Branch 0 was taken 291 times"> + </span><span class="branchCov" title="Branch 1 was taken 31 times"> + </span>]:<span class="lineCov">        322 :             item.nConf = std::min(item.nConf, nDepth);</span></a>
<a name="1064"><span class="lineNum">    1064 </span>        [<span class="branchCov" title="Branch 0 was taken 322 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        322 :             item.txids.push_back(wtx.GetHash());</span></a>
<a name="1065"><span class="lineNum">    1065 </span>        [<span class="branchCov" title="Branch 0 was taken 184 times"> + </span><span class="branchCov" title="Branch 1 was taken 138 times"> + </span>]:<span class="lineCov">        322 :             if (mine &amp; ISMINE_WATCH_ONLY)</span></a>
<a name="1066"><span class="lineNum">    1066 </span>                :<span class="lineCov">        184 :                 item.fIsWatchonly = true;</span></a>
<a name="1067"><span class="lineNum">    1067 </span>                :            :         }</a>
<a name="1068"><span class="lineNum">    1068 </span>                :            :     }</a>
<a name="1069"><span class="lineNum">    1069 </span>                :            : </a>
<a name="1070"><span class="lineNum">    1070 </span>                :            :     // Reply</a>
<a name="1071"><span class="lineNum">    1071 </span>  [<span class="branchCov" title="Branch 0 was taken 366 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 366 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        366 :     UniValue ret(UniValue::VARR);</span></a>
<a name="1072"><span class="lineNum">    1072 </span>        [<span class="branchCov" title="Branch 0 was taken 334 times"> + </span><span class="branchCov" title="Branch 1 was taken 32 times"> + </span>]:<span class="lineCov">        732 :     std::map&lt;std::string, tallyitem&gt; label_tally;</span></a>
<a name="1073"><span class="lineNum">    1073 </span>                :            : </a>
<a name="1074"><span class="lineNum">    1074 </span>                :            :     // Create m_address_book iterator</a>
<a name="1075"><span class="lineNum">    1075 </span>                :            :     // If we aren't filtering, go from begin() to end()</a>
<a name="1076"><span class="lineNum">    1076 </span>        [<span class="branchCov" title="Branch 0 was taken 334 times"> + </span><span class="branchCov" title="Branch 1 was taken 32 times"> + </span>]:<span class="lineCov">        366 :     auto start = wallet.m_address_book.begin();</span></a>
<a name="1077"><span class="lineNum">    1077 </span>        [<span class="branchCov" title="Branch 0 was taken 334 times"> + </span><span class="branchCov" title="Branch 1 was taken 32 times"> + </span>]:<span class="lineCov">        366 :     auto end = wallet.m_address_book.end();</span></a>
<a name="1078"><span class="lineNum">    1078 </span>                :            :     // If we are filtering, find() the applicable entry</a>
<a name="1079"><span class="lineNum">    1079 </span>        [<span class="branchCov" title="Branch 0 was taken 334 times"> + </span><span class="branchCov" title="Branch 1 was taken 32 times"> + </span>]:<span class="lineCov">        366 :     if (has_filtered_address) {</span></a>
<a name="1080"><span class="lineNum">    1080 </span>        [<span class="branchCov" title="Branch 0 was taken 334 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        334 :         start = wallet.m_address_book.find(filtered_address);</span></a>
<a name="1081"><span class="lineNum">    1081 </span>        [<span class="branchCov" title="Branch 0 was taken 332 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">        334 :         if (start != end) {</span></a>
<a name="1082"><span class="lineNum">    1082 </span>                :<span class="lineCov">        332 :             end = std::next(start);</span></a>
<a name="1083"><span class="lineNum">    1083 </span>                :            :         }</a>
<a name="1084"><span class="lineNum">    1084 </span>                :            :     }</a>
<a name="1085"><span class="lineNum">    1085 </span>                :            : </a>
<a name="1086"><span class="lineNum">    1086 </span>        [<span class="branchCov" title="Branch 0 was taken 492 times"> + </span><span class="branchCov" title="Branch 1 was taken 366 times"> + </span>]:<span class="lineCov">        858 :     for (auto item_it = start; item_it != end; ++item_it)</span></a>
<a name="1087"><span class="lineNum">    1087 </span>                :            :     {</a>
<a name="1088"><span class="lineNum">    1088 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 492 times"> + </span>]:<span class="lineCov">        492 :         if (item_it-&gt;second.IsChange()) continue;</span></a>
<a name="1089"><span class="lineNum">    1089 </span>        [<span class="branchCov" title="Branch 0 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        492 :         const CTxDestination&amp; address = item_it-&gt;first;</span></a>
<a name="1090"><span class="lineNum">    1090 </span>        [<span class="branchCov" title="Branch 0 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        492 :         const std::string&amp; label = item_it-&gt;second.GetLabel();</span></a>
<a name="1091"><span class="lineNum">    1091 </span>        [<span class="branchCov" title="Branch 0 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        492 :         auto it = mapTally.find(address);</span></a>
<a name="1092"><span class="lineNum">    1092 </span>  [<span class="branchCov" title="Branch 0 was taken 228 times"> + </span><span class="branchCov" title="Branch 1 was taken 264 times"> + </span><span class="branchCov" title="Branch 2 was taken 32 times"> + </span><span class="branchCov" title="Branch 3 was taken 196 times"> + </span>]:<span class="lineCov">        492 :         if (it == mapTally.end() &amp;&amp; !fIncludeEmpty)</span></a>
<a name="1093"><span class="lineNum">    1093 </span>                :<span class="lineCov">        196 :             continue;</span></a>
<a name="1094"><span class="lineNum">    1094 </span>                :            : </a>
<a name="1095"><span class="lineNum">    1095 </span>                :<span class="lineCov">        296 :         CAmount nAmount = 0;</span></a>
<a name="1096"><span class="lineNum">    1096 </span>                :<span class="lineCov">        296 :         int nConf = std::numeric_limits&lt;int&gt;::max();</span></a>
<a name="1097"><span class="lineNum">    1097 </span>                :<span class="lineCov">        296 :         bool fIsWatchonly = false;</span></a>
<a name="1098"><span class="lineNum">    1098 </span>        [<span class="branchCov" title="Branch 0 was taken 264 times"> + </span><span class="branchCov" title="Branch 1 was taken 32 times"> + </span>]:<span class="lineCov">        296 :         if (it != mapTally.end())</span></a>
<a name="1099"><span class="lineNum">    1099 </span>                :            :         {</a>
<a name="1100"><span class="lineNum">    1100 </span>                :<span class="lineCov">        264 :             nAmount = (*it).second.nAmount;</span></a>
<a name="1101"><span class="lineNum">    1101 </span>                :<span class="lineCov">        264 :             nConf = (*it).second.nConf;</span></a>
<a name="1102"><span class="lineNum">    1102 </span>                :<span class="lineCov">        264 :             fIsWatchonly = (*it).second.fIsWatchonly;</span></a>
<a name="1103"><span class="lineNum">    1103 </span>                :            :         }</a>
<a name="1104"><span class="lineNum">    1104 </span>                :            : </a>
<a name="1105"><span class="lineNum">    1105 </span>        [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchCov" title="Branch 1 was taken 260 times"> + </span>]:<span class="lineCov">        296 :         if (by_label)</span></a>
<a name="1106"><span class="lineNum">    1106 </span>                :            :         {</a>
<a name="1107"><span class="lineNum">    1107 </span>        [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         36 :             tallyitem&amp; _item = label_tally[label];</span></a>
<a name="1108"><span class="lineNum">    1108 </span>                :<span class="lineCov">         36 :             _item.nAmount += nAmount;</span></a>
<a name="1109"><span class="lineNum">    1109 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         36 :             _item.nConf = std::min(_item.nConf, nConf);</span></a>
<a name="1110"><span class="lineNum">    1110 </span>                :<span class="lineCov">         36 :             _item.fIsWatchonly = fIsWatchonly;</span></a>
<a name="1111"><span class="lineNum">    1111 </span>                :            :         }</a>
<a name="1112"><span class="lineNum">    1112 </span>                :            :         else</a>
<a name="1113"><span class="lineNum">    1113 </span>                :            :         {</a>
<a name="1114"><span class="lineNum">    1114 </span>  [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        520 :             UniValue obj(UniValue::VOBJ);</span></a>
<a name="1115"><span class="lineNum">    1115 </span>        [<span class="branchCov" title="Branch 0 was taken 146 times"> + </span><span class="branchCov" title="Branch 1 was taken 114 times"> + </span>]:<span class="lineCov">        260 :             if(fIsWatchonly)</span></a>
<a name="1116"><span class="lineNum">    1116 </span>  [<span class="branchCov" title="Branch 0 was taken 146 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 146 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        406 :                 obj.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1117"><span class="lineNum">    1117 </span>  [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        520 :             obj.pushKV(&quot;address&quot;,       EncodeDestination(address));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1118"><span class="lineNum">    1118 </span>  [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        520 :             obj.pushKV(&quot;amount&quot;,        ValueFromAmount(nAmount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1119"><span class="lineNum">    1119 </span>  [<span class="branchCov" title="Branch 0 was taken 238 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        758 :             obj.pushKV(&quot;confirmations&quot;, (nConf == std::numeric_limits&lt;int&gt;::max() ? 0 : nConf));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1120"><span class="lineNum">    1120 </span>  [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        520 :             obj.pushKV(&quot;label&quot;, label);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1121"><span class="lineNum">    1121 </span>  [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        520 :             UniValue transactions(UniValue::VARR);</span></a>
<a name="1122"><span class="lineNum">    1122 </span>        [<span class="branchCov" title="Branch 0 was taken 238 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">        260 :             if (it != mapTally.end())</span></a>
<a name="1123"><span class="lineNum">    1123 </span>                :            :             {</a>
<a name="1124"><span class="lineNum">    1124 </span>        [<span class="branchCov" title="Branch 0 was taken 292 times"> + </span><span class="branchCov" title="Branch 1 was taken 238 times"> + </span>]:<span class="lineCov">        530 :                 for (const uint256&amp; _item : (*it).second.txids)</span></a>
<a name="1125"><span class="lineNum">    1125 </span>                :            :                 {</a>
<a name="1126"><span class="lineNum">    1126 </span>  [<span class="branchCov" title="Branch 0 was taken 292 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 292 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        584 :                     transactions.push_back(_item.GetHex());</span></a>
<a name="1127"><span class="lineNum">    1127 </span>                :            :                 }</a>
<a name="1128"><span class="lineNum">    1128 </span>                :            :             }</a>
<a name="1129"><span class="lineNum">    1129 </span>  [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        520 :             obj.pushKV(&quot;txids&quot;, transactions);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1130"><span class="lineNum">    1130 </span>        [<span class="branchCov" title="Branch 0 was taken 260 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        260 :             ret.push_back(obj);</span></a>
<a name="1131"><span class="lineNum">    1131 </span>                :            :         }</a>
<a name="1132"><span class="lineNum">    1132 </span>                :            :     }</a>
<a name="1133"><span class="lineNum">    1133 </span>                :            : </a>
<a name="1134"><span class="lineNum">    1134 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 354 times"> + </span>]:<span class="lineCov">        366 :     if (by_label)</span></a>
<a name="1135"><span class="lineNum">    1135 </span>                :            :     {</a>
<a name="1136"><span class="lineNum">    1136 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>]:<span class="lineCov">         26 :         for (const auto&amp; entry : label_tally)</span></a>
<a name="1137"><span class="lineNum">    1137 </span>                :            :         {</a>
<a name="1138"><span class="lineNum">    1138 </span>                :<span class="lineCov">         14 :             CAmount nAmount = entry.second.nAmount;</span></a>
<a name="1139"><span class="lineNum">    1139 </span>                :<span class="lineCov">         14 :             int nConf = entry.second.nConf;</span></a>
<a name="1140"><span class="lineNum">    1140 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         28 :             UniValue obj(UniValue::VOBJ);</span></a>
<a name="1141"><span class="lineNum">    1141 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>]:<span class="lineCov">         14 :             if (entry.second.fIsWatchonly)</span></a>
<a name="1142"><span class="lineNum">    1142 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         16 :                 obj.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1143"><span class="lineNum">    1143 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         28 :             obj.pushKV(&quot;amount&quot;,        ValueFromAmount(nAmount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1144"><span class="lineNum">    1144 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 10 times"> + </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         32 :             obj.pushKV(&quot;confirmations&quot;, (nConf == std::numeric_limits&lt;int&gt;::max() ? 0 : nConf));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1145"><span class="lineNum">    1145 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         28 :             obj.pushKV(&quot;label&quot;,         entry.first);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1146"><span class="lineNum">    1146 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :             ret.push_back(obj);</span></a>
<a name="1147"><span class="lineNum">    1147 </span>                :            :         }</a>
<a name="1148"><span class="lineNum">    1148 </span>                :            :     }</a>
<a name="1149"><span class="lineNum">    1149 </span>                :            : </a>
<a name="1150"><span class="lineNum">    1150 </span>                :<span class="lineCov">        732 :     return ret;</span></a>
<a name="1151"><span class="lineNum">    1151 </span>                :            : }</a>
<a name="1152"><span class="lineNum">    1152 </span>                :            : </a>
<a name="1153"><span class="lineNum">    1153 </span>                :<span class="lineCov">       1828 : static RPCHelpMan listreceivedbyaddress()</span></a>
<a name="1154"><span class="lineNum">    1154 </span>                :            : {</a>
<a name="1155"><span class="lineNum">    1155 </span>                :<span class="lineCov">       1828 :     return RPCHelpMan{&quot;listreceivedbyaddress&quot;,</span></a>
<a name="1156"><span class="lineNum">    1156 </span>                :            :                 &quot;\nList balances by receiving address.\n&quot;,</a>
<a name="1157"><span class="lineNum">    1157 </span>                :            :                 {</a>
<a name="1158"><span class="lineNum">    1158 </span>        [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3656 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;The minimum number of confirmations before payments are included.&quot;},</span></a>
<a name="1159"><span class="lineNum">    1159 </span>        [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3656 :                     {&quot;include_empty&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Whether to include addresses that haven't received any payments.&quot;},</span></a>
<a name="1160"><span class="lineNum">    1160 </span>        [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3656 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Whether to include watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="1161"><span class="lineNum">    1161 </span>                :<span class="lineCov">       1828 :                     {&quot;address_filter&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;If present, only return information on this address.&quot;},</span></a>
<a name="1162"><span class="lineNum">    1162 </span>                :            :                 },</a>
<a name="1163"><span class="lineNum">    1163 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="1164"><span class="lineNum">    1164 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="1165"><span class="lineNum">    1165 </span>                :            :                     {</a>
<a name="1166"><span class="lineNum">    1166 </span>                :            :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="1167"><span class="lineNum">    1167 </span>                :            :                         {</a>
<a name="1168"><span class="lineNum">    1168 </span>                :            :                             {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /* optional */ true, &quot;Only returns true if imported addresses were involved in transaction&quot;},</a>
<a name="1169"><span class="lineNum">    1169 </span>                :            :                             {RPCResult::Type::STR, &quot;address&quot;, &quot;The receiving address&quot;},</a>
<a name="1170"><span class="lineNum">    1170 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3656 :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount in &quot; + CURRENCY_UNIT + &quot; received by the address&quot;},</span></a>
<a name="1171"><span class="lineNum">    1171 </span>                :            :                             {RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations of the most recent transaction included&quot;},</a>
<a name="1172"><span class="lineNum">    1172 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, &quot;The label of the receiving address. The default label is \&quot;\&quot;&quot;},</a>
<a name="1173"><span class="lineNum">    1173 </span>                :            :                             {RPCResult::Type::ARR, &quot;txids&quot;, &quot;&quot;,</a>
<a name="1174"><span class="lineNum">    1174 </span>                :            :                             {</a>
<a name="1175"><span class="lineNum">    1175 </span>                :            :                                 {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The ids of transactions received with the address&quot;},</a>
<a name="1176"><span class="lineNum">    1176 </span>                :            :                             }},</a>
<a name="1177"><span class="lineNum">    1177 </span>                :            :                         }},</a>
<a name="1178"><span class="lineNum">    1178 </span>                :            :                     }</a>
<a name="1179"><span class="lineNum">    1179 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      21936 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 59 was taken 1828 times"> + </span><span class="branchCov" title="Branch 60 was taken 10968 times"> + </span><span class="branchCov" title="Branch 61 was taken 1828 times"> + </span><span class="branchCov" title="Branch 62 was taken 1828 times"> + </span><span class="branchCov" title="Branch 63 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 64 was not taken"> - </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchNoCov" title="Branch 66 was not taken"> - </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 69 was not taken"> - </span>]
<a name="1180"><span class="lineNum">    1180 </span>                :<span class="lineCov">       1828 :                 RPCExamples{</span></a>
<a name="1181"><span class="lineNum">    1181 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3656 :                     HelpExampleCli(&quot;listreceivedbyaddress&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1182"><span class="lineNum">    1182 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7312 :             + HelpExampleCli(&quot;listreceivedbyaddress&quot;, &quot;6 true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1183"><span class="lineNum">    1183 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7312 :             + HelpExampleRpc(&quot;listreceivedbyaddress&quot;, &quot;6, true, true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1184"><span class="lineNum">    1184 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7312 :             + HelpExampleRpc(&quot;listreceivedbyaddress&quot;, &quot;6, true, true, \&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1828 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="1185"><span class="lineNum">    1185 </span>                :<span class="lineCov">       1828 :                 },</span></a>
<a name="1186"><span class="lineNum">    1186 </span>                :<span class="lineCov">        356 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1187"><span class="lineNum">    1187 </span>                :            : {</a>
<a name="1188"><span class="lineNum">    1188 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 356 times"> + </span>]:<span class="lineCov">        710 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1189"><span class="lineNum">    1189 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 356 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        356 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1190"><span class="lineNum">    1190 </span>                :            : </a>
<a name="1191"><span class="lineNum">    1191 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1192"><span class="lineNum">    1192 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1193"><span class="lineNum">    1193 </span>        [<span class="branchCov" title="Branch 0 was taken 356 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        356 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="1194"><span class="lineNum">    1194 </span>                :            : </a>
<a name="1195"><span class="lineNum">    1195 </span>  [<span class="branchCov" title="Branch 0 was taken 356 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 354 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        712 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1196"><span class="lineNum">    1196 </span>                :            : </a>
<a name="1197"><span class="lineNum">    1197 </span>        [<span class="branchCov" title="Branch 0 was taken 354 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">        356 :     return ListReceived(*pwallet, request.params, false);</span></a>
<a name="1198"><span class="lineNum">    1198 </span>                :            : },</a>
<a name="1199"><span class="lineNum">    1199 </span>  [<span class="branchCov" title="Branch 0 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      31076 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1828 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1828 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 7312 times"> + </span><span class="branchCov" title="Branch 41 was taken 1828 times"> + </span><span class="branchNoCov" title="Branch 42 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 43 was not taken"> - </span>]
<a name="1200"><span class="lineNum">    1200 </span>                :            : }</a>
<a name="1201"><span class="lineNum">    1201 </span>                :            : </a>
<a name="1202"><span class="lineNum">    1202 </span>                :<span class="lineCov">       1484 : static RPCHelpMan listreceivedbylabel()</span></a>
<a name="1203"><span class="lineNum">    1203 </span>                :            : {</a>
<a name="1204"><span class="lineNum">    1204 </span>                :<span class="lineCov">       1484 :     return RPCHelpMan{&quot;listreceivedbylabel&quot;,</span></a>
<a name="1205"><span class="lineNum">    1205 </span>                :            :                 &quot;\nList received transactions by label.\n&quot;,</a>
<a name="1206"><span class="lineNum">    1206 </span>                :            :                 {</a>
<a name="1207"><span class="lineNum">    1207 </span>        [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2968 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;The minimum number of confirmations before payments are included.&quot;},</span></a>
<a name="1208"><span class="lineNum">    1208 </span>        [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2968 :                     {&quot;include_empty&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Whether to include labels that haven't received any payments.&quot;},</span></a>
<a name="1209"><span class="lineNum">    1209 </span>        [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2968 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Whether to include watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="1210"><span class="lineNum">    1210 </span>                :            :                 },</a>
<a name="1211"><span class="lineNum">    1211 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="1212"><span class="lineNum">    1212 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="1213"><span class="lineNum">    1213 </span>                :            :                     {</a>
<a name="1214"><span class="lineNum">    1214 </span>                :            :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="1215"><span class="lineNum">    1215 </span>                :            :                         {</a>
<a name="1216"><span class="lineNum">    1216 </span>                :            :                             {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /* optional */ true, &quot;Only returns true if imported addresses were involved in transaction&quot;},</a>
<a name="1217"><span class="lineNum">    1217 </span>                :            :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount received by addresses with this label&quot;},</a>
<a name="1218"><span class="lineNum">    1218 </span>                :            :                             {RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations of the most recent transaction included&quot;},</a>
<a name="1219"><span class="lineNum">    1219 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, &quot;The label of the receiving address. The default label is \&quot;\&quot;&quot;},</a>
<a name="1220"><span class="lineNum">    1220 </span>                :            :                         }},</a>
<a name="1221"><span class="lineNum">    1221 </span>                :            :                     }</a>
<a name="1222"><span class="lineNum">    1222 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10388 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1484 times"> + </span><span class="branchCov" title="Branch 41 was taken 1484 times"> + </span><span class="branchCov" title="Branch 42 was taken 5936 times"> + </span><span class="branchCov" title="Branch 43 was taken 1484 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 44 was not taken"> - </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>]
<a name="1223"><span class="lineNum">    1223 </span>                :<span class="lineCov">       1484 :                 RPCExamples{</span></a>
<a name="1224"><span class="lineNum">    1224 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2968 :                     HelpExampleCli(&quot;listreceivedbylabel&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1225"><span class="lineNum">    1225 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5936 :             + HelpExampleCli(&quot;listreceivedbylabel&quot;, &quot;6 true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1226"><span class="lineNum">    1226 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5936 :             + HelpExampleRpc(&quot;listreceivedbylabel&quot;, &quot;6, true, true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1227"><span class="lineNum">    1227 </span>                :<span class="lineCov">       1484 :                 },</span></a>
<a name="1228"><span class="lineNum">    1228 </span>                :<span class="lineCov">         12 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1229"><span class="lineNum">    1229 </span>                :            : {</a>
<a name="1230"><span class="lineNum">    1230 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>]:<span class="lineCov">         24 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1231"><span class="lineNum">    1231 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1232"><span class="lineNum">    1232 </span>                :            : </a>
<a name="1233"><span class="lineNum">    1233 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1234"><span class="lineNum">    1234 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1235"><span class="lineNum">    1235 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="1236"><span class="lineNum">    1236 </span>                :            : </a>
<a name="1237"><span class="lineNum">    1237 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         24 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1238"><span class="lineNum">    1238 </span>                :            : </a>
<a name="1239"><span class="lineNum">    1239 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :     return ListReceived(*pwallet, request.params, true);</span></a>
<a name="1240"><span class="lineNum">    1240 </span>                :            : },</a>
<a name="1241"><span class="lineNum">    1241 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      22260 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 4452 times"> + </span><span class="branchCov" title="Branch 33 was taken 1484 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>]
<a name="1242"><span class="lineNum">    1242 </span>                :            : }</a>
<a name="1243"><span class="lineNum">    1243 </span>                :            : </a>
<a name="1244"><span class="lineNum">    1244 </span>                :<span class="lineCov">       3933 : static void MaybePushAddress(UniValue &amp; entry, const CTxDestination &amp;dest)</span></a>
<a name="1245"><span class="lineNum">    1245 </span>                :            : {</a>
<a name="1246"><span class="lineNum">    1246 </span>        [<span class="branchCov" title="Branch 0 was taken 3931 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">       3933 :     if (IsValidDestination(dest)) {</span></a>
<a name="1247"><span class="lineNum">    1247 </span>  [<span class="branchCov" title="Branch 0 was taken 3931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       7862 :         entry.pushKV(&quot;address&quot;, EncodeDestination(dest));</span></a>
<a name="1248"><span class="lineNum">    1248 </span>                :            :     }</a>
<a name="1249"><span class="lineNum">    1249 </span>                :<span class="lineCov">       3933 : }</span></a>
<a name="1250"><span class="lineNum">    1250 </span>                :            : </a>
<a name="1251"><span class="lineNum">    1251 </span>                :            : /**</a>
<a name="1252"><span class="lineNum">    1252 </span>                :            :  * List transactions based on the given criteria.</a>
<a name="1253"><span class="lineNum">    1253 </span>                :            :  *</a>
<a name="1254"><span class="lineNum">    1254 </span>                :            :  * @param  wallet         The wallet.</a>
<a name="1255"><span class="lineNum">    1255 </span>                :            :  * @param  wtx            The wallet transaction.</a>
<a name="1256"><span class="lineNum">    1256 </span>                :            :  * @param  nMinDepth      The minimum confirmation depth.</a>
<a name="1257"><span class="lineNum">    1257 </span>                :            :  * @param  fLong          Whether to include the JSON version of the transaction.</a>
<a name="1258"><span class="lineNum">    1258 </span>                :            :  * @param  ret            The UniValue into which the result is stored.</a>
<a name="1259"><span class="lineNum">    1259 </span>                :            :  * @param  filter_ismine  The &quot;is mine&quot; filter flags.</a>
<a name="1260"><span class="lineNum">    1260 </span>                :            :  * @param  filter_label   Optional label string to filter incoming transactions.</a>
<a name="1261"><span class="lineNum">    1261 </span>                :            :  */</a>
<a name="1262"><span class="lineNum">    1262 </span>                :<span class="lineCov">      18414 : static void ListTransactions(const CWallet&amp; wallet, const CWalletTx&amp; wtx, int nMinDepth, bool fLong, UniValue&amp; ret, const isminefilter&amp; filter_ismine, const std::string* filter_label) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)</span></a>
<a name="1263"><span class="lineNum">    1263 </span>                :            : {</a>
<a name="1264"><span class="lineNum">    1264 </span>                :<span class="lineCov">      18414 :     CAmount nFee;</span></a>
<a name="1265"><span class="lineNum">    1265 </span>        [<span class="branchCov" title="Branch 0 was taken 18414 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      18414 :     std::list&lt;COutputEntry&gt; listReceived;</span></a>
<a name="1266"><span class="lineNum">    1266 </span>                :<span class="lineCov">      18414 :     std::list&lt;COutputEntry&gt; listSent;</span></a>
<a name="1267"><span class="lineNum">    1267 </span>                :            : </a>
<a name="1268"><span class="lineNum">    1268 </span>        [<span class="branchCov" title="Branch 0 was taken 18414 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      18414 :     CachedTxGetAmounts(wallet, wtx, listReceived, listSent, nFee, filter_ismine);</span></a>
<a name="1269"><span class="lineNum">    1269 </span>                :            : </a>
<a name="1270"><span class="lineNum">    1270 </span>        [<span class="branchCov" title="Branch 0 was taken 18414 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      18414 :     bool involvesWatchonly = CachedTxIsFromMe(wallet, wtx, ISMINE_WATCH_ONLY);</span></a>
<a name="1271"><span class="lineNum">    1271 </span>                :            : </a>
<a name="1272"><span class="lineNum">    1272 </span>                :            :     // Sent</a>
<a name="1273"><span class="lineNum">    1273 </span>        [<span class="branchCov" title="Branch 0 was taken 3284 times"> + </span><span class="branchCov" title="Branch 1 was taken 15130 times"> + </span>]:<span class="lineCov">      18414 :     if (!filter_label)</span></a>
<a name="1274"><span class="lineNum">    1274 </span>                :            :     {</a>
<a name="1275"><span class="lineNum">    1275 </span>        [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchCov" title="Branch 1 was taken 3284 times"> + </span>]:<span class="lineCov">       4063 :         for (const COutputEntry&amp; s : listSent)</span></a>
<a name="1276"><span class="lineNum">    1276 </span>                :            :         {</a>
<a name="1277"><span class="lineNum">    1277 </span>  [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1558 :             UniValue entry(UniValue::VOBJ);</span></a>
<a name="1278"><span class="lineNum">    1278 </span>  [<span class="branchCov" title="Branch 0 was taken 778 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchCov" title="Branch 2 was taken 778 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        779 :             if (involvesWatchonly || (wallet.IsMine(s.destination) &amp; ISMINE_WATCH_ONLY)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchCov" title="Branch 5 was taken 770 times"> + </span>]
<a name="1279"><span class="lineNum">    1279 </span>  [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        788 :                 entry.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1280"><span class="lineNum">    1280 </span>                :            :             }</a>
<a name="1281"><span class="lineNum">    1281 </span>        [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        779 :             MaybePushAddress(entry, s.destination);</span></a>
<a name="1282"><span class="lineNum">    1282 </span>  [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1558 :             entry.pushKV(&quot;category&quot;, &quot;send&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1283"><span class="lineNum">    1283 </span>  [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1558 :             entry.pushKV(&quot;amount&quot;, ValueFromAmount(-s.amount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1284"><span class="lineNum">    1284 </span>        [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        779 :             const auto* address_book_entry = wallet.FindAddressBookEntry(s.destination);</span></a>
<a name="1285"><span class="lineNum">    1285 </span>        [<span class="branchCov" title="Branch 0 was taken 289 times"> + </span><span class="branchCov" title="Branch 1 was taken 490 times"> + </span>]:<span class="lineCov">        779 :             if (address_book_entry) {</span></a>
<a name="1286"><span class="lineNum">    1286 </span>  [<span class="branchCov" title="Branch 0 was taken 289 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 289 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1068 :                 entry.pushKV(&quot;label&quot;, address_book_entry-&gt;GetLabel());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1287"><span class="lineNum">    1287 </span>                :            :             }</a>
<a name="1288"><span class="lineNum">    1288 </span>  [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1558 :             entry.pushKV(&quot;vout&quot;, s.vout);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1289"><span class="lineNum">    1289 </span>  [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1558 :             entry.pushKV(&quot;fee&quot;, ValueFromAmount(-nFee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1290"><span class="lineNum">    1290 </span>        [<span class="branchCov" title="Branch 0 was taken 354 times"> + </span><span class="branchCov" title="Branch 1 was taken 425 times"> + </span>]:<span class="lineCov">        779 :             if (fLong)</span></a>
<a name="1291"><span class="lineNum">    1291 </span>        [<span class="branchCov" title="Branch 0 was taken 354 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        354 :                 WalletTxToJSON(wallet, wtx, entry);</span></a>
<a name="1292"><span class="lineNum">    1292 </span>  [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1558 :             entry.pushKV(&quot;abandoned&quot;, wtx.isAbandoned());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1293"><span class="lineNum">    1293 </span>        [<span class="branchCov" title="Branch 0 was taken 779 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        779 :             ret.push_back(entry);</span></a>
<a name="1294"><span class="lineNum">    1294 </span>                :            :         }</a>
<a name="1295"><span class="lineNum">    1295 </span>                :            :     }</a>
<a name="1296"><span class="lineNum">    1296 </span>                :            : </a>
<a name="1297"><span class="lineNum">    1297 </span>                :            :     // Received</a>
<a name="1298"><span class="lineNum">    1298 </span>  [<span class="branchCov" title="Branch 0 was taken 17974 times"> + </span><span class="branchCov" title="Branch 1 was taken 440 times"> + </span><span class="branchCov" title="Branch 2 was taken 17974 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      18414 :     if (listReceived.size() &gt; 0 &amp;&amp; wallet.GetTxDepthInMainChain(wtx) &gt;= nMinDepth) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 17959 times"> + </span><span class="branchCov" title="Branch 5 was taken 15 times"> + </span>]
<a name="1299"><span class="lineNum">    1299 </span>        [<span class="branchCov" title="Branch 0 was taken 18008 times"> + </span><span class="branchCov" title="Branch 1 was taken 17959 times"> + </span>]:<span class="lineCov">      35967 :         for (const COutputEntry&amp; r : listReceived)</span></a>
<a name="1300"><span class="lineNum">    1300 </span>                :            :         {</a>
<a name="1301"><span class="lineNum">    1301 </span>        [<span class="branchCov" title="Branch 0 was taken 18008 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      18008 :             std::string label;</span></a>
<a name="1302"><span class="lineNum">    1302 </span>        [<span class="branchCov" title="Branch 0 was taken 18008 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      18008 :             const auto* address_book_entry = wallet.FindAddressBookEntry(r.destination);</span></a>
<a name="1303"><span class="lineNum">    1303 </span>        [<span class="branchCov" title="Branch 0 was taken 16876 times"> + </span><span class="branchCov" title="Branch 1 was taken 1132 times"> + </span>]:<span class="lineCov">      18008 :             if (address_book_entry) {</span></a>
<a name="1304"><span class="lineNum">    1304 </span>        [<span class="branchCov" title="Branch 0 was taken 16876 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      16876 :                 label = address_book_entry-&gt;GetLabel();</span></a>
<a name="1305"><span class="lineNum">    1305 </span>                :            :             }</a>
<a name="1306"><span class="lineNum">    1306 </span>  [<span class="branchCov" title="Branch 0 was taken 15129 times"> + </span><span class="branchCov" title="Branch 1 was taken 2879 times"> + </span><span class="branchCov" title="Branch 2 was taken 275 times"> + </span><span class="branchCov" title="Branch 3 was taken 14854 times"> + </span>]:<span class="lineCov">      18008 :             if (filter_label &amp;&amp; label != *filter_label) {</span></a>
<a name="1307"><span class="lineNum">    1307 </span>                :<span class="lineCov">      32862 :                 continue;</span></a>
<a name="1308"><span class="lineNum">    1308 </span>                :            :             }</a>
<a name="1309"><span class="lineNum">    1309 </span>  [<span class="branchCov" title="Branch 0 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6308 :             UniValue entry(UniValue::VOBJ);</span></a>
<a name="1310"><span class="lineNum">    1310 </span>  [<span class="branchCov" title="Branch 0 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3154 :             if (involvesWatchonly || (wallet.IsMine(r.destination) &amp; ISMINE_WATCH_ONLY)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 212 times"> + </span><span class="branchCov" title="Branch 5 was taken 2942 times"> + </span>]
<a name="1311"><span class="lineNum">    1311 </span>  [<span class="branchCov" title="Branch 0 was taken 212 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 212 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3366 :                 entry.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1312"><span class="lineNum">    1312 </span>                :            :             }</a>
<a name="1313"><span class="lineNum">    1313 </span>        [<span class="branchCov" title="Branch 0 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3154 :             MaybePushAddress(entry, r.destination);</span></a>
<a name="1314"><span class="lineNum">    1314 </span>        [<span class="branchCov" title="Branch 0 was taken 2381 times"> + </span><span class="branchCov" title="Branch 1 was taken 773 times"> + </span>]:<span class="lineCov">       3154 :             if (wtx.IsCoinBase())</span></a>
<a name="1315"><span class="lineNum">    1315 </span>                :            :             {</a>
<a name="1316"><span class="lineNum">    1316 </span>  [<span class="branchCov" title="Branch 0 was taken 2381 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 406 times"> + </span><span class="branchCov" title="Branch 3 was taken 1975 times"> + </span>]:<span class="lineCov">       2381 :                 if (wallet.GetTxDepthInMainChain(wtx) &lt; 1)</span></a>
<a name="1317"><span class="lineNum">    1317 </span>  [<span class="branchCov" title="Branch 0 was taken 406 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 406 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        406 :                     entry.pushKV(&quot;category&quot;, &quot;orphan&quot;);</span></a>
<a name="1318"><span class="lineNum">    1318 </span>  [<span class="branchCov" title="Branch 0 was taken 1975 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1344 times"> + </span><span class="branchCov" title="Branch 3 was taken 631 times"> + </span>]:<span class="lineCov">       1975 :                 else if (wallet.IsTxImmatureCoinBase(wtx))</span></a>
<a name="1319"><span class="lineNum">    1319 </span>  [<span class="branchCov" title="Branch 0 was taken 1344 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1344 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1344 :                     entry.pushKV(&quot;category&quot;, &quot;immature&quot;);</span></a>
<a name="1320"><span class="lineNum">    1320 </span>                :            :                 else</a>
<a name="1321"><span class="lineNum">    1321 </span>  [<span class="branchCov" title="Branch 0 was taken 631 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 631 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        631 :                     entry.pushKV(&quot;category&quot;, &quot;generate&quot;);</span></a>
<a name="1322"><span class="lineNum">    1322 </span>                :            :             }</a>
<a name="1323"><span class="lineNum">    1323 </span>                :            :             else</a>
<a name="1324"><span class="lineNum">    1324 </span>                :            :             {</a>
<a name="1325"><span class="lineNum">    1325 </span>  [<span class="branchCov" title="Branch 0 was taken 773 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 773 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3927 :                 entry.pushKV(&quot;category&quot;, &quot;receive&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1326"><span class="lineNum">    1326 </span>                :            :             }</a>
<a name="1327"><span class="lineNum">    1327 </span>  [<span class="branchCov" title="Branch 0 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6308 :             entry.pushKV(&quot;amount&quot;, ValueFromAmount(r.amount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1328"><span class="lineNum">    1328 </span>        [<span class="branchCov" title="Branch 0 was taken 2022 times"> + </span><span class="branchCov" title="Branch 1 was taken 1132 times"> + </span>]:<span class="lineCov">       3154 :             if (address_book_entry) {</span></a>
<a name="1329"><span class="lineNum">    1329 </span>  [<span class="branchCov" title="Branch 0 was taken 2022 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2022 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5176 :                 entry.pushKV(&quot;label&quot;, label);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1330"><span class="lineNum">    1330 </span>                :            :             }</a>
<a name="1331"><span class="lineNum">    1331 </span>  [<span class="branchCov" title="Branch 0 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6308 :             entry.pushKV(&quot;vout&quot;, r.vout);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2946 times"> + </span><span class="branchCov" title="Branch 5 was taken 208 times"> + </span>]
<a name="1332"><span class="lineNum">    1332 </span>        [<span class="branchCov" title="Branch 0 was taken 2946 times"> + </span><span class="branchCov" title="Branch 1 was taken 208 times"> + </span>]:<span class="lineCov">       3154 :             if (fLong)</span></a>
<a name="1333"><span class="lineNum">    1333 </span>        [<span class="branchCov" title="Branch 0 was taken 2946 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2946 :                 WalletTxToJSON(wallet, wtx, entry);</span></a>
<a name="1334"><span class="lineNum">    1334 </span>        [<span class="branchCov" title="Branch 0 was taken 3154 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3154 :             ret.push_back(entry);</span></a>
<a name="1335"><span class="lineNum">    1335 </span>                :            :         }</a>
<a name="1336"><span class="lineNum">    1336 </span>                :            :     }</a>
<a name="1337"><span class="lineNum">    1337 </span>                :<span class="lineCov">      18414 : }</span></a>
<a name="1338"><span class="lineNum">    1338 </span>                :            : </a>
<a name="1339"><span class="lineNum">    1339 </span>                :<span class="lineCov">       5365 : static const std::vector&lt;RPCResult&gt; TransactionDescriptionString()</span></a>
<a name="1340"><span class="lineNum">    1340 </span>                :            : {</a>
<a name="1341"><span class="lineNum">    1341 </span>                :<span class="lineCov">       5365 :     return{{RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations for the transaction. Negative confirmations means the\n&quot;</span></a>
<a name="1342"><span class="lineNum">    1342 </span>                :            :                &quot;transaction conflicted that many blocks ago.&quot;},</a>
<a name="1343"><span class="lineNum">    1343 </span>                :            :            {RPCResult::Type::BOOL, &quot;generated&quot;, /* optional */ true, &quot;Only present if the transaction's only input is a coinbase one.&quot;},</a>
<a name="1344"><span class="lineNum">    1344 </span>                :            :            {RPCResult::Type::BOOL, &quot;trusted&quot;, /* optional */ true, &quot;Whether we consider the transaction to be trusted and safe to spend from.\n&quot;</a>
<a name="1345"><span class="lineNum">    1345 </span>                :            :                 &quot;Only present when the transaction has 0 confirmations (or negative confirmations, if conflicted).&quot;},</a>
<a name="1346"><span class="lineNum">    1346 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;blockhash&quot;, /* optional */ true, &quot;The block hash containing the transaction.&quot;},</a>
<a name="1347"><span class="lineNum">    1347 </span>                :            :            {RPCResult::Type::NUM, &quot;blockheight&quot;, /* optional */ true, &quot;The block height containing the transaction.&quot;},</a>
<a name="1348"><span class="lineNum">    1348 </span>                :            :            {RPCResult::Type::NUM, &quot;blockindex&quot;, /* optional */ true, &quot;The index of the transaction in the block that includes it.&quot;},</a>
<a name="1349"><span class="lineNum">    1349 </span>  [<span class="branchCov" title="Branch 0 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      10730 :            {RPCResult::Type::NUM_TIME, &quot;blocktime&quot;, /* optional */ true, &quot;The block time expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="1350"><span class="lineNum">    1350 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id.&quot;},</a>
<a name="1351"><span class="lineNum">    1351 </span>                :            :            {RPCResult::Type::ARR, &quot;walletconflicts&quot;, &quot;Conflicting transaction ids.&quot;,</a>
<a name="1352"><span class="lineNum">    1352 </span>                :            :            {</a>
<a name="1353"><span class="lineNum">    1353 </span>                :            :                {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id.&quot;},</a>
<a name="1354"><span class="lineNum">    1354 </span>                :            :            }},</a>
<a name="1355"><span class="lineNum">    1355 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;replaced_by_txid&quot;, /* optional */ true, &quot;The txid if this tx was replaced.&quot;},</a>
<a name="1356"><span class="lineNum">    1356 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;replaces_txid&quot;, /* optional */ true, &quot;The txid if the tx replaces one.&quot;},</a>
<a name="1357"><span class="lineNum">    1357 </span>                :            :            {RPCResult::Type::STR, &quot;comment&quot;, /* optional */ true, &quot;&quot;},</a>
<a name="1358"><span class="lineNum">    1358 </span>                :            :            {RPCResult::Type::STR, &quot;to&quot;, /* optional */ true, &quot;If a comment to is associated with the transaction.&quot;},</a>
<a name="1359"><span class="lineNum">    1359 </span>  [<span class="branchCov" title="Branch 0 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      10730 :            {RPCResult::Type::NUM_TIME, &quot;time&quot;, &quot;The transaction time expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="1360"><span class="lineNum">    1360 </span>  [<span class="branchCov" title="Branch 0 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      10730 :            {RPCResult::Type::NUM_TIME, &quot;timereceived&quot;, &quot;The time received expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="1361"><span class="lineNum">    1361 </span>                :            :            {RPCResult::Type::STR, &quot;comment&quot;, /* optional */ true, &quot;If a comment is associated with the transaction, only present if not empty.&quot;},</a>
<a name="1362"><span class="lineNum">    1362 </span>                :            :            {RPCResult::Type::STR, &quot;bip125-replaceable&quot;, &quot;(\&quot;yes|no|unknown\&quot;) Whether this transaction could be replaced due to BIP125 (replace-by-fee);\n&quot;</a>
<a name="1363"><span class="lineNum">    1363 </span>  [<span class="branchCov" title="Branch 0 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">     139490 :                &quot;may be unknown for unconfirmed transactions not in the mempool.&quot;}};</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 5365 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 91205 times"> + </span><span class="branchCov" title="Branch 105 was taken 5365 times"> + </span><span class="branchCov" title="Branch 106 was taken 5365 times"> + </span><span class="branchCov" title="Branch 107 was taken 5365 times"> + </span><span class="branchNoCov" title="Branch 108 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchNoCov" title="Branch 110 was not taken"> - </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span>]
<a name="1364"><span class="lineNum">    1364 </span>                :            : }</a>
<a name="1365"><span class="lineNum">    1365 </span>                :            : </a>
<a name="1366"><span class="lineNum">    1366 </span>                :<span class="lineCov">       1909 : static RPCHelpMan listtransactions()</span></a>
<a name="1367"><span class="lineNum">    1367 </span>                :            : {</a>
<a name="1368"><span class="lineNum">    1368 </span>                :<span class="lineCov">       1909 :     return RPCHelpMan{&quot;listtransactions&quot;,</span></a>
<a name="1369"><span class="lineNum">    1369 </span>                :            :                 &quot;\nIf a label name is provided, this will return only incoming transactions paying to addresses with the specified label.\n&quot;</a>
<a name="1370"><span class="lineNum">    1370 </span>                :            :                 &quot;\nReturns up to 'count' most recent transactions skipping the first 'from' transactions.\n&quot;,</a>
<a name="1371"><span class="lineNum">    1371 </span>                :            :                 {</a>
<a name="1372"><span class="lineNum">    1372 </span>                :<span class="lineCov">       1909 :                     {&quot;label|dummy&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;If set, should be a valid label name to return only incoming transactions\n&quot;</span></a>
<a name="1373"><span class="lineNum">    1373 </span>                :            :                           &quot;with the specified label, or \&quot;*\&quot; to disable filtering and return all transactions.&quot;},</a>
<a name="1374"><span class="lineNum">    1374 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3818 :                     {&quot;count&quot;, RPCArg::Type::NUM, RPCArg::Default{10}, &quot;The number of transactions to return&quot;},</span></a>
<a name="1375"><span class="lineNum">    1375 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3818 :                     {&quot;skip&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;The number of transactions to skip&quot;},</span></a>
<a name="1376"><span class="lineNum">    1376 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3818 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Include transactions to watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="1377"><span class="lineNum">    1377 </span>                :            :                 },</a>
<a name="1378"><span class="lineNum">    1378 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="1379"><span class="lineNum">    1379 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="1380"><span class="lineNum">    1380 </span>                :            :                     {</a>
<a name="1381"><span class="lineNum">    1381 </span>                :<span class="lineCov">       1909 :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(Cat&lt;std::vector&lt;RPCResult&gt;&gt;(</span></a>
<a name="1382"><span class="lineNum">    1382 </span>                :            :                         {</a>
<a name="1383"><span class="lineNum">    1383 </span>                :            :                             {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /* optional */ true, &quot;Only returns true if imported addresses were involved in transaction.&quot;},</a>
<a name="1384"><span class="lineNum">    1384 </span>                :            :                             {RPCResult::Type::STR, &quot;address&quot;, &quot;The bitcoin address of the transaction.&quot;},</a>
<a name="1385"><span class="lineNum">    1385 </span>                :            :                             {RPCResult::Type::STR, &quot;category&quot;, &quot;The transaction category.\n&quot;</a>
<a name="1386"><span class="lineNum">    1386 </span>                :            :                                 &quot;\&quot;send\&quot;                  Transactions sent.\n&quot;</a>
<a name="1387"><span class="lineNum">    1387 </span>                :            :                                 &quot;\&quot;receive\&quot;               Non-coinbase transactions received.\n&quot;</a>
<a name="1388"><span class="lineNum">    1388 </span>                :            :                                 &quot;\&quot;generate\&quot;              Coinbase transactions received with more than 100 confirmations.\n&quot;</a>
<a name="1389"><span class="lineNum">    1389 </span>                :            :                                 &quot;\&quot;immature\&quot;              Coinbase transactions received with 100 or fewer confirmations.\n&quot;</a>
<a name="1390"><span class="lineNum">    1390 </span>                :            :                                 &quot;\&quot;orphan\&quot;                Orphaned coinbase transactions received.&quot;},</a>
<a name="1391"><span class="lineNum">    1391 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3818 :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT + &quot;. This is negative for the 'send' category, and is positive\n&quot;</span></a>
<a name="1392"><span class="lineNum">    1392 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1909 :                                 &quot;for all other categories&quot;},</span></a>
<a name="1393"><span class="lineNum">    1393 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, /* optional */ true, &quot;A comment for the address/transaction, if any&quot;},</a>
<a name="1394"><span class="lineNum">    1394 </span>                :            :                             {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="1395"><span class="lineNum">    1395 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3818 :                             {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /* optional */ true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the\n&quot;</span></a>
<a name="1396"><span class="lineNum">    1396 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1909 :                                  &quot;'send' category of transactions.&quot;},</span></a>
<a name="1397"><span class="lineNum">    1397 </span>                :            :                         },</a>
<a name="1398"><span class="lineNum">    1398 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      24817 :                         TransactionDescriptionString()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 44 was taken 13363 times"> + </span><span class="branchCov" title="Branch 45 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>]
<a name="1399"><span class="lineNum">    1399 </span>                :            :                         {</a>
<a name="1400"><span class="lineNum">    1400 </span>                :            :                             {RPCResult::Type::BOOL, &quot;abandoned&quot;, /* optional */ true, &quot;'true' if the transaction has been abandoned (inputs are respendable). Only available for the \n&quot;</a>
<a name="1401"><span class="lineNum">    1401 </span>                :            :                                  &quot;'send' category of transactions.&quot;},</a>
<a name="1402"><span class="lineNum">    1402 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7636 :                         })},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1909 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1909 times"> + </span><span class="branchCov" title="Branch 11 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="1403"><span class="lineNum">    1403 </span>                :            :                     }</a>
<a name="1404"><span class="lineNum">    1404 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9545 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1909 times"> + </span><span class="branchCov" title="Branch 15 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="1405"><span class="lineNum">    1405 </span>                :<span class="lineCov">       1909 :                 RPCExamples{</span></a>
<a name="1406"><span class="lineNum">    1406 </span>                :            :             &quot;\nList the most recent 10 transactions in the systems\n&quot;</a>
<a name="1407"><span class="lineNum">    1407 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3818 :             + HelpExampleCli(&quot;listtransactions&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1408"><span class="lineNum">    1408 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1909 :             &quot;\nList transactions 100 to 120\n&quot;</span></a>
<a name="1409"><span class="lineNum">    1409 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7636 :             + HelpExampleCli(&quot;listtransactions&quot;, &quot;\&quot;*\&quot; 20 100&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1410"><span class="lineNum">    1410 </span>        [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1909 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="1411"><span class="lineNum">    1411 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7636 :             + HelpExampleRpc(&quot;listtransactions&quot;, &quot;\&quot;*\&quot;, 20, 100&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1412"><span class="lineNum">    1412 </span>                :<span class="lineCov">       1909 :                 },</span></a>
<a name="1413"><span class="lineNum">    1413 </span>                :<span class="lineCov">        437 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1414"><span class="lineNum">    1414 </span>                :            : {</a>
<a name="1415"><span class="lineNum">    1415 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 437 times"> + </span>]:<span class="lineCov">        874 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1416"><span class="lineNum">    1416 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        437 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1417"><span class="lineNum">    1417 </span>                :            : </a>
<a name="1418"><span class="lineNum">    1418 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1419"><span class="lineNum">    1419 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1420"><span class="lineNum">    1420 </span>        [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        437 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="1421"><span class="lineNum">    1421 </span>                :            : </a>
<a name="1422"><span class="lineNum">    1422 </span>                :<span class="lineCov">        437 :     const std::string* filter_label = nullptr;</span></a>
<a name="1423"><span class="lineNum">    1423 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 340 times"> + </span><span class="branchCov" title="Branch 3 was taken 97 times"> + </span> :<span class="lineCov">        437 :     if (!request.params[0].isNull() &amp;&amp; request.params[0].get_str() != &quot;*&quot;) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 340 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 340 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 330 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 10 times"> + </span>]
<a name="1424"><span class="lineNum">    1424 </span>  [<span class="branchCov" title="Branch 0 was taken 330 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 330 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        330 :         filter_label = &amp;request.params[0].get_str();</span></a>
<a name="1425"><span class="lineNum">    1425 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 330 times"> + </span>]:<span class="lineCov">        330 :         if (filter_label-&gt;empty()) {</span></a>
<a name="1426"><span class="lineNum">    1426 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Label argument must be a valid label name or \&quot;*\&quot;.&quot;);</span></a>
<a name="1427"><span class="lineNum">    1427 </span>                :            :         }</a>
<a name="1428"><span class="lineNum">    1428 </span>                :            :     }</a>
<a name="1429"><span class="lineNum">    1429 </span>                :<span class="lineCov">        437 :     int nCount = 10;</span></a>
<a name="1430"><span class="lineNum">    1430 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 340 times"> + </span><span class="branchCov" title="Branch 3 was taken 97 times"> + </span>]:<span class="lineCov">        437 :     if (!request.params[1].isNull())</span></a>
<a name="1431"><span class="lineNum">    1431 </span>  [<span class="branchCov" title="Branch 0 was taken 340 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 340 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        340 :         nCount = request.params[1].get_int();</span></a>
<a name="1432"><span class="lineNum">    1432 </span>                :<span class="lineCov">        437 :     int nFrom = 0;</span></a>
<a name="1433"><span class="lineNum">    1433 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchCov" title="Branch 3 was taken 425 times"> + </span>]:<span class="lineCov">        437 :     if (!request.params[2].isNull())</span></a>
<a name="1434"><span class="lineNum">    1434 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         nFrom = request.params[2].get_int();</span></a>
<a name="1435"><span class="lineNum">    1435 </span>                :<span class="lineCov">        437 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="1436"><span class="lineNum">    1436 </span>                :            : </a>
<a name="1437"><span class="lineNum">    1437 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        437 :     if (ParseIncludeWatchonly(request.params[3], *pwallet)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 348 times"> + </span><span class="branchCov" title="Branch 5 was taken 89 times"> + </span>]
<a name="1438"><span class="lineNum">    1438 </span>                :<span class="lineCov">        348 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="1439"><span class="lineNum">    1439 </span>                :            :     }</a>
<a name="1440"><span class="lineNum">    1440 </span>                :            : </a>
<a name="1441"><span class="lineNum">    1441 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 437 times"> + </span>]:<span class="lineCov">        437 :     if (nCount &lt; 0)</span></a>
<a name="1442"><span class="lineNum">    1442 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Negative count&quot;);</span></a>
<a name="1443"><span class="lineNum">    1443 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 437 times"> + </span>]:<span class="lineCov">        437 :     if (nFrom &lt; 0)</span></a>
<a name="1444"><span class="lineNum">    1444 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Negative from&quot;);</span></a>
<a name="1445"><span class="lineNum">    1445 </span>                :            : </a>
<a name="1446"><span class="lineNum">    1446 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        874 :     UniValue ret(UniValue::VARR);</span></a>
<a name="1447"><span class="lineNum">    1447 </span>                :            : </a>
<a name="1448"><span class="lineNum">    1448 </span>                :<span class="lineCov">        437 :     {</span></a>
<a name="1449"><span class="lineNum">    1449 </span>        [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        437 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1450"><span class="lineNum">    1450 </span>                :            : </a>
<a name="1451"><span class="lineNum">    1451 </span>                :<span class="lineCov">        437 :         const CWallet::TxItems &amp; txOrdered = pwallet-&gt;wtxOrdered;</span></a>
<a name="1452"><span class="lineNum">    1452 </span>                :            : </a>
<a name="1453"><span class="lineNum">    1453 </span>                :            :         // iterate backwards until we have nCount items to return:</a>
<a name="1454"><span class="lineNum">    1454 </span>        [<span class="branchCov" title="Branch 0 was taken 16566 times"> + </span><span class="branchCov" title="Branch 1 was taken 365 times"> + </span>]:<span class="lineCov">      16931 :         for (CWallet::TxItems::const_reverse_iterator it = txOrdered.rbegin(); it != txOrdered.rend(); ++it)</span></a>
<a name="1455"><span class="lineNum">    1455 </span>                :            :         {</a>
<a name="1456"><span class="lineNum">    1456 </span>                :<span class="lineCov">      16566 :             CWalletTx *const pwtx = (*it).second;</span></a>
<a name="1457"><span class="lineNum">    1457 </span>        [<span class="branchCov" title="Branch 0 was taken 16566 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      16566 :             ListTransactions(*pwallet, *pwtx, 0, true, ret, filter, filter_label);</span></a>
<a name="1458"><span class="lineNum">    1458 </span>        [<span class="branchCov" title="Branch 0 was taken 16494 times"> + </span><span class="branchCov" title="Branch 1 was taken 72 times"> + </span>]:<span class="lineCov">      16566 :             if ((int)ret.size() &gt;= (nCount+nFrom)) break;</span></a>
<a name="1459"><span class="lineNum">    1459 </span>                :            :         }</a>
<a name="1460"><span class="lineNum">    1460 </span>                :            :     }</a>
<a name="1461"><span class="lineNum">    1461 </span>                :            : </a>
<a name="1462"><span class="lineNum">    1462 </span>                :            :     // ret is newest to oldest</a>
<a name="1463"><span class="lineNum">    1463 </span>                :            : </a>
<a name="1464"><span class="lineNum">    1464 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 437 times"> + </span>]:<span class="lineCov">        437 :     if (nFrom &gt; (int)ret.size())</span></a>
<a name="1465"><span class="lineNum">    1465 </span>                :<span class="lineNoCov">          0 :         nFrom = ret.size();</span></a>
<a name="1466"><span class="lineNum">    1466 </span>        [<span class="branchCov" title="Branch 0 was taken 365 times"> + </span><span class="branchCov" title="Branch 1 was taken 72 times"> + </span>]:<span class="lineCov">        437 :     if ((nFrom + nCount) &gt; (int)ret.size())</span></a>
<a name="1467"><span class="lineNum">    1467 </span>                :<span class="lineCov">        365 :         nCount = ret.size() - nFrom;</span></a>
<a name="1468"><span class="lineNum">    1468 </span>                :            : </a>
<a name="1469"><span class="lineNum">    1469 </span>        [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        437 :     const std::vector&lt;UniValue&gt;&amp; txs = ret.getValues();</span></a>
<a name="1470"><span class="lineNum">    1470 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        874 :     UniValue result{UniValue::VARR};</span></a>
<a name="1471"><span class="lineNum">    1471 </span>  [<span class="branchCov" title="Branch 0 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 437 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        437 :     result.push_backV({ txs.rend() - nFrom - nCount, txs.rend() - nFrom }); // Return oldest to newest</span></a>
<a name="1472"><span class="lineNum">    1472 </span>                :<span class="lineCov">        437 :     return result;</span></a>
<a name="1473"><span class="lineNum">    1473 </span>                :            : },</a>
<a name="1474"><span class="lineNum">    1474 </span>  [<span class="branchCov" title="Branch 0 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      32453 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1909 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1909 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 7636 times"> + </span><span class="branchCov" title="Branch 41 was taken 1909 times"> + </span><span class="branchNoCov" title="Branch 42 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 43 was not taken"> - </span>]
<a name="1475"><span class="lineNum">    1475 </span>                :            : }</a>
<a name="1476"><span class="lineNum">    1476 </span>                :            : </a>
<a name="1477"><span class="lineNum">    1477 </span>                :<span class="lineCov">       1524 : static RPCHelpMan listsinceblock()</span></a>
<a name="1478"><span class="lineNum">    1478 </span>                :            : {</a>
<a name="1479"><span class="lineNum">    1479 </span>                :<span class="lineCov">       1524 :     return RPCHelpMan{&quot;listsinceblock&quot;,</span></a>
<a name="1480"><span class="lineNum">    1480 </span>                :            :                 &quot;\nGet all transactions in blocks since block [blockhash], or all transactions if omitted.\n&quot;</a>
<a name="1481"><span class="lineNum">    1481 </span>                :            :                 &quot;If \&quot;blockhash\&quot; is no longer a part of the main chain, transactions from the fork point onward are included.\n&quot;</a>
<a name="1482"><span class="lineNum">    1482 </span>                :            :                 &quot;Additionally, if include_removed is set, transactions affecting the wallet which were removed are returned in the \&quot;removed\&quot; array.\n&quot;,</a>
<a name="1483"><span class="lineNum">    1483 </span>                :            :                 {</a>
<a name="1484"><span class="lineNum">    1484 </span>                :<span class="lineCov">       1524 :                     {&quot;blockhash&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;If set, the block hash to list transactions since, otherwise list all transactions.&quot;},</span></a>
<a name="1485"><span class="lineNum">    1485 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3048 :                     {&quot;target_confirmations&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;Return the nth block hash from the main chain. e.g. 1 would mean the best block hash. Note: this is not used as a filter, but only affects [lastblock] in the return value&quot;},</span></a>
<a name="1486"><span class="lineNum">    1486 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3048 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Include transactions to watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="1487"><span class="lineNum">    1487 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3048 :                     {&quot;include_removed&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Show transactions that were removed due to a reorg in the \&quot;removed\&quot; array\n&quot;</span></a>
<a name="1488"><span class="lineNum">    1488 </span>                :            :                                                                        &quot;(not guaranteed to work on pruned nodes)&quot;},</a>
<a name="1489"><span class="lineNum">    1489 </span>                :            :                 },</a>
<a name="1490"><span class="lineNum">    1490 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="1491"><span class="lineNum">    1491 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="1492"><span class="lineNum">    1492 </span>                :            :                     {</a>
<a name="1493"><span class="lineNum">    1493 </span>                :            :                         {RPCResult::Type::ARR, &quot;transactions&quot;, &quot;&quot;,</a>
<a name="1494"><span class="lineNum">    1494 </span>                :            :                         {</a>
<a name="1495"><span class="lineNum">    1495 </span>                :<span class="lineCov">       1524 :                             {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(Cat&lt;std::vector&lt;RPCResult&gt;&gt;(</span></a>
<a name="1496"><span class="lineNum">    1496 </span>                :            :                             {</a>
<a name="1497"><span class="lineNum">    1497 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /* optional */ true, &quot;Only returns true if imported addresses were involved in transaction.&quot;},</a>
<a name="1498"><span class="lineNum">    1498 </span>                :            :                                 {RPCResult::Type::STR, &quot;address&quot;, &quot;The bitcoin address of the transaction.&quot;},</a>
<a name="1499"><span class="lineNum">    1499 </span>                :            :                                 {RPCResult::Type::STR, &quot;category&quot;, &quot;The transaction category.\n&quot;</a>
<a name="1500"><span class="lineNum">    1500 </span>                :            :                                     &quot;\&quot;send\&quot;                  Transactions sent.\n&quot;</a>
<a name="1501"><span class="lineNum">    1501 </span>                :            :                                     &quot;\&quot;receive\&quot;               Non-coinbase transactions received.\n&quot;</a>
<a name="1502"><span class="lineNum">    1502 </span>                :            :                                     &quot;\&quot;generate\&quot;              Coinbase transactions received with more than 100 confirmations.\n&quot;</a>
<a name="1503"><span class="lineNum">    1503 </span>                :            :                                     &quot;\&quot;immature\&quot;              Coinbase transactions received with 100 or fewer confirmations.\n&quot;</a>
<a name="1504"><span class="lineNum">    1504 </span>                :            :                                     &quot;\&quot;orphan\&quot;                Orphaned coinbase transactions received.&quot;},</a>
<a name="1505"><span class="lineNum">    1505 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3048 :                                 {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT + &quot;. This is negative for the 'send' category, and is positive\n&quot;</span></a>
<a name="1506"><span class="lineNum">    1506 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1524 :                                     &quot;for all other categories&quot;},</span></a>
<a name="1507"><span class="lineNum">    1507 </span>                :            :                                 {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="1508"><span class="lineNum">    1508 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3048 :                                 {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /* optional */ true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the\n&quot;</span></a>
<a name="1509"><span class="lineNum">    1509 </span>        [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1524 :                                      &quot;'send' category of transactions.&quot;},</span></a>
<a name="1510"><span class="lineNum">    1510 </span>                :            :                             },</a>
<a name="1511"><span class="lineNum">    1511 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      18288 :                             TransactionDescriptionString()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 9144 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 39 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>]
<a name="1512"><span class="lineNum">    1512 </span>                :            :                             {</a>
<a name="1513"><span class="lineNum">    1513 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;abandoned&quot;, /* optional */ true, &quot;'true' if the transaction has been abandoned (inputs are respendable). Only available for the \n&quot;</a>
<a name="1514"><span class="lineNum">    1514 </span>                :            :                                      &quot;'send' category of transactions.&quot;},</a>
<a name="1515"><span class="lineNum">    1515 </span>                :            :                                 {RPCResult::Type::STR, &quot;label&quot;, /* optional */ true, &quot;A comment for the address/transaction, if any&quot;},</a>
<a name="1516"><span class="lineNum">    1516 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7620 :                             })},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3048 times"> + </span><span class="branchCov" title="Branch 17 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="1517"><span class="lineNum">    1517 </span>                :            :                         }},</a>
<a name="1518"><span class="lineNum">    1518 </span>                :            :                         {RPCResult::Type::ARR, &quot;removed&quot;, /* optional */ true, &quot;&lt;structure is the same as \&quot;transactions\&quot; above, only present if include_removed=true&gt;\n&quot;</a>
<a name="1519"><span class="lineNum">    1519 </span>                :            :                             &quot;Note: transactions that were re-added in the active chain will appear as-is in this array, and may thus have a positive confirmation count.&quot;</a>
<a name="1520"><span class="lineNum">    1520 </span>                :            :                         , {{RPCResult::Type::ELISION, &quot;&quot;, &quot;&quot;},}},</a>
<a name="1521"><span class="lineNum">    1521 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;lastblock&quot;, &quot;The hash of the block (target_confirmations-1) from the best block on the main chain, or the genesis hash if the referenced block does not exist yet. This is typically used to feed back into listsinceblock the next time you call it. So you would generally use a target_confirmations of say 6, so you will be continually re-notified of transactions until they've reached 6 confirmations plus any new ones&quot;},</a>
<a name="1522"><span class="lineNum">    1522 </span>                :            :                     }</a>
<a name="1523"><span class="lineNum">    1523 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      13716 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 4572 times"> + </span><span class="branchCov" title="Branch 43 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1524 times"> + </span><span class="branchCov" title="Branch 45 was taken 1524 times"> + </span><span class="branchCov" title="Branch 46 was taken 1524 times"> + </span><span class="branchCov" title="Branch 47 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 48 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchNoCov" title="Branch 52 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 53 was not taken"> - </span>]
<a name="1524"><span class="lineNum">    1524 </span>                :<span class="lineCov">       1524 :                 RPCExamples{</span></a>
<a name="1525"><span class="lineNum">    1525 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3048 :                     HelpExampleCli(&quot;listsinceblock&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1526"><span class="lineNum">    1526 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6096 :             + HelpExampleCli(&quot;listsinceblock&quot;, &quot;\&quot;000000000000000bacf66f7497b7dc45ef753ee9a7d38571037cdb1a57f663ad\&quot; 6&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1527"><span class="lineNum">    1527 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6096 :             + HelpExampleRpc(&quot;listsinceblock&quot;, &quot;\&quot;000000000000000bacf66f7497b7dc45ef753ee9a7d38571037cdb1a57f663ad\&quot;, 6&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1528"><span class="lineNum">    1528 </span>                :<span class="lineCov">       1524 :                 },</span></a>
<a name="1529"><span class="lineNum">    1529 </span>                :<span class="lineCov">         52 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1530"><span class="lineNum">    1530 </span>                :            : {</a>
<a name="1531"><span class="lineNum">    1531 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 52 times"> + </span>]:<span class="lineCov">         94 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1532"><span class="lineNum">    1532 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         52 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1533"><span class="lineNum">    1533 </span>                :            : </a>
<a name="1534"><span class="lineNum">    1534 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         52 :     const CWallet&amp; wallet = *pwallet;</span></a>
<a name="1535"><span class="lineNum">    1535 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1536"><span class="lineNum">    1536 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1537"><span class="lineNum">    1537 </span>        [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         52 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="1538"><span class="lineNum">    1538 </span>                :            : </a>
<a name="1539"><span class="lineNum">    1539 </span>  [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        104 :     LOCK(wallet.cs_wallet);</span></a>
<a name="1540"><span class="lineNum">    1540 </span>                :            : </a>
<a name="1541"><span class="lineNum">    1541 </span>                :<span class="lineCov">         52 :     std::optional&lt;int&gt; height;    // Height of the specified block or the common ancestor, if the block provided was in a deactivated chain.</span></a>
<a name="1542"><span class="lineNum">    1542 </span>                :<span class="lineCov">         52 :     std::optional&lt;int&gt; altheight; // Height of the specified block, even if it's in a deactivated chain.</span></a>
<a name="1543"><span class="lineNum">    1543 </span>                :<span class="lineCov">         52 :     int target_confirms = 1;</span></a>
<a name="1544"><span class="lineNum">    1544 </span>                :<span class="lineCov">         52 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="1545"><span class="lineNum">    1545 </span>                :            : </a>
<a name="1546"><span class="lineNum">    1546 </span>                :<span class="lineCov">         52 :     uint256 blockId;</span></a>
<a name="1547"><span class="lineNum">    1547 </span>  [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 32 times"> + </span><span class="branchCov" title="Branch 3 was taken 20 times"> + </span> :<span class="lineCov">         52 :     if (!request.params[0].isNull() &amp;&amp; !request.params[0].get_str().empty()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 30 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 2 times"> + </span>]
<a name="1548"><span class="lineNum">    1548 </span>  [<span class="branchCov" title="Branch 0 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         60 :         blockId = ParseHashV(request.params[0], &quot;blockhash&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 26 times"> + </span><span class="branchCov" title="Branch 5 was taken 4 times"> + </span>]
<a name="1549"><span class="lineNum">    1549 </span>                :<span class="lineCov">         26 :         height = int{};</span></a>
<a name="1550"><span class="lineNum">    1550 </span>                :<span class="lineCov">         26 :         altheight = int{};</span></a>
<a name="1551"><span class="lineNum">    1551 </span>  [<span class="branchCov" title="Branch 0 was taken 26 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 22 times"> + </span>]:<span class="lineCov">         26 :         if (!wallet.chain().findCommonAncestor(blockId, wallet.GetLastBlockHash(), /* ancestor out */ FoundBlock().height(*height), /* blockId out */ FoundBlock().height(*altheight))) {</span></a>
<a name="1552"><span class="lineNum">    1552 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Block not found&quot;);</span></a>
<a name="1553"><span class="lineNum">    1553 </span>                :            :         }</a>
<a name="1554"><span class="lineNum">    1554 </span>                :            :     }</a>
<a name="1555"><span class="lineNum">    1555 </span>                :            : </a>
<a name="1556"><span class="lineNum">    1556 </span>  [<span class="branchCov" title="Branch 0 was taken 44 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 38 times"> + </span>]:<span class="lineCov">         44 :     if (!request.params[1].isNull()) {</span></a>
<a name="1557"><span class="lineNum">    1557 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         target_confirms = request.params[1].get_int();</span></a>
<a name="1558"><span class="lineNum">    1558 </span>                :            : </a>
<a name="1559"><span class="lineNum">    1559 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">          6 :         if (target_confirms &lt; 1) {</span></a>
<a name="1560"><span class="lineNum">    1560 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter&quot;);</span></a>
<a name="1561"><span class="lineNum">    1561 </span>                :            :         }</a>
<a name="1562"><span class="lineNum">    1562 </span>                :            :     }</a>
<a name="1563"><span class="lineNum">    1563 </span>                :            : </a>
<a name="1564"><span class="lineNum">    1564 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         42 :     if (ParseIncludeWatchonly(request.params[2], wallet)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 40 times"> + </span>]
<a name="1565"><span class="lineNum">    1565 </span>                :<span class="lineCov">          2 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="1566"><span class="lineNum">    1566 </span>                :            :     }</a>
<a name="1567"><span class="lineNum">    1567 </span>                :            : </a>
<a name="1568"><span class="lineNum">    1568 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 40 times"> + </span> :<span class="lineCov">         42 :     bool include_removed = (request.params[3].isNull() || request.params[3].get_bool());</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 2 times"> + </span>]
<a name="1569"><span class="lineNum">    1569 </span>                :            : </a>
<a name="1570"><span class="lineNum">    1570 </span>        [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">         42 :     int depth = height ? wallet.GetLastBlockHeight() + 1 - *height : -1;</span></a>
<a name="1571"><span class="lineNum">    1571 </span>                :            : </a>
<a name="1572"><span class="lineNum">    1572 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         84 :     UniValue transactions(UniValue::VARR);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1573"><span class="lineNum">    1573 </span>                :            : </a>
<a name="1574"><span class="lineNum">    1574 </span>        [<span class="branchCov" title="Branch 0 was taken 2027 times"> + </span><span class="branchCov" title="Branch 1 was taken 42 times"> + </span>]:<span class="lineCov">       2069 :     for (const std::pair&lt;const uint256, CWalletTx&gt;&amp; pairWtx : wallet.mapWallet) {</span></a>
<a name="1575"><span class="lineNum">    1575 </span>                :<span class="lineCov">       2027 :         const CWalletTx&amp; tx = pairWtx.second;</span></a>
<a name="1576"><span class="lineNum">    1576 </span>                :            : </a>
<a name="1577"><span class="lineNum">    1577 </span>  [<span class="branchCov" title="Branch 0 was taken 654 times"> + </span><span class="branchCov" title="Branch 1 was taken 1373 times"> + </span><span class="branchCov" title="Branch 2 was taken 654 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2027 :         if (depth == -1 || abs(wallet.GetTxDepthInMainChain(tx)) &lt; depth) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchCov" title="Branch 5 was taken 640 times"> + </span>]
<a name="1578"><span class="lineNum">    1578 </span>        [<span class="branchCov" title="Branch 0 was taken 1387 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1387 :             ListTransactions(wallet, tx, 0, true, transactions, filter, nullptr /* filter_label */);</span></a>
<a name="1579"><span class="lineNum">    1579 </span>                :            :         }</a>
<a name="1580"><span class="lineNum">    1580 </span>                :            :     }</a>
<a name="1581"><span class="lineNum">    1581 </span>                :            : </a>
<a name="1582"><span class="lineNum">    1582 </span>                :            :     // when a reorg'd block is requested, we also list any relevant transactions</a>
<a name="1583"><span class="lineNum">    1583 </span>                :            :     // in the blocks of the chain that was detached</a>
<a name="1584"><span class="lineNum">    1584 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         84 :     UniValue removed(UniValue::VARR);</span></a>
<a name="1585"><span class="lineNum">    1585 </span>  [<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchCov" title="Branch 3 was taken 22 times"> + </span> :<span class="lineCov">         66 :     while (include_removed &amp;&amp; altheight &amp;&amp; *altheight &gt; *height) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchCov" title="Branch 5 was taken 24 times"> + </span>]
<a name="1586"><span class="lineNum">    1586 </span>        [<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">         90 :         CBlock block;</span></a>
<a name="1587"><span class="lineNum">    1587 </span>  [<span class="branchCov" title="Branch 0 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         24 :         if (!wallet.chain().findBlock(blockId, FoundBlock().data(block)) || block.IsNull()) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1588"><span class="lineNum">    1588 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INTERNAL_ERROR, &quot;Can't read block from disk&quot;);</span></a>
<a name="1589"><span class="lineNum">    1589 </span>                :            :         }</a>
<a name="1590"><span class="lineNum">    1590 </span>        [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>]:<span class="lineCov">         52 :         for (const CTransactionRef&amp; tx : block.vtx) {</span></a>
<a name="1591"><span class="lineNum">    1591 </span>                :<span class="lineCov">         28 :             auto it = wallet.mapWallet.find(tx-&gt;GetHash());</span></a>
<a name="1592"><span class="lineNum">    1592 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>]:<span class="lineCov">         28 :             if (it != wallet.mapWallet.end()) {</span></a>
<a name="1593"><span class="lineNum">    1593 </span>                :            :                 // We want all transactions regardless of confirmation count to appear here,</a>
<a name="1594"><span class="lineNum">    1594 </span>                :            :                 // even negative confirmation ones, hence the big negative.</a>
<a name="1595"><span class="lineNum">    1595 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :                 ListTransactions(wallet, it-&gt;second, -100000000, true, removed, filter, nullptr /* filter_label */);</span></a>
<a name="1596"><span class="lineNum">    1596 </span>                :            :             }</a>
<a name="1597"><span class="lineNum">    1597 </span>                :            :         }</a>
<a name="1598"><span class="lineNum">    1598 </span>                :<span class="lineCov">         24 :         blockId = block.hashPrevBlock;</span></a>
<a name="1599"><span class="lineNum">    1599 </span>                :<span class="lineCov">         24 :         --*altheight;</span></a>
<a name="1600"><span class="lineNum">    1600 </span>                :            :     }</a>
<a name="1601"><span class="lineNum">    1601 </span>                :            : </a>
<a name="1602"><span class="lineNum">    1602 </span>                :<span class="lineCov">         42 :     uint256 lastblock;</span></a>
<a name="1603"><span class="lineNum">    1603 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 40 times"> + </span>]:<span class="lineCov">         42 :     target_confirms = std::min(target_confirms, wallet.GetLastBlockHeight() + 1);</span></a>
<a name="1604"><span class="lineNum">    1604 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 42 times"> + </span> :<span class="lineCov">         42 :     CHECK_NONFATAL(wallet.chain().findAncestorByHeight(wallet.GetLastBlockHash(), wallet.GetLastBlockHeight() + 1 - target_confirms, FoundBlock().hash(lastblock)));</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1605"><span class="lineNum">    1605 </span>                :            : </a>
<a name="1606"><span class="lineNum">    1606 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         84 :     UniValue ret(UniValue::VOBJ);</span></a>
<a name="1607"><span class="lineNum">    1607 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         84 :     ret.pushKV(&quot;transactions&quot;, transactions);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 40 times"> + </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span>]
<a name="1608"><span class="lineNum">    1608 </span>  [<span class="branchCov" title="Branch 0 was taken 40 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         82 :     if (include_removed) ret.pushKV(&quot;removed&quot;, removed);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1609"><span class="lineNum">    1609 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         84 :     ret.pushKV(&quot;lastblock&quot;, lastblock.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1610"><span class="lineNum">    1610 </span>                :            : </a>
<a name="1611"><span class="lineNum">    1611 </span>                :<span class="lineCov">         42 :     return ret;</span></a>
<a name="1612"><span class="lineNum">    1612 </span>                :            : },</a>
<a name="1613"><span class="lineNum">    1613 </span>  [<span class="branchCov" title="Branch 0 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      25908 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1524 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1524 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 6096 times"> + </span><span class="branchCov" title="Branch 41 was taken 1524 times"> + </span><span class="branchNoCov" title="Branch 42 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 43 was not taken"> - </span>]
<a name="1614"><span class="lineNum">    1614 </span>                :            : }</a>
<a name="1615"><span class="lineNum">    1615 </span>                :            : </a>
<a name="1616"><span class="lineNum">    1616 </span>                :<span class="lineCov">       1932 : static RPCHelpMan gettransaction()</span></a>
<a name="1617"><span class="lineNum">    1617 </span>                :            : {</a>
<a name="1618"><span class="lineNum">    1618 </span>                :<span class="lineCov">       1932 :     return RPCHelpMan{&quot;gettransaction&quot;,</span></a>
<a name="1619"><span class="lineNum">    1619 </span>                :            :                 &quot;\nGet detailed information about in-wallet transaction &lt;txid&gt;\n&quot;,</a>
<a name="1620"><span class="lineNum">    1620 </span>                :            :                 {</a>
<a name="1621"><span class="lineNum">    1621 </span>                :<span class="lineCov">       1932 :                     {&quot;txid&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="1622"><span class="lineNum">    1622 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3864 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;},</span></a>
<a name="1623"><span class="lineNum">    1623 </span>                :            :                             &quot;Whether to include watch-only addresses in balance calculation and details[]&quot;},</a>
<a name="1624"><span class="lineNum">    1624 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3864 :                     {&quot;verbose&quot;, RPCArg::Type::BOOL, RPCArg::Default{false},</span></a>
<a name="1625"><span class="lineNum">    1625 </span>                :            :                             &quot;Whether to include a `decoded` field containing the decoded transaction (equivalent to RPC decoderawtransaction)&quot;},</a>
<a name="1626"><span class="lineNum">    1626 </span>                :            :                 },</a>
<a name="1627"><span class="lineNum">    1627 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="1628"><span class="lineNum">    1628 </span>                :<span class="lineCov">       1932 :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(Cat&lt;std::vector&lt;RPCResult&gt;&gt;(</span></a>
<a name="1629"><span class="lineNum">    1629 </span>                :            :                     {</a>
<a name="1630"><span class="lineNum">    1630 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3864 :                         {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT},</span></a>
<a name="1631"><span class="lineNum">    1631 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3864 :                         {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /* optional */ true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the\n&quot;</span></a>
<a name="1632"><span class="lineNum">    1632 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1932 :                                      &quot;'send' category of transactions.&quot;},</span></a>
<a name="1633"><span class="lineNum">    1633 </span>                :            :                     },</a>
<a name="1634"><span class="lineNum">    1634 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15456 :                     TransactionDescriptionString()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 3864 times"> + </span><span class="branchCov" title="Branch 15 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="1635"><span class="lineNum">    1635 </span>                :            :                     {</a>
<a name="1636"><span class="lineNum">    1636 </span>                :            :                         {RPCResult::Type::ARR, &quot;details&quot;, &quot;&quot;,</a>
<a name="1637"><span class="lineNum">    1637 </span>                :            :                         {</a>
<a name="1638"><span class="lineNum">    1638 </span>                :            :                             {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="1639"><span class="lineNum">    1639 </span>                :            :                             {</a>
<a name="1640"><span class="lineNum">    1640 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /* optional */ true, &quot;Only returns true if imported addresses were involved in transaction.&quot;},</a>
<a name="1641"><span class="lineNum">    1641 </span>                :            :                                 {RPCResult::Type::STR, &quot;address&quot;, /* optional */ true, &quot;The bitcoin address involved in the transaction.&quot;},</a>
<a name="1642"><span class="lineNum">    1642 </span>                :            :                                 {RPCResult::Type::STR, &quot;category&quot;, &quot;The transaction category.\n&quot;</a>
<a name="1643"><span class="lineNum">    1643 </span>                :            :                                     &quot;\&quot;send\&quot;                  Transactions sent.\n&quot;</a>
<a name="1644"><span class="lineNum">    1644 </span>                :            :                                     &quot;\&quot;receive\&quot;               Non-coinbase transactions received.\n&quot;</a>
<a name="1645"><span class="lineNum">    1645 </span>                :            :                                     &quot;\&quot;generate\&quot;              Coinbase transactions received with more than 100 confirmations.\n&quot;</a>
<a name="1646"><span class="lineNum">    1646 </span>                :            :                                     &quot;\&quot;immature\&quot;              Coinbase transactions received with 100 or fewer confirmations.\n&quot;</a>
<a name="1647"><span class="lineNum">    1647 </span>                :            :                                     &quot;\&quot;orphan\&quot;                Orphaned coinbase transactions received.&quot;},</a>
<a name="1648"><span class="lineNum">    1648 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3864 :                                 {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT},</span></a>
<a name="1649"><span class="lineNum">    1649 </span>                :            :                                 {RPCResult::Type::STR, &quot;label&quot;, /* optional */ true, &quot;A comment for the address/transaction, if any&quot;},</a>
<a name="1650"><span class="lineNum">    1650 </span>                :            :                                 {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="1651"><span class="lineNum">    1651 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3864 :                                 {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /* optional */ true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the \n&quot;</span></a>
<a name="1652"><span class="lineNum">    1652 </span>        [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1932 :                                     &quot;'send' category of transactions.&quot;},</span></a>
<a name="1653"><span class="lineNum">    1653 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;abandoned&quot;, /* optional */ true, &quot;'true' if the transaction has been abandoned (inputs are respendable). Only available for the \n&quot;</a>
<a name="1654"><span class="lineNum">    1654 </span>                :            :                                      &quot;'send' category of transactions.&quot;},</a>
<a name="1655"><span class="lineNum">    1655 </span>                :            :                             }},</a>
<a name="1656"><span class="lineNum">    1656 </span>                :            :                         }},</a>
<a name="1657"><span class="lineNum">    1657 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hex&quot;, &quot;Raw data for transaction&quot;},</a>
<a name="1658"><span class="lineNum">    1658 </span>                :            :                         {RPCResult::Type::OBJ, &quot;decoded&quot;, /* optional */ true, &quot;The decoded transaction (only present when `verbose` is passed)&quot;,</a>
<a name="1659"><span class="lineNum">    1659 </span>                :            :                         {</a>
<a name="1660"><span class="lineNum">    1660 </span>                :            :                             {RPCResult::Type::ELISION, &quot;&quot;, &quot;Equivalent to the RPC decoderawtransaction method, or the RPC getrawtransaction method when `verbose` is passed.&quot;},</a>
<a name="1661"><span class="lineNum">    1661 </span>                :            :                         }},</a>
<a name="1662"><span class="lineNum">    1662 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      38640 :                     })</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 5796 times"> + </span><span class="branchCov" title="Branch 85 was taken 1932 times"> + </span><span class="branchCov" title="Branch 86 was taken 1932 times"> + </span><span class="branchCov" title="Branch 87 was taken 1932 times"> + </span><span class="branchCov" title="Branch 88 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 89 was taken 1932 times"> + </span><span class="branchCov" title="Branch 90 was taken 15456 times"> + </span><span class="branchCov" title="Branch 91 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 94 was not taken"> - </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchNoCov" title="Branch 96 was not taken"> - </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 99 was not taken"> - </span>]
<a name="1663"><span class="lineNum">    1663 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5796 :                 },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1664"><span class="lineNum">    1664 </span>                :<span class="lineCov">       1932 :                 RPCExamples{</span></a>
<a name="1665"><span class="lineNum">    1665 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3864 :                     HelpExampleCli(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1666"><span class="lineNum">    1666 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7728 :             + HelpExampleCli(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot; true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1667"><span class="lineNum">    1667 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7728 :             + HelpExampleCli(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot; false true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1668"><span class="lineNum">    1668 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7728 :             + HelpExampleRpc(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1669"><span class="lineNum">    1669 </span>                :<span class="lineCov">       1932 :                 },</span></a>
<a name="1670"><span class="lineNum">    1670 </span>                :<span class="lineCov">        460 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1671"><span class="lineNum">    1671 </span>                :            : {</a>
<a name="1672"><span class="lineNum">    1672 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 460 times"> + </span>]:<span class="lineCov">        917 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1673"><span class="lineNum">    1673 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        460 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1674"><span class="lineNum">    1674 </span>                :            : </a>
<a name="1675"><span class="lineNum">    1675 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1676"><span class="lineNum">    1676 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1677"><span class="lineNum">    1677 </span>        [<span class="branchCov" title="Branch 0 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        460 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="1678"><span class="lineNum">    1678 </span>                :            : </a>
<a name="1679"><span class="lineNum">    1679 </span>  [<span class="branchCov" title="Branch 0 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        920 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1680"><span class="lineNum">    1680 </span>                :            : </a>
<a name="1681"><span class="lineNum">    1681 </span>  [<span class="branchCov" title="Branch 0 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        920 :     uint256 hash(ParseHashV(request.params[0], &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1682"><span class="lineNum">    1682 </span>                :            : </a>
<a name="1683"><span class="lineNum">    1683 </span>                :<span class="lineCov">        460 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="1684"><span class="lineNum">    1684 </span>                :            : </a>
<a name="1685"><span class="lineNum">    1685 </span>  [<span class="branchCov" title="Branch 0 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        460 :     if (ParseIncludeWatchonly(request.params[1], *pwallet)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 47 times"> + </span><span class="branchCov" title="Branch 5 was taken 413 times"> + </span>]
<a name="1686"><span class="lineNum">    1686 </span>                :<span class="lineCov">         47 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="1687"><span class="lineNum">    1687 </span>                :            :     }</a>
<a name="1688"><span class="lineNum">    1688 </span>                :            : </a>
<a name="1689"><span class="lineNum">    1689 </span>  [<span class="branchCov" title="Branch 0 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 64 times"> + </span><span class="branchCov" title="Branch 3 was taken 396 times"> + </span> :<span class="lineCov">        460 :     bool verbose = request.params[2].isNull() ? false : request.params[2].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1690"><span class="lineNum">    1690 </span>                :            : </a>
<a name="1691"><span class="lineNum">    1691 </span>  [<span class="branchCov" title="Branch 0 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 460 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        920 :     UniValue entry(UniValue::VOBJ);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1692"><span class="lineNum">    1692 </span>                :<span class="lineCov">        460 :     auto it = pwallet-&gt;mapWallet.find(hash);</span></a>
<a name="1693"><span class="lineNum">    1693 </span>        [<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchCov" title="Branch 1 was taken 457 times"> + </span>]:<span class="lineCov">        460 :     if (it == pwallet-&gt;mapWallet.end()) {</span></a>
<a name="1694"><span class="lineNum">    1694 </span>  [<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid or non-wallet transaction id&quot;);</span></a>
<a name="1695"><span class="lineNum">    1695 </span>                :            :     }</a>
<a name="1696"><span class="lineNum">    1696 </span>        [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        457 :     const CWalletTx&amp; wtx = it-&gt;second;</span></a>
<a name="1697"><span class="lineNum">    1697 </span>                :            : </a>
<a name="1698"><span class="lineNum">    1698 </span>        [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        457 :     CAmount nCredit = CachedTxGetCredit(*pwallet, wtx, filter);</span></a>
<a name="1699"><span class="lineNum">    1699 </span>        [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        457 :     CAmount nDebit = CachedTxGetDebit(*pwallet, wtx, filter);</span></a>
<a name="1700"><span class="lineNum">    1700 </span>                :<span class="lineCov">        457 :     CAmount nNet = nCredit - nDebit;</span></a>
<a name="1701"><span class="lineNum">    1701 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 409 times"> + </span><span class="branchCov" title="Branch 3 was taken 48 times"> + </span> :<span class="lineCov">        457 :     CAmount nFee = (CachedTxIsFromMe(*pwallet, wtx, filter) ? wtx.tx-&gt;GetValueOut() - nDebit : 0);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 409 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1702"><span class="lineNum">    1702 </span>                :            : </a>
<a name="1703"><span class="lineNum">    1703 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        914 :     entry.pushKV(&quot;amount&quot;, ValueFromAmount(nNet - nFee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1704"><span class="lineNum">    1704 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 409 times"> + </span><span class="branchCov" title="Branch 3 was taken 48 times"> + </span>]:<span class="lineCov">        457 :     if (CachedTxIsFromMe(*pwallet, wtx, filter))</span></a>
<a name="1705"><span class="lineNum">    1705 </span>  [<span class="branchCov" title="Branch 0 was taken 409 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 409 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        818 :         entry.pushKV(&quot;fee&quot;, ValueFromAmount(nFee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 409 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1706"><span class="lineNum">    1706 </span>                :            : </a>
<a name="1707"><span class="lineNum">    1707 </span>        [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        457 :     WalletTxToJSON(*pwallet, wtx, entry);</span></a>
<a name="1708"><span class="lineNum">    1708 </span>                :            : </a>
<a name="1709"><span class="lineNum">    1709 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        457 :     UniValue details(UniValue::VARR);</span></a>
<a name="1710"><span class="lineNum">    1710 </span>        [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        457 :     ListTransactions(*pwallet, wtx, 0, false, details, filter, nullptr /* filter_label */);</span></a>
<a name="1711"><span class="lineNum">    1711 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        914 :     entry.pushKV(&quot;details&quot;, details);</span></a>
<a name="1712"><span class="lineNum">    1712 </span>                :            : </a>
<a name="1713"><span class="lineNum">    1713 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        914 :     std::string strHex = EncodeHexTx(*wtx.tx, pwallet-&gt;chain().rpcSerializationFlags());</span></a>
<a name="1714"><span class="lineNum">    1714 </span>  [<span class="branchCov" title="Branch 0 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 457 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        914 :     entry.pushKV(&quot;hex&quot;, strHex);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 62 times"> + </span><span class="branchCov" title="Branch 5 was taken 395 times"> + </span>]
<a name="1715"><span class="lineNum">    1715 </span>                :            : </a>
<a name="1716"><span class="lineNum">    1716 </span>        [<span class="branchCov" title="Branch 0 was taken 62 times"> + </span><span class="branchCov" title="Branch 1 was taken 395 times"> + </span>]:<span class="lineCov">        457 :     if (verbose) {</span></a>
<a name="1717"><span class="lineNum">    1717 </span>  [<span class="branchCov" title="Branch 0 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        124 :         UniValue decoded(UniValue::VOBJ);</span></a>
<a name="1718"><span class="lineNum">    1718 </span>        [<span class="branchCov" title="Branch 0 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        124 :         TxToUniv(*wtx.tx, uint256(), decoded, false);</span></a>
<a name="1719"><span class="lineNum">    1719 </span>  [<span class="branchCov" title="Branch 0 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 62 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        124 :         entry.pushKV(&quot;decoded&quot;, decoded);</span></a>
<a name="1720"><span class="lineNum">    1720 </span>                :            :     }</a>
<a name="1721"><span class="lineNum">    1721 </span>                :            : </a>
<a name="1722"><span class="lineNum">    1722 </span>                :<span class="lineCov">        457 :     return entry;</span></a>
<a name="1723"><span class="lineNum">    1723 </span>                :            : },</a>
<a name="1724"><span class="lineNum">    1724 </span>  [<span class="branchCov" title="Branch 0 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      27048 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1932 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1932 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 5796 times"> + </span><span class="branchCov" title="Branch 33 was taken 1932 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>]
<a name="1725"><span class="lineNum">    1725 </span>                :            : }</a>
<a name="1726"><span class="lineNum">    1726 </span>                :            : </a>
<a name="1727"><span class="lineNum">    1727 </span>                :<span class="lineCov">       1485 : static RPCHelpMan abandontransaction()</span></a>
<a name="1728"><span class="lineNum">    1728 </span>                :            : {</a>
<a name="1729"><span class="lineNum">    1729 </span>                :<span class="lineCov">       1485 :     return RPCHelpMan{&quot;abandontransaction&quot;,</span></a>
<a name="1730"><span class="lineNum">    1730 </span>                :            :                 &quot;\nMark in-wallet transaction &lt;txid&gt; as abandoned\n&quot;</a>
<a name="1731"><span class="lineNum">    1731 </span>                :            :                 &quot;This will mark this transaction and all its in-wallet descendants as abandoned which will allow\n&quot;</a>
<a name="1732"><span class="lineNum">    1732 </span>                :            :                 &quot;for their inputs to be respent.  It can be used to replace \&quot;stuck\&quot; or evicted transactions.\n&quot;</a>
<a name="1733"><span class="lineNum">    1733 </span>                :            :                 &quot;It only works on transactions which are not included in a block and are not currently in the mempool.\n&quot;</a>
<a name="1734"><span class="lineNum">    1734 </span>                :            :                 &quot;It has no effect on transactions which are already abandoned.\n&quot;,</a>
<a name="1735"><span class="lineNum">    1735 </span>                :            :                 {</a>
<a name="1736"><span class="lineNum">    1736 </span>                :<span class="lineCov">       1485 :                     {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="1737"><span class="lineNum">    1737 </span>                :            :                 },</a>
<a name="1738"><span class="lineNum">    1738 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2970 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1739"><span class="lineNum">    1739 </span>                :<span class="lineCov">       1485 :                 RPCExamples{</span></a>
<a name="1740"><span class="lineNum">    1740 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2970 :                     HelpExampleCli(&quot;abandontransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1741"><span class="lineNum">    1741 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5940 :             + HelpExampleRpc(&quot;abandontransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1742"><span class="lineNum">    1742 </span>                :<span class="lineCov">       1485 :                 },</span></a>
<a name="1743"><span class="lineNum">    1743 </span>                :<span class="lineCov">         13 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1744"><span class="lineNum">    1744 </span>                :            : {</a>
<a name="1745"><span class="lineNum">    1745 </span>                :<span class="lineCov">         20 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1746"><span class="lineNum">    1746 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         13 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1747"><span class="lineNum">    1747 </span>                :            : </a>
<a name="1748"><span class="lineNum">    1748 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1749"><span class="lineNum">    1749 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1750"><span class="lineNum">    1750 </span>        [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         13 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="1751"><span class="lineNum">    1751 </span>                :            : </a>
<a name="1752"><span class="lineNum">    1752 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         26 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1753"><span class="lineNum">    1753 </span>                :            : </a>
<a name="1754"><span class="lineNum">    1754 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         26 :     uint256 hash(ParseHashV(request.params[0], &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1755"><span class="lineNum">    1755 </span>                :            : </a>
<a name="1756"><span class="lineNum">    1756 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span>]:<span class="lineCov">         13 :     if (!pwallet-&gt;mapWallet.count(hash)) {</span></a>
<a name="1757"><span class="lineNum">    1757 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid or non-wallet transaction id&quot;);</span></a>
<a name="1758"><span class="lineNum">    1758 </span>                :            :     }</a>
<a name="1759"><span class="lineNum">    1759 </span>  [<span class="branchCov" title="Branch 0 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 7 times"> + </span>]:<span class="lineCov">         11 :     if (!pwallet-&gt;AbandonTransaction(hash)) {</span></a>
<a name="1760"><span class="lineNum">    1760 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Transaction not eligible for abandonment&quot;);</span></a>
<a name="1761"><span class="lineNum">    1761 </span>                :            :     }</a>
<a name="1762"><span class="lineNum">    1762 </span>                :            : </a>
<a name="1763"><span class="lineNum">    1763 </span>        [<span class="branchCov" title="Branch 0 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          7 :     return NullUniValue;</span></a>
<a name="1764"><span class="lineNum">    1764 </span>                :            : },</a>
<a name="1765"><span class="lineNum">    1765 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      11880 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1485 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1485 times"> + </span><span class="branchCov" title="Branch 17 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="1766"><span class="lineNum">    1766 </span>                :            : }</a>
<a name="1767"><span class="lineNum">    1767 </span>                :            : </a>
<a name="1768"><span class="lineNum">    1768 </span>                :            : </a>
<a name="1769"><span class="lineNum">    1769 </span>                :<span class="lineCov">       1515 : static RPCHelpMan backupwallet()</span></a>
<a name="1770"><span class="lineNum">    1770 </span>                :            : {</a>
<a name="1771"><span class="lineNum">    1771 </span>                :<span class="lineCov">       1515 :     return RPCHelpMan{&quot;backupwallet&quot;,</span></a>
<a name="1772"><span class="lineNum">    1772 </span>                :            :                 &quot;\nSafely copies current wallet file to destination, which can be a directory or a path with filename.\n&quot;,</a>
<a name="1773"><span class="lineNum">    1773 </span>                :            :                 {</a>
<a name="1774"><span class="lineNum">    1774 </span>                :<span class="lineCov">       1515 :                     {&quot;destination&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The destination directory or file&quot;},</span></a>
<a name="1775"><span class="lineNum">    1775 </span>                :            :                 },</a>
<a name="1776"><span class="lineNum">    1776 </span>  [<span class="branchCov" title="Branch 0 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3030 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1777"><span class="lineNum">    1777 </span>                :<span class="lineCov">       1515 :                 RPCExamples{</span></a>
<a name="1778"><span class="lineNum">    1778 </span>  [<span class="branchCov" title="Branch 0 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3030 :                     HelpExampleCli(&quot;backupwallet&quot;, &quot;\&quot;backup.dat\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1779"><span class="lineNum">    1779 </span>  [<span class="branchCov" title="Branch 0 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6060 :             + HelpExampleRpc(&quot;backupwallet&quot;, &quot;\&quot;backup.dat\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1780"><span class="lineNum">    1780 </span>                :<span class="lineCov">       1515 :                 },</span></a>
<a name="1781"><span class="lineNum">    1781 </span>                :<span class="lineCov">         43 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1782"><span class="lineNum">    1782 </span>                :            : {</a>
<a name="1783"><span class="lineNum">    1783 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 43 times"> + </span>]:<span class="lineCov">         78 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1784"><span class="lineNum">    1784 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         43 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1785"><span class="lineNum">    1785 </span>                :            : </a>
<a name="1786"><span class="lineNum">    1786 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="1787"><span class="lineNum">    1787 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="1788"><span class="lineNum">    1788 </span>        [<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         43 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="1789"><span class="lineNum">    1789 </span>                :            : </a>
<a name="1790"><span class="lineNum">    1790 </span>  [<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 35 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         86 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1791"><span class="lineNum">    1791 </span>                :            : </a>
<a name="1792"><span class="lineNum">    1792 </span>  [<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         86 :     std::string strDest = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 35 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1793"><span class="lineNum">    1793 </span>  [<span class="branchCov" title="Branch 0 was taken 43 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 35 times"> + </span>]:<span class="lineCov">         43 :     if (!pwallet-&gt;BackupWallet(strDest)) {</span></a>
<a name="1794"><span class="lineNum">    1794 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error: Wallet backup failed!&quot;);</span></a>
<a name="1795"><span class="lineNum">    1795 </span>                :            :     }</a>
<a name="1796"><span class="lineNum">    1796 </span>                :            : </a>
<a name="1797"><span class="lineNum">    1797 </span>        [<span class="branchCov" title="Branch 0 was taken 35 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         35 :     return NullUniValue;</span></a>
<a name="1798"><span class="lineNum">    1798 </span>                :            : },</a>
<a name="1799"><span class="lineNum">    1799 </span>  [<span class="branchCov" title="Branch 0 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      12120 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1515 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1515 times"> + </span><span class="branchCov" title="Branch 17 was taken 1515 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="1800"><span class="lineNum">    1800 </span>                :            : }</a>
<a name="1801"><span class="lineNum">    1801 </span>                :            : </a>
<a name="1802"><span class="lineNum">    1802 </span>                :            : </a>
<a name="1803"><span class="lineNum">    1803 </span>                :<span class="lineCov">       1488 : static RPCHelpMan keypoolrefill()</span></a>
<a name="1804"><span class="lineNum">    1804 </span>                :            : {</a>
<a name="1805"><span class="lineNum">    1805 </span>                :<span class="lineCov">       1488 :     return RPCHelpMan{&quot;keypoolrefill&quot;,</span></a>
<a name="1806"><span class="lineNum">    1806 </span>                :<span class="lineCov">       1488 :                 &quot;\nFills the keypool.&quot;+</span></a>
<a name="1807"><span class="lineNum">    1807 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :         HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="1808"><span class="lineNum">    1808 </span>                :            :                 {</a>
<a name="1809"><span class="lineNum">    1809 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2976 :                     {&quot;newsize&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{strprintf(&quot;%u, or as set by -keypool&quot;, DEFAULT_KEYPOOL_SIZE)}, &quot;The new keypool size&quot;},</span></a>
<a name="1810"><span class="lineNum">    1810 </span>                :            :                 },</a>
<a name="1811"><span class="lineNum">    1811 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2976 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1812"><span class="lineNum">    1812 </span>                :<span class="lineCov">       1488 :                 RPCExamples{</span></a>
<a name="1813"><span class="lineNum">    1813 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2976 :                     HelpExampleCli(&quot;keypoolrefill&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1814"><span class="lineNum">    1814 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5952 :             + HelpExampleRpc(&quot;keypoolrefill&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1815"><span class="lineNum">    1815 </span>                :<span class="lineCov">       1488 :                 },</span></a>
<a name="1816"><span class="lineNum">    1816 </span>                :<span class="lineCov">         16 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1817"><span class="lineNum">    1817 </span>                :            : {</a>
<a name="1818"><span class="lineNum">    1818 </span>                :<span class="lineCov">         32 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1819"><span class="lineNum">    1819 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1820"><span class="lineNum">    1820 </span>                :            : </a>
<a name="1821"><span class="lineNum">    1821 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span> :<span class="lineCov">         16 :     if (pwallet-&gt;IsLegacy() &amp;&amp; pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 10 times"> + </span>]
<a name="1822"><span class="lineNum">    1822 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error: Private keys are disabled for this wallet&quot;);</span></a>
<a name="1823"><span class="lineNum">    1823 </span>                :            :     }</a>
<a name="1824"><span class="lineNum">    1824 </span>                :            : </a>
<a name="1825"><span class="lineNum">    1825 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         32 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1826"><span class="lineNum">    1826 </span>                :            : </a>
<a name="1827"><span class="lineNum">    1827 </span>                :            :     // 0 is interpreted by TopUpKeyPool() as the default keypool size given by -keypool</a>
<a name="1828"><span class="lineNum">    1828 </span>                :<span class="lineCov">         16 :     unsigned int kpSize = 0;</span></a>
<a name="1829"><span class="lineNum">    1829 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchCov" title="Branch 3 was taken 3 times"> + </span>]:<span class="lineCov">         16 :     if (!request.params[0].isNull()) {</span></a>
<a name="1830"><span class="lineNum">    1830 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         13 :         if (request.params[0].get_int() &lt; 0)</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 13 times"> + </span>]
<a name="1831"><span class="lineNum">    1831 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, expected valid size.&quot;);</span></a>
<a name="1832"><span class="lineNum">    1832 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         13 :         kpSize = (unsigned int)request.params[0].get_int();</span></a>
<a name="1833"><span class="lineNum">    1833 </span>                :            :     }</a>
<a name="1834"><span class="lineNum">    1834 </span>                :            : </a>
<a name="1835"><span class="lineNum">    1835 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :     EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="1836"><span class="lineNum">    1836 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :     pwallet-&gt;TopUpKeyPool(kpSize);</span></a>
<a name="1837"><span class="lineNum">    1837 </span>                :            : </a>
<a name="1838"><span class="lineNum">    1838 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 16 times"> + </span>]:<span class="lineCov">         16 :     if (pwallet-&gt;GetKeyPoolSize() &lt; kpSize) {</span></a>
<a name="1839"><span class="lineNum">    1839 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Error refreshing keypool.&quot;);</span></a>
<a name="1840"><span class="lineNum">    1840 </span>                :            :     }</a>
<a name="1841"><span class="lineNum">    1841 </span>                :            : </a>
<a name="1842"><span class="lineNum">    1842 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :     return NullUniValue;</span></a>
<a name="1843"><span class="lineNum">    1843 </span>                :            : },</a>
<a name="1844"><span class="lineNum">    1844 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      16368 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1488 times"> + </span><span class="branchCov" title="Branch 15 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="1845"><span class="lineNum">    1845 </span>                :            : }</a>
<a name="1846"><span class="lineNum">    1846 </span>                :            : </a>
<a name="1847"><span class="lineNum">    1847 </span>                :            : </a>
<a name="1848"><span class="lineNum">    1848 </span>                :<span class="lineCov">       1473 : static RPCHelpMan newkeypool()</span></a>
<a name="1849"><span class="lineNum">    1849 </span>                :            : {</a>
<a name="1850"><span class="lineNum">    1850 </span>                :<span class="lineCov">       1473 :     return RPCHelpMan{&quot;newkeypool&quot;,</span></a>
<a name="1851"><span class="lineNum">    1851 </span>                :<span class="lineCov">       1473 :                 &quot;\nEntirely clears and refills the keypool.&quot;+</span></a>
<a name="1852"><span class="lineNum">    1852 </span>        [<span class="branchCov" title="Branch 0 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1473 :             HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="1853"><span class="lineNum">    1853 </span>                :            :                 {},</a>
<a name="1854"><span class="lineNum">    1854 </span>  [<span class="branchCov" title="Branch 0 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2946 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1855"><span class="lineNum">    1855 </span>                :<span class="lineCov">       1473 :                 RPCExamples{</span></a>
<a name="1856"><span class="lineNum">    1856 </span>  [<span class="branchCov" title="Branch 0 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2946 :             HelpExampleCli(&quot;newkeypool&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1857"><span class="lineNum">    1857 </span>  [<span class="branchCov" title="Branch 0 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5892 :             + HelpExampleRpc(&quot;newkeypool&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1858"><span class="lineNum">    1858 </span>                :<span class="lineCov">       1473 :                 },</span></a>
<a name="1859"><span class="lineNum">    1859 </span>                :<span class="lineCov">          1 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1860"><span class="lineNum">    1860 </span>                :            : {</a>
<a name="1861"><span class="lineNum">    1861 </span>                :<span class="lineCov">          2 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1862"><span class="lineNum">    1862 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          1 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1863"><span class="lineNum">    1863 </span>                :            : </a>
<a name="1864"><span class="lineNum">    1864 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1865"><span class="lineNum">    1865 </span>                :            : </a>
<a name="1866"><span class="lineNum">    1866 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          1 :     LegacyScriptPubKeyMan&amp; spk_man = EnsureLegacyScriptPubKeyMan(*pwallet, true);</span></a>
<a name="1867"><span class="lineNum">    1867 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          1 :     spk_man.NewKeyPool();</span></a>
<a name="1868"><span class="lineNum">    1868 </span>                :            : </a>
<a name="1869"><span class="lineNum">    1869 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          1 :     return NullUniValue;</span></a>
<a name="1870"><span class="lineNum">    1870 </span>                :            : },</a>
<a name="1871"><span class="lineNum">    1871 </span>  [<span class="branchCov" title="Branch 0 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      11784 :     };</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1473 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1872"><span class="lineNum">    1872 </span>                :            : }</a>
<a name="1873"><span class="lineNum">    1873 </span>                :            : </a>
<a name="1874"><span class="lineNum">    1874 </span>                :            : </a>
<a name="1875"><span class="lineNum">    1875 </span>                :<span class="lineCov">       1548 : static RPCHelpMan walletpassphrase()</span></a>
<a name="1876"><span class="lineNum">    1876 </span>                :            : {</a>
<a name="1877"><span class="lineNum">    1877 </span>                :<span class="lineCov">       1548 :     return RPCHelpMan{&quot;walletpassphrase&quot;,</span></a>
<a name="1878"><span class="lineNum">    1878 </span>                :            :                 &quot;\nStores the wallet decryption key in memory for 'timeout' seconds.\n&quot;</a>
<a name="1879"><span class="lineNum">    1879 </span>                :            :                 &quot;This is needed prior to performing transactions related to private keys such as sending bitcoins\n&quot;</a>
<a name="1880"><span class="lineNum">    1880 </span>                :            :             &quot;\nNote:\n&quot;</a>
<a name="1881"><span class="lineNum">    1881 </span>                :            :             &quot;Issuing the walletpassphrase command while the wallet is already unlocked will set a new unlock\n&quot;</a>
<a name="1882"><span class="lineNum">    1882 </span>                :            :             &quot;time that overrides the old one.\n&quot;,</a>
<a name="1883"><span class="lineNum">    1883 </span>                :            :                 {</a>
<a name="1884"><span class="lineNum">    1884 </span>                :<span class="lineCov">       1548 :                     {&quot;passphrase&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The wallet passphrase&quot;},</span></a>
<a name="1885"><span class="lineNum">    1885 </span>                :<span class="lineCov">       1548 :                     {&quot;timeout&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The time to keep the decryption key in seconds; capped at 100000000 (~3 years).&quot;},</span></a>
<a name="1886"><span class="lineNum">    1886 </span>                :            :                 },</a>
<a name="1887"><span class="lineNum">    1887 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3096 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1888"><span class="lineNum">    1888 </span>                :<span class="lineCov">       1548 :                 RPCExamples{</span></a>
<a name="1889"><span class="lineNum">    1889 </span>                :            :             &quot;\nUnlock the wallet for 60 seconds\n&quot;</a>
<a name="1890"><span class="lineNum">    1890 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3096 :             + HelpExampleCli(&quot;walletpassphrase&quot;, &quot;\&quot;my pass phrase\&quot; 60&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1891"><span class="lineNum">    1891 </span>        [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1548 :             &quot;\nLock the wallet again (before 60 seconds)\n&quot;</span></a>
<a name="1892"><span class="lineNum">    1892 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6192 :             + HelpExampleCli(&quot;walletlock&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1893"><span class="lineNum">    1893 </span>        [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1548 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="1894"><span class="lineNum">    1894 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6192 :             + HelpExampleRpc(&quot;walletpassphrase&quot;, &quot;\&quot;my pass phrase\&quot;, 60&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1895"><span class="lineNum">    1895 </span>                :<span class="lineCov">       1548 :                 },</span></a>
<a name="1896"><span class="lineNum">    1896 </span>                :<span class="lineCov">         76 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1897"><span class="lineNum">    1897 </span>                :            : {</a>
<a name="1898"><span class="lineNum">    1898 </span>                :<span class="lineCov">        136 :     std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1899"><span class="lineNum">    1899 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         76 :     if (!wallet) return NullUniValue;</span></a>
<a name="1900"><span class="lineNum">    1900 </span>        [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         76 :     CWallet* const pwallet = wallet.get();</span></a>
<a name="1901"><span class="lineNum">    1901 </span>                :            : </a>
<a name="1902"><span class="lineNum">    1902 </span>                :<span class="lineCov">         76 :     int64_t nSleepTime;</span></a>
<a name="1903"><span class="lineNum">    1903 </span>                :<span class="lineCov">         76 :     int64_t relock_time;</span></a>
<a name="1904"><span class="lineNum">    1904 </span>                :            :     // Prevent concurrent calls to walletpassphrase with the same wallet.</a>
<a name="1905"><span class="lineNum">    1905 </span>  [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        152 :     LOCK(pwallet-&gt;m_unlock_mutex);</span></a>
<a name="1906"><span class="lineNum">    1906 </span>                :<span class="lineCov">         76 :     {</span></a>
<a name="1907"><span class="lineNum">    1907 </span>        [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         92 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1908"><span class="lineNum">    1908 </span>                :            : </a>
<a name="1909"><span class="lineNum">    1909 </span>  [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 68 times"> + </span>]:<span class="lineCov">         76 :         if (!pwallet-&gt;IsCrypted()) {</span></a>
<a name="1910"><span class="lineNum">    1910 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :             throw JSONRPCError(RPC_WALLET_WRONG_ENC_STATE, &quot;Error: running with an unencrypted wallet, but walletpassphrase was called.&quot;);</span></a>
<a name="1911"><span class="lineNum">    1911 </span>                :            :         }</a>
<a name="1912"><span class="lineNum">    1912 </span>                :            : </a>
<a name="1913"><span class="lineNum">    1913 </span>                :            :         // Note that the walletpassphrase is stored in request.params[0] which is not mlock()ed</a>
<a name="1914"><span class="lineNum">    1914 </span>  [<span class="branchCov" title="Branch 0 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        136 :         SecureString strWalletPass;</span></a>
<a name="1915"><span class="lineNum">    1915 </span>        [<span class="branchCov" title="Branch 0 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         68 :         strWalletPass.reserve(100);</span></a>
<a name="1916"><span class="lineNum">    1916 </span>                :            :         // TODO: get rid of this .c_str() by implementing SecureString::operator=(std::string)</a>
<a name="1917"><span class="lineNum">    1917 </span>                :            :         // Alternately, find a way to make request.params[0] mlock()'d to begin with.</a>
<a name="1918"><span class="lineNum">    1918 </span>  [<span class="branchCov" title="Branch 0 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         68 :         strWalletPass = request.params[0].get_str().c_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1919"><span class="lineNum">    1919 </span>                :            : </a>
<a name="1920"><span class="lineNum">    1920 </span>                :            :         // Get the timeout</a>
<a name="1921"><span class="lineNum">    1921 </span>  [<span class="branchCov" title="Branch 0 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 68 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         68 :         nSleepTime = request.params[1].get_int64();</span></a>
<a name="1922"><span class="lineNum">    1922 </span>                :            :         // Timeout cannot be negative, otherwise it will relock immediately</a>
<a name="1923"><span class="lineNum">    1923 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 66 times"> + </span>]:<span class="lineCov">         68 :         if (nSleepTime &lt; 0) {</span></a>
<a name="1924"><span class="lineNum">    1924 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Timeout cannot be negative.&quot;);</span></a>
<a name="1925"><span class="lineNum">    1925 </span>                :            :         }</a>
<a name="1926"><span class="lineNum">    1926 </span>                :            :         // Clamp timeout</a>
<a name="1927"><span class="lineNum">    1927 </span>                :<span class="lineCov">         66 :         constexpr int64_t MAX_SLEEP_TIME = 100000000; // larger values trigger a macos/libevent bug?</span></a>
<a name="1928"><span class="lineNum">    1928 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 64 times"> + </span>]:<span class="lineCov">         66 :         if (nSleepTime &gt; MAX_SLEEP_TIME) {</span></a>
<a name="1929"><span class="lineNum">    1929 </span>                :<span class="lineCov">          2 :             nSleepTime = MAX_SLEEP_TIME;</span></a>
<a name="1930"><span class="lineNum">    1930 </span>                :            :         }</a>
<a name="1931"><span class="lineNum">    1931 </span>                :            : </a>
<a name="1932"><span class="lineNum">    1932 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 64 times"> + </span>]:<span class="lineCov">         66 :         if (strWalletPass.empty()) {</span></a>
<a name="1933"><span class="lineNum">    1933 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;passphrase can not be empty&quot;);</span></a>
<a name="1934"><span class="lineNum">    1934 </span>                :            :         }</a>
<a name="1935"><span class="lineNum">    1935 </span>                :            : </a>
<a name="1936"><span class="lineNum">    1936 </span>  [<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 60 times"> + </span>]:<span class="lineCov">         64 :         if (!pwallet-&gt;Unlock(strWalletPass)) {</span></a>
<a name="1937"><span class="lineNum">    1937 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :             throw JSONRPCError(RPC_WALLET_PASSPHRASE_INCORRECT, &quot;Error: The wallet passphrase entered was incorrect.&quot;);</span></a>
<a name="1938"><span class="lineNum">    1938 </span>                :            :         }</a>
<a name="1939"><span class="lineNum">    1939 </span>                :            : </a>
<a name="1940"><span class="lineNum">    1940 </span>        [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         60 :         pwallet-&gt;TopUpKeyPool();</span></a>
<a name="1941"><span class="lineNum">    1941 </span>                :            : </a>
<a name="1942"><span class="lineNum">    1942 </span>        [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         60 :         pwallet-&gt;nRelockTime = GetTime() + nSleepTime;</span></a>
<a name="1943"><span class="lineNum">    1943 </span>                :<span class="lineCov">         60 :         relock_time = pwallet-&gt;nRelockTime;</span></a>
<a name="1944"><span class="lineNum">    1944 </span>                :            :     }</a>
<a name="1945"><span class="lineNum">    1945 </span>                :            : </a>
<a name="1946"><span class="lineNum">    1946 </span>                :            :     // rpcRunLater must be called without cs_wallet held otherwise a deadlock</a>
<a name="1947"><span class="lineNum">    1947 </span>                :            :     // can occur. The deadlock would happen when RPCRunLater removes the</a>
<a name="1948"><span class="lineNum">    1948 </span>                :            :     // previous timer (and waits for the callback to finish if already running)</a>
<a name="1949"><span class="lineNum">    1949 </span>                :            :     // and the callback locks cs_wallet.</a>
<a name="1950"><span class="lineNum">    1950 </span>        [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         60 :     AssertLockNotHeld(wallet-&gt;cs_wallet);</span></a>
<a name="1951"><span class="lineNum">    1951 </span>                :            :     // Keep a weak pointer to the wallet so that it is possible to unload the</a>
<a name="1952"><span class="lineNum">    1952 </span>                :            :     // wallet before the following callback is called. If a valid shared pointer</a>
<a name="1953"><span class="lineNum">    1953 </span>                :            :     // is acquired in the callback then the wallet is still loaded.</a>
<a name="1954"><span class="lineNum">    1954 </span>  [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        120 :     std::weak_ptr&lt;CWallet&gt; weak_wallet = wallet;</span></a>
<a name="1955"><span class="lineNum">    1955 </span>  [<span class="branchCov" title="Branch 0 was taken 120 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        424 :     pwallet-&gt;chain().rpcRunLater(strprintf(&quot;lockwallet(%s)&quot;, pwallet-&gt;GetName()), [weak_wallet, relock_time] {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 4 times"> + </span>]
<a name="1956"><span class="lineNum">    1956 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">         14 :         if (auto shared_wallet = weak_wallet.lock()) {</span></a>
<a name="1957"><span class="lineNum">    1957 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 3 times"> + </span>]:<span class="lineCov">         11 :             LOCK(shared_wallet-&gt;cs_wallet);</span></a>
<a name="1958"><span class="lineNum">    1958 </span>                :            :             // Skip if this is not the most recent rpcRunLater callback.</a>
<a name="1959"><span class="lineNum">    1959 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :             if (shared_wallet-&gt;nRelockTime != relock_time) return;</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1960"><span class="lineNum">    1960 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :             shared_wallet-&gt;Lock();</span></a>
<a name="1961"><span class="lineNum">    1961 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :             shared_wallet-&gt;nRelockTime = 0;</span></a>
<a name="1962"><span class="lineNum">    1962 </span>                :            :         }</a>
<a name="1963"><span class="lineNum">    1963 </span>  [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        180 :     }, nSleepTime);</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 60 times"> + </span>]
<a name="1964"><span class="lineNum">    1964 </span>                :            : </a>
<a name="1965"><span class="lineNum">    1965 </span>        [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         60 :     return NullUniValue;</span></a>
<a name="1966"><span class="lineNum">    1966 </span>                :            : },</a>
<a name="1967"><span class="lineNum">    1967 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15480 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1548 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1548 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 3096 times"> + </span><span class="branchCov" title="Branch 25 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="1968"><span class="lineNum">    1968 </span>                :            : }</a>
<a name="1969"><span class="lineNum">    1969 </span>                :            : </a>
<a name="1970"><span class="lineNum">    1970 </span>                :            : </a>
<a name="1971"><span class="lineNum">    1971 </span>                :<span class="lineCov">       1478 : static RPCHelpMan walletpassphrasechange()</span></a>
<a name="1972"><span class="lineNum">    1972 </span>                :            : {</a>
<a name="1973"><span class="lineNum">    1973 </span>                :<span class="lineCov">       1478 :     return RPCHelpMan{&quot;walletpassphrasechange&quot;,</span></a>
<a name="1974"><span class="lineNum">    1974 </span>                :            :                 &quot;\nChanges the wallet passphrase from 'oldpassphrase' to 'newpassphrase'.\n&quot;,</a>
<a name="1975"><span class="lineNum">    1975 </span>                :            :                 {</a>
<a name="1976"><span class="lineNum">    1976 </span>                :<span class="lineCov">       1478 :                     {&quot;oldpassphrase&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The current passphrase&quot;},</span></a>
<a name="1977"><span class="lineNum">    1977 </span>                :<span class="lineCov">       1478 :                     {&quot;newpassphrase&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The new passphrase&quot;},</span></a>
<a name="1978"><span class="lineNum">    1978 </span>                :            :                 },</a>
<a name="1979"><span class="lineNum">    1979 </span>  [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2956 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1980"><span class="lineNum">    1980 </span>                :<span class="lineCov">       1478 :                 RPCExamples{</span></a>
<a name="1981"><span class="lineNum">    1981 </span>  [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2956 :                     HelpExampleCli(&quot;walletpassphrasechange&quot;, &quot;\&quot;old one\&quot; \&quot;new one\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="1982"><span class="lineNum">    1982 </span>  [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5912 :             + HelpExampleRpc(&quot;walletpassphrasechange&quot;, &quot;\&quot;old one\&quot;, \&quot;new one\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="1983"><span class="lineNum">    1983 </span>                :<span class="lineCov">       1478 :                 },</span></a>
<a name="1984"><span class="lineNum">    1984 </span>                :<span class="lineCov">          6 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="1985"><span class="lineNum">    1985 </span>                :            : {</a>
<a name="1986"><span class="lineNum">    1986 </span>                :<span class="lineCov">          8 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="1987"><span class="lineNum">    1987 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :     if (!pwallet) return NullUniValue;</span></a>
<a name="1988"><span class="lineNum">    1988 </span>                :            : </a>
<a name="1989"><span class="lineNum">    1989 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="1990"><span class="lineNum">    1990 </span>                :            : </a>
<a name="1991"><span class="lineNum">    1991 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span>]:<span class="lineCov">          6 :     if (!pwallet-&gt;IsCrypted()) {</span></a>
<a name="1992"><span class="lineNum">    1992 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_WALLET_WRONG_ENC_STATE, &quot;Error: running with an unencrypted wallet, but walletpassphrasechange was called.&quot;);</span></a>
<a name="1993"><span class="lineNum">    1993 </span>                :            :     }</a>
<a name="1994"><span class="lineNum">    1994 </span>                :            : </a>
<a name="1995"><span class="lineNum">    1995 </span>                :            :     // TODO: get rid of these .c_str() calls by implementing SecureString::operator=(std::string)</a>
<a name="1996"><span class="lineNum">    1996 </span>                :            :     // Alternately, find a way to make request.params[0] mlock()'d to begin with.</a>
<a name="1997"><span class="lineNum">    1997 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :     SecureString strOldWalletPass;</span></a>
<a name="1998"><span class="lineNum">    1998 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :     strOldWalletPass.reserve(100);</span></a>
<a name="1999"><span class="lineNum">    1999 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :     strOldWalletPass = request.params[0].get_str().c_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2000"><span class="lineNum">    2000 </span>                :            : </a>
<a name="2001"><span class="lineNum">    2001 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :     SecureString strNewWalletPass;</span></a>
<a name="2002"><span class="lineNum">    2002 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :     strNewWalletPass.reserve(100);</span></a>
<a name="2003"><span class="lineNum">    2003 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :     strNewWalletPass = request.params[1].get_str().c_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2004"><span class="lineNum">    2004 </span>                :            : </a>
<a name="2005"><span class="lineNum">    2005 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          4 :     if (strOldWalletPass.empty() || strNewWalletPass.empty()) {</span></a>
<a name="2006"><span class="lineNum">    2006 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;passphrase can not be empty&quot;);</span></a>
<a name="2007"><span class="lineNum">    2007 </span>                :            :     }</a>
<a name="2008"><span class="lineNum">    2008 </span>                :            : </a>
<a name="2009"><span class="lineNum">    2009 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          2 :     if (!pwallet-&gt;ChangeWalletPassphrase(strOldWalletPass, strNewWalletPass)) {</span></a>
<a name="2010"><span class="lineNum">    2010 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_PASSPHRASE_INCORRECT, &quot;Error: The wallet passphrase entered was incorrect.&quot;);</span></a>
<a name="2011"><span class="lineNum">    2011 </span>                :            :     }</a>
<a name="2012"><span class="lineNum">    2012 </span>                :            : </a>
<a name="2013"><span class="lineNum">    2013 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          2 :     return NullUniValue;</span></a>
<a name="2014"><span class="lineNum">    2014 </span>                :            : },</a>
<a name="2015"><span class="lineNum">    2015 </span>  [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14780 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1478 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1478 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 2956 times"> + </span><span class="branchCov" title="Branch 25 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="2016"><span class="lineNum">    2016 </span>                :            : }</a>
<a name="2017"><span class="lineNum">    2017 </span>                :            : </a>
<a name="2018"><span class="lineNum">    2018 </span>                :            : </a>
<a name="2019"><span class="lineNum">    2019 </span>                :<span class="lineCov">       1488 : static RPCHelpMan walletlock()</span></a>
<a name="2020"><span class="lineNum">    2020 </span>                :            : {</a>
<a name="2021"><span class="lineNum">    2021 </span>                :<span class="lineCov">       1488 :     return RPCHelpMan{&quot;walletlock&quot;,</span></a>
<a name="2022"><span class="lineNum">    2022 </span>                :            :                 &quot;\nRemoves the wallet encryption key from memory, locking the wallet.\n&quot;</a>
<a name="2023"><span class="lineNum">    2023 </span>                :            :                 &quot;After calling this method, you will need to call walletpassphrase again\n&quot;</a>
<a name="2024"><span class="lineNum">    2024 </span>                :            :                 &quot;before being able to call any methods which require the wallet to be unlocked.\n&quot;,</a>
<a name="2025"><span class="lineNum">    2025 </span>                :            :                 {},</a>
<a name="2026"><span class="lineNum">    2026 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2976 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2027"><span class="lineNum">    2027 </span>                :<span class="lineCov">       1488 :                 RPCExamples{</span></a>
<a name="2028"><span class="lineNum">    2028 </span>                :            :             &quot;\nSet the passphrase for 2 minutes to perform a transaction\n&quot;</a>
<a name="2029"><span class="lineNum">    2029 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2976 :             + HelpExampleCli(&quot;walletpassphrase&quot;, &quot;\&quot;my pass phrase\&quot; 120&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2030"><span class="lineNum">    2030 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :             &quot;\nPerform a send (requires passphrase set)\n&quot;</span></a>
<a name="2031"><span class="lineNum">    2031 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5952 :             + HelpExampleCli(&quot;sendtoaddress&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot; 1.0&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1488 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="2032"><span class="lineNum">    2032 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :             &quot;\nClear the passphrase since we are done before 2 minutes is up\n&quot;</span></a>
<a name="2033"><span class="lineNum">    2033 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5952 :             + HelpExampleCli(&quot;walletlock&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2034"><span class="lineNum">    2034 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="2035"><span class="lineNum">    2035 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5952 :             + HelpExampleRpc(&quot;walletlock&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2036"><span class="lineNum">    2036 </span>                :<span class="lineCov">       1488 :                 },</span></a>
<a name="2037"><span class="lineNum">    2037 </span>                :<span class="lineCov">         16 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2038"><span class="lineNum">    2038 </span>                :            : {</a>
<a name="2039"><span class="lineNum">    2039 </span>                :<span class="lineCov">         32 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2040"><span class="lineNum">    2040 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2041"><span class="lineNum">    2041 </span>                :            : </a>
<a name="2042"><span class="lineNum">    2042 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         32 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="2043"><span class="lineNum">    2043 </span>                :            : </a>
<a name="2044"><span class="lineNum">    2044 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 16 times"> + </span>]:<span class="lineCov">         16 :     if (!pwallet-&gt;IsCrypted()) {</span></a>
<a name="2045"><span class="lineNum">    2045 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_WRONG_ENC_STATE, &quot;Error: running with an unencrypted wallet, but walletlock was called.&quot;);</span></a>
<a name="2046"><span class="lineNum">    2046 </span>                :            :     }</a>
<a name="2047"><span class="lineNum">    2047 </span>                :            : </a>
<a name="2048"><span class="lineNum">    2048 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :     pwallet-&gt;Lock();</span></a>
<a name="2049"><span class="lineNum">    2049 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :     pwallet-&gt;nRelockTime = 0;</span></a>
<a name="2050"><span class="lineNum">    2050 </span>                :            : </a>
<a name="2051"><span class="lineNum">    2051 </span>        [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :     return NullUniValue;</span></a>
<a name="2052"><span class="lineNum">    2052 </span>                :            : },</a>
<a name="2053"><span class="lineNum">    2053 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8928 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2054"><span class="lineNum">    2054 </span>                :            : }</a>
<a name="2055"><span class="lineNum">    2055 </span>                :            : </a>
<a name="2056"><span class="lineNum">    2056 </span>                :            : </a>
<a name="2057"><span class="lineNum">    2057 </span>                :<span class="lineCov">       1502 : static RPCHelpMan encryptwallet()</span></a>
<a name="2058"><span class="lineNum">    2058 </span>                :            : {</a>
<a name="2059"><span class="lineNum">    2059 </span>                :<span class="lineCov">       1502 :     return RPCHelpMan{&quot;encryptwallet&quot;,</span></a>
<a name="2060"><span class="lineNum">    2060 </span>                :            :                 &quot;\nEncrypts the wallet with 'passphrase'. This is for first time encryption.\n&quot;</a>
<a name="2061"><span class="lineNum">    2061 </span>                :            :                 &quot;After this, any calls that interact with private keys such as sending or signing \n&quot;</a>
<a name="2062"><span class="lineNum">    2062 </span>                :            :                 &quot;will require the passphrase to be set prior the making these calls.\n&quot;</a>
<a name="2063"><span class="lineNum">    2063 </span>                :            :                 &quot;Use the walletpassphrase call for this, and then walletlock call.\n&quot;</a>
<a name="2064"><span class="lineNum">    2064 </span>                :            :                 &quot;If the wallet is already encrypted, use the walletpassphrasechange call.\n&quot;,</a>
<a name="2065"><span class="lineNum">    2065 </span>                :            :                 {</a>
<a name="2066"><span class="lineNum">    2066 </span>                :<span class="lineCov">       1502 :                     {&quot;passphrase&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The pass phrase to encrypt the wallet with. It must be at least 1 character, but should be long.&quot;},</span></a>
<a name="2067"><span class="lineNum">    2067 </span>                :            :                 },</a>
<a name="2068"><span class="lineNum">    2068 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3004 :                 RPCResult{RPCResult::Type::STR, &quot;&quot;, &quot;A string with further instructions&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2069"><span class="lineNum">    2069 </span>                :<span class="lineCov">       1502 :                 RPCExamples{</span></a>
<a name="2070"><span class="lineNum">    2070 </span>                :            :             &quot;\nEncrypt your wallet\n&quot;</a>
<a name="2071"><span class="lineNum">    2071 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3004 :             + HelpExampleCli(&quot;encryptwallet&quot;, &quot;\&quot;my pass phrase\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2072"><span class="lineNum">    2072 </span>        [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1502 :             &quot;\nNow set the passphrase to use the wallet, such as for signing or sending bitcoin\n&quot;</span></a>
<a name="2073"><span class="lineNum">    2073 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6008 :             + HelpExampleCli(&quot;walletpassphrase&quot;, &quot;\&quot;my pass phrase\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2074"><span class="lineNum">    2074 </span>        [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1502 :             &quot;\nNow we can do something like sign\n&quot;</span></a>
<a name="2075"><span class="lineNum">    2075 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6008 :             + HelpExampleCli(&quot;signmessage&quot;, &quot;\&quot;address\&quot; \&quot;test message\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2076"><span class="lineNum">    2076 </span>        [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1502 :             &quot;\nNow lock the wallet again by removing the passphrase\n&quot;</span></a>
<a name="2077"><span class="lineNum">    2077 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6008 :             + HelpExampleCli(&quot;walletlock&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2078"><span class="lineNum">    2078 </span>        [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1502 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="2079"><span class="lineNum">    2079 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6008 :             + HelpExampleRpc(&quot;encryptwallet&quot;, &quot;\&quot;my pass phrase\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2080"><span class="lineNum">    2080 </span>                :<span class="lineCov">       1502 :                 },</span></a>
<a name="2081"><span class="lineNum">    2081 </span>                :<span class="lineCov">         30 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2082"><span class="lineNum">    2082 </span>                :            : {</a>
<a name="2083"><span class="lineNum">    2083 </span>                :<span class="lineCov">         53 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2084"><span class="lineNum">    2084 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         30 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2085"><span class="lineNum">    2085 </span>                :            : </a>
<a name="2086"><span class="lineNum">    2086 </span>  [<span class="branchCov" title="Branch 0 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 23 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         60 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="2087"><span class="lineNum">    2087 </span>                :            : </a>
<a name="2088"><span class="lineNum">    2088 </span>  [<span class="branchCov" title="Branch 0 was taken 30 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchCov" title="Branch 3 was taken 27 times"> + </span>]:<span class="lineCov">         30 :     if (pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<a name="2089"><span class="lineNum">    2089 </span>  [<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         throw JSONRPCError(RPC_WALLET_ENCRYPTION_FAILED, &quot;Error: wallet does not contain private keys, nothing to encrypt.&quot;);</span></a>
<a name="2090"><span class="lineNum">    2090 </span>                :            :     }</a>
<a name="2091"><span class="lineNum">    2091 </span>                :            : </a>
<a name="2092"><span class="lineNum">    2092 </span>  [<span class="branchCov" title="Branch 0 was taken 27 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 25 times"> + </span>]:<span class="lineCov">         27 :     if (pwallet-&gt;IsCrypted()) {</span></a>
<a name="2093"><span class="lineNum">    2093 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_WALLET_WRONG_ENC_STATE, &quot;Error: running with an encrypted wallet, but encryptwallet was called.&quot;);</span></a>
<a name="2094"><span class="lineNum">    2094 </span>                :            :     }</a>
<a name="2095"><span class="lineNum">    2095 </span>                :            : </a>
<a name="2096"><span class="lineNum">    2096 </span>                :            :     // TODO: get rid of this .c_str() by implementing SecureString::operator=(std::string)</a>
<a name="2097"><span class="lineNum">    2097 </span>                :            :     // Alternately, find a way to make request.params[0] mlock()'d to begin with.</a>
<a name="2098"><span class="lineNum">    2098 </span>  [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 23 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         50 :     SecureString strWalletPass;</span></a>
<a name="2099"><span class="lineNum">    2099 </span>        [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         25 :     strWalletPass.reserve(100);</span></a>
<a name="2100"><span class="lineNum">    2100 </span>  [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         25 :     strWalletPass = request.params[0].get_str().c_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2101"><span class="lineNum">    2101 </span>                :            : </a>
<a name="2102"><span class="lineNum">    2102 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 23 times"> + </span>]:<span class="lineCov">         25 :     if (strWalletPass.empty()) {</span></a>
<a name="2103"><span class="lineNum">    2103 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;passphrase can not be empty&quot;);</span></a>
<a name="2104"><span class="lineNum">    2104 </span>                :            :     }</a>
<a name="2105"><span class="lineNum">    2105 </span>                :            : </a>
<a name="2106"><span class="lineNum">    2106 </span>  [<span class="branchCov" title="Branch 0 was taken 23 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 23 times"> + </span>]:<span class="lineCov">         23 :     if (!pwallet-&gt;EncryptWallet(strWalletPass)) {</span></a>
<a name="2107"><span class="lineNum">    2107 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ENCRYPTION_FAILED, &quot;Error: Failed to encrypt the wallet.&quot;);</span></a>
<a name="2108"><span class="lineNum">    2108 </span>                :            :     }</a>
<a name="2109"><span class="lineNum">    2109 </span>                :            : </a>
<a name="2110"><span class="lineNum">    2110 </span>        [<span class="branchCov" title="Branch 0 was taken 23 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         23 :     return &quot;wallet encrypted; The keypool has been flushed and a new HD seed was generated (if you are using HD). You need to make a new backup.&quot;;</span></a>
<a name="2111"><span class="lineNum">    2111 </span>                :            : },</a>
<a name="2112"><span class="lineNum">    2112 </span>  [<span class="branchCov" title="Branch 0 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      12016 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1502 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1502 times"> + </span><span class="branchCov" title="Branch 17 was taken 1502 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="2113"><span class="lineNum">    2113 </span>                :            : }</a>
<a name="2114"><span class="lineNum">    2114 </span>                :            : </a>
<a name="2115"><span class="lineNum">    2115 </span>                :<span class="lineCov">       1537 : static RPCHelpMan lockunspent()</span></a>
<a name="2116"><span class="lineNum">    2116 </span>                :            : {</a>
<a name="2117"><span class="lineNum">    2117 </span>                :<span class="lineCov">       1537 :     return RPCHelpMan{&quot;lockunspent&quot;,</span></a>
<a name="2118"><span class="lineNum">    2118 </span>                :            :                 &quot;\nUpdates list of temporarily unspendable outputs.\n&quot;</a>
<a name="2119"><span class="lineNum">    2119 </span>                :            :                 &quot;Temporarily lock (unlock=false) or unlock (unlock=true) specified transaction outputs.\n&quot;</a>
<a name="2120"><span class="lineNum">    2120 </span>                :            :                 &quot;If no transaction outputs are specified when unlocking then all current locked transaction outputs are unlocked.\n&quot;</a>
<a name="2121"><span class="lineNum">    2121 </span>                :            :                 &quot;A locked transaction output will not be chosen by automatic coin selection, when spending bitcoins.\n&quot;</a>
<a name="2122"><span class="lineNum">    2122 </span>                :            :                 &quot;Manually selected coins are automatically unlocked.\n&quot;</a>
<a name="2123"><span class="lineNum">    2123 </span>                :            :                 &quot;Locks are stored in memory only, unless persistent=true, in which case they will be written to the\n&quot;</a>
<a name="2124"><span class="lineNum">    2124 </span>                :            :                 &quot;wallet database and loaded on node start. Unwritten (persistent=false) locks are always cleared\n&quot;</a>
<a name="2125"><span class="lineNum">    2125 </span>                :            :                 &quot;(by virtue of process exit) when a node stops or fails. Unlocking will clear both persistent and not.\n&quot;</a>
<a name="2126"><span class="lineNum">    2126 </span>                :            :                 &quot;Also see the listunspent call\n&quot;,</a>
<a name="2127"><span class="lineNum">    2127 </span>                :            :                 {</a>
<a name="2128"><span class="lineNum">    2128 </span>                :<span class="lineCov">       1537 :                     {&quot;unlock&quot;, RPCArg::Type::BOOL, RPCArg::Optional::NO, &quot;Whether to unlock (true) or lock (false) the specified transactions&quot;},</span></a>
<a name="2129"><span class="lineNum">    2129 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3074 :                     {&quot;transactions&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;The transaction outputs and within each, the txid (string) vout (numeric).&quot;,</span></a>
<a name="2130"><span class="lineNum">    2130 </span>                :            :                         {</a>
<a name="2131"><span class="lineNum">    2131 </span>                :<span class="lineCov">       1537 :                             {&quot;&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="2132"><span class="lineNum">    2132 </span>                :            :                                 {</a>
<a name="2133"><span class="lineNum">    2133 </span>                :<span class="lineCov">       1537 :                                     {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="2134"><span class="lineNum">    2134 </span>                :<span class="lineCov">       1537 :                                     {&quot;vout&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The output number&quot;},</span></a>
<a name="2135"><span class="lineNum">    2135 </span>                :            :                                 },</a>
<a name="2136"><span class="lineNum">    2136 </span>                :            :                             },</a>
<a name="2137"><span class="lineNum">    2137 </span>                :            :                         },</a>
<a name="2138"><span class="lineNum">    2138 </span>                :            :                     },</a>
<a name="2139"><span class="lineNum">    2139 </span>        [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3074 :                     {&quot;persistent&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Whether to write/erase this lock in the wallet database, or keep the change in memory only. Ignored for unlocking.&quot;},</span></a>
<a name="2140"><span class="lineNum">    2140 </span>                :            :                 },</a>
<a name="2141"><span class="lineNum">    2141 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2142"><span class="lineNum">    2142 </span>                :            :                     RPCResult::Type::BOOL, &quot;&quot;, &quot;Whether the command was successful or not&quot;</a>
<a name="2143"><span class="lineNum">    2143 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3074 :                 },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2144"><span class="lineNum">    2144 </span>                :<span class="lineCov">       1537 :                 RPCExamples{</span></a>
<a name="2145"><span class="lineNum">    2145 </span>                :            :             &quot;\nList the unspent transactions\n&quot;</a>
<a name="2146"><span class="lineNum">    2146 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3074 :             + HelpExampleCli(&quot;listunspent&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2147"><span class="lineNum">    2147 </span>        [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1537 :             &quot;\nLock an unspent transaction\n&quot;</span></a>
<a name="2148"><span class="lineNum">    2148 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6148 :             + HelpExampleCli(&quot;lockunspent&quot;, &quot;false \&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\&quot;,\\\&quot;vout\\\&quot;:1}]\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2149"><span class="lineNum">    2149 </span>        [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1537 :             &quot;\nList the locked transactions\n&quot;</span></a>
<a name="2150"><span class="lineNum">    2150 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6148 :             + HelpExampleCli(&quot;listlockunspent&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2151"><span class="lineNum">    2151 </span>        [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1537 :             &quot;\nUnlock the transaction again\n&quot;</span></a>
<a name="2152"><span class="lineNum">    2152 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6148 :             + HelpExampleCli(&quot;lockunspent&quot;, &quot;true \&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\&quot;,\\\&quot;vout\\\&quot;:1}]\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2153"><span class="lineNum">    2153 </span>        [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1537 :             &quot;\nLock the transaction persistently in the wallet database\n&quot;</span></a>
<a name="2154"><span class="lineNum">    2154 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6148 :             + HelpExampleCli(&quot;lockunspent&quot;, &quot;false \&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\&quot;,\\\&quot;vout\\\&quot;:1}]\&quot; true&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2155"><span class="lineNum">    2155 </span>        [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1537 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="2156"><span class="lineNum">    2156 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6148 :             + HelpExampleRpc(&quot;lockunspent&quot;, &quot;false, \&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\&quot;,\\\&quot;vout\\\&quot;:1}]\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2157"><span class="lineNum">    2157 </span>                :<span class="lineCov">       1537 :                 },</span></a>
<a name="2158"><span class="lineNum">    2158 </span>                :<span class="lineCov">         65 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2159"><span class="lineNum">    2159 </span>                :            : {</a>
<a name="2160"><span class="lineNum">    2160 </span>                :<span class="lineCov">        112 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2161"><span class="lineNum">    2161 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         65 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2162"><span class="lineNum">    2162 </span>                :            : </a>
<a name="2163"><span class="lineNum">    2163 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="2164"><span class="lineNum">    2164 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="2165"><span class="lineNum">    2165 </span>        [<span class="branchCov" title="Branch 0 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         65 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="2166"><span class="lineNum">    2166 </span>                :            : </a>
<a name="2167"><span class="lineNum">    2167 </span>  [<span class="branchCov" title="Branch 0 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 47 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        130 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="2168"><span class="lineNum">    2168 </span>                :            : </a>
<a name="2169"><span class="lineNum">    2169 </span>  [<span class="branchCov" title="Branch 0 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         65 :     RPCTypeCheckArgument(request.params[0], UniValue::VBOOL);</span></a>
<a name="2170"><span class="lineNum">    2170 </span>                :            : </a>
<a name="2171"><span class="lineNum">    2171 </span>  [<span class="branchCov" title="Branch 0 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         65 :     bool fUnlock = request.params[0].get_bool();</span></a>
<a name="2172"><span class="lineNum">    2172 </span>                :            : </a>
<a name="2173"><span class="lineNum">    2173 </span>  [<span class="branchCov" title="Branch 0 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 63 times"> + </span> :<span class="lineCov">         65 :     const bool persistent{request.params[2].isNull() ? false : request.params[2].get_bool()};</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2174"><span class="lineNum">    2174 </span>                :            : </a>
<a name="2175"><span class="lineNum">    2175 </span>  [<span class="branchCov" title="Branch 0 was taken 65 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 57 times"> + </span>]:<span class="lineCov">         65 :     if (request.params[1].isNull()) {</span></a>
<a name="2176"><span class="lineNum">    2176 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :         if (fUnlock) {</span></a>
<a name="2177"><span class="lineNum">    2177 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span>]:<span class="lineCov">          8 :             if (!pwallet-&gt;UnlockAllCoins())</span></a>
<a name="2178"><span class="lineNum">    2178 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_WALLET_ERROR, &quot;Unlocking coins failed&quot;);</span></a>
<a name="2179"><span class="lineNum">    2179 </span>                :            :         }</a>
<a name="2180"><span class="lineNum">    2180 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :         return true;</span></a>
<a name="2181"><span class="lineNum">    2181 </span>                :            :     }</a>
<a name="2182"><span class="lineNum">    2182 </span>                :            : </a>
<a name="2183"><span class="lineNum">    2183 </span>  [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         57 :     RPCTypeCheckArgument(request.params[1], UniValue::VARR);</span></a>
<a name="2184"><span class="lineNum">    2184 </span>                :            : </a>
<a name="2185"><span class="lineNum">    2185 </span>        [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         57 :     const UniValue&amp; output_params = request.params[1];</span></a>
<a name="2186"><span class="lineNum">    2186 </span>                :            : </a>
<a name="2187"><span class="lineNum">    2187 </span>                :            :     // Create and validate the COutPoints first.</a>
<a name="2188"><span class="lineNum">    2188 </span>                :            : </a>
<a name="2189"><span class="lineNum">    2189 </span>  [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 47 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        122 :     std::vector&lt;COutPoint&gt; outputs;</span></a>
<a name="2190"><span class="lineNum">    2190 </span>        [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         57 :     outputs.reserve(output_params.size());</span></a>
<a name="2191"><span class="lineNum">    2191 </span>                :            : </a>
<a name="2192"><span class="lineNum">    2192 </span>        [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchCov" title="Branch 1 was taken 39 times"> + </span>]:<span class="lineCov">        192 :     for (unsigned int idx = 0; idx &lt; output_params.size(); idx++) {</span></a>
<a name="2193"><span class="lineNum">    2193 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        153 :         const UniValue&amp; o = output_params[idx].get_obj();</span></a>
<a name="2194"><span class="lineNum">    2194 </span>                :            : </a>
<a name="2195"><span class="lineNum">    2195 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        306 :         RPCTypeCheckObj(o,</span></a>
<a name="2196"><span class="lineNum">    2196 </span>                :            :             {</a>
<a name="2197"><span class="lineNum">    2197 </span>        [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        153 :                 {&quot;txid&quot;, UniValueType(UniValue::VSTR)},</span></a>
<a name="2198"><span class="lineNum">    2198 </span>        [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        153 :                 {&quot;vout&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="2199"><span class="lineNum">    2199 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        918 :             });</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 306 times"> + </span><span class="branchCov" title="Branch 5 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2200"><span class="lineNum">    2200 </span>                :            : </a>
<a name="2201"><span class="lineNum">    2201 </span>  [<span class="branchCov" title="Branch 0 was taken 153 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 149 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span> :<span class="lineCov">        306 :         const uint256 txid(ParseHashO(o, &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2202"><span class="lineNum">    2202 </span>  [<span class="branchCov" title="Branch 0 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        149 :         const int nOutput = find_value(o, &quot;vout&quot;).get_int();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 149 times"> + </span>]
<a name="2203"><span class="lineNum">    2203 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 149 times"> + </span>]:<span class="lineCov">        149 :         if (nOutput &lt; 0) {</span></a>
<a name="2204"><span class="lineNum">    2204 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, vout cannot be negative&quot;);</span></a>
<a name="2205"><span class="lineNum">    2205 </span>                :            :         }</a>
<a name="2206"><span class="lineNum">    2206 </span>                :            : </a>
<a name="2207"><span class="lineNum">    2207 </span>                :<span class="lineCov">        149 :         const COutPoint outpt(txid, nOutput);</span></a>
<a name="2208"><span class="lineNum">    2208 </span>                :            : </a>
<a name="2209"><span class="lineNum">    2209 </span>                :<span class="lineCov">        149 :         const auto it = pwallet-&gt;mapWallet.find(outpt.hash);</span></a>
<a name="2210"><span class="lineNum">    2210 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 147 times"> + </span>]:<span class="lineCov">        149 :         if (it == pwallet-&gt;mapWallet.end()) {</span></a>
<a name="2211"><span class="lineNum">    2211 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, unknown transaction&quot;);</span></a>
<a name="2212"><span class="lineNum">    2212 </span>                :            :         }</a>
<a name="2213"><span class="lineNum">    2213 </span>                :            : </a>
<a name="2214"><span class="lineNum">    2214 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 145 times"> + </span>]:<span class="lineCov">        147 :         const CWalletTx&amp; trans = it-&gt;second;</span></a>
<a name="2215"><span class="lineNum">    2215 </span>                :            : </a>
<a name="2216"><span class="lineNum">    2216 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 145 times"> + </span>]:<span class="lineCov">        147 :         if (outpt.n &gt;= trans.tx-&gt;vout.size()) {</span></a>
<a name="2217"><span class="lineNum">    2217 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, vout index out of bounds&quot;);</span></a>
<a name="2218"><span class="lineNum">    2218 </span>                :            :         }</a>
<a name="2219"><span class="lineNum">    2219 </span>                :            : </a>
<a name="2220"><span class="lineNum">    2220 </span>  [<span class="branchCov" title="Branch 0 was taken 145 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 143 times"> + </span>]:<span class="lineCov">        145 :         if (pwallet-&gt;IsSpent(outpt.hash, outpt.n)) {</span></a>
<a name="2221"><span class="lineNum">    2221 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, expected unspent output&quot;);</span></a>
<a name="2222"><span class="lineNum">    2222 </span>                :            :         }</a>
<a name="2223"><span class="lineNum">    2223 </span>                :            : </a>
<a name="2224"><span class="lineNum">    2224 </span>        [<span class="branchCov" title="Branch 0 was taken 143 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        143 :         const bool is_locked = pwallet-&gt;IsLockedCoin(outpt.hash, outpt.n);</span></a>
<a name="2225"><span class="lineNum">    2225 </span>                :            : </a>
<a name="2226"><span class="lineNum">    2226 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 141 times"> + </span>]:<span class="lineCov">        143 :         if (fUnlock &amp;&amp; !is_locked) {</span></a>
<a name="2227"><span class="lineNum">    2227 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, expected locked output&quot;);</span></a>
<a name="2228"><span class="lineNum">    2228 </span>                :            :         }</a>
<a name="2229"><span class="lineNum">    2229 </span>                :            : </a>
<a name="2230"><span class="lineNum">    2230 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 133 times"> + </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">        141 :         if (!fUnlock &amp;&amp; is_locked &amp;&amp; !persistent) {</span></a>
<a name="2231"><span class="lineNum">    2231 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter, output already locked&quot;);</span></a>
<a name="2232"><span class="lineNum">    2232 </span>                :            :         }</a>
<a name="2233"><span class="lineNum">    2233 </span>                :            : </a>
<a name="2234"><span class="lineNum">    2234 </span>        [<span class="branchCov" title="Branch 0 was taken 135 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        135 :         outputs.push_back(outpt);</span></a>
<a name="2235"><span class="lineNum">    2235 </span>                :            :     }</a>
<a name="2236"><span class="lineNum">    2236 </span>                :            : </a>
<a name="2237"><span class="lineNum">    2237 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 33 times"> + </span>]:<span class="lineCov">         78 :     std::unique_ptr&lt;WalletBatch&gt; batch = nullptr;</span></a>
<a name="2238"><span class="lineNum">    2238 </span>                :            :     // Unlock is always persistent</a>
<a name="2239"><span class="lineNum">    2239 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 33 times"> + </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         45 :     if (fUnlock || persistent) batch = std::make_unique&lt;WalletBatch&gt;(pwallet-&gt;GetDatabase());</span></a>
<a name="2240"><span class="lineNum">    2240 </span>                :            : </a>
<a name="2241"><span class="lineNum">    2241 </span>                :            :     // Atomically set (un)locked status for the outputs.</a>
<a name="2242"><span class="lineNum">    2242 </span>        [<span class="branchCov" title="Branch 0 was taken 135 times"> + </span><span class="branchCov" title="Branch 1 was taken 39 times"> + </span>]:<span class="lineCov">        174 :     for (const COutPoint&amp; outpt : outputs) {</span></a>
<a name="2243"><span class="lineNum">    2243 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 131 times"> + </span>]:<span class="lineCov">        135 :         if (fUnlock) {</span></a>
<a name="2244"><span class="lineNum">    2244 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span> :<span class="lineCov">          4 :             if (!pwallet-&gt;UnlockCoin(outpt, batch.get())) throw JSONRPCError(RPC_WALLET_ERROR, &quot;Unlocking coin failed&quot;);</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2245"><span class="lineNum">    2245 </span>                :            :         } else {</a>
<a name="2246"><span class="lineNum">    2246 </span>  [<span class="branchCov" title="Branch 0 was taken 131 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 131 times"> + </span> :<span class="lineCov">        131 :             if (!pwallet-&gt;LockCoin(outpt, batch.get())) throw JSONRPCError(RPC_WALLET_ERROR, &quot;Locking coin failed&quot;);</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2247"><span class="lineNum">    2247 </span>                :            :         }</a>
<a name="2248"><span class="lineNum">    2248 </span>                :            :     }</a>
<a name="2249"><span class="lineNum">    2249 </span>                :            : </a>
<a name="2250"><span class="lineNum">    2250 </span>        [<span class="branchCov" title="Branch 0 was taken 39 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         39 :     return true;</span></a>
<a name="2251"><span class="lineNum">    2251 </span>                :            : },</a>
<a name="2252"><span class="lineNum">    2252 </span>  [<span class="branchCov" title="Branch 0 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      30740 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 4611 times"> + </span><span class="branchCov" title="Branch 61 was taken 1537 times"> + </span><span class="branchCov" title="Branch 62 was taken 1537 times"> + </span><span class="branchCov" title="Branch 63 was taken 1537 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 3074 times"> + </span><span class="branchCov" title="Branch 65 was taken 1537 times"> + </span><span class="branchNoCov" title="Branch 66 was not taken"> - </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchNoCov" title="Branch 70 was not taken"> - </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span>]
<a name="2253"><span class="lineNum">    2253 </span>                :            : }</a>
<a name="2254"><span class="lineNum">    2254 </span>                :            : </a>
<a name="2255"><span class="lineNum">    2255 </span>                :<span class="lineCov">       1490 : static RPCHelpMan listlockunspent()</span></a>
<a name="2256"><span class="lineNum">    2256 </span>                :            : {</a>
<a name="2257"><span class="lineNum">    2257 </span>                :<span class="lineCov">       1490 :     return RPCHelpMan{&quot;listlockunspent&quot;,</span></a>
<a name="2258"><span class="lineNum">    2258 </span>                :            :                 &quot;\nReturns list of temporarily unspendable outputs.\n&quot;</a>
<a name="2259"><span class="lineNum">    2259 </span>                :            :                 &quot;See the lockunspent call to lock and unlock transactions for spending.\n&quot;,</a>
<a name="2260"><span class="lineNum">    2260 </span>                :            :                 {},</a>
<a name="2261"><span class="lineNum">    2261 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2262"><span class="lineNum">    2262 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="2263"><span class="lineNum">    2263 </span>                :            :                     {</a>
<a name="2264"><span class="lineNum">    2264 </span>                :            :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2265"><span class="lineNum">    2265 </span>                :            :                         {</a>
<a name="2266"><span class="lineNum">    2266 </span>                :            :                             {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id locked&quot;},</a>
<a name="2267"><span class="lineNum">    2267 </span>                :            :                             {RPCResult::Type::NUM, &quot;vout&quot;, &quot;The vout value&quot;},</a>
<a name="2268"><span class="lineNum">    2268 </span>                :            :                         }},</a>
<a name="2269"><span class="lineNum">    2269 </span>                :            :                     }</a>
<a name="2270"><span class="lineNum">    2270 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7450 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1490 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1490 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1490 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 29 was taken 1490 times"> + </span><span class="branchCov" title="Branch 30 was taken 2980 times"> + </span><span class="branchCov" title="Branch 31 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>]
<a name="2271"><span class="lineNum">    2271 </span>                :<span class="lineCov">       1490 :                 RPCExamples{</span></a>
<a name="2272"><span class="lineNum">    2272 </span>                :            :             &quot;\nList the unspent transactions\n&quot;</a>
<a name="2273"><span class="lineNum">    2273 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2980 :             + HelpExampleCli(&quot;listunspent&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2274"><span class="lineNum">    2274 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nLock an unspent transaction\n&quot;</span></a>
<a name="2275"><span class="lineNum">    2275 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleCli(&quot;lockunspent&quot;, &quot;false \&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\&quot;,\\\&quot;vout\\\&quot;:1}]\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2276"><span class="lineNum">    2276 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nList the locked transactions\n&quot;</span></a>
<a name="2277"><span class="lineNum">    2277 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleCli(&quot;listlockunspent&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2278"><span class="lineNum">    2278 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nUnlock the transaction again\n&quot;</span></a>
<a name="2279"><span class="lineNum">    2279 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleCli(&quot;lockunspent&quot;, &quot;true \&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\&quot;,\\\&quot;vout\\\&quot;:1}]\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2280"><span class="lineNum">    2280 </span>        [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1490 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="2281"><span class="lineNum">    2281 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5960 :             + HelpExampleRpc(&quot;listlockunspent&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2282"><span class="lineNum">    2282 </span>                :<span class="lineCov">       1490 :                 },</span></a>
<a name="2283"><span class="lineNum">    2283 </span>                :<span class="lineCov">         18 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2284"><span class="lineNum">    2284 </span>                :            : {</a>
<a name="2285"><span class="lineNum">    2285 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         36 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2286"><span class="lineNum">    2286 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         18 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2287"><span class="lineNum">    2287 </span>                :            : </a>
<a name="2288"><span class="lineNum">    2288 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         36 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="2289"><span class="lineNum">    2289 </span>                :            : </a>
<a name="2290"><span class="lineNum">    2290 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         36 :     std::vector&lt;COutPoint&gt; vOutpts;</span></a>
<a name="2291"><span class="lineNum">    2291 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         18 :     pwallet-&gt;ListLockedCoins(vOutpts);</span></a>
<a name="2292"><span class="lineNum">    2292 </span>                :            : </a>
<a name="2293"><span class="lineNum">    2293 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         36 :     UniValue ret(UniValue::VARR);</span></a>
<a name="2294"><span class="lineNum">    2294 </span>                :            : </a>
<a name="2295"><span class="lineNum">    2295 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">         26 :     for (const COutPoint&amp; outpt : vOutpts) {</span></a>
<a name="2296"><span class="lineNum">    2296 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :         UniValue o(UniValue::VOBJ);</span></a>
<a name="2297"><span class="lineNum">    2297 </span>                :            : </a>
<a name="2298"><span class="lineNum">    2298 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         16 :         o.pushKV(&quot;txid&quot;, outpt.hash.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2299"><span class="lineNum">    2299 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         16 :         o.pushKV(&quot;vout&quot;, (int)outpt.n);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2300"><span class="lineNum">    2300 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :         ret.push_back(o);</span></a>
<a name="2301"><span class="lineNum">    2301 </span>                :            :     }</a>
<a name="2302"><span class="lineNum">    2302 </span>                :            : </a>
<a name="2303"><span class="lineNum">    2303 </span>                :<span class="lineCov">         18 :     return ret;</span></a>
<a name="2304"><span class="lineNum">    2304 </span>                :            : },</a>
<a name="2305"><span class="lineNum">    2305 </span>  [<span class="branchCov" title="Branch 0 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8940 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1490 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2306"><span class="lineNum">    2306 </span>                :            : }</a>
<a name="2307"><span class="lineNum">    2307 </span>                :            : </a>
<a name="2308"><span class="lineNum">    2308 </span>                :<span class="lineCov">       1503 : static RPCHelpMan settxfee()</span></a>
<a name="2309"><span class="lineNum">    2309 </span>                :            : {</a>
<a name="2310"><span class="lineNum">    2310 </span>                :<span class="lineCov">       1503 :     return RPCHelpMan{&quot;settxfee&quot;,</span></a>
<a name="2311"><span class="lineNum">    2311 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3006 :                 &quot;\nSet the transaction fee rate in &quot; + CURRENCY_UNIT + &quot;/kvB for this wallet. Overrides the global -paytxfee command line parameter.\n&quot;</span></a>
<a name="2312"><span class="lineNum">    2312 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1503 :                 &quot;Can be deactivated by passing 0 as the fee. In that case automatic fee selection will be used by default.\n&quot;,</span></a>
<a name="2313"><span class="lineNum">    2313 </span>                :            :                 {</a>
<a name="2314"><span class="lineNum">    2314 </span>        [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4509 :                     {&quot;amount&quot;, RPCArg::Type::AMOUNT, RPCArg::Optional::NO, &quot;The transaction fee rate in &quot; + CURRENCY_UNIT + &quot;/kvB&quot;},</span></a>
<a name="2315"><span class="lineNum">    2315 </span>                :            :                 },</a>
<a name="2316"><span class="lineNum">    2316 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2317"><span class="lineNum">    2317 </span>                :            :                     RPCResult::Type::BOOL, &quot;&quot;, &quot;Returns true if successful&quot;</a>
<a name="2318"><span class="lineNum">    2318 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3006 :                 },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2319"><span class="lineNum">    2319 </span>                :<span class="lineCov">       1503 :                 RPCExamples{</span></a>
<a name="2320"><span class="lineNum">    2320 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3006 :                     HelpExampleCli(&quot;settxfee&quot;, &quot;0.00001&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2321"><span class="lineNum">    2321 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6012 :             + HelpExampleRpc(&quot;settxfee&quot;, &quot;0.00001&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2322"><span class="lineNum">    2322 </span>                :<span class="lineCov">       1503 :                 },</span></a>
<a name="2323"><span class="lineNum">    2323 </span>                :<span class="lineCov">         31 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2324"><span class="lineNum">    2324 </span>                :            : {</a>
<a name="2325"><span class="lineNum">    2325 </span>                :<span class="lineCov">         56 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2326"><span class="lineNum">    2326 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         31 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2327"><span class="lineNum">    2327 </span>                :            : </a>
<a name="2328"><span class="lineNum">    2328 </span>  [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         62 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="2329"><span class="lineNum">    2329 </span>                :            : </a>
<a name="2330"><span class="lineNum">    2330 </span>  [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         31 :     CAmount nAmount = AmountFromValue(request.params[0]);</span></a>
<a name="2331"><span class="lineNum">    2331 </span>        [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         31 :     CFeeRate tx_fee_rate(nAmount, 1000);</span></a>
<a name="2332"><span class="lineNum">    2332 </span>        [<span class="branchCov" title="Branch 0 was taken 31 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         31 :     CFeeRate max_tx_fee_rate(pwallet-&gt;m_default_max_tx_fee, 1000);</span></a>
<a name="2333"><span class="lineNum">    2333 </span>        [<span class="branchCov" title="Branch 0 was taken 27 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">         31 :     if (tx_fee_rate == CFeeRate(0)) {</span></a>
<a name="2334"><span class="lineNum">    2334 </span>                :            :         // automatic selection</a>
<a name="2335"><span class="lineNum">    2335 </span>  [<span class="branchCov" title="Branch 0 was taken 27 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 25 times"> + </span>]:<span class="lineCov">         27 :     } else if (tx_fee_rate &lt; pwallet-&gt;chain().relayMinFee()) {</span></a>
<a name="2336"><span class="lineNum">    2336 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;txfee cannot be less than min relay tx fee (%s)&quot;, pwallet-&gt;chain().relayMinFee().ToString()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2337"><span class="lineNum">    2337 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 23 times"> + </span>]:<span class="lineCov">         25 :     } else if (tx_fee_rate &lt; pwallet-&gt;m_min_fee) {</span></a>
<a name="2338"><span class="lineNum">    2338 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;txfee cannot be less than wallet min fee (%s)&quot;, pwallet-&gt;m_min_fee.ToString()));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2339"><span class="lineNum">    2339 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 21 times"> + </span>]:<span class="lineCov">         23 :     } else if (tx_fee_rate &gt; max_tx_fee_rate) {</span></a>
<a name="2340"><span class="lineNum">    2340 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;txfee cannot be more than wallet max tx fee (%s)&quot;, max_tx_fee_rate.ToString()));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2341"><span class="lineNum">    2341 </span>                :            :     }</a>
<a name="2342"><span class="lineNum">    2342 </span>                :            : </a>
<a name="2343"><span class="lineNum">    2343 </span>        [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         25 :     pwallet-&gt;m_pay_tx_fee = tx_fee_rate;</span></a>
<a name="2344"><span class="lineNum">    2344 </span>        [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         25 :     return true;</span></a>
<a name="2345"><span class="lineNum">    2345 </span>                :            : },</a>
<a name="2346"><span class="lineNum">    2346 </span>  [<span class="branchCov" title="Branch 0 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      18036 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1503 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1503 times"> + </span><span class="branchCov" title="Branch 15 was taken 1503 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="2347"><span class="lineNum">    2347 </span>                :            : }</a>
<a name="2348"><span class="lineNum">    2348 </span>                :            : </a>
<a name="2349"><span class="lineNum">    2349 </span>                :<span class="lineCov">       2405 : static RPCHelpMan getbalances()</span></a>
<a name="2350"><span class="lineNum">    2350 </span>                :            : {</a>
<a name="2351"><span class="lineNum">    2351 </span>                :<span class="lineCov">       2405 :     return RPCHelpMan{</span></a>
<a name="2352"><span class="lineNum">    2352 </span>                :            :         &quot;getbalances&quot;,</a>
<a name="2353"><span class="lineNum">    2353 </span>  [<span class="branchCov" title="Branch 0 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4810 :         &quot;Returns an object with all balances in &quot; + CURRENCY_UNIT + &quot;.\n&quot;,</span></a>
<a name="2354"><span class="lineNum">    2354 </span>                :            :         {},</a>
<a name="2355"><span class="lineNum">    2355 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="2356"><span class="lineNum">    2356 </span>                :            :             RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2357"><span class="lineNum">    2357 </span>                :            :             {</a>
<a name="2358"><span class="lineNum">    2358 </span>                :            :                 {RPCResult::Type::OBJ, &quot;mine&quot;, &quot;balances from outputs that the wallet can sign&quot;,</a>
<a name="2359"><span class="lineNum">    2359 </span>                :            :                 {</a>
<a name="2360"><span class="lineNum">    2360 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;trusted&quot;, &quot;trusted balance (outputs created by the wallet or confirmed outputs)&quot;},</a>
<a name="2361"><span class="lineNum">    2361 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;untrusted_pending&quot;, &quot;untrusted pending balance (outputs created by others that are in the mempool)&quot;},</a>
<a name="2362"><span class="lineNum">    2362 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;immature&quot;, &quot;balance from immature coinbase outputs&quot;},</a>
<a name="2363"><span class="lineNum">    2363 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;used&quot;, /* optional */ true, &quot;(only present if avoid_reuse is set) balance from coins sent to addresses that were previously spent from (potentially privacy violating)&quot;},</a>
<a name="2364"><span class="lineNum">    2364 </span>                :            :                 }},</a>
<a name="2365"><span class="lineNum">    2365 </span>                :            :                 {RPCResult::Type::OBJ, &quot;watchonly&quot;, /* optional */ true, &quot;watchonly balances (not present if wallet does not watch anything)&quot;,</a>
<a name="2366"><span class="lineNum">    2366 </span>                :            :                 {</a>
<a name="2367"><span class="lineNum">    2367 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;trusted&quot;, &quot;trusted balance (outputs created by the wallet or confirmed outputs)&quot;},</a>
<a name="2368"><span class="lineNum">    2368 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;untrusted_pending&quot;, &quot;untrusted pending balance (outputs created by others that are in the mempool)&quot;},</a>
<a name="2369"><span class="lineNum">    2369 </span>                :            :                     {RPCResult::Type::STR_AMOUNT, &quot;immature&quot;, &quot;balance from immature coinbase outputs&quot;},</a>
<a name="2370"><span class="lineNum">    2370 </span>                :            :                 }},</a>
<a name="2371"><span class="lineNum">    2371 </span>                :            :             }</a>
<a name="2372"><span class="lineNum">    2372 </span>  [<span class="branchCov" title="Branch 0 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      26455 :             },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2405 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2405 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2405 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2405 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2405 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2405 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 4810 times"> + </span><span class="branchCov" title="Branch 67 was taken 2405 times"> + </span><span class="branchCov" title="Branch 68 was taken 7215 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 69 was taken 2405 times"> + </span><span class="branchCov" title="Branch 70 was taken 9620 times"> + </span><span class="branchCov" title="Branch 71 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 72 was not taken"> - </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 74 was not taken"> - </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchNoCov" title="Branch 76 was not taken"> - </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span>]
<a name="2373"><span class="lineNum">    2373 </span>                :<span class="lineCov">       2405 :         RPCExamples{</span></a>
<a name="2374"><span class="lineNum">    2374 </span>  [<span class="branchCov" title="Branch 0 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4810 :             HelpExampleCli(&quot;getbalances&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2375"><span class="lineNum">    2375 </span>  [<span class="branchCov" title="Branch 0 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7215 :             HelpExampleRpc(&quot;getbalances&quot;, &quot;&quot;)},</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2376"><span class="lineNum">    2376 </span>                :<span class="lineCov">        933 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2377"><span class="lineNum">    2377 </span>                :            : {</a>
<a name="2378"><span class="lineNum">    2378 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 929 times"> + </span>]:<span class="lineCov">       1862 :     const std::shared_ptr&lt;const CWallet&gt; rpc_wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2379"><span class="lineNum">    2379 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        929 :     if (!rpc_wallet) return NullUniValue;</span></a>
<a name="2380"><span class="lineNum">    2380 </span>        [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        929 :     const CWallet&amp; wallet = *rpc_wallet;</span></a>
<a name="2381"><span class="lineNum">    2381 </span>                :            : </a>
<a name="2382"><span class="lineNum">    2382 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="2383"><span class="lineNum">    2383 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="2384"><span class="lineNum">    2384 </span>        [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        929 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="2385"><span class="lineNum">    2385 </span>                :            : </a>
<a name="2386"><span class="lineNum">    2386 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1858 :     LOCK(wallet.cs_wallet);</span></a>
<a name="2387"><span class="lineNum">    2387 </span>                :            : </a>
<a name="2388"><span class="lineNum">    2388 </span>        [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        929 :     const auto bal = GetBalance(wallet);</span></a>
<a name="2389"><span class="lineNum">    2389 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1858 :     UniValue balances{UniValue::VOBJ};</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2390"><span class="lineNum">    2390 </span>                :<span class="lineCov">        929 :     {</span></a>
<a name="2391"><span class="lineNum">    2391 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1858 :         UniValue balances_mine{UniValue::VOBJ};</span></a>
<a name="2392"><span class="lineNum">    2392 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1858 :         balances_mine.pushKV(&quot;trusted&quot;, ValueFromAmount(bal.m_mine_trusted));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2393"><span class="lineNum">    2393 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1858 :         balances_mine.pushKV(&quot;untrusted_pending&quot;, ValueFromAmount(bal.m_mine_untrusted_pending));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2394"><span class="lineNum">    2394 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1858 :         balances_mine.pushKV(&quot;immature&quot;, ValueFromAmount(bal.m_mine_immature));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2395"><span class="lineNum">    2395 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchCov" title="Branch 3 was taken 901 times"> + </span>]:<span class="lineCov">        929 :         if (wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE)) {</span></a>
<a name="2396"><span class="lineNum">    2396 </span>                :            :             // If the AVOID_REUSE flag is set, bal has been set to just the un-reused address balance. Get</a>
<a name="2397"><span class="lineNum">    2397 </span>                :            :             // the total balance, and then subtract bal to get the reused address balance.</a>
<a name="2398"><span class="lineNum">    2398 </span>        [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         28 :             const auto full_bal = GetBalance(wallet, 0, false);</span></a>
<a name="2399"><span class="lineNum">    2399 </span>  [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         56 :             balances_mine.pushKV(&quot;used&quot;, ValueFromAmount(full_bal.m_mine_trusted + full_bal.m_mine_untrusted_pending - bal.m_mine_trusted - bal.m_mine_untrusted_pending));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2400"><span class="lineNum">    2400 </span>                :            :         }</a>
<a name="2401"><span class="lineNum">    2401 </span>  [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1858 :         balances.pushKV(&quot;mine&quot;, balances_mine);</span></a>
<a name="2402"><span class="lineNum">    2402 </span>                :            :     }</a>
<a name="2403"><span class="lineNum">    2403 </span>        [<span class="branchCov" title="Branch 0 was taken 929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        929 :     auto spk_man = wallet.GetLegacyScriptPubKeyMan();</span></a>
<a name="2404"><span class="lineNum">    2404 </span>  [<span class="branchCov" title="Branch 0 was taken 530 times"> + </span><span class="branchCov" title="Branch 1 was taken 399 times"> + </span><span class="branchCov" title="Branch 2 was taken 530 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        929 :     if (spk_man &amp;&amp; spk_man-&gt;HaveWatchOnly()) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchCov" title="Branch 5 was taken 517 times"> + </span>]
<a name="2405"><span class="lineNum">    2405 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         26 :         UniValue balances_watchonly{UniValue::VOBJ};</span></a>
<a name="2406"><span class="lineNum">    2406 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         26 :         balances_watchonly.pushKV(&quot;trusted&quot;, ValueFromAmount(bal.m_watchonly_trusted));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2407"><span class="lineNum">    2407 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         26 :         balances_watchonly.pushKV(&quot;untrusted_pending&quot;, ValueFromAmount(bal.m_watchonly_untrusted_pending));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2408"><span class="lineNum">    2408 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         26 :         balances_watchonly.pushKV(&quot;immature&quot;, ValueFromAmount(bal.m_watchonly_immature));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2409"><span class="lineNum">    2409 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         26 :         balances.pushKV(&quot;watchonly&quot;, balances_watchonly);</span></a>
<a name="2410"><span class="lineNum">    2410 </span>                :            :     }</a>
<a name="2411"><span class="lineNum">    2411 </span>                :<span class="lineCov">        929 :     return balances;</span></a>
<a name="2412"><span class="lineNum">    2412 </span>                :            : },</a>
<a name="2413"><span class="lineNum">    2413 </span>  [<span class="branchCov" title="Branch 0 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      19240 :     };</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2405 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2414"><span class="lineNum">    2414 </span>                :            : }</a>
<a name="2415"><span class="lineNum">    2415 </span>                :            : </a>
<a name="2416"><span class="lineNum">    2416 </span>                :<span class="lineCov">       2491 : static RPCHelpMan getwalletinfo()</span></a>
<a name="2417"><span class="lineNum">    2417 </span>                :            : {</a>
<a name="2418"><span class="lineNum">    2418 </span>                :<span class="lineCov">       2491 :     return RPCHelpMan{&quot;getwalletinfo&quot;,</span></a>
<a name="2419"><span class="lineNum">    2419 </span>                :            :                 &quot;Returns an object containing various wallet state info.\n&quot;,</a>
<a name="2420"><span class="lineNum">    2420 </span>                :            :                 {},</a>
<a name="2421"><span class="lineNum">    2421 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2422"><span class="lineNum">    2422 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2423"><span class="lineNum">    2423 </span>                :            :                     {</a>
<a name="2424"><span class="lineNum">    2424 </span>                :            :                         {</a>
<a name="2425"><span class="lineNum">    2425 </span>                :            :                         {RPCResult::Type::STR, &quot;walletname&quot;, &quot;the wallet name&quot;},</a>
<a name="2426"><span class="lineNum">    2426 </span>                :            :                         {RPCResult::Type::NUM, &quot;walletversion&quot;, &quot;the wallet version&quot;},</a>
<a name="2427"><span class="lineNum">    2427 </span>                :            :                         {RPCResult::Type::STR, &quot;format&quot;, &quot;the database format (bdb or sqlite)&quot;},</a>
<a name="2428"><span class="lineNum">    2428 </span>                :            :                         {RPCResult::Type::STR_AMOUNT, &quot;balance&quot;, &quot;DEPRECATED. Identical to getbalances().mine.trusted&quot;},</a>
<a name="2429"><span class="lineNum">    2429 </span>                :            :                         {RPCResult::Type::STR_AMOUNT, &quot;unconfirmed_balance&quot;, &quot;DEPRECATED. Identical to getbalances().mine.untrusted_pending&quot;},</a>
<a name="2430"><span class="lineNum">    2430 </span>                :            :                         {RPCResult::Type::STR_AMOUNT, &quot;immature_balance&quot;, &quot;DEPRECATED. Identical to getbalances().mine.immature&quot;},</a>
<a name="2431"><span class="lineNum">    2431 </span>                :            :                         {RPCResult::Type::NUM, &quot;txcount&quot;, &quot;the total number of transactions in the wallet&quot;},</a>
<a name="2432"><span class="lineNum">    2432 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4982 :                         {RPCResult::Type::NUM_TIME, &quot;keypoololdest&quot;, /* optional */ true, &quot;the &quot; + UNIX_EPOCH_TIME + &quot; of the oldest pre-generated key in the key pool. Legacy wallets only.&quot;},</span></a>
<a name="2433"><span class="lineNum">    2433 </span>                :            :                         {RPCResult::Type::NUM, &quot;keypoolsize&quot;, &quot;how many new keys are pre-generated (only counts external keys)&quot;},</a>
<a name="2434"><span class="lineNum">    2434 </span>                :            :                         {RPCResult::Type::NUM, &quot;keypoolsize_hd_internal&quot;, /* optional */ true, &quot;how many new keys are pre-generated for internal use (used for change outputs, only appears if the wallet is using this feature, otherwise external keys are used)&quot;},</a>
<a name="2435"><span class="lineNum">    2435 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4982 :                         {RPCResult::Type::NUM_TIME, &quot;unlocked_until&quot;, /* optional */ true, &quot;the &quot; + UNIX_EPOCH_TIME + &quot; until which the wallet is unlocked for transfers, or 0 if the wallet is locked (only present for passphrase-encrypted wallets)&quot;},</span></a>
<a name="2436"><span class="lineNum">    2436 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4982 :                         {RPCResult::Type::STR_AMOUNT, &quot;paytxfee&quot;, &quot;the transaction fee configuration, set in &quot; + CURRENCY_UNIT + &quot;/kvB&quot;},</span></a>
<a name="2437"><span class="lineNum">    2437 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hdseedid&quot;, /* optional */ true, &quot;the Hash160 of the HD seed (only present when HD is enabled)&quot;},</a>
<a name="2438"><span class="lineNum">    2438 </span>                :            :                         {RPCResult::Type::BOOL, &quot;private_keys_enabled&quot;, &quot;false if privatekeys are disabled for this wallet (enforced watch-only wallet)&quot;},</a>
<a name="2439"><span class="lineNum">    2439 </span>                :            :                         {RPCResult::Type::BOOL, &quot;avoid_reuse&quot;, &quot;whether this wallet tracks clean/dirty coins in terms of reuse&quot;},</a>
<a name="2440"><span class="lineNum">    2440 </span>                :            :                         {RPCResult::Type::OBJ, &quot;scanning&quot;, &quot;current scanning details, or false if no scan is in progress&quot;,</a>
<a name="2441"><span class="lineNum">    2441 </span>                :            :                         {</a>
<a name="2442"><span class="lineNum">    2442 </span>                :            :                             {RPCResult::Type::NUM, &quot;duration&quot;, &quot;elapsed seconds since scan start&quot;},</a>
<a name="2443"><span class="lineNum">    2443 </span>                :            :                             {RPCResult::Type::NUM, &quot;progress&quot;, &quot;scanning progress percentage [0.0, 1.0]&quot;},</a>
<a name="2444"><span class="lineNum">    2444 </span>                :            :                         }},</a>
<a name="2445"><span class="lineNum">    2445 </span>                :            :                         {RPCResult::Type::BOOL, &quot;descriptors&quot;, &quot;whether this wallet uses descriptors for scriptPubKey management&quot;},</a>
<a name="2446"><span class="lineNum">    2446 </span>                :            :                     }},</a>
<a name="2447"><span class="lineNum">    2447 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      67257 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 2491 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchCov" title="Branch 116 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span><span class="branchCov" title="Branch 118 was taken 42347 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 119 was taken 2491 times"> + </span><span class="branchCov" title="Branch 120 was taken 4982 times"> + </span><span class="branchCov" title="Branch 121 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 122 was not taken"> - </span><span class="branchNoCov" title="Branch 123 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 124 was not taken"> - </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span>]
<a name="2448"><span class="lineNum">    2448 </span>                :<span class="lineCov">       2491 :                 RPCExamples{</span></a>
<a name="2449"><span class="lineNum">    2449 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4982 :                     HelpExampleCli(&quot;getwalletinfo&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2450"><span class="lineNum">    2450 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9964 :             + HelpExampleRpc(&quot;getwalletinfo&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2451"><span class="lineNum">    2451 </span>                :<span class="lineCov">       2491 :                 },</span></a>
<a name="2452"><span class="lineNum">    2452 </span>                :<span class="lineCov">       1019 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2453"><span class="lineNum">    2453 </span>                :            : {</a>
<a name="2454"><span class="lineNum">    2454 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1000 times"> + </span>]:<span class="lineCov">       2019 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2455"><span class="lineNum">    2455 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1000 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2456"><span class="lineNum">    2456 </span>                :            : </a>
<a name="2457"><span class="lineNum">    2457 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="2458"><span class="lineNum">    2458 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="2459"><span class="lineNum">    2459 </span>        [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1000 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="2460"><span class="lineNum">    2460 </span>                :            : </a>
<a name="2461"><span class="lineNum">    2461 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2000 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="2462"><span class="lineNum">    2462 </span>                :            : </a>
<a name="2463"><span class="lineNum">    2463 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     UniValue obj(UniValue::VOBJ);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2464"><span class="lineNum">    2464 </span>                :            : </a>
<a name="2465"><span class="lineNum">    2465 </span>        [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1000 :     size_t kpExternalSize = pwallet-&gt;KeypoolCountExternalKeys();</span></a>
<a name="2466"><span class="lineNum">    2466 </span>        [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1000 :     const auto bal = GetBalance(*pwallet);</span></a>
<a name="2467"><span class="lineNum">    2467 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;walletname&quot;, pwallet-&gt;GetName());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2468"><span class="lineNum">    2468 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;walletversion&quot;, pwallet-&gt;GetVersion());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2469"><span class="lineNum">    2469 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;format&quot;, pwallet-&gt;GetDatabase().Format());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2470"><span class="lineNum">    2470 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;balance&quot;, ValueFromAmount(bal.m_mine_trusted));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2471"><span class="lineNum">    2471 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;unconfirmed_balance&quot;, ValueFromAmount(bal.m_mine_untrusted_pending));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2472"><span class="lineNum">    2472 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;immature_balance&quot;, ValueFromAmount(bal.m_mine_immature));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2473"><span class="lineNum">    2473 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;txcount&quot;,       (int)pwallet-&gt;mapWallet.size());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2474"><span class="lineNum">    2474 </span>        [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1000 :     const auto kp_oldest = pwallet-&gt;GetOldestKeyPoolTime();</span></a>
<a name="2475"><span class="lineNum">    2475 </span>        [<span class="branchCov" title="Branch 0 was taken 659 times"> + </span><span class="branchCov" title="Branch 1 was taken 341 times"> + </span>]:<span class="lineCov">       1000 :     if (kp_oldest.has_value()) {</span></a>
<a name="2476"><span class="lineNum">    2476 </span>  [<span class="branchCov" title="Branch 0 was taken 659 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 659 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1659 :         obj.pushKV(&quot;keypoololdest&quot;, kp_oldest.value());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2477"><span class="lineNum">    2477 </span>                :            :     }</a>
<a name="2478"><span class="lineNum">    2478 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;keypoolsize&quot;, (int64_t)kpExternalSize);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2479"><span class="lineNum">    2479 </span>                :            : </a>
<a name="2480"><span class="lineNum">    2480 </span>        [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1000 :     LegacyScriptPubKeyMan* spk_man = pwallet-&gt;GetLegacyScriptPubKeyMan();</span></a>
<a name="2481"><span class="lineNum">    2481 </span>        [<span class="branchCov" title="Branch 0 was taken 659 times"> + </span><span class="branchCov" title="Branch 1 was taken 341 times"> + </span>]:<span class="lineCov">       1000 :     if (spk_man) {</span></a>
<a name="2482"><span class="lineNum">    2482 </span>                :<span class="lineCov">        659 :         CKeyID seed_id = spk_man-&gt;GetHDChain().seed_id;</span></a>
<a name="2483"><span class="lineNum">    2483 </span>        [<span class="branchCov" title="Branch 0 was taken 578 times"> + </span><span class="branchCov" title="Branch 1 was taken 81 times"> + </span>]:<span class="lineCov">       1318 :         if (!seed_id.IsNull()) {</span></a>
<a name="2484"><span class="lineNum">    2484 </span>  [<span class="branchCov" title="Branch 0 was taken 578 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 578 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1156 :             obj.pushKV(&quot;hdseedid&quot;, seed_id.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 578 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2485"><span class="lineNum">    2485 </span>                :            :         }</a>
<a name="2486"><span class="lineNum">    2486 </span>                :            :     }</a>
<a name="2487"><span class="lineNum">    2487 </span>                :            : </a>
<a name="2488"><span class="lineNum">    2488 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1000 :     if (pwallet-&gt;CanSupportFeature(FEATURE_HD_SPLIT)) {</span></a>
<a name="2489"><span class="lineNum">    2489 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :         obj.pushKV(&quot;keypoolsize_hd_internal&quot;,   (int64_t)(pwallet-&gt;GetKeyPoolSize() - kpExternalSize));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2490"><span class="lineNum">    2490 </span>                :            :     }</a>
<a name="2491"><span class="lineNum">    2491 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 23 times"> + </span><span class="branchCov" title="Branch 3 was taken 977 times"> + </span>]:<span class="lineCov">       1000 :     if (pwallet-&gt;IsCrypted()) {</span></a>
<a name="2492"><span class="lineNum">    2492 </span>  [<span class="branchCov" title="Branch 0 was taken 23 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 23 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1023 :         obj.pushKV(&quot;unlocked_until&quot;, pwallet-&gt;nRelockTime);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2493"><span class="lineNum">    2493 </span>                :            :     }</a>
<a name="2494"><span class="lineNum">    2494 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;paytxfee&quot;, ValueFromAmount(pwallet-&gt;m_pay_tx_fee.GetFeePerK()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2495"><span class="lineNum">    2495 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;private_keys_enabled&quot;, !pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2496"><span class="lineNum">    2496 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;avoid_reuse&quot;, pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 1000 times"> + </span>]
<a name="2497"><span class="lineNum">    2497 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1000 times"> + </span>]:<span class="lineCov">       1000 :     if (pwallet-&gt;IsScanning()) {</span></a>
<a name="2498"><span class="lineNum">    2498 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         UniValue scanning(UniValue::VOBJ);</span></a>
<a name="2499"><span class="lineNum">    2499 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :         scanning.pushKV(&quot;duration&quot;, pwallet-&gt;ScanningDuration() / 1000);</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="2500"><span class="lineNum">    2500 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :         scanning.pushKV(&quot;progress&quot;, pwallet-&gt;ScanningProgress());</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="2501"><span class="lineNum">    2501 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         obj.pushKV(&quot;scanning&quot;, scanning);</span></a>
<a name="2502"><span class="lineNum">    2502 </span>                :            :     } else {</a>
<a name="2503"><span class="lineNum">    2503 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :         obj.pushKV(&quot;scanning&quot;, false);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2504"><span class="lineNum">    2504 </span>                :            :     }</a>
<a name="2505"><span class="lineNum">    2505 </span>  [<span class="branchCov" title="Branch 0 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2000 :     obj.pushKV(&quot;descriptors&quot;, pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DESCRIPTORS));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1000 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2506"><span class="lineNum">    2506 </span>                :<span class="lineCov">       1000 :     return obj;</span></a>
<a name="2507"><span class="lineNum">    2507 </span>                :            : },</a>
<a name="2508"><span class="lineNum">    2508 </span>  [<span class="branchCov" title="Branch 0 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      14946 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2491 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2509"><span class="lineNum">    2509 </span>                :            : }</a>
<a name="2510"><span class="lineNum">    2510 </span>                :            : </a>
<a name="2511"><span class="lineNum">    2511 </span>                :<span class="lineCov">       1485 : static RPCHelpMan listwalletdir()</span></a>
<a name="2512"><span class="lineNum">    2512 </span>                :            : {</a>
<a name="2513"><span class="lineNum">    2513 </span>                :<span class="lineCov">       1485 :     return RPCHelpMan{&quot;listwalletdir&quot;,</span></a>
<a name="2514"><span class="lineNum">    2514 </span>                :            :                 &quot;Returns a list of wallets in the wallet directory.\n&quot;,</a>
<a name="2515"><span class="lineNum">    2515 </span>                :            :                 {},</a>
<a name="2516"><span class="lineNum">    2516 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2517"><span class="lineNum">    2517 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2518"><span class="lineNum">    2518 </span>                :            :                     {</a>
<a name="2519"><span class="lineNum">    2519 </span>                :            :                         {RPCResult::Type::ARR, &quot;wallets&quot;, &quot;&quot;,</a>
<a name="2520"><span class="lineNum">    2520 </span>                :            :                         {</a>
<a name="2521"><span class="lineNum">    2521 </span>                :            :                             {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2522"><span class="lineNum">    2522 </span>                :            :                             {</a>
<a name="2523"><span class="lineNum">    2523 </span>                :            :                                 {RPCResult::Type::STR, &quot;name&quot;, &quot;The wallet name&quot;},</a>
<a name="2524"><span class="lineNum">    2524 </span>                :            :                             }},</a>
<a name="2525"><span class="lineNum">    2525 </span>                :            :                         }},</a>
<a name="2526"><span class="lineNum">    2526 </span>                :            :                     }</a>
<a name="2527"><span class="lineNum">    2527 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7425 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1485 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1485 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1485 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1485 times"> + </span><span class="branchCov" title="Branch 31 was taken 1485 times"> + </span><span class="branchCov" title="Branch 32 was taken 1485 times"> + </span><span class="branchCov" title="Branch 33 was taken 1485 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1485 times"> + </span><span class="branchCov" title="Branch 35 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 36 was not taken"> - </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>]
<a name="2528"><span class="lineNum">    2528 </span>                :<span class="lineCov">       1485 :                 RPCExamples{</span></a>
<a name="2529"><span class="lineNum">    2529 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2970 :                     HelpExampleCli(&quot;listwalletdir&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2530"><span class="lineNum">    2530 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5940 :             + HelpExampleRpc(&quot;listwalletdir&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2531"><span class="lineNum">    2531 </span>                :<span class="lineCov">       1485 :                 },</span></a>
<a name="2532"><span class="lineNum">    2532 </span>                :<span class="lineCov">         13 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2533"><span class="lineNum">    2533 </span>                :            : {</a>
<a name="2534"><span class="lineNum">    2534 </span>        [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         13 :     UniValue wallets(UniValue::VARR);</span></a>
<a name="2535"><span class="lineNum">    2535 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        101 :     for (const auto&amp; path : ListDatabases(GetWalletDir())) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 88 times"> + </span><span class="branchCov" title="Branch 5 was taken 13 times"> + </span>]
<a name="2536"><span class="lineNum">    2536 </span>  [<span class="branchCov" title="Branch 0 was taken 88 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 88 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        176 :         UniValue wallet(UniValue::VOBJ);</span></a>
<a name="2537"><span class="lineNum">    2537 </span>  [<span class="branchCov" title="Branch 0 was taken 88 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 88 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        176 :         wallet.pushKV(&quot;name&quot;, path.u8string());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 88 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2538"><span class="lineNum">    2538 </span>        [<span class="branchCov" title="Branch 0 was taken 88 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         88 :         wallets.push_back(wallet);</span></a>
<a name="2539"><span class="lineNum">    2539 </span>                :            :     }</a>
<a name="2540"><span class="lineNum">    2540 </span>                :            : </a>
<a name="2541"><span class="lineNum">    2541 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         13 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="2542"><span class="lineNum">    2542 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         26 :     result.pushKV(&quot;wallets&quot;, wallets);</span></a>
<a name="2543"><span class="lineNum">    2543 </span>                :<span class="lineCov">         13 :     return result;</span></a>
<a name="2544"><span class="lineNum">    2544 </span>                :            : },</a>
<a name="2545"><span class="lineNum">    2545 </span>  [<span class="branchCov" title="Branch 0 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8910 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1485 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2546"><span class="lineNum">    2546 </span>                :            : }</a>
<a name="2547"><span class="lineNum">    2547 </span>                :            : </a>
<a name="2548"><span class="lineNum">    2548 </span>                :<span class="lineCov">       1586 : static RPCHelpMan listwallets()</span></a>
<a name="2549"><span class="lineNum">    2549 </span>                :            : {</a>
<a name="2550"><span class="lineNum">    2550 </span>                :<span class="lineCov">       1586 :     return RPCHelpMan{&quot;listwallets&quot;,</span></a>
<a name="2551"><span class="lineNum">    2551 </span>                :            :                 &quot;Returns a list of currently loaded wallets.\n&quot;</a>
<a name="2552"><span class="lineNum">    2552 </span>                :            :                 &quot;For full information on the wallet, use \&quot;getwalletinfo\&quot;\n&quot;,</a>
<a name="2553"><span class="lineNum">    2553 </span>                :            :                 {},</a>
<a name="2554"><span class="lineNum">    2554 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2555"><span class="lineNum">    2555 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="2556"><span class="lineNum">    2556 </span>                :            :                     {</a>
<a name="2557"><span class="lineNum">    2557 </span>                :            :                         {RPCResult::Type::STR, &quot;walletname&quot;, &quot;the wallet name&quot;},</a>
<a name="2558"><span class="lineNum">    2558 </span>                :            :                     }</a>
<a name="2559"><span class="lineNum">    2559 </span>  [<span class="branchCov" title="Branch 0 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4758 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1586 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1586 times"> + </span><span class="branchCov" title="Branch 15 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="2560"><span class="lineNum">    2560 </span>                :<span class="lineCov">       1586 :                 RPCExamples{</span></a>
<a name="2561"><span class="lineNum">    2561 </span>  [<span class="branchCov" title="Branch 0 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3172 :                     HelpExampleCli(&quot;listwallets&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2562"><span class="lineNum">    2562 </span>  [<span class="branchCov" title="Branch 0 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6344 :             + HelpExampleRpc(&quot;listwallets&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2563"><span class="lineNum">    2563 </span>                :<span class="lineCov">       1586 :                 },</span></a>
<a name="2564"><span class="lineNum">    2564 </span>                :<span class="lineCov">        114 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2565"><span class="lineNum">    2565 </span>                :            : {</a>
<a name="2566"><span class="lineNum">    2566 </span>        [<span class="branchCov" title="Branch 0 was taken 114 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        114 :     UniValue obj(UniValue::VARR);</span></a>
<a name="2567"><span class="lineNum">    2567 </span>                :            : </a>
<a name="2568"><span class="lineNum">    2568 </span>        [<span class="branchCov" title="Branch 0 was taken 114 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        114 :     WalletContext&amp; context = EnsureWalletContext(request.context);</span></a>
<a name="2569"><span class="lineNum">    2569 </span>  [<span class="branchCov" title="Branch 0 was taken 114 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 381 times"> + </span><span class="branchCov" title="Branch 3 was taken 114 times"> + </span>]:<span class="lineCov">        495 :     for (const std::shared_ptr&lt;CWallet&gt;&amp; wallet : GetWallets(context)) {</span></a>
<a name="2570"><span class="lineNum">    2570 </span>        [<span class="branchCov" title="Branch 0 was taken 381 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        762 :         LOCK(wallet-&gt;cs_wallet);</span></a>
<a name="2571"><span class="lineNum">    2571 </span>        [<span class="branchCov" title="Branch 0 was taken 381 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        381 :         obj.push_back(wallet-&gt;GetName());</span></a>
<a name="2572"><span class="lineNum">    2572 </span>                :            :     }</a>
<a name="2573"><span class="lineNum">    2573 </span>                :            : </a>
<a name="2574"><span class="lineNum">    2574 </span>                :<span class="lineCov">        114 :     return obj;</span></a>
<a name="2575"><span class="lineNum">    2575 </span>                :            : },</a>
<a name="2576"><span class="lineNum">    2576 </span>  [<span class="branchCov" title="Branch 0 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9516 :     };</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1586 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2577"><span class="lineNum">    2577 </span>                :            : }</a>
<a name="2578"><span class="lineNum">    2578 </span>                :            : </a>
<a name="2579"><span class="lineNum">    2579 </span>                :<span class="lineCov">        232 : static std::tuple&lt;std::shared_ptr&lt;CWallet&gt;, std::vector&lt;bilingual_str&gt;&gt; LoadWalletHelper(WalletContext&amp; context, UniValue load_on_start_param, const std::string wallet_name)</span></a>
<a name="2580"><span class="lineNum">    2580 </span>                :            : {</a>
<a name="2581"><span class="lineNum">    2581 </span>        [<span class="branchCov" title="Branch 0 was taken 228 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">        232 :     DatabaseOptions options;</span></a>
<a name="2582"><span class="lineNum">    2582 </span>                :<span class="lineCov">        232 :     DatabaseStatus status;</span></a>
<a name="2583"><span class="lineNum">    2583 </span>                :<span class="lineCov">        232 :     options.require_existing = true;</span></a>
<a name="2584"><span class="lineNum">    2584 </span>        [<span class="branchCov" title="Branch 0 was taken 228 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">        464 :     bilingual_str error;</span></a>
<a name="2585"><span class="lineNum">    2585 </span>        [<span class="branchCov" title="Branch 0 was taken 228 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">        464 :     std::vector&lt;bilingual_str&gt; warnings;</span></a>
<a name="2586"><span class="lineNum">    2586 </span>  [<span class="branchCov" title="Branch 0 was taken 228 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        232 :     std::optional&lt;bool&gt; load_on_start = load_on_start_param.isNull() ? std::nullopt : std::optional&lt;bool&gt;(load_on_start_param.get_bool());</span></a>
<a name="2587"><span class="lineNum">    2587 </span>        [<span class="branchCov" title="Branch 0 was taken 232 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        464 :     std::shared_ptr&lt;CWallet&gt; const wallet = LoadWallet(context, wallet_name, load_on_start, options, status, error, warnings);</span></a>
<a name="2588"><span class="lineNum">    2588 </span>                :            : </a>
<a name="2589"><span class="lineNum">    2589 </span>        [<span class="branchCov" title="Branch 0 was taken 29 times"> + </span><span class="branchCov" title="Branch 1 was taken 203 times"> + </span>]:<span class="lineCov">        232 :     if (!wallet) {</span></a>
<a name="2590"><span class="lineNum">    2590 </span>                :            :         // Map bad format to not found, since bad format is returned when the</a>
<a name="2591"><span class="lineNum">    2591 </span>                :            :         // wallet directory exists, but doesn't contain a data file.</a>
<a name="2592"><span class="lineNum">    2592 </span>                :<span class="lineCov">         29 :         RPCErrorCode code = RPC_WALLET_ERROR;</span></a>
<a name="2593"><span class="lineNum">    2593 </span>     [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchCov" title="Branch 2 was taken 17 times"> + </span>]:<span class="lineCov">         29 :         switch (status) {</span></a>
<a name="2594"><span class="lineNum">    2594 </span>                :<span class="lineCov">          8 :             case DatabaseStatus::FAILED_NOT_FOUND:</span></a>
<a name="2595"><span class="lineNum">    2595 </span>                :<span class="lineCov">          8 :             case DatabaseStatus::FAILED_BAD_FORMAT:</span></a>
<a name="2596"><span class="lineNum">    2596 </span>                :<span class="lineCov">          8 :                 code = RPC_WALLET_NOT_FOUND;</span></a>
<a name="2597"><span class="lineNum">    2597 </span>                :<span class="lineCov">          8 :                 break;</span></a>
<a name="2598"><span class="lineNum">    2598 </span>                :<span class="lineCov">          4 :             case DatabaseStatus::FAILED_ALREADY_LOADED:</span></a>
<a name="2599"><span class="lineNum">    2599 </span>                :<span class="lineCov">          4 :                 code = RPC_WALLET_ALREADY_LOADED;</span></a>
<a name="2600"><span class="lineNum">    2600 </span>                :<span class="lineCov">          4 :                 break;</span></a>
<a name="2601"><span class="lineNum">    2601 </span>                :            :             default: // RPC_WALLET_ERROR is returned for all other cases.</a>
<a name="2602"><span class="lineNum">    2602 </span>                :            :                 break;</a>
<a name="2603"><span class="lineNum">    2603 </span>                :            :         }</a>
<a name="2604"><span class="lineNum">    2604 </span>        [<span class="branchCov" title="Branch 0 was taken 29 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         29 :         throw JSONRPCError(code, error.original);</span></a>
<a name="2605"><span class="lineNum">    2605 </span>                :            :     }</a>
<a name="2606"><span class="lineNum">    2606 </span>                :            : </a>
<a name="2607"><span class="lineNum">    2607 </span>  [<span class="branchCov" title="Branch 0 was taken 203 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 203 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        406 :     return { wallet, warnings };</span></a>
<a name="2608"><span class="lineNum">    2608 </span>                :            : }</a>
<a name="2609"><span class="lineNum">    2609 </span>                :            : </a>
<a name="2610"><span class="lineNum">    2610 </span>                :<span class="lineCov">       1698 : static RPCHelpMan loadwallet()</span></a>
<a name="2611"><span class="lineNum">    2611 </span>                :            : {</a>
<a name="2612"><span class="lineNum">    2612 </span>                :<span class="lineCov">       1698 :     return RPCHelpMan{&quot;loadwallet&quot;,</span></a>
<a name="2613"><span class="lineNum">    2613 </span>                :            :                 &quot;\nLoads a wallet from a wallet file or directory.&quot;</a>
<a name="2614"><span class="lineNum">    2614 </span>                :            :                 &quot;\nNote that all wallet command-line options used when starting bitcoind will be&quot;</a>
<a name="2615"><span class="lineNum">    2615 </span>                :            :                 &quot;\napplied to the new wallet.\n&quot;,</a>
<a name="2616"><span class="lineNum">    2616 </span>                :            :                 {</a>
<a name="2617"><span class="lineNum">    2617 </span>                :<span class="lineCov">       1698 :                     {&quot;filename&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The wallet directory or .dat file.&quot;},</span></a>
<a name="2618"><span class="lineNum">    2618 </span>                :<span class="lineCov">       1698 :                     {&quot;load_on_startup&quot;, RPCArg::Type::BOOL, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Save wallet name to persistent settings and load on startup. True to add wallet to startup list, false to remove, null to leave unchanged.&quot;},</span></a>
<a name="2619"><span class="lineNum">    2619 </span>                :            :                 },</a>
<a name="2620"><span class="lineNum">    2620 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2621"><span class="lineNum">    2621 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2622"><span class="lineNum">    2622 </span>                :            :                     {</a>
<a name="2623"><span class="lineNum">    2623 </span>                :            :                         {RPCResult::Type::STR, &quot;name&quot;, &quot;The wallet name if loaded successfully.&quot;},</a>
<a name="2624"><span class="lineNum">    2624 </span>                :            :                         {RPCResult::Type::STR, &quot;warning&quot;, &quot;Warning message if wallet was not loaded cleanly.&quot;},</a>
<a name="2625"><span class="lineNum">    2625 </span>                :            :                     }</a>
<a name="2626"><span class="lineNum">    2626 </span>  [<span class="branchCov" title="Branch 0 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6792 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1698 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1698 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3396 times"> + </span><span class="branchCov" title="Branch 21 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="2627"><span class="lineNum">    2627 </span>                :<span class="lineCov">       1698 :                 RPCExamples{</span></a>
<a name="2628"><span class="lineNum">    2628 </span>  [<span class="branchCov" title="Branch 0 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3396 :                     HelpExampleCli(&quot;loadwallet&quot;, &quot;\&quot;test.dat\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2629"><span class="lineNum">    2629 </span>  [<span class="branchCov" title="Branch 0 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6792 :             + HelpExampleRpc(&quot;loadwallet&quot;, &quot;\&quot;test.dat\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2630"><span class="lineNum">    2630 </span>                :<span class="lineCov">       1698 :                 },</span></a>
<a name="2631"><span class="lineNum">    2631 </span>                :<span class="lineCov">        226 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2632"><span class="lineNum">    2632 </span>                :            : {</a>
<a name="2633"><span class="lineNum">    2633 </span>                :<span class="lineCov">        226 :     WalletContext&amp; context = EnsureWalletContext(request.context);</span></a>
<a name="2634"><span class="lineNum">    2634 </span>                :<span class="lineCov">        226 :     const std::string name(request.params[0].get_str());</span></a>
<a name="2635"><span class="lineNum">    2635 </span>                :            : </a>
<a name="2636"><span class="lineNum">    2636 </span>  [<span class="branchCov" title="Branch 0 was taken 226 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 226 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        620 :     auto [wallet, warnings] = LoadWalletHelper(context, request.params[1], name);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 226 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 197 times"> + </span><span class="branchCov" title="Branch 7 was taken 29 times"> + </span><span class="branchCov" title="Branch 8 was taken 197 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="2637"><span class="lineNum">    2637 </span>                :            : </a>
<a name="2638"><span class="lineNum">    2638 </span>  [<span class="branchCov" title="Branch 0 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        197 :     UniValue obj(UniValue::VOBJ);</span></a>
<a name="2639"><span class="lineNum">    2639 </span>  [<span class="branchCov" title="Branch 0 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        394 :     obj.pushKV(&quot;name&quot;, wallet-&gt;GetName());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2640"><span class="lineNum">    2640 </span>  [<span class="branchCov" title="Branch 0 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        985 :     obj.pushKV(&quot;warning&quot;, Join(warnings, Untranslated(&quot;\n&quot;)).original);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 197 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2641"><span class="lineNum">    2641 </span>                :            : </a>
<a name="2642"><span class="lineNum">    2642 </span>                :<span class="lineCov">        394 :     return obj;</span></a>
<a name="2643"><span class="lineNum">    2643 </span>                :            : },</a>
<a name="2644"><span class="lineNum">    2644 </span>  [<span class="branchCov" title="Branch 0 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      16980 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1698 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1698 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 3396 times"> + </span><span class="branchCov" title="Branch 25 was taken 1698 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="2645"><span class="lineNum">    2645 </span>                :            : }</a>
<a name="2646"><span class="lineNum">    2646 </span>                :            : </a>
<a name="2647"><span class="lineNum">    2647 </span>                :<span class="lineCov">       1483 : static RPCHelpMan setwalletflag()</span></a>
<a name="2648"><span class="lineNum">    2648 </span>                :            : {</a>
<a name="2649"><span class="lineNum">    2649 </span>                :<span class="lineCov">       1483 :             std::string flags = &quot;&quot;;</span></a>
<a name="2650"><span class="lineNum">    2650 </span>        [<span class="branchCov" title="Branch 0 was taken 10381 times"> + </span><span class="branchCov" title="Branch 1 was taken 1483 times"> + </span>]:<span class="lineCov">      11864 :             for (auto&amp; it : WALLET_FLAG_MAP)</span></a>
<a name="2651"><span class="lineNum">    2651 </span>        [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchCov" title="Branch 1 was taken 8898 times"> + </span>]:<span class="lineCov">      10381 :                 if (it.second &amp; MUTABLE_WALLET_FLAGS)</span></a>
<a name="2652"><span class="lineNum">    2652 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1483 times"> + </span><span class="branchCov" title="Branch 2 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      13347 :                     flags += (flags == &quot;&quot; ? &quot;&quot; : &quot;, &quot;) + it.first;</span></a>
<a name="2653"><span class="lineNum">    2653 </span>                :            : </a>
<a name="2654"><span class="lineNum">    2654 </span>        [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1483 :     return RPCHelpMan{&quot;setwalletflag&quot;,</span></a>
<a name="2655"><span class="lineNum">    2655 </span>                :            :                 &quot;\nChange the state of the given wallet flag for a wallet.\n&quot;,</a>
<a name="2656"><span class="lineNum">    2656 </span>                :            :                 {</a>
<a name="2657"><span class="lineNum">    2657 </span>                :<span class="lineCov">       2966 :                     {&quot;flag&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The name of the flag to change. Current available flags: &quot; + flags},</span></a>
<a name="2658"><span class="lineNum">    2658 </span>        [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2966 :                     {&quot;value&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;The new state.&quot;},</span></a>
<a name="2659"><span class="lineNum">    2659 </span>                :            :                 },</a>
<a name="2660"><span class="lineNum">    2660 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2661"><span class="lineNum">    2661 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2662"><span class="lineNum">    2662 </span>                :            :                     {</a>
<a name="2663"><span class="lineNum">    2663 </span>                :            :                         {RPCResult::Type::STR, &quot;flag_name&quot;, &quot;The name of the flag that was modified&quot;},</a>
<a name="2664"><span class="lineNum">    2664 </span>                :            :                         {RPCResult::Type::BOOL, &quot;flag_state&quot;, &quot;The new state of the flag&quot;},</a>
<a name="2665"><span class="lineNum">    2665 </span>                :            :                         {RPCResult::Type::STR, &quot;warnings&quot;, &quot;Any warnings associated with the change&quot;},</a>
<a name="2666"><span class="lineNum">    2666 </span>                :            :                     }</a>
<a name="2667"><span class="lineNum">    2667 </span>  [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7415 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1483 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1483 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 4449 times"> + </span><span class="branchCov" title="Branch 27 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<a name="2668"><span class="lineNum">    2668 </span>                :<span class="lineCov">       1483 :                 RPCExamples{</span></a>
<a name="2669"><span class="lineNum">    2669 </span>  [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2966 :                     HelpExampleCli(&quot;setwalletflag&quot;, &quot;avoid_reuse&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2670"><span class="lineNum">    2670 </span>  [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5932 :                   + HelpExampleRpc(&quot;setwalletflag&quot;, &quot;\&quot;avoid_reuse\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2671"><span class="lineNum">    2671 </span>                :<span class="lineCov">       1483 :                 },</span></a>
<a name="2672"><span class="lineNum">    2672 </span>                :<span class="lineCov">         11 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2673"><span class="lineNum">    2673 </span>                :            : {</a>
<a name="2674"><span class="lineNum">    2674 </span>                :<span class="lineCov">         13 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2675"><span class="lineNum">    2675 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         11 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2676"><span class="lineNum">    2676 </span>                :            : </a>
<a name="2677"><span class="lineNum">    2677 </span>  [<span class="branchCov" title="Branch 0 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         22 :     std::string flag_str = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2678"><span class="lineNum">    2678 </span>  [<span class="branchCov" title="Branch 0 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 7 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span> :<span class="lineCov">         11 :     bool value = request.params[1].isNull() || request.params[1].get_bool();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 4 times"> + </span>]
<a name="2679"><span class="lineNum">    2679 </span>                :            : </a>
<a name="2680"><span class="lineNum">    2680 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span>]:<span class="lineCov">         11 :     if (!WALLET_FLAG_MAP.count(flag_str)) {</span></a>
<a name="2681"><span class="lineNum">    2681 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Unknown wallet flag: %s&quot;, flag_str));</span></a>
<a name="2682"><span class="lineNum">    2682 </span>                :            :     }</a>
<a name="2683"><span class="lineNum">    2683 </span>                :            : </a>
<a name="2684"><span class="lineNum">    2684 </span>        [<span class="branchCov" title="Branch 0 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         11 :     auto flag = WALLET_FLAG_MAP.at(flag_str);</span></a>
<a name="2685"><span class="lineNum">    2685 </span>                :            : </a>
<a name="2686"><span class="lineNum">    2686 </span>        [<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">         11 :     if (!(flag &amp; MUTABLE_WALLET_FLAGS)) {</span></a>
<a name="2687"><span class="lineNum">    2687 </span>  [<span class="branchCov" title="Branch 0 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         10 :         throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Wallet flag is immutable: %s&quot;, flag_str));</span></a>
<a name="2688"><span class="lineNum">    2688 </span>                :            :     }</a>
<a name="2689"><span class="lineNum">    2689 </span>                :            : </a>
<a name="2690"><span class="lineNum">    2690 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :     UniValue res(UniValue::VOBJ);</span></a>
<a name="2691"><span class="lineNum">    2691 </span>                :            : </a>
<a name="2692"><span class="lineNum">    2692 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          6 :     if (pwallet-&gt;IsWalletFlagSet(flag) == value) {</span></a>
<a name="2693"><span class="lineNum">    2693 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         10 :         throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Wallet flag is already set to %s: %s&quot;, value ? &quot;true&quot; : &quot;false&quot;, flag_str));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2694"><span class="lineNum">    2694 </span>                :            :     }</a>
<a name="2695"><span class="lineNum">    2695 </span>                :            : </a>
<a name="2696"><span class="lineNum">    2696 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :     res.pushKV(&quot;flag_name&quot;, flag_str);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2697"><span class="lineNum">    2697 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :     res.pushKV(&quot;flag_state&quot;, value);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2698"><span class="lineNum">    2698 </span>                :            : </a>
<a name="2699"><span class="lineNum">    2699 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          2 :     if (value) {</span></a>
<a name="2700"><span class="lineNum">    2700 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          2 :         pwallet-&gt;SetWalletFlag(flag);</span></a>
<a name="2701"><span class="lineNum">    2701 </span>                :            :     } else {</a>
<a name="2702"><span class="lineNum">    2702 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :         pwallet-&gt;UnsetWalletFlag(flag);</span></a>
<a name="2703"><span class="lineNum">    2703 </span>                :            :     }</a>
<a name="2704"><span class="lineNum">    2704 </span>                :            : </a>
<a name="2705"><span class="lineNum">    2705 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :     if (flag &amp;&amp; value &amp;&amp; WALLET_FLAG_CAVEATS.count(flag)) {</span></a>
<a name="2706"><span class="lineNum">    2706 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :         res.pushKV(&quot;warnings&quot;, WALLET_FLAG_CAVEATS.at(flag));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2707"><span class="lineNum">    2707 </span>                :            :     }</a>
<a name="2708"><span class="lineNum">    2708 </span>                :            : </a>
<a name="2709"><span class="lineNum">    2709 </span>                :<span class="lineCov">          2 :     return res;</span></a>
<a name="2710"><span class="lineNum">    2710 </span>                :            : },</a>
<a name="2711"><span class="lineNum">    2711 </span>  [<span class="branchCov" title="Branch 0 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      17796 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1483 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1483 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2966 times"> + </span><span class="branchCov" title="Branch 27 was taken 1483 times"> + </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<a name="2712"><span class="lineNum">    2712 </span>                :            : }</a>
<a name="2713"><span class="lineNum">    2713 </span>                :            : </a>
<a name="2714"><span class="lineNum">    2714 </span>                :<span class="lineCov">       1931 : static RPCHelpMan createwallet()</span></a>
<a name="2715"><span class="lineNum">    2715 </span>                :            : {</a>
<a name="2716"><span class="lineNum">    2716 </span>                :<span class="lineCov">       1931 :     return RPCHelpMan{</span></a>
<a name="2717"><span class="lineNum">    2717 </span>                :            :         &quot;createwallet&quot;,</a>
<a name="2718"><span class="lineNum">    2718 </span>                :            :         &quot;\nCreates and loads a new wallet.\n&quot;,</a>
<a name="2719"><span class="lineNum">    2719 </span>                :            :         {</a>
<a name="2720"><span class="lineNum">    2720 </span>                :<span class="lineCov">       1931 :             {&quot;wallet_name&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The name for the new wallet. If this is a path, the wallet will be created at the path location.&quot;},</span></a>
<a name="2721"><span class="lineNum">    2721 </span>        [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3862 :             {&quot;disable_private_keys&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Disable the possibility of private keys (only watchonlys are possible in this mode).&quot;},</span></a>
<a name="2722"><span class="lineNum">    2722 </span>        [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3862 :             {&quot;blank&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Create a blank wallet. A blank wallet has no keys or HD seed. One can be set using sethdseed.&quot;},</span></a>
<a name="2723"><span class="lineNum">    2723 </span>                :<span class="lineCov">       1931 :             {&quot;passphrase&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Encrypt the wallet with this passphrase.&quot;},</span></a>
<a name="2724"><span class="lineNum">    2724 </span>        [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3862 :             {&quot;avoid_reuse&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Keep track of coin reuse, and treat dirty and clean coins differently with privacy considerations in mind.&quot;},</span></a>
<a name="2725"><span class="lineNum">    2725 </span>        [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3862 :             {&quot;descriptors&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Create a native descriptor wallet. The wallet will use descriptors internally to handle address creation&quot;},</span></a>
<a name="2726"><span class="lineNum">    2726 </span>                :<span class="lineCov">       1931 :             {&quot;load_on_startup&quot;, RPCArg::Type::BOOL, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Save wallet name to persistent settings and load on startup. True to add wallet to startup list, false to remove, null to leave unchanged.&quot;},</span></a>
<a name="2727"><span class="lineNum">    2727 </span>        [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3862 :             {&quot;external_signer&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Use an external signer such as a hardware wallet. Requires -signer to be configured. Wallet creation will fail if keys cannot be fetched. Requires disable_private_keys and descriptors set to true.&quot;},</span></a>
<a name="2728"><span class="lineNum">    2728 </span>                :            :         },</a>
<a name="2729"><span class="lineNum">    2729 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="2730"><span class="lineNum">    2730 </span>                :            :             RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2731"><span class="lineNum">    2731 </span>                :            :             {</a>
<a name="2732"><span class="lineNum">    2732 </span>                :            :                 {RPCResult::Type::STR, &quot;name&quot;, &quot;The wallet name if created successfully. If the wallet was created using a full path, the wallet_name will be the full path.&quot;},</a>
<a name="2733"><span class="lineNum">    2733 </span>                :            :                 {RPCResult::Type::STR, &quot;warning&quot;, &quot;Warning message if wallet was not loaded cleanly.&quot;},</a>
<a name="2734"><span class="lineNum">    2734 </span>                :            :             }</a>
<a name="2735"><span class="lineNum">    2735 </span>  [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7724 :         },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1931 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3862 times"> + </span><span class="branchCov" title="Branch 21 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="2736"><span class="lineNum">    2736 </span>                :<span class="lineCov">       1931 :         RPCExamples{</span></a>
<a name="2737"><span class="lineNum">    2737 </span>  [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3862 :             HelpExampleCli(&quot;createwallet&quot;, &quot;\&quot;testwallet\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2738"><span class="lineNum">    2738 </span>  [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7724 :             + HelpExampleRpc(&quot;createwallet&quot;, &quot;\&quot;testwallet\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2739"><span class="lineNum">    2739 </span>  [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15448 :             + HelpExampleCliNamed(&quot;createwallet&quot;, {{&quot;wallet_name&quot;, &quot;descriptors&quot;}, {&quot;avoid_reuse&quot;, true}, {&quot;descriptors&quot;, true}, {&quot;load_on_startup&quot;, true}})</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 7724 times"> + </span><span class="branchCov" title="Branch 17 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="2740"><span class="lineNum">    2740 </span>  [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15448 :             + HelpExampleRpcNamed(&quot;createwallet&quot;, {{&quot;wallet_name&quot;, &quot;descriptors&quot;}, {&quot;avoid_reuse&quot;, true}, {&quot;descriptors&quot;, true}, {&quot;load_on_startup&quot;, true}})</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 7724 times"> + </span><span class="branchCov" title="Branch 17 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="2741"><span class="lineNum">    2741 </span>                :<span class="lineCov">       1931 :         },</span></a>
<a name="2742"><span class="lineNum">    2742 </span>                :<span class="lineCov">        459 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2743"><span class="lineNum">    2743 </span>                :            : {</a>
<a name="2744"><span class="lineNum">    2744 </span>                :<span class="lineCov">        459 :     WalletContext&amp; context = EnsureWalletContext(request.context);</span></a>
<a name="2745"><span class="lineNum">    2745 </span>                :<span class="lineCov">        459 :     uint64_t flags = 0;</span></a>
<a name="2746"><span class="lineNum">    2746 </span>  [<span class="branchCov" title="Branch 0 was taken 83 times"> + </span><span class="branchCov" title="Branch 1 was taken 376 times"> + </span><span class="branchCov" title="Branch 2 was taken 56 times"> + </span><span class="branchCov" title="Branch 3 was taken 27 times"> + </span>]:<span class="lineCov">        459 :     if (!request.params[1].isNull() &amp;&amp; request.params[1].get_bool()) {</span></a>
<a name="2747"><span class="lineNum">    2747 </span>                :            :         flags |= WALLET_FLAG_DISABLE_PRIVATE_KEYS;</a>
<a name="2748"><span class="lineNum">    2748 </span>                :            :     }</a>
<a name="2749"><span class="lineNum">    2749 </span>                :            : </a>
<a name="2750"><span class="lineNum">    2750 </span>  [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchCov" title="Branch 1 was taken 399 times"> + </span><span class="branchCov" title="Branch 2 was taken 50 times"> + </span><span class="branchCov" title="Branch 3 was taken 10 times"> + </span>]:<span class="lineCov">        459 :     if (!request.params[2].isNull() &amp;&amp; request.params[2].get_bool()) {</span></a>
<a name="2751"><span class="lineNum">    2751 </span>                :<span class="lineCov">         50 :         flags |= WALLET_FLAG_BLANK_WALLET;</span></a>
<a name="2752"><span class="lineNum">    2752 </span>                :            :     }</a>
<a name="2753"><span class="lineNum">    2753 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        459 :     SecureString passphrase;</span></a>
<a name="2754"><span class="lineNum">    2754 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        459 :     passphrase.reserve(100);</span></a>
<a name="2755"><span class="lineNum">    2755 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        918 :     std::vector&lt;bilingual_str&gt; warnings;</span></a>
<a name="2756"><span class="lineNum">    2756 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        459 :     if (!request.params[3].isNull()) {</span></a>
<a name="2757"><span class="lineNum">    2757 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        459 :         passphrase = request.params[3].get_str().c_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2758"><span class="lineNum">    2758 </span>        [<span class="branchCov" title="Branch 0 was taken 449 times"> + </span><span class="branchCov" title="Branch 1 was taken 10 times"> + </span>]:<span class="lineCov">        459 :         if (passphrase.empty()) {</span></a>
<a name="2759"><span class="lineNum">    2759 </span>                :            :             // Empty string means unencrypted</a>
<a name="2760"><span class="lineNum">    2760 </span>  [<span class="branchCov" title="Branch 0 was taken 449 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 449 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1806 :             warnings.emplace_back(Untranslated(&quot;Empty string given as passphrase, wallet will not be encrypted.&quot;));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2761"><span class="lineNum">    2761 </span>                :            :         }</a>
<a name="2762"><span class="lineNum">    2762 </span>                :            :     }</a>
<a name="2763"><span class="lineNum">    2763 </span>                :            : </a>
<a name="2764"><span class="lineNum">    2764 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 455 times"> + </span> :<span class="lineCov">        459 :     if (!request.params[4].isNull() &amp;&amp; request.params[4].get_bool()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 1 time"> + </span>]
<a name="2765"><span class="lineNum">    2765 </span>                :<span class="lineCov">          3 :         flags |= WALLET_FLAG_AVOID_REUSE;</span></a>
<a name="2766"><span class="lineNum">    2766 </span>                :            :     }</a>
<a name="2767"><span class="lineNum">    2767 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        459 :     if (request.params[5].isNull() || request.params[5].get_bool()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 184 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 275 times"> + </span>]
<a name="2768"><span class="lineNum">    2768 </span>                :            : #ifndef USE_SQLITE</a>
<a name="2769"><span class="lineNum">    2769 </span>                :            :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Compiled without sqlite support (required for descriptor wallets)&quot;);</a>
<a name="2770"><span class="lineNum">    2770 </span>                :            : #endif</a>
<a name="2771"><span class="lineNum">    2771 </span>                :<span class="lineCov">        184 :         flags |= WALLET_FLAG_DESCRIPTORS;</span></a>
<a name="2772"><span class="lineNum">    2772 </span>                :            :     }</a>
<a name="2773"><span class="lineNum">    2773 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 455 times"> + </span> :<span class="lineCov">        459 :     if (!request.params[7].isNull() &amp;&amp; request.params[7].get_bool()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 1 time"> + </span>]
<a name="2774"><span class="lineNum">    2774 </span>                :            : #ifdef ENABLE_EXTERNAL_SIGNER</a>
<a name="2775"><span class="lineNum">    2775 </span>                :<span class="lineCov">          3 :         flags |= WALLET_FLAG_EXTERNAL_SIGNER;</span></a>
<a name="2776"><span class="lineNum">    2776 </span>                :            : #else</a>
<a name="2777"><span class="lineNum">    2777 </span>                :            :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Compiled without external signing support (required for external signing)&quot;);</a>
<a name="2778"><span class="lineNum">    2778 </span>                :            : #endif</a>
<a name="2779"><span class="lineNum">    2779 </span>                :            :     }</a>
<a name="2780"><span class="lineNum">    2780 </span>                :            : </a>
<a name="2781"><span class="lineNum">    2781 </span>                :            : #ifndef USE_BDB</a>
<a name="2782"><span class="lineNum">    2782 </span>                :            :     if (!(flags &amp; WALLET_FLAG_DESCRIPTORS)) {</a>
<a name="2783"><span class="lineNum">    2783 </span>                :            :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Compiled without bdb support (required for legacy wallets)&quot;);</a>
<a name="2784"><span class="lineNum">    2784 </span>                :            :     }</a>
<a name="2785"><span class="lineNum">    2785 </span>                :            : #endif</a>
<a name="2786"><span class="lineNum">    2786 </span>                :            : </a>
<a name="2787"><span class="lineNum">    2787 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        918 :     DatabaseOptions options;</span></a>
<a name="2788"><span class="lineNum">    2788 </span>                :<span class="lineCov">        459 :     DatabaseStatus status;</span></a>
<a name="2789"><span class="lineNum">    2789 </span>                :<span class="lineCov">        459 :     options.require_create = true;</span></a>
<a name="2790"><span class="lineNum">    2790 </span>                :<span class="lineCov">        459 :     options.create_flags = flags;</span></a>
<a name="2791"><span class="lineNum">    2791 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        459 :     options.create_passphrase = passphrase;</span></a>
<a name="2792"><span class="lineNum">    2792 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        918 :     bilingual_str error;</span></a>
<a name="2793"><span class="lineNum">    2793 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 213 times"> + </span><span class="branchCov" title="Branch 3 was taken 246 times"> + </span> :<span class="lineCov">        459 :     std::optional&lt;bool&gt; load_on_start = request.params[6].isNull() ? std::nullopt : std::optional&lt;bool&gt;(request.params[6].get_bool());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 246 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 246 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2794"><span class="lineNum">    2794 </span>  [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        916 :     const std::shared_ptr&lt;CWallet&gt; wallet = CreateWallet(context, request.params[0].get_str(), load_on_start, options, status, error, warnings);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 457 times"> + </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span>]
<a name="2795"><span class="lineNum">    2795 </span>        [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchCov" title="Branch 1 was taken 448 times"> + </span>]:<span class="lineCov">        457 :     if (!wallet) {</span></a>
<a name="2796"><span class="lineNum">    2796 </span>        [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          9 :         RPCErrorCode code = status == DatabaseStatus::FAILED_ENCRYPT ? RPC_WALLET_ENCRYPTION_FAILED : RPC_WALLET_ERROR;</span></a>
<a name="2797"><span class="lineNum">    2797 </span>        [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          9 :         throw JSONRPCError(code, error.original);</span></a>
<a name="2798"><span class="lineNum">    2798 </span>                :            :     }</a>
<a name="2799"><span class="lineNum">    2799 </span>                :            : </a>
<a name="2800"><span class="lineNum">    2800 </span>  [<span class="branchCov" title="Branch 0 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        448 :     UniValue obj(UniValue::VOBJ);</span></a>
<a name="2801"><span class="lineNum">    2801 </span>  [<span class="branchCov" title="Branch 0 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        896 :     obj.pushKV(&quot;name&quot;, wallet-&gt;GetName());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2802"><span class="lineNum">    2802 </span>  [<span class="branchCov" title="Branch 0 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2240 :     obj.pushKV(&quot;warning&quot;, Join(warnings, Untranslated(&quot;\n&quot;)).original);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 448 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="2803"><span class="lineNum">    2803 </span>                :            : </a>
<a name="2804"><span class="lineNum">    2804 </span>        [<span class="branchCov" title="Branch 0 was taken 448 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        896 :     return obj;</span></a>
<a name="2805"><span class="lineNum">    2805 </span>                :            : },</a>
<a name="2806"><span class="lineNum">    2806 </span>  [<span class="branchCov" title="Branch 0 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      52137 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1931 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1931 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 15448 times"> + </span><span class="branchCov" title="Branch 73 was taken 1931 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 74 was not taken"> - </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span>]
<a name="2807"><span class="lineNum">    2807 </span>                :            : }</a>
<a name="2808"><span class="lineNum">    2808 </span>                :            : </a>
<a name="2809"><span class="lineNum">    2809 </span>                :<span class="lineCov">       1482 : static RPCHelpMan restorewallet()</span></a>
<a name="2810"><span class="lineNum">    2810 </span>                :            : {</a>
<a name="2811"><span class="lineNum">    2811 </span>                :<span class="lineCov">       1482 :     return RPCHelpMan{</span></a>
<a name="2812"><span class="lineNum">    2812 </span>                :            :         &quot;restorewallet&quot;,</a>
<a name="2813"><span class="lineNum">    2813 </span>                :            :         &quot;\nRestore and loads a wallet from backup.\n&quot;,</a>
<a name="2814"><span class="lineNum">    2814 </span>                :            :         {</a>
<a name="2815"><span class="lineNum">    2815 </span>                :<span class="lineCov">       1482 :             {&quot;wallet_name&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The name that will be applied to the restored wallet&quot;},</span></a>
<a name="2816"><span class="lineNum">    2816 </span>                :<span class="lineCov">       1482 :             {&quot;backup_file&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The backup file that will be used to restore the wallet.&quot;},</span></a>
<a name="2817"><span class="lineNum">    2817 </span>                :<span class="lineCov">       1482 :             {&quot;load_on_startup&quot;, RPCArg::Type::BOOL, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Save wallet name to persistent settings and load on startup. True to add wallet to startup list, false to remove, null to leave unchanged.&quot;},</span></a>
<a name="2818"><span class="lineNum">    2818 </span>                :            :         },</a>
<a name="2819"><span class="lineNum">    2819 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="2820"><span class="lineNum">    2820 </span>                :            :             RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2821"><span class="lineNum">    2821 </span>                :            :             {</a>
<a name="2822"><span class="lineNum">    2822 </span>                :            :                 {RPCResult::Type::STR, &quot;name&quot;, &quot;The wallet name if restored successfully.&quot;},</a>
<a name="2823"><span class="lineNum">    2823 </span>                :            :                 {RPCResult::Type::STR, &quot;warning&quot;, &quot;Warning message if wallet was not loaded cleanly.&quot;},</a>
<a name="2824"><span class="lineNum">    2824 </span>                :            :             }</a>
<a name="2825"><span class="lineNum">    2825 </span>  [<span class="branchCov" title="Branch 0 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5928 :         },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1482 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1482 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2964 times"> + </span><span class="branchCov" title="Branch 21 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="2826"><span class="lineNum">    2826 </span>                :<span class="lineCov">       1482 :         RPCExamples{</span></a>
<a name="2827"><span class="lineNum">    2827 </span>  [<span class="branchCov" title="Branch 0 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2964 :             HelpExampleCli(&quot;restorewallet&quot;, &quot;\&quot;testwallet\&quot; \&quot;home\\backups\\backup-file.bak\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2828"><span class="lineNum">    2828 </span>  [<span class="branchCov" title="Branch 0 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5928 :             + HelpExampleRpc(&quot;restorewallet&quot;, &quot;\&quot;testwallet\&quot; \&quot;home\\backups\\backup-file.bak\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2829"><span class="lineNum">    2829 </span>  [<span class="branchCov" title="Branch 0 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10374 :             + HelpExampleCliNamed(&quot;restorewallet&quot;, {{&quot;wallet_name&quot;, &quot;testwallet&quot;}, {&quot;backup_file&quot;, &quot;home\\backups\\backup-file.bak\&quot;&quot;}, {&quot;load_on_startup&quot;, true}})</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1482 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 4446 times"> + </span><span class="branchCov" title="Branch 15 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="2830"><span class="lineNum">    2830 </span>  [<span class="branchCov" title="Branch 0 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10374 :             + HelpExampleRpcNamed(&quot;restorewallet&quot;, {{&quot;wallet_name&quot;, &quot;testwallet&quot;}, {&quot;backup_file&quot;, &quot;home\\backups\\backup-file.bak\&quot;&quot;}, {&quot;load_on_startup&quot;, true}})</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1482 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 4446 times"> + </span><span class="branchCov" title="Branch 15 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="2831"><span class="lineNum">    2831 </span>                :<span class="lineCov">       1482 :         },</span></a>
<a name="2832"><span class="lineNum">    2832 </span>                :<span class="lineCov">         10 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2833"><span class="lineNum">    2833 </span>                :            : {</a>
<a name="2834"><span class="lineNum">    2834 </span>                :            : </a>
<a name="2835"><span class="lineNum">    2835 </span>                :<span class="lineCov">         10 :     WalletContext&amp; context = EnsureWalletContext(request.context);</span></a>
<a name="2836"><span class="lineNum">    2836 </span>                :            : </a>
<a name="2837"><span class="lineNum">    2837 </span>                :<span class="lineCov">         10 :     auto backup_file = fs::u8path(request.params[1].get_str());</span></a>
<a name="2838"><span class="lineNum">    2838 </span>                :            : </a>
<a name="2839"><span class="lineNum">    2839 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span>]:<span class="lineCov">         10 :     if (!fs::exists(backup_file)) {</span></a>
<a name="2840"><span class="lineNum">    2840 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Backup file does not exist&quot;);</span></a>
<a name="2841"><span class="lineNum">    2841 </span>                :            :     }</a>
<a name="2842"><span class="lineNum">    2842 </span>                :            : </a>
<a name="2843"><span class="lineNum">    2843 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         16 :     std::string wallet_name = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2844"><span class="lineNum">    2844 </span>                :            : </a>
<a name="2845"><span class="lineNum">    2845 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         16 :     const fs::path wallet_path = fsbridge::AbsPathJoin(GetWalletDir(), fs::u8path(wallet_name));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2846"><span class="lineNum">    2846 </span>                :            : </a>
<a name="2847"><span class="lineNum">    2847 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">          8 :     if (fs::exists(wallet_path)) {</span></a>
<a name="2848"><span class="lineNum">    2848 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Wallet name already exists.&quot;);</span></a>
<a name="2849"><span class="lineNum">    2849 </span>                :            :     }</a>
<a name="2850"><span class="lineNum">    2850 </span>                :            : </a>
<a name="2851"><span class="lineNum">    2851 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">          6 :     if (!TryCreateDirectories(wallet_path)) {</span></a>
<a name="2852"><span class="lineNum">    2852 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, strprintf(&quot;Failed to create database path '%s'. Database already exists.&quot;, wallet_path.u8string()));</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="2853"><span class="lineNum">    2853 </span>                :            :     }</a>
<a name="2854"><span class="lineNum">    2854 </span>                :            : </a>
<a name="2855"><span class="lineNum">    2855 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :     auto wallet_file = wallet_path / &quot;wallet.dat&quot;;</span></a>
<a name="2856"><span class="lineNum">    2856 </span>                :            : </a>
<a name="2857"><span class="lineNum">    2857 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :     fs::copy_file(backup_file, wallet_file, fs::copy_option::fail_if_exists);</span></a>
<a name="2858"><span class="lineNum">    2858 </span>                :            : </a>
<a name="2859"><span class="lineNum">    2859 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         18 :     auto [wallet, warnings] = LoadWalletHelper(context, request.params[2], wallet_name);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 6 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="2860"><span class="lineNum">    2860 </span>                :            : </a>
<a name="2861"><span class="lineNum">    2861 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :     UniValue obj(UniValue::VOBJ);</span></a>
<a name="2862"><span class="lineNum">    2862 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         12 :     obj.pushKV(&quot;name&quot;, wallet-&gt;GetName());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2863"><span class="lineNum">    2863 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         30 :     obj.pushKV(&quot;warning&quot;, Join(warnings, Untranslated(&quot;\n&quot;)).original);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2864"><span class="lineNum">    2864 </span>                :            : </a>
<a name="2865"><span class="lineNum">    2865 </span>                :<span class="lineCov">         12 :     return obj;</span></a>
<a name="2866"><span class="lineNum">    2866 </span>                :            : </a>
<a name="2867"><span class="lineNum">    2867 </span>                :            : },</a>
<a name="2868"><span class="lineNum">    2868 </span>  [<span class="branchCov" title="Branch 0 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      17784 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1482 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1482 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1482 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1482 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 4446 times"> + </span><span class="branchCov" title="Branch 33 was taken 1482 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>]
<a name="2869"><span class="lineNum">    2869 </span>                :            : }</a>
<a name="2870"><span class="lineNum">    2870 </span>                :            : </a>
<a name="2871"><span class="lineNum">    2871 </span>                :<span class="lineCov">       1655 : static RPCHelpMan unloadwallet()</span></a>
<a name="2872"><span class="lineNum">    2872 </span>                :            : {</a>
<a name="2873"><span class="lineNum">    2873 </span>                :<span class="lineCov">       1655 :     return RPCHelpMan{&quot;unloadwallet&quot;,</span></a>
<a name="2874"><span class="lineNum">    2874 </span>                :            :                 &quot;Unloads the wallet referenced by the request endpoint otherwise unloads the wallet specified in the argument.\n&quot;</a>
<a name="2875"><span class="lineNum">    2875 </span>                :            :                 &quot;Specifying the wallet name on a wallet endpoint is invalid.&quot;,</a>
<a name="2876"><span class="lineNum">    2876 </span>                :            :                 {</a>
<a name="2877"><span class="lineNum">    2877 </span>        [<span class="branchCov" title="Branch 0 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3310 :                     {&quot;wallet_name&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;the wallet name from the RPC endpoint&quot;}, &quot;The name of the wallet to unload. If provided both here and in the RPC endpoint, the two must be identical.&quot;},</span></a>
<a name="2878"><span class="lineNum">    2878 </span>                :<span class="lineCov">       1655 :                     {&quot;load_on_startup&quot;, RPCArg::Type::BOOL, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Save wallet name to persistent settings and load on startup. True to add wallet to startup list, false to remove, null to leave unchanged.&quot;},</span></a>
<a name="2879"><span class="lineNum">    2879 </span>                :            :                 },</a>
<a name="2880"><span class="lineNum">    2880 </span>                :<span class="lineNoCov">          0 :                 RPCResult{RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, {</span></a>
<a name="2881"><span class="lineNum">    2881 </span>                :            :                     {RPCResult::Type::STR, &quot;warning&quot;, &quot;Warning message if wallet was not unloaded cleanly.&quot;},</a>
<a name="2882"><span class="lineNum">    2882 </span>  [<span class="branchCov" title="Branch 0 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4965 :                 }},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1655 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1655 times"> + </span><span class="branchCov" title="Branch 15 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="2883"><span class="lineNum">    2883 </span>                :<span class="lineCov">       1655 :                 RPCExamples{</span></a>
<a name="2884"><span class="lineNum">    2884 </span>  [<span class="branchCov" title="Branch 0 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3310 :                     HelpExampleCli(&quot;unloadwallet&quot;, &quot;wallet_name&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2885"><span class="lineNum">    2885 </span>  [<span class="branchCov" title="Branch 0 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6620 :             + HelpExampleRpc(&quot;unloadwallet&quot;, &quot;wallet_name&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2886"><span class="lineNum">    2886 </span>                :<span class="lineCov">       1655 :                 },</span></a>
<a name="2887"><span class="lineNum">    2887 </span>                :<span class="lineCov">        183 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2888"><span class="lineNum">    2888 </span>                :            : {</a>
<a name="2889"><span class="lineNum">    2889 </span>        [<span class="branchCov" title="Branch 0 was taken 183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        183 :     std::string wallet_name;</span></a>
<a name="2890"><span class="lineNum">    2890 </span>  [<span class="branchCov" title="Branch 0 was taken 183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 51 times"> + </span><span class="branchCov" title="Branch 3 was taken 132 times"> + </span>]:<span class="lineCov">        183 :     if (GetWalletNameFromJSONRPCRequest(request, wallet_name)) {</span></a>
<a name="2891"><span class="lineNum">    2891 </span>  [<span class="branchCov" title="Branch 0 was taken 51 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 45 times"> + </span> :<span class="lineCov">         51 :         if (!(request.params[0].isNull() || request.params[0].get_str() == wallet_name)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 3 times"> + </span>]
<a name="2892"><span class="lineNum">    2892 </span>  [<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;RPC endpoint wallet and wallet_name parameter specify different wallets&quot;);</span></a>
<a name="2893"><span class="lineNum">    2893 </span>                :            :         }</a>
<a name="2894"><span class="lineNum">    2894 </span>                :            :     } else {</a>
<a name="2895"><span class="lineNum">    2895 </span>  [<span class="branchCov" title="Branch 0 was taken 132 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 129 times"> + </span><span class="branchCov" title="Branch 3 was taken 3 times"> + </span> :<span class="lineCov">        132 :         wallet_name = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 129 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2896"><span class="lineNum">    2896 </span>                :            :     }</a>
<a name="2897"><span class="lineNum">    2897 </span>                :            : </a>
<a name="2898"><span class="lineNum">    2898 </span>        [<span class="branchCov" title="Branch 0 was taken 177 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        177 :     WalletContext&amp; context = EnsureWalletContext(request.context);</span></a>
<a name="2899"><span class="lineNum">    2899 </span>        [<span class="branchCov" title="Branch 0 was taken 177 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        354 :     std::shared_ptr&lt;CWallet&gt; wallet = GetWallet(context, wallet_name);</span></a>
<a name="2900"><span class="lineNum">    2900 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchCov" title="Branch 1 was taken 171 times"> + </span>]:<span class="lineCov">        177 :     if (!wallet) {</span></a>
<a name="2901"><span class="lineNum">    2901 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         throw JSONRPCError(RPC_WALLET_NOT_FOUND, &quot;Requested wallet does not exist or is not loaded&quot;);</span></a>
<a name="2902"><span class="lineNum">    2902 </span>                :            :     }</a>
<a name="2903"><span class="lineNum">    2903 </span>                :            : </a>
<a name="2904"><span class="lineNum">    2904 </span>                :            :     // Release the &quot;main&quot; shared pointer and prevent further notifications.</a>
<a name="2905"><span class="lineNum">    2905 </span>                :            :     // Note that any attempt to load the same wallet would fail until the wallet</a>
<a name="2906"><span class="lineNum">    2906 </span>                :            :     // is destroyed (see CheckUniqueFileid).</a>
<a name="2907"><span class="lineNum">    2907 </span>  [<span class="branchCov" title="Branch 0 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 171 times"> + </span>]:<span class="lineCov">        342 :     std::vector&lt;bilingual_str&gt; warnings;</span></a>
<a name="2908"><span class="lineNum">    2908 </span>  [<span class="branchCov" title="Branch 0 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 165 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span> :<span class="lineCov">        171 :     std::optional&lt;bool&gt; load_on_start = request.params[1].isNull() ? std::nullopt : std::optional&lt;bool&gt;(request.params[1].get_bool());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2909"><span class="lineNum">    2909 </span>  [<span class="branchCov" title="Branch 0 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 171 times"> + </span>]:<span class="lineCov">        171 :     if (!RemoveWallet(context, wallet, load_on_start, warnings)) {</span></a>
<a name="2910"><span class="lineNum">    2910 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_MISC_ERROR, &quot;Requested wallet already unloaded&quot;);</span></a>
<a name="2911"><span class="lineNum">    2911 </span>                :            :     }</a>
<a name="2912"><span class="lineNum">    2912 </span>                :            : </a>
<a name="2913"><span class="lineNum">    2913 </span>        [<span class="branchCov" title="Branch 0 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        171 :     UnloadWallet(std::move(wallet));</span></a>
<a name="2914"><span class="lineNum">    2914 </span>                :            : </a>
<a name="2915"><span class="lineNum">    2915 </span>  [<span class="branchCov" title="Branch 0 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        171 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="2916"><span class="lineNum">    2916 </span>  [<span class="branchCov" title="Branch 0 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        855 :     result.pushKV(&quot;warning&quot;, Join(warnings, Untranslated(&quot;\n&quot;)).original);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 171 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2917"><span class="lineNum">    2917 </span>                :<span class="lineCov">        342 :     return result;</span></a>
<a name="2918"><span class="lineNum">    2918 </span>                :            : },</a>
<a name="2919"><span class="lineNum">    2919 </span>  [<span class="branchCov" title="Branch 0 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      18205 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1655 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1655 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 3310 times"> + </span><span class="branchCov" title="Branch 25 was taken 1655 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="2920"><span class="lineNum">    2920 </span>                :            : }</a>
<a name="2921"><span class="lineNum">    2921 </span>                :            : </a>
<a name="2922"><span class="lineNum">    2922 </span>                :<span class="lineCov">       2018 : static RPCHelpMan listunspent()</span></a>
<a name="2923"><span class="lineNum">    2923 </span>                :            : {</a>
<a name="2924"><span class="lineNum">    2924 </span>                :<span class="lineCov">       2018 :     return RPCHelpMan{</span></a>
<a name="2925"><span class="lineNum">    2925 </span>                :            :                 &quot;listunspent&quot;,</a>
<a name="2926"><span class="lineNum">    2926 </span>                :            :                 &quot;\nReturns array of unspent transaction outputs\n&quot;</a>
<a name="2927"><span class="lineNum">    2927 </span>                :            :                 &quot;with between minconf and maxconf (inclusive) confirmations.\n&quot;</a>
<a name="2928"><span class="lineNum">    2928 </span>                :            :                 &quot;Optionally filter to only include txouts paid to specified addresses.\n&quot;,</a>
<a name="2929"><span class="lineNum">    2929 </span>                :            :                 {</a>
<a name="2930"><span class="lineNum">    2930 </span>        [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4036 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;The minimum confirmations to filter&quot;},</span></a>
<a name="2931"><span class="lineNum">    2931 </span>        [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4036 :                     {&quot;maxconf&quot;, RPCArg::Type::NUM, RPCArg::Default{9999999}, &quot;The maximum confirmations to filter&quot;},</span></a>
<a name="2932"><span class="lineNum">    2932 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4036 :                     {&quot;addresses&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;The bitcoin addresses to filter&quot;,</span></a>
<a name="2933"><span class="lineNum">    2933 </span>                :            :                         {</a>
<a name="2934"><span class="lineNum">    2934 </span>                :<span class="lineCov">       2018 :                             {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;bitcoin address&quot;},</span></a>
<a name="2935"><span class="lineNum">    2935 </span>                :            :                         },</a>
<a name="2936"><span class="lineNum">    2936 </span>                :            :                     },</a>
<a name="2937"><span class="lineNum">    2937 </span>        [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4036 :                     {&quot;include_unsafe&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Include outputs that are not safe to spend\n&quot;</span></a>
<a name="2938"><span class="lineNum">    2938 </span>                :            :                               &quot;See description of \&quot;safe\&quot; attribute below.&quot;},</a>
<a name="2939"><span class="lineNum">    2939 </span>                :<span class="lineCov">       2018 :                     {&quot;query_options&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;JSON with query options&quot;,</span></a>
<a name="2940"><span class="lineNum">    2940 </span>                :            :                         {</a>
<a name="2941"><span class="lineNum">    2941 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :                             {&quot;minimumAmount&quot;, RPCArg::Type::AMOUNT, RPCArg::Default{FormatMoney(0)}, &quot;Minimum value of each UTXO in &quot; + CURRENCY_UNIT + &quot;&quot;},</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2942"><span class="lineNum">    2942 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :                             {&quot;maximumAmount&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;unlimited&quot;}, &quot;Maximum value of each UTXO in &quot; + CURRENCY_UNIT + &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2943"><span class="lineNum">    2943 </span>        [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4036 :                             {&quot;maximumCount&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;unlimited&quot;}, &quot;Maximum number of UTXOs&quot;},</span></a>
<a name="2944"><span class="lineNum">    2944 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :                             {&quot;minimumSumAmount&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;unlimited&quot;}, &quot;Minimum sum value of all UTXOs in &quot; + CURRENCY_UNIT + &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2945"><span class="lineNum">    2945 </span>                :            :                         },</a>
<a name="2946"><span class="lineNum">    2946 </span>                :            :                         &quot;query_options&quot;},</a>
<a name="2947"><span class="lineNum">    2947 </span>                :            :                 },</a>
<a name="2948"><span class="lineNum">    2948 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="2949"><span class="lineNum">    2949 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="2950"><span class="lineNum">    2950 </span>                :            :                     {</a>
<a name="2951"><span class="lineNum">    2951 </span>                :            :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="2952"><span class="lineNum">    2952 </span>                :            :                         {</a>
<a name="2953"><span class="lineNum">    2953 </span>                :            :                             {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;the transaction id&quot;},</a>
<a name="2954"><span class="lineNum">    2954 </span>                :            :                             {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="2955"><span class="lineNum">    2955 </span>                :            :                             {RPCResult::Type::STR, &quot;address&quot;, /* optional */ true, &quot;the bitcoin address&quot;},</a>
<a name="2956"><span class="lineNum">    2956 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, /* optional */ true, &quot;The associated label, or \&quot;\&quot; for the default label&quot;},</a>
<a name="2957"><span class="lineNum">    2957 </span>                :            :                             {RPCResult::Type::STR, &quot;scriptPubKey&quot;, &quot;the script key&quot;},</a>
<a name="2958"><span class="lineNum">    2958 </span>        [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       4036 :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;the transaction output amount in &quot; + CURRENCY_UNIT},</span></a>
<a name="2959"><span class="lineNum">    2959 </span>                :            :                             {RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations&quot;},</a>
<a name="2960"><span class="lineNum">    2960 </span>                :            :                             {RPCResult::Type::NUM, &quot;ancestorcount&quot;, /* optional */ true, &quot;The number of in-mempool ancestor transactions, including this one (if transaction is in the mempool)&quot;},</a>
<a name="2961"><span class="lineNum">    2961 </span>                :            :                             {RPCResult::Type::NUM, &quot;ancestorsize&quot;, /* optional */ true, &quot;The virtual transaction size of in-mempool ancestors, including this one (if transaction is in the mempool)&quot;},</a>
<a name="2962"><span class="lineNum">    2962 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       4036 :                             {RPCResult::Type::STR_AMOUNT, &quot;ancestorfees&quot;, /* optional */ true, &quot;The total fees of in-mempool ancestors (including this one) with fee deltas used for mining priority in &quot; + CURRENCY_ATOM + &quot; (if transaction is in the mempool)&quot;},</span></a>
<a name="2963"><span class="lineNum">    2963 </span>                :            :                             {RPCResult::Type::STR_HEX, &quot;redeemScript&quot;, /* optional */ true, &quot;The redeemScript if scriptPubKey is P2SH&quot;},</a>
<a name="2964"><span class="lineNum">    2964 </span>                :            :                             {RPCResult::Type::STR, &quot;witnessScript&quot;, /* optional */ true, &quot;witnessScript if the scriptPubKey is P2WSH or P2SH-P2WSH&quot;},</a>
<a name="2965"><span class="lineNum">    2965 </span>                :            :                             {RPCResult::Type::BOOL, &quot;spendable&quot;, &quot;Whether we have the private keys to spend this output&quot;},</a>
<a name="2966"><span class="lineNum">    2966 </span>                :            :                             {RPCResult::Type::BOOL, &quot;solvable&quot;, &quot;Whether we know how to spend this output, ignoring the lack of keys&quot;},</a>
<a name="2967"><span class="lineNum">    2967 </span>                :            :                             {RPCResult::Type::BOOL, &quot;reused&quot;, /* optional */ true, &quot;(only present if avoid_reuse is set) Whether this output is reused/dirty (sent to an address that was previously spent from)&quot;},</a>
<a name="2968"><span class="lineNum">    2968 </span>                :            :                             {RPCResult::Type::STR, &quot;desc&quot;, /* optional */ true, &quot;(only when solvable) A descriptor for spending this output&quot;},</a>
<a name="2969"><span class="lineNum">    2969 </span>                :            :                             {RPCResult::Type::BOOL, &quot;safe&quot;, &quot;Whether this output is considered safe to spend. Unconfirmed transactions\n&quot;</a>
<a name="2970"><span class="lineNum">    2970 </span>                :            :                                                             &quot;from outside keys and unconfirmed replacement transactions are considered unsafe\n&quot;</a>
<a name="2971"><span class="lineNum">    2971 </span>                :            :                                                             &quot;and are not eligible for spending by fundrawtransaction and sendtoaddress.&quot;},</a>
<a name="2972"><span class="lineNum">    2972 </span>                :            :                         }},</a>
<a name="2973"><span class="lineNum">    2973 </span>                :            :                     }</a>
<a name="2974"><span class="lineNum">    2974 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      48432 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 2018 times"> + </span><span class="branchCov" title="Branch 115 was taken 2018 times"> + </span><span class="branchCov" title="Branch 116 was taken 34306 times"> + </span><span class="branchCov" title="Branch 117 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 118 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchNoCov" title="Branch 120 was not taken"> - </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span>]
<a name="2975"><span class="lineNum">    2975 </span>                :<span class="lineCov">       2018 :                 RPCExamples{</span></a>
<a name="2976"><span class="lineNum">    2976 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4036 :                     HelpExampleCli(&quot;listunspent&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="2977"><span class="lineNum">    2977 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :             + HelpExampleCli(&quot;listunspent&quot;, &quot;6 9999999 \&quot;[\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;]\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2018 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2018 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="2978"><span class="lineNum">    2978 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :             + HelpExampleRpc(&quot;listunspent&quot;, &quot;6, 9999999 \&quot;[\\\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\\\&quot;,\\\&quot;&quot; + EXAMPLE_ADDRESS[1] + &quot;\\\&quot;]\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2018 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2018 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="2979"><span class="lineNum">    2979 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :             + HelpExampleCli(&quot;listunspent&quot;, &quot;6 9999999 '[]' true '{ \&quot;minimumAmount\&quot;: 0.005 }'&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2980"><span class="lineNum">    2980 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8072 :             + HelpExampleRpc(&quot;listunspent&quot;, &quot;6, 9999999, [] , true, { \&quot;minimumAmount\&quot;: 0.005 } &quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="2981"><span class="lineNum">    2981 </span>                :<span class="lineCov">       2018 :                 },</span></a>
<a name="2982"><span class="lineNum">    2982 </span>                :<span class="lineCov">        546 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="2983"><span class="lineNum">    2983 </span>                :            : {</a>
<a name="2984"><span class="lineNum">    2984 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 546 times"> + </span>]:<span class="lineCov">       1092 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="2985"><span class="lineNum">    2985 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        546 :     if (!pwallet) return NullUniValue;</span></a>
<a name="2986"><span class="lineNum">    2986 </span>                :            : </a>
<a name="2987"><span class="lineNum">    2987 </span>                :<span class="lineCov">        546 :     int nMinDepth = 1;</span></a>
<a name="2988"><span class="lineNum">    2988 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 90 times"> + </span><span class="branchCov" title="Branch 3 was taken 456 times"> + </span>]:<span class="lineCov">        546 :     if (!request.params[0].isNull()) {</span></a>
<a name="2989"><span class="lineNum">    2989 </span>  [<span class="branchCov" title="Branch 0 was taken 90 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 90 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         90 :         RPCTypeCheckArgument(request.params[0], UniValue::VNUM);</span></a>
<a name="2990"><span class="lineNum">    2990 </span>  [<span class="branchCov" title="Branch 0 was taken 90 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 90 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         90 :         nMinDepth = request.params[0].get_int();</span></a>
<a name="2991"><span class="lineNum">    2991 </span>                :            :     }</a>
<a name="2992"><span class="lineNum">    2992 </span>                :            : </a>
<a name="2993"><span class="lineNum">    2993 </span>                :<span class="lineCov">        546 :     int nMaxDepth = 9999999;</span></a>
<a name="2994"><span class="lineNum">    2994 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchCov" title="Branch 3 was taken 534 times"> + </span>]:<span class="lineCov">        546 :     if (!request.params[1].isNull()) {</span></a>
<a name="2995"><span class="lineNum">    2995 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         RPCTypeCheckArgument(request.params[1], UniValue::VNUM);</span></a>
<a name="2996"><span class="lineNum">    2996 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :         nMaxDepth = request.params[1].get_int();</span></a>
<a name="2997"><span class="lineNum">    2997 </span>                :            :     }</a>
<a name="2998"><span class="lineNum">    2998 </span>                :            : </a>
<a name="2999"><span class="lineNum">    2999 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1092 :     std::set&lt;CTxDestination&gt; destinations;</span></a>
<a name="3000"><span class="lineNum">    3000 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span><span class="branchCov" title="Branch 3 was taken 537 times"> + </span>]:<span class="lineCov">        546 :     if (!request.params[2].isNull()) {</span></a>
<a name="3001"><span class="lineNum">    3001 </span>  [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          9 :         RPCTypeCheckArgument(request.params[2], UniValue::VARR);</span></a>
<a name="3002"><span class="lineNum">    3002 </span>  [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         18 :         UniValue inputs = request.params[2].get_array();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3003"><span class="lineNum">    3003 </span>        [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchCov" title="Branch 1 was taken 9 times"> + </span>]:<span class="lineCov">         18 :         for (unsigned int idx = 0; idx &lt; inputs.size(); idx++) {</span></a>
<a name="3004"><span class="lineNum">    3004 </span>        [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          9 :             const UniValue&amp; input = inputs[idx];</span></a>
<a name="3005"><span class="lineNum">    3005 </span>  [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          9 :             CTxDestination dest = DecodeDestination(input.get_str());</span></a>
<a name="3006"><span class="lineNum">    3006 </span>  [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 9 times"> + </span>]:<span class="lineCov">          9 :             if (!IsValidDestination(dest)) {</span></a>
<a name="3007"><span class="lineNum">    3007 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, std::string(&quot;Invalid Bitcoin address: &quot;) + input.get_str());</span></a>
<span class="lineNum">         </span>   <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<a name="3008"><span class="lineNum">    3008 </span>                :            :             }</a>
<a name="3009"><span class="lineNum">    3009 </span>  [<span class="branchCov" title="Branch 0 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 9 times"> + </span>]:<span class="lineCov">          9 :             if (!destinations.insert(dest).second) {</span></a>
<a name="3010"><span class="lineNum">    3010 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, std::string(&quot;Invalid parameter, duplicated address: &quot;) + input.get_str());</span></a>
<span class="lineNum">         </span>   <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<a name="3011"><span class="lineNum">    3011 </span>                :            :             }</a>
<a name="3012"><span class="lineNum">    3012 </span>                :            :         }</a>
<a name="3013"><span class="lineNum">    3013 </span>                :            :     }</a>
<a name="3014"><span class="lineNum">    3014 </span>                :            : </a>
<a name="3015"><span class="lineNum">    3015 </span>                :<span class="lineCov">        546 :     bool include_unsafe = true;</span></a>
<a name="3016"><span class="lineNum">    3016 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 540 times"> + </span>]:<span class="lineCov">        546 :     if (!request.params[3].isNull()) {</span></a>
<a name="3017"><span class="lineNum">    3017 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         RPCTypeCheckArgument(request.params[3], UniValue::VBOOL);</span></a>
<a name="3018"><span class="lineNum">    3018 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         include_unsafe = request.params[3].get_bool();</span></a>
<a name="3019"><span class="lineNum">    3019 </span>                :            :     }</a>
<a name="3020"><span class="lineNum">    3020 </span>                :            : </a>
<a name="3021"><span class="lineNum">    3021 </span>                :<span class="lineCov">        546 :     CAmount nMinimumAmount = 0;</span></a>
<a name="3022"><span class="lineNum">    3022 </span>                :<span class="lineCov">        546 :     CAmount nMaximumAmount = MAX_MONEY;</span></a>
<a name="3023"><span class="lineNum">    3023 </span>                :<span class="lineCov">        546 :     CAmount nMinimumSumAmount = MAX_MONEY;</span></a>
<a name="3024"><span class="lineNum">    3024 </span>                :<span class="lineCov">        546 :     uint64_t nMaximumCount = 0;</span></a>
<a name="3025"><span class="lineNum">    3025 </span>                :            : </a>
<a name="3026"><span class="lineNum">    3026 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 144 times"> + </span><span class="branchCov" title="Branch 3 was taken 402 times"> + </span>]:<span class="lineCov">        546 :     if (!request.params[4].isNull()) {</span></a>
<a name="3027"><span class="lineNum">    3027 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        144 :         const UniValue&amp; options = request.params[4].get_obj();</span></a>
<a name="3028"><span class="lineNum">    3028 </span>                :            : </a>
<a name="3029"><span class="lineNum">    3029 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        288 :         RPCTypeCheckObj(options,</span></a>
<a name="3030"><span class="lineNum">    3030 </span>                :            :             {</a>
<a name="3031"><span class="lineNum">    3031 </span>        [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        144 :                 {&quot;minimumAmount&quot;, UniValueType()},</span></a>
<a name="3032"><span class="lineNum">    3032 </span>        [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        144 :                 {&quot;maximumAmount&quot;, UniValueType()},</span></a>
<a name="3033"><span class="lineNum">    3033 </span>        [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        144 :                 {&quot;minimumSumAmount&quot;, UniValueType()},</span></a>
<a name="3034"><span class="lineNum">    3034 </span>        [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        144 :                 {&quot;maximumCount&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3035"><span class="lineNum">    3035 </span>                :            :             },</a>
<a name="3036"><span class="lineNum">    3036 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1440 :             true, true);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 576 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 9 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="3037"><span class="lineNum">    3037 </span>                :            : </a>
<a name="3038"><span class="lineNum">    3038 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        288 :         if (options.exists(&quot;minimumAmount&quot;))</span></a>
<a name="3039"><span class="lineNum">    3039 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        288 :             nMinimumAmount = AmountFromValue(options[&quot;minimumAmount&quot;]);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3040"><span class="lineNum">    3040 </span>                :            : </a>
<a name="3041"><span class="lineNum">    3041 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 144 times"> + </span>]:<span class="lineCov">        288 :         if (options.exists(&quot;maximumAmount&quot;))</span></a>
<a name="3042"><span class="lineNum">    3042 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        144 :             nMaximumAmount = AmountFromValue(options[&quot;maximumAmount&quot;]);</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3043"><span class="lineNum">    3043 </span>                :            : </a>
<a name="3044"><span class="lineNum">    3044 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 144 times"> + </span>]:<span class="lineCov">        288 :         if (options.exists(&quot;minimumSumAmount&quot;))</span></a>
<a name="3045"><span class="lineNum">    3045 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        144 :             nMinimumSumAmount = AmountFromValue(options[&quot;minimumSumAmount&quot;]);</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3046"><span class="lineNum">    3046 </span>                :            : </a>
<a name="3047"><span class="lineNum">    3047 </span>  [<span class="branchCov" title="Branch 0 was taken 144 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 144 times"> + </span>]:<span class="lineCov">        288 :         if (options.exists(&quot;maximumCount&quot;))</span></a>
<a name="3048"><span class="lineNum">    3048 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        546 :             nMaximumCount = options[&quot;maximumCount&quot;].get_int64();</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3049"><span class="lineNum">    3049 </span>                :            :     }</a>
<a name="3050"><span class="lineNum">    3050 </span>                :            : </a>
<a name="3051"><span class="lineNum">    3051 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="3052"><span class="lineNum">    3052 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="3053"><span class="lineNum">    3053 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        546 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="3054"><span class="lineNum">    3054 </span>                :            : </a>
<a name="3055"><span class="lineNum">    3055 </span>  [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1092 :     UniValue results(UniValue::VARR);</span></a>
<a name="3056"><span class="lineNum">    3056 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1092 :     std::vector&lt;COutput&gt; vecOutputs;</span></a>
<a name="3057"><span class="lineNum">    3057 </span>                :<span class="lineCov">        546 :     {</span></a>
<a name="3058"><span class="lineNum">    3058 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        546 :         CCoinControl cctl;</span></a>
<a name="3059"><span class="lineNum">    3059 </span>                :<span class="lineCov">        546 :         cctl.m_avoid_address_reuse = false;</span></a>
<a name="3060"><span class="lineNum">    3060 </span>                :<span class="lineCov">        546 :         cctl.m_min_depth = nMinDepth;</span></a>
<a name="3061"><span class="lineNum">    3061 </span>                :<span class="lineCov">        546 :         cctl.m_max_depth = nMaxDepth;</span></a>
<a name="3062"><span class="lineNum">    3062 </span>                :<span class="lineCov">        546 :         cctl.m_include_unsafe_inputs = include_unsafe;</span></a>
<a name="3063"><span class="lineNum">    3063 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1092 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="3064"><span class="lineNum">    3064 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        546 :         AvailableCoins(*pwallet, vecOutputs, &amp;cctl, nMinimumAmount, nMaximumAmount, nMinimumSumAmount, nMaximumCount);</span></a>
<a name="3065"><span class="lineNum">    3065 </span>                :            :     }</a>
<a name="3066"><span class="lineNum">    3066 </span>                :            : </a>
<a name="3067"><span class="lineNum">    3067 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1092 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="3068"><span class="lineNum">    3068 </span>                :            : </a>
<a name="3069"><span class="lineNum">    3069 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        546 :     const bool avoid_reuse = pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);</span></a>
<a name="3070"><span class="lineNum">    3070 </span>                :            : </a>
<a name="3071"><span class="lineNum">    3071 </span>        [<span class="branchCov" title="Branch 0 was taken 31405 times"> + </span><span class="branchCov" title="Branch 1 was taken 546 times"> + </span>]:<span class="lineCov">      31951 :     for (const COutput&amp; out : vecOutputs) {</span></a>
<a name="3072"><span class="lineNum">    3072 </span>                :<span class="lineCov">      31405 :         CTxDestination address;</span></a>
<a name="3073"><span class="lineNum">    3073 </span>        [<span class="branchCov" title="Branch 0 was taken 31405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      31405 :         const CScript&amp; scriptPubKey = out.tx-&gt;tx-&gt;vout[out.i].scriptPubKey;</span></a>
<a name="3074"><span class="lineNum">    3074 </span>        [<span class="branchCov" title="Branch 0 was taken 31405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      31405 :         bool fValidAddress = ExtractDestination(scriptPubKey, address);</span></a>
<a name="3075"><span class="lineNum">    3075 </span>  [<span class="branchCov" title="Branch 0 was taken 40 times"> + </span><span class="branchCov" title="Branch 1 was taken 31365 times"> + </span><span class="branchCov" title="Branch 2 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      31405 :         bool reused = avoid_reuse &amp;&amp; pwallet-&gt;IsSpentKey(out.tx-&gt;GetHash(), out.i);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30 times"> + </span><span class="branchCov" title="Branch 5 was taken 10 times"> + </span>]
<a name="3076"><span class="lineNum">    3076 </span>                :            : </a>
<a name="3077"><span class="lineNum">    3077 </span>  [<span class="branchCov" title="Branch 0 was taken 513 times"> + </span><span class="branchCov" title="Branch 1 was taken 30892 times"> + </span><span class="branchCov" title="Branch 2 was taken 513 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      31405 :         if (destinations.size() &amp;&amp; (!fValidAddress || !destinations.count(address)))</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 513 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 504 times"> + </span><span class="branchCov" title="Branch 7 was taken 9 times"> + </span>]
<a name="3078"><span class="lineNum">    3078 </span>                :<span class="lineCov">        504 :             continue;</span></a>
<a name="3079"><span class="lineNum">    3079 </span>                :            : </a>
<a name="3080"><span class="lineNum">    3080 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      61802 :         UniValue entry(UniValue::VOBJ);</span></a>
<a name="3081"><span class="lineNum">    3081 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;txid&quot;, out.tx-&gt;GetHash().GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3082"><span class="lineNum">    3082 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;vout&quot;, out.i);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30714 times"> + </span><span class="branchCov" title="Branch 5 was taken 187 times"> + </span>]
<a name="3083"><span class="lineNum">    3083 </span>                :            : </a>
<a name="3084"><span class="lineNum">    3084 </span>        [<span class="branchCov" title="Branch 0 was taken 30714 times"> + </span><span class="branchCov" title="Branch 1 was taken 187 times"> + </span>]:<span class="lineCov">      30901 :         if (fValidAddress) {</span></a>
<a name="3085"><span class="lineNum">    3085 </span>  [<span class="branchCov" title="Branch 0 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61428 :             entry.pushKV(&quot;address&quot;, EncodeDestination(address));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3086"><span class="lineNum">    3086 </span>                :            : </a>
<a name="3087"><span class="lineNum">    3087 </span>        [<span class="branchCov" title="Branch 0 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      30714 :             const auto* address_book_entry = pwallet-&gt;FindAddressBookEntry(address);</span></a>
<a name="3088"><span class="lineNum">    3088 </span>        [<span class="branchCov" title="Branch 0 was taken 25916 times"> + </span><span class="branchCov" title="Branch 1 was taken 4798 times"> + </span>]:<span class="lineCov">      30714 :             if (address_book_entry) {</span></a>
<a name="3089"><span class="lineNum">    3089 </span>  [<span class="branchCov" title="Branch 0 was taken 25916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 25916 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      56630 :                 entry.pushKV(&quot;label&quot;, address_book_entry-&gt;GetLabel());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3090"><span class="lineNum">    3090 </span>                :            :             }</a>
<a name="3091"><span class="lineNum">    3091 </span>                :            : </a>
<a name="3092"><span class="lineNum">    3092 </span>        [<span class="branchCov" title="Branch 0 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      30714 :             std::unique_ptr&lt;SigningProvider&gt; provider = pwallet-&gt;GetSolvingProvider(scriptPubKey);</span></a>
<a name="3093"><span class="lineNum">    3093 </span>        [<span class="branchCov" title="Branch 0 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      30714 :             if (provider) {</span></a>
<a name="3094"><span class="lineNum">    3094 </span>  [<span class="branchCov" title="Branch 0 was taken 30714 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2019 times"> + </span><span class="branchCov" title="Branch 3 was taken 28695 times"> + </span>]:<span class="lineCov">      30714 :                 if (scriptPubKey.IsPayToScriptHash()) {</span></a>
<a name="3095"><span class="lineNum">    3095 </span>  [<span class="branchCov" title="Branch 0 was taken 2019 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2019 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2019 :                     const CScriptID&amp; hash = CScriptID(std::get&lt;ScriptHash&gt;(address));</span></a>
<a name="3096"><span class="lineNum">    3096 </span>        [<span class="branchCov" title="Branch 0 was taken 2019 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2019 :                     CScript redeemScript;</span></a>
<a name="3097"><span class="lineNum">    3097 </span>  [<span class="branchCov" title="Branch 0 was taken 2019 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1993 times"> + </span><span class="branchCov" title="Branch 3 was taken 26 times"> + </span>]:<span class="lineCov">       2019 :                     if (provider-&gt;GetCScript(hash, redeemScript)) {</span></a>
<a name="3098"><span class="lineNum">    3098 </span>  [<span class="branchCov" title="Branch 0 was taken 712 times"> + </span><span class="branchCov" title="Branch 1 was taken 1281 times"> + </span><span class="branchCov" title="Branch 2 was taken 1993 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5979 :                         entry.pushKV(&quot;redeemScript&quot;, HexStr(redeemScript));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1993 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1993 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3099"><span class="lineNum">    3099 </span>                :            :                         // Now check if the redeemScript is actually a P2WSH script</a>
<a name="3100"><span class="lineNum">    3100 </span>                :<span class="lineCov">       1993 :                         CTxDestination witness_destination;</span></a>
<a name="3101"><span class="lineNum">    3101 </span>  [<span class="branchCov" title="Branch 0 was taken 1993 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 338 times"> + </span><span class="branchCov" title="Branch 3 was taken 1655 times"> + </span>]:<span class="lineCov">       1993 :                         if (redeemScript.IsPayToWitnessScriptHash()) {</span></a>
<a name="3102"><span class="lineNum">    3102 </span>        [<span class="branchCov" title="Branch 0 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        338 :                             bool extracted = ExtractDestination(redeemScript, witness_destination);</span></a>
<a name="3103"><span class="lineNum">    3103 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        338 :                             CHECK_NONFATAL(extracted);</span></a>
<a name="3104"><span class="lineNum">    3104 </span>                :            :                             // Also return the witness script</a>
<a name="3105"><span class="lineNum">    3105 </span>        [<span class="branchCov" title="Branch 0 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        338 :                             const WitnessV0ScriptHash&amp; whash = std::get&lt;WitnessV0ScriptHash&gt;(witness_destination);</span></a>
<a name="3106"><span class="lineNum">    3106 </span>                :<span class="lineCov">        338 :                             CScriptID id;</span></a>
<a name="3107"><span class="lineNum">    3107 </span>  [<span class="branchCov" title="Branch 0 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        338 :                             CRIPEMD160().Write(whash.begin(), whash.size()).Finalize(id.begin());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3108"><span class="lineNum">    3108 </span>        [<span class="branchCov" title="Branch 0 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2357 :                             CScript witnessScript;</span></a>
<a name="3109"><span class="lineNum">    3109 </span>  [<span class="branchCov" title="Branch 0 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        338 :                             if (provider-&gt;GetCScript(id, witnessScript)) {</span></a>
<a name="3110"><span class="lineNum">    3110 </span>  [<span class="branchCov" title="Branch 0 was taken 255 times"> + </span><span class="branchCov" title="Branch 1 was taken 83 times"> + </span><span class="branchCov" title="Branch 2 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1352 :                                 entry.pushKV(&quot;witnessScript&quot;, HexStr(witnessScript));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 338 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3111"><span class="lineNum">    3111 </span>                :            :                             }</a>
<a name="3112"><span class="lineNum">    3112 </span>                :            :                         }</a>
<a name="3113"><span class="lineNum">    3113 </span>                :            :                     }</a>
<a name="3114"><span class="lineNum">    3114 </span>  [<span class="branchCov" title="Branch 0 was taken 28695 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 485 times"> + </span><span class="branchCov" title="Branch 3 was taken 28210 times"> + </span>]:<span class="lineCov">      28695 :                 } else if (scriptPubKey.IsPayToWitnessScriptHash()) {</span></a>
<a name="3115"><span class="lineNum">    3115 </span>        [<span class="branchCov" title="Branch 0 was taken 485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        485 :                     const WitnessV0ScriptHash&amp; whash = std::get&lt;WitnessV0ScriptHash&gt;(address);</span></a>
<a name="3116"><span class="lineNum">    3116 </span>                :<span class="lineCov">        485 :                     CScriptID id;</span></a>
<a name="3117"><span class="lineNum">    3117 </span>  [<span class="branchCov" title="Branch 0 was taken 485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 485 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        485 :                     CRIPEMD160().Write(whash.begin(), whash.size()).Finalize(id.begin());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 485 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3118"><span class="lineNum">    3118 </span>        [<span class="branchCov" title="Branch 0 was taken 485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      31199 :                     CScript witnessScript;</span></a>
<a name="3119"><span class="lineNum">    3119 </span>  [<span class="branchCov" title="Branch 0 was taken 485 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 484 times"> + </span><span class="branchCov" title="Branch 3 was taken 1 time"> + </span>]:<span class="lineCov">        485 :                     if (provider-&gt;GetCScript(id, witnessScript)) {</span></a>
<a name="3120"><span class="lineNum">    3120 </span>  [<span class="branchCov" title="Branch 0 was taken 351 times"> + </span><span class="branchCov" title="Branch 1 was taken 133 times"> + </span><span class="branchCov" title="Branch 2 was taken 484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1937 :                         entry.pushKV(&quot;witnessScript&quot;, HexStr(witnessScript));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3121"><span class="lineNum">    3121 </span>                :            :                     }</a>
<a name="3122"><span class="lineNum">    3122 </span>                :            :                 }</a>
<a name="3123"><span class="lineNum">    3123 </span>                :            :             }</a>
<a name="3124"><span class="lineNum">    3124 </span>                :            :         }</a>
<a name="3125"><span class="lineNum">    3125 </span>                :            : </a>
<a name="3126"><span class="lineNum">    3126 </span>  [<span class="branchCov" title="Branch 0 was taken 28739 times"> + </span><span class="branchCov" title="Branch 1 was taken 2162 times"> + </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      92703 :         entry.pushKV(&quot;scriptPubKey&quot;, HexStr(scriptPubKey));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3127"><span class="lineNum">    3127 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;amount&quot;, ValueFromAmount(out.tx-&gt;tx-&gt;vout[out.i].nValue));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3128"><span class="lineNum">    3128 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;confirmations&quot;, out.nDepth);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 70 times"> + </span><span class="branchCov" title="Branch 5 was taken 30831 times"> + </span>]
<a name="3129"><span class="lineNum">    3129 </span>        [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchCov" title="Branch 1 was taken 30831 times"> + </span>]:<span class="lineCov">      30901 :         if (!out.nDepth) {</span></a>
<a name="3130"><span class="lineNum">    3130 </span>                :<span class="lineCov">         70 :             size_t ancestor_count, descendant_count, ancestor_size;</span></a>
<a name="3131"><span class="lineNum">    3131 </span>                :<span class="lineCov">         70 :             CAmount ancestor_fees;</span></a>
<a name="3132"><span class="lineNum">    3132 </span>        [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         70 :             pwallet-&gt;chain().getTransactionAncestry(out.tx-&gt;GetHash(), ancestor_count, descendant_count, &amp;ancestor_size, &amp;ancestor_fees);</span></a>
<a name="3133"><span class="lineNum">    3133 </span>        [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         70 :             if (ancestor_count) {</span></a>
<a name="3134"><span class="lineNum">    3134 </span>  [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        140 :                 entry.pushKV(&quot;ancestorcount&quot;, uint64_t(ancestor_count));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3135"><span class="lineNum">    3135 </span>  [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        140 :                 entry.pushKV(&quot;ancestorsize&quot;, uint64_t(ancestor_size));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3136"><span class="lineNum">    3136 </span>  [<span class="branchCov" title="Branch 0 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 70 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      30971 :                 entry.pushKV(&quot;ancestorfees&quot;, uint64_t(ancestor_fees));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3137"><span class="lineNum">    3137 </span>                :            :             }</a>
<a name="3138"><span class="lineNum">    3138 </span>                :            :         }</a>
<a name="3139"><span class="lineNum">    3139 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;spendable&quot;, out.fSpendable);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3140"><span class="lineNum">    3140 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;solvable&quot;, out.fSolvable);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30773 times"> + </span><span class="branchCov" title="Branch 5 was taken 128 times"> + </span>]
<a name="3141"><span class="lineNum">    3141 </span>        [<span class="branchCov" title="Branch 0 was taken 30773 times"> + </span><span class="branchCov" title="Branch 1 was taken 128 times"> + </span>]:<span class="lineCov">      30901 :         if (out.fSolvable) {</span></a>
<a name="3142"><span class="lineNum">    3142 </span>        [<span class="branchCov" title="Branch 0 was taken 30773 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      61546 :             std::unique_ptr&lt;SigningProvider&gt; provider = pwallet-&gt;GetSolvingProvider(scriptPubKey);</span></a>
<a name="3143"><span class="lineNum">    3143 </span>        [<span class="branchCov" title="Branch 0 was taken 30773 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      30773 :             if (provider) {</span></a>
<a name="3144"><span class="lineNum">    3144 </span>        [<span class="branchCov" title="Branch 0 was taken 30773 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      30773 :                 auto descriptor = InferDescriptor(scriptPubKey, *provider);</span></a>
<a name="3145"><span class="lineNum">    3145 </span>  [<span class="branchCov" title="Branch 0 was taken 30773 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30773 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61546 :                 entry.pushKV(&quot;desc&quot;, descriptor-&gt;ToString());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30773 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3146"><span class="lineNum">    3146 </span>                :            :             }</a>
<a name="3147"><span class="lineNum">    3147 </span>                :            :         }</a>
<a name="3148"><span class="lineNum">    3148 </span>  [<span class="branchCov" title="Branch 0 was taken 40 times"> + </span><span class="branchCov" title="Branch 1 was taken 30861 times"> + </span><span class="branchCov" title="Branch 2 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      30941 :         if (avoid_reuse) entry.pushKV(&quot;reused&quot;, reused);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 40 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3149"><span class="lineNum">    3149 </span>  [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      61802 :         entry.pushKV(&quot;safe&quot;, out.fSafe);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3150"><span class="lineNum">    3150 </span>        [<span class="branchCov" title="Branch 0 was taken 30901 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      30901 :         results.push_back(entry);</span></a>
<a name="3151"><span class="lineNum">    3151 </span>                :            :     }</a>
<a name="3152"><span class="lineNum">    3152 </span>                :            : </a>
<a name="3153"><span class="lineNum">    3153 </span>        [<span class="branchCov" title="Branch 0 was taken 546 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        546 :     return results;</span></a>
<a name="3154"><span class="lineNum">    3154 </span>                :            : },</a>
<a name="3155"><span class="lineNum">    3155 </span>  [<span class="branchCov" title="Branch 0 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      80720 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 2018 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 10090 times"> + </span><span class="branchCov" title="Branch 87 was taken 2018 times"> + </span><span class="branchCov" title="Branch 88 was taken 8072 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 89 was taken 2018 times"> + </span><span class="branchCov" title="Branch 90 was taken 2018 times"> + </span><span class="branchCov" title="Branch 91 was taken 2018 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 94 was not taken"> - </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchNoCov" title="Branch 96 was not taken"> - </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span>]
<a name="3156"><span class="lineNum">    3156 </span>                :            : }</a>
<a name="3157"><span class="lineNum">    3157 </span>                :            : </a>
<a name="3158"><span class="lineNum">    3158 </span>                :            : // Only includes key documentation where the key is snake_case in all RPC methods. MixedCase keys can be added later.</a>
<a name="3159"><span class="lineNum">    3159 </span>                :<span class="lineCov">       5230 : static std::vector&lt;RPCArg&gt; FundTxDoc()</span></a>
<a name="3160"><span class="lineNum">    3160 </span>                :            : {</a>
<a name="3161"><span class="lineNum">    3161 </span>                :<span class="lineCov">       5230 :     return {</span></a>
<a name="3162"><span class="lineNum">    3162 </span>        [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      10460 :         {&quot;conf_target&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;wallet -txconfirmtarget&quot;}, &quot;Confirmation target in blocks&quot;},</span></a>
<a name="3163"><span class="lineNum">    3163 </span>        [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      15690 :         {&quot;estimate_mode&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;unset&quot;}, std::string() + &quot;The fee estimate mode, must be one of (case insensitive):\n&quot;</span></a>
<a name="3164"><span class="lineNum">    3164 </span>  [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15690 :             &quot;         \&quot;&quot; + FeeModes(&quot;\&quot;\n\&quot;&quot;) + &quot;\&quot;&quot;},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 5230 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="3165"><span class="lineNum">    3165 </span>        [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      10460 :         {&quot;replaceable&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;wallet default&quot;}, &quot;Marks this transaction as BIP125 replaceable.\n&quot;</span></a>
<a name="3166"><span class="lineNum">    3166 </span>                :            :             &quot;Allows this transaction to be replaced by a transaction with higher fees&quot;},</a>
<a name="3167"><span class="lineNum">    3167 </span>                :<span class="lineCov">       5230 :         {&quot;solving_data&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Keys and scripts needed for producing a final transaction with a dummy signature.\n&quot;</span></a>
<a name="3168"><span class="lineNum">    3168 </span>                :            :             &quot;Used for fee estimation during coin selection.&quot;,</a>
<a name="3169"><span class="lineNum">    3169 </span>                :            :          {</a>
<a name="3170"><span class="lineNum">    3170 </span>  [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      10460 :              {&quot;pubkeys&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;Public keys involved in this transaction.&quot;,</span></a>
<a name="3171"><span class="lineNum">    3171 </span>                :            :              {</a>
<a name="3172"><span class="lineNum">    3172 </span>                :<span class="lineCov">       5230 :                  {&quot;pubkey&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED, &quot;A public key&quot;},</span></a>
<a name="3173"><span class="lineNum">    3173 </span>                :            :              }},</a>
<a name="3174"><span class="lineNum">    3174 </span>  [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      10460 :              {&quot;scripts&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;Scripts involved in this transaction.&quot;,</span></a>
<a name="3175"><span class="lineNum">    3175 </span>                :            :              {</a>
<a name="3176"><span class="lineNum">    3176 </span>                :<span class="lineCov">       5230 :                  {&quot;script&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED, &quot;A script&quot;},</span></a>
<a name="3177"><span class="lineNum">    3177 </span>                :            :              }},</a>
<a name="3178"><span class="lineNum">    3178 </span>  [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">      10460 :              {&quot;descriptors&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;Descriptors that provide solving data for this transaction.&quot;,</span></a>
<a name="3179"><span class="lineNum">    3179 </span>                :            :              {</a>
<a name="3180"><span class="lineNum">    3180 </span>                :<span class="lineCov">       5230 :                  {&quot;descriptor&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED, &quot;A descriptor&quot;},</span></a>
<a name="3181"><span class="lineNum">    3181 </span>                :            :              }},</a>
<a name="3182"><span class="lineNum">    3182 </span>                :            :          }},</a>
<a name="3183"><span class="lineNum">    3183 </span>  [<span class="branchCov" title="Branch 0 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">     156900 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 20920 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 89 was taken 5230 times"> + </span><span class="branchCov" title="Branch 90 was taken 15690 times"> + </span><span class="branchCov" title="Branch 91 was taken 5230 times"> + </span><span class="branchCov" title="Branch 92 was taken 5230 times"> + </span><span class="branchCov" title="Branch 93 was taken 5230 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 5230 times"> + </span><span class="branchCov" title="Branch 95 was taken 5230 times"> + </span><span class="branchCov" title="Branch 96 was taken 5230 times"> + </span><span class="branchCov" title="Branch 97 was taken 5230 times"> + </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchNoCov" title="Branch 100 was not taken"> - </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchNoCov" title="Branch 102 was not taken"> - </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 104 was not taken"> - </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchNoCov" title="Branch 106 was not taken"> - </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span>]
<a name="3184"><span class="lineNum">    3184 </span>                :            : }</a>
<a name="3185"><span class="lineNum">    3185 </span>                :            : </a>
<a name="3186"><span class="lineNum">    3186 </span>                :<span class="lineCov">        802 : void FundTransaction(CWallet&amp; wallet, CMutableTransaction&amp; tx, CAmount&amp; fee_out, int&amp; change_position, const UniValue&amp; options, CCoinControl&amp; coinControl, bool override_min_fee)</span></a>
<a name="3187"><span class="lineNum">    3187 </span>                :            : {</a>
<a name="3188"><span class="lineNum">    3188 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="3189"><span class="lineNum">    3189 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="3190"><span class="lineNum">    3190 </span>                :<span class="lineCov">        802 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="3191"><span class="lineNum">    3191 </span>                :            : </a>
<a name="3192"><span class="lineNum">    3192 </span>                :<span class="lineCov">        802 :     change_position = -1;</span></a>
<a name="3193"><span class="lineNum">    3193 </span>                :<span class="lineCov">        802 :     bool lockUnspents = false;</span></a>
<a name="3194"><span class="lineNum">    3194 </span>        [<span class="branchCov" title="Branch 0 was taken 685 times"> + </span><span class="branchCov" title="Branch 1 was taken 117 times"> + </span>]:<span class="lineCov">       1235 :     UniValue subtractFeeFromOutputs;</span></a>
<a name="3195"><span class="lineNum">    3195 </span>        [<span class="branchCov" title="Branch 0 was taken 685 times"> + </span><span class="branchCov" title="Branch 1 was taken 117 times"> + </span>]:<span class="lineCov">       1604 :     std::set&lt;int&gt; setSubtractFeeFromOutputs;</span></a>
<a name="3196"><span class="lineNum">    3196 </span>                :            : </a>
<a name="3197"><span class="lineNum">    3197 </span>        [<span class="branchCov" title="Branch 0 was taken 685 times"> + </span><span class="branchCov" title="Branch 1 was taken 117 times"> + </span>]:<span class="lineCov">        802 :     if (!options.isNull()) {</span></a>
<a name="3198"><span class="lineNum">    3198 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 683 times"> + </span>]:<span class="lineCov">        685 :       if (options.type() == UniValue::VBOOL) {</span></a>
<a name="3199"><span class="lineNum">    3199 </span>                :            :         // backward compatibility bool only fallback</a>
<a name="3200"><span class="lineNum">    3200 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          2 :         coinControl.fAllowWatchOnly = options.get_bool();</span></a>
<a name="3201"><span class="lineNum">    3201 </span>                :            :       }</a>
<a name="3202"><span class="lineNum">    3202 </span>                :            :       else {</a>
<a name="3203"><span class="lineNum">    3203 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :         RPCTypeCheckArgument(options, UniValue::VOBJ);</span></a>
<a name="3204"><span class="lineNum">    3204 </span>  [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 633 times"> + </span><span class="branchCov" title="Branch 3 was taken 50 times"> + </span>]:<span class="lineCov">       1366 :         RPCTypeCheckObj(options,</span></a>
<a name="3205"><span class="lineNum">    3205 </span>                :            :             {</a>
<a name="3206"><span class="lineNum">    3206 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;add_inputs&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3207"><span class="lineNum">    3207 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;include_unsafe&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3208"><span class="lineNum">    3208 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;add_to_wallet&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3209"><span class="lineNum">    3209 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;changeAddress&quot;, UniValueType(UniValue::VSTR)},</span></a>
<a name="3210"><span class="lineNum">    3210 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;change_address&quot;, UniValueType(UniValue::VSTR)},</span></a>
<a name="3211"><span class="lineNum">    3211 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;changePosition&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3212"><span class="lineNum">    3212 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;change_position&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3213"><span class="lineNum">    3213 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;change_type&quot;, UniValueType(UniValue::VSTR)},</span></a>
<a name="3214"><span class="lineNum">    3214 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;includeWatching&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3215"><span class="lineNum">    3215 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;include_watching&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3216"><span class="lineNum">    3216 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;inputs&quot;, UniValueType(UniValue::VARR)},</span></a>
<a name="3217"><span class="lineNum">    3217 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;lockUnspents&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3218"><span class="lineNum">    3218 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;lock_unspents&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3219"><span class="lineNum">    3219 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;locktime&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3220"><span class="lineNum">    3220 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;fee_rate&quot;, UniValueType()}, // will be checked by AmountFromValue() in SetFeeEstimateMode()</span></a>
<a name="3221"><span class="lineNum">    3221 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;feeRate&quot;, UniValueType()}, // will be checked by AmountFromValue() below</span></a>
<a name="3222"><span class="lineNum">    3222 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;psbt&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3223"><span class="lineNum">    3223 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;solving_data&quot;, UniValueType(UniValue::VOBJ)},</span></a>
<a name="3224"><span class="lineNum">    3224 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;subtractFeeFromOutputs&quot;, UniValueType(UniValue::VARR)},</span></a>
<a name="3225"><span class="lineNum">    3225 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;subtract_fee_from_outputs&quot;, UniValueType(UniValue::VARR)},</span></a>
<a name="3226"><span class="lineNum">    3226 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;replaceable&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3227"><span class="lineNum">    3227 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;conf_target&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3228"><span class="lineNum">    3228 </span>        [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        683 :                 {&quot;estimate_mode&quot;, UniValueType(UniValue::VSTR)},</span></a>
<a name="3229"><span class="lineNum">    3229 </span>                :            :             },</a>
<a name="3230"><span class="lineNum">    3230 </span>  [<span class="branchCov" title="Branch 0 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      32834 :             true, true);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 683 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 683 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 683 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 683 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 683 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 14559 times"> + </span><span class="branchCov" title="Branch 47 was taken 633 times"> + </span><span class="branchCov" title="Branch 48 was taken 1150 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 49 was taken 50 times"> + </span>]
<a name="3231"><span class="lineNum">    3231 </span>                :            : </a>
<a name="3232"><span class="lineNum">    3232 </span>  [<span class="branchCov" title="Branch 0 was taken 633 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 252 times"> + </span><span class="branchCov" title="Branch 3 was taken 381 times"> + </span>]:<span class="lineCov">       1266 :         if (options.exists(&quot;add_inputs&quot;) ) {</span></a>
<a name="3233"><span class="lineNum">    3233 </span>  [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        885 :             coinControl.m_add_inputs = options[&quot;add_inputs&quot;].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 633 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3234"><span class="lineNum">    3234 </span>                :            :         }</a>
<a name="3235"><span class="lineNum">    3235 </span>                :            : </a>
<a name="3236"><span class="lineNum">    3236 </span>  [<span class="branchCov" title="Branch 0 was taken 633 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 633 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1246 :         if (options.exists(&quot;changeAddress&quot;) || options.exists(&quot;change_address&quot;)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 607 times"> + </span><span class="branchCov" title="Branch 5 was taken 26 times"> + </span><span class="branchCov" title="Branch 6 was taken 607 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 607 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 6 times"> + </span><span class="branchCov" title="Branch 11 was taken 601 times"> + </span><span class="branchCov" title="Branch 12 was taken 607 times"> + </span><span class="branchCov" title="Branch 13 was taken 26 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 32 times"> + </span><span class="branchCov" title="Branch 15 was taken 601 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3237"><span class="lineNum">    3237 </span>  [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 26 times"> + </span> :<span class="lineCov">         94 :             const std::string change_address_str = (options.exists(&quot;change_address&quot;) ? options[&quot;change_address&quot;] : options[&quot;changeAddress&quot;]).get_str();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 26 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 26 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 26 times"> + </span><span class="branchCov" title="Branch 17 was taken 6 times"> + </span><span class="branchCov" title="Branch 18 was taken 6 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 19 was taken 26 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="3238"><span class="lineNum">    3238 </span>        [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         32 :             CTxDestination dest = DecodeDestination(change_address_str);</span></a>
<a name="3239"><span class="lineNum">    3239 </span>                :            : </a>
<a name="3240"><span class="lineNum">    3240 </span>  [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 28 times"> + </span>]:<span class="lineCov">         32 :             if (!IsValidDestination(dest)) {</span></a>
<a name="3241"><span class="lineNum">    3241 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :                 throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Change address must be a valid bitcoin address&quot;);</span></a>
<a name="3242"><span class="lineNum">    3242 </span>                :            :             }</a>
<a name="3243"><span class="lineNum">    3243 </span>                :            : </a>
<a name="3244"><span class="lineNum">    3244 </span>                :<span class="lineCov">         28 :             coinControl.destChange = dest;</span></a>
<a name="3245"><span class="lineNum">    3245 </span>                :            :         }</a>
<a name="3246"><span class="lineNum">    3246 </span>                :            : </a>
<a name="3247"><span class="lineNum">    3247 </span>  [<span class="branchCov" title="Branch 0 was taken 629 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 629 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1254 :         if (options.exists(&quot;changePosition&quot;) || options.exists(&quot;change_position&quot;)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 621 times"> + </span><span class="branchCov" title="Branch 5 was taken 8 times"> + </span><span class="branchCov" title="Branch 6 was taken 621 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 621 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 4 times"> + </span><span class="branchCov" title="Branch 11 was taken 617 times"> + </span><span class="branchCov" title="Branch 12 was taken 621 times"> + </span><span class="branchCov" title="Branch 13 was taken 8 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 12 times"> + </span><span class="branchCov" title="Branch 15 was taken 617 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3248"><span class="lineNum">    3248 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span> :<span class="lineCov">        665 :             change_position = (options.exists(&quot;change_position&quot;) ? options[&quot;change_position&quot;] : options[&quot;changePosition&quot;]).get_int();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 8 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 8 times"> + </span><span class="branchCov" title="Branch 15 was taken 4 times"> + </span><span class="branchCov" title="Branch 16 was taken 4 times"> + </span><span class="branchCov" title="Branch 17 was taken 8 times"> + </span><span class="branchCov" title="Branch 18 was taken 629 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="3249"><span class="lineNum">    3249 </span>                :            :         }</a>
<a name="3250"><span class="lineNum">    3250 </span>                :            : </a>
<a name="3251"><span class="lineNum">    3251 </span>  [<span class="branchCov" title="Branch 0 was taken 629 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchCov" title="Branch 3 was taken 617 times"> + </span>]:<span class="lineCov">       1258 :         if (options.exists(&quot;change_type&quot;)) {</span></a>
<a name="3252"><span class="lineNum">    3252 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         22 :             if (options.exists(&quot;changeAddress&quot;) || options.exists(&quot;change_address&quot;)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 10 times"> + </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchCov" title="Branch 6 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 10 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span><span class="branchCov" title="Branch 11 was taken 10 times"> + </span><span class="branchCov" title="Branch 12 was taken 10 times"> + </span><span class="branchCov" title="Branch 13 was taken 2 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2 times"> + </span><span class="branchCov" title="Branch 15 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3253"><span class="lineNum">    3253 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot specify both change address and address type options&quot;);</span></a>
<a name="3254"><span class="lineNum">    3254 </span>                :            :             }</a>
<a name="3255"><span class="lineNum">    3255 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         20 :             if (std::optional&lt;OutputType&gt; parsed = ParseOutputType(options[&quot;change_type&quot;].get_str())) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span><span class="branchCov" title="Branch 6 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 6 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 2 times"> + </span>]
<a name="3256"><span class="lineNum">    3256 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">          6 :                 coinControl.m_change_type.emplace(parsed.value());</span></a>
<a name="3257"><span class="lineNum">    3257 </span>                :            :             } else {</a>
<a name="3258"><span class="lineNum">    3258 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :                 throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;Unknown change type '%s'&quot;, options[&quot;change_type&quot;].get_str()));</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="3259"><span class="lineNum">    3259 </span>                :            :             }</a>
<a name="3260"><span class="lineNum">    3260 </span>                :            :         }</a>
<a name="3261"><span class="lineNum">    3261 </span>                :            : </a>
<a name="3262"><span class="lineNum">    3262 </span>  [<span class="branchCov" title="Branch 0 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 7 times"> + </span><span class="branchCov" title="Branch 3 was taken 616 times"> + </span> :<span class="lineCov">       2485 :         const UniValue include_watching_option = options.exists(&quot;include_watching&quot;) ? options[&quot;include_watching&quot;] : options[&quot;includeWatching&quot;];</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 7 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 616 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 616 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 616 times"> + </span><span class="branchCov" title="Branch 15 was taken 7 times"> + </span><span class="branchCov" title="Branch 16 was taken 7 times"> + </span><span class="branchCov" title="Branch 17 was taken 616 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<a name="3263"><span class="lineNum">    3263 </span>        [<span class="branchCov" title="Branch 0 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        623 :         coinControl.fAllowWatchOnly = ParseIncludeWatchonly(include_watching_option, wallet);</span></a>
<a name="3264"><span class="lineNum">    3264 </span>                :            : </a>
<a name="3265"><span class="lineNum">    3265 </span>  [<span class="branchCov" title="Branch 0 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1242 :         if (options.exists(&quot;lockUnspents&quot;) || options.exists(&quot;lock_unspents&quot;)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 617 times"> + </span><span class="branchCov" title="Branch 5 was taken 6 times"> + </span><span class="branchCov" title="Branch 6 was taken 617 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 617 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2 times"> + </span><span class="branchCov" title="Branch 11 was taken 615 times"> + </span><span class="branchCov" title="Branch 12 was taken 617 times"> + </span><span class="branchCov" title="Branch 13 was taken 6 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 8 times"> + </span><span class="branchCov" title="Branch 15 was taken 615 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3266"><span class="lineNum">    3266 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span> :<span class="lineCov">        647 :             lockUnspents = (options.exists(&quot;lock_unspents&quot;) ? options[&quot;lock_unspents&quot;] : options[&quot;lockUnspents&quot;]).get_bool();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 6 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 6 times"> + </span><span class="branchCov" title="Branch 15 was taken 2 times"> + </span><span class="branchCov" title="Branch 16 was taken 2 times"> + </span><span class="branchCov" title="Branch 17 was taken 6 times"> + </span><span class="branchCov" title="Branch 18 was taken 623 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="3267"><span class="lineNum">    3267 </span>                :            :         }</a>
<a name="3268"><span class="lineNum">    3268 </span>                :            : </a>
<a name="3269"><span class="lineNum">    3269 </span>  [<span class="branchCov" title="Branch 0 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 615 times"> + </span>]:<span class="lineCov">       1246 :         if (options.exists(&quot;include_unsafe&quot;)) {</span></a>
<a name="3270"><span class="lineNum">    3270 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        631 :             coinControl.m_include_unsafe_inputs = options[&quot;include_unsafe&quot;].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3271"><span class="lineNum">    3271 </span>                :            :         }</a>
<a name="3272"><span class="lineNum">    3272 </span>                :            : </a>
<a name="3273"><span class="lineNum">    3273 </span>  [<span class="branchCov" title="Branch 0 was taken 623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 106 times"> + </span><span class="branchCov" title="Branch 3 was taken 517 times"> + </span>]:<span class="lineCov">       1246 :         if (options.exists(&quot;feeRate&quot;)) {</span></a>
<a name="3274"><span class="lineNum">    3274 </span>  [<span class="branchCov" title="Branch 0 was taken 106 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 102 times"> + </span>]:<span class="lineCov">        212 :             if (options.exists(&quot;fee_rate&quot;)) {</span></a>
<a name="3275"><span class="lineNum">    3275 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          8 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot specify both fee_rate (&quot; + CURRENCY_ATOM + &quot;/vB) and feeRate (&quot; + CURRENCY_UNIT + &quot;/kvB)&quot;);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 4 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="3276"><span class="lineNum">    3276 </span>                :            :             }</a>
<a name="3277"><span class="lineNum">    3277 </span>  [<span class="branchCov" title="Branch 0 was taken 102 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 98 times"> + </span>]:<span class="lineCov">        204 :             if (options.exists(&quot;conf_target&quot;)) {</span></a>
<a name="3278"><span class="lineNum">    3278 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot specify both conf_target and feeRate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.&quot;);</span></a>
<a name="3279"><span class="lineNum">    3279 </span>                :            :             }</a>
<a name="3280"><span class="lineNum">    3280 </span>  [<span class="branchCov" title="Branch 0 was taken 98 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 94 times"> + </span>]:<span class="lineCov">        196 :             if (options.exists(&quot;estimate_mode&quot;)) {</span></a>
<a name="3281"><span class="lineNum">    3281 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Cannot specify both estimate_mode and feeRate&quot;);</span></a>
<a name="3282"><span class="lineNum">    3282 </span>                :            :             }</a>
<a name="3283"><span class="lineNum">    3283 </span>  [<span class="branchCov" title="Branch 0 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 94 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        188 :             coinControl.m_feerate = CFeeRate(AmountFromValue(options[&quot;feeRate&quot;]));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 62 times"> + </span><span class="branchCov" title="Branch 5 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 62 times"> + </span>]
<a name="3284"><span class="lineNum">    3284 </span>                :<span class="lineCov">         62 :             coinControl.fOverrideFeeRate = true;</span></a>
<a name="3285"><span class="lineNum">    3285 </span>                :            :         }</a>
<a name="3286"><span class="lineNum">    3286 </span>                :            : </a>
<a name="3287"><span class="lineNum">    3287 </span>  [<span class="branchCov" title="Branch 0 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1091 :         if (options.exists(&quot;subtractFeeFromOutputs&quot;) || options.exists(&quot;subtract_fee_from_outputs&quot;) )</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 510 times"> + </span><span class="branchCov" title="Branch 5 was taken 69 times"> + </span><span class="branchCov" title="Branch 6 was taken 510 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 510 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2 times"> + </span><span class="branchCov" title="Branch 11 was taken 508 times"> + </span><span class="branchCov" title="Branch 12 was taken 510 times"> + </span><span class="branchCov" title="Branch 13 was taken 69 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 71 times"> + </span><span class="branchCov" title="Branch 15 was taken 508 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3288"><span class="lineNum">    3288 </span>  [<span class="branchCov" title="Branch 0 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 69 times"> + </span> :<span class="lineCov">        792 :             subtractFeeFromOutputs = (options.exists(&quot;subtract_fee_from_outputs&quot;) ? options[&quot;subtract_fee_from_outputs&quot;] : options[&quot;subtractFeeFromOutputs&quot;]).get_array();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 69 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 69 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 69 times"> + </span><span class="branchCov" title="Branch 17 was taken 2 times"> + </span><span class="branchCov" title="Branch 18 was taken 2 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 19 was taken 69 times"> + </span><span class="branchCov" title="Branch 20 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>]
<a name="3289"><span class="lineNum">    3289 </span>                :            : </a>
<a name="3290"><span class="lineNum">    3290 </span>  [<span class="branchCov" title="Branch 0 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchCov" title="Branch 3 was taken 567 times"> + </span>]:<span class="lineCov">       1158 :         if (options.exists(&quot;replaceable&quot;)) {</span></a>
<a name="3291"><span class="lineNum">    3291 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        591 :             coinControl.m_signal_bip125_rbf = options[&quot;replaceable&quot;].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3292"><span class="lineNum">    3292 </span>                :            :         }</a>
<a name="3293"><span class="lineNum">    3293 </span>  [<span class="branchCov" title="Branch 0 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1610 :         SetFeeEstimateMode(wallet, coinControl, options[&quot;conf_target&quot;], options[&quot;estimate_mode&quot;], options[&quot;fee_rate&quot;], override_min_fee);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 579 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 579 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 353 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 13 was taken 226 times"> + </span>]
<a name="3294"><span class="lineNum">    3294 </span>                :            :       }</a>
<a name="3295"><span class="lineNum">    3295 </span>                :            :     } else {</a>
<a name="3296"><span class="lineNum">    3296 </span>                :            :         // if options is null and not a bool</a>
<a name="3297"><span class="lineNum">    3297 </span>        [<span class="branchCov" title="Branch 0 was taken 117 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        117 :         coinControl.fAllowWatchOnly = ParseIncludeWatchonly(NullUniValue, wallet);</span></a>
<a name="3298"><span class="lineNum">    3298 </span>                :            :     }</a>
<a name="3299"><span class="lineNum">    3299 </span>                :            : </a>
<a name="3300"><span class="lineNum">    3300 </span>  [<span class="branchCov" title="Branch 0 was taken 472 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 20 times"> + </span><span class="branchCov" title="Branch 3 was taken 452 times"> + </span>]:<span class="lineCov">        944 :     if (options.exists(&quot;solving_data&quot;)) {</span></a>
<a name="3301"><span class="lineNum">    3301 </span>  [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         40 :         const UniValue solving_data = options[&quot;solving_data&quot;].get_obj();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3302"><span class="lineNum">    3302 </span>  [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchCov" title="Branch 3 was taken 10 times"> + </span>]:<span class="lineCov">         40 :         if (solving_data.exists(&quot;pubkeys&quot;)) {</span></a>
<a name="3303"><span class="lineNum">    3303 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         16 :             for (const UniValue&amp; pk_univ : solving_data[&quot;pubkeys&quot;].get_array().getValues()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 10 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 6 times"> + </span>]
<a name="3304"><span class="lineNum">    3304 </span>        [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         10 :                 const std::string&amp; pk_str = pk_univ.get_str();</span></a>
<a name="3305"><span class="lineNum">    3305 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span>]:<span class="lineCov">         10 :                 if (!IsHex(pk_str)) {</span></a>
<a name="3306"><span class="lineNum">    3306 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                     throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;'%s' is not hex&quot;, pk_str));</span></a>
<a name="3307"><span class="lineNum">    3307 </span>                :            :                 }</a>
<a name="3308"><span class="lineNum">    3308 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :                 const std::vector&lt;unsigned char&gt; data(ParseHex(pk_str));</span></a>
<a name="3309"><span class="lineNum">    3309 </span>                :<span class="lineCov">          8 :                 const CPubKey pubkey(data.begin(), data.end());</span></a>
<a name="3310"><span class="lineNum">    3310 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">          8 :                 if (!pubkey.IsFullyValid()) {</span></a>
<a name="3311"><span class="lineNum">    3311 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                     throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;'%s' is not a valid public key&quot;, pk_str));</span></a>
<a name="3312"><span class="lineNum">    3312 </span>                :            :                 }</a>
<a name="3313"><span class="lineNum">    3313 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :                 coinControl.m_external_provider.pubkeys.emplace(pubkey.GetID(), pubkey);</span></a>
<a name="3314"><span class="lineNum">    3314 </span>                :            :                 // Add witness script for pubkeys</a>
<a name="3315"><span class="lineNum">    3315 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :                 const CScript wit_script = GetScriptForDestination(WitnessV0KeyHash(pubkey));</span></a>
<a name="3316"><span class="lineNum">    3316 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :                 coinControl.m_external_provider.scripts.emplace(CScriptID(wit_script), wit_script);</span></a>
<a name="3317"><span class="lineNum">    3317 </span>                :            :             }</a>
<a name="3318"><span class="lineNum">    3318 </span>                :            :         }</a>
<a name="3319"><span class="lineNum">    3319 </span>                :            : </a>
<a name="3320"><span class="lineNum">    3320 </span>  [<span class="branchCov" title="Branch 0 was taken 16 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span>]:<span class="lineCov">         32 :         if (solving_data.exists(&quot;scripts&quot;)) {</span></a>
<a name="3321"><span class="lineNum">    3321 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         14 :             for (const UniValue&amp; script_univ : solving_data[&quot;scripts&quot;].get_array().getValues()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 8 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 6 times"> + </span>]
<a name="3322"><span class="lineNum">    3322 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :                 const std::string&amp; script_str = script_univ.get_str();</span></a>
<a name="3323"><span class="lineNum">    3323 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">          8 :                 if (!IsHex(script_str)) {</span></a>
<a name="3324"><span class="lineNum">    3324 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                     throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(&quot;'%s' is not hex&quot;, script_str));</span></a>
<a name="3325"><span class="lineNum">    3325 </span>                :            :                 }</a>
<a name="3326"><span class="lineNum">    3326 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :                 std::vector&lt;unsigned char&gt; script_data(ParseHex(script_str));</span></a>
<a name="3327"><span class="lineNum">    3327 </span>                :<span class="lineCov">         12 :                 const CScript script(script_data.begin(), script_data.end());</span></a>
<a name="3328"><span class="lineNum">    3328 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :                 coinControl.m_external_provider.scripts.emplace(CScriptID(script), script);</span></a>
<a name="3329"><span class="lineNum">    3329 </span>                :            :             }</a>
<a name="3330"><span class="lineNum">    3330 </span>                :            :         }</a>
<a name="3331"><span class="lineNum">    3331 </span>                :            : </a>
<a name="3332"><span class="lineNum">    3332 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">         28 :         if (solving_data.exists(&quot;descriptors&quot;)) {</span></a>
<a name="3333"><span class="lineNum">    3333 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         14 :             for (const UniValue&amp; desc_univ : solving_data[&quot;descriptors&quot;].get_array().getValues()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 8 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 6 times"> + </span>]
<a name="3334"><span class="lineNum">    3334 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :                 const std::string&amp; desc_str  = desc_univ.get_str();</span></a>
<a name="3335"><span class="lineNum">    3335 </span>                :<span class="lineCov">         10 :                 FlatSigningProvider desc_out;</span></a>
<a name="3336"><span class="lineNum">    3336 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :                 std::string error;</span></a>
<a name="3337"><span class="lineNum">    3337 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :                 std::vector&lt;CScript&gt; scripts_temp;</span></a>
<a name="3338"><span class="lineNum">    3338 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         16 :                 std::unique_ptr&lt;Descriptor&gt; desc = Parse(desc_str, desc_out, error, true);</span></a>
<a name="3339"><span class="lineNum">    3339 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">          8 :                 if (!desc) {</span></a>
<a name="3340"><span class="lineNum">    3340 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                     throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Unable to parse descriptor '%s': %s&quot;, desc_str, error));</span></a>
<a name="3341"><span class="lineNum">    3341 </span>                :            :                 }</a>
<a name="3342"><span class="lineNum">    3342 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :                 desc-&gt;Expand(0, desc_out, scripts_temp, desc_out);</span></a>
<a name="3343"><span class="lineNum">    3343 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :                 coinControl.m_external_provider = Merge(coinControl.m_external_provider, desc_out);</span></a>
<a name="3344"><span class="lineNum">    3344 </span>                :            :             }</a>
<a name="3345"><span class="lineNum">    3345 </span>                :            :         }</a>
<a name="3346"><span class="lineNum">    3346 </span>                :            :     }</a>
<a name="3347"><span class="lineNum">    3347 </span>                :            : </a>
<a name="3348"><span class="lineNum">    3348 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 464 times"> + </span>]:<span class="lineCov">        464 :     if (tx.vout.size() == 0)</span></a>
<a name="3349"><span class="lineNum">    3349 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;TX must have at least one output&quot;);</span></a>
<a name="3350"><span class="lineNum">    3350 </span>                :            : </a>
<a name="3351"><span class="lineNum">    3351 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 452 times"> + </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        464 :     if (change_position != -1 &amp;&amp; (change_position &lt; 0 || (unsigned int)change_position &gt; tx.vout.size()))</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 10 times"> + </span>]
<a name="3352"><span class="lineNum">    3352 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;changePosition out of bounds&quot;);</span></a>
<a name="3353"><span class="lineNum">    3353 </span>                :            : </a>
<a name="3354"><span class="lineNum">    3354 </span>        [<span class="branchCov" title="Branch 0 was taken 71 times"> + </span><span class="branchCov" title="Branch 1 was taken 462 times"> + </span>]:<span class="lineCov">        533 :     for (unsigned int idx = 0; idx &lt; subtractFeeFromOutputs.size(); idx++) {</span></a>
<a name="3355"><span class="lineNum">    3355 </span>  [<span class="branchCov" title="Branch 0 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         71 :         int pos = subtractFeeFromOutputs[idx].get_int();</span></a>
<a name="3356"><span class="lineNum">    3356 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 71 times"> + </span>]:<span class="lineCov">         71 :         if (setSubtractFeeFromOutputs.count(pos))</span></a>
<a name="3357"><span class="lineNum">    3357 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Invalid parameter, duplicated position: %d&quot;, pos));</span></a>
<a name="3358"><span class="lineNum">    3358 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 71 times"> + </span>]:<span class="lineCov">         71 :         if (pos &lt; 0)</span></a>
<a name="3359"><span class="lineNum">    3359 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Invalid parameter, negative position: %d&quot;, pos));</span></a>
<a name="3360"><span class="lineNum">    3360 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 71 times"> + </span>]:<span class="lineCov">         71 :         if (pos &gt;= int(tx.vout.size()))</span></a>
<a name="3361"><span class="lineNum">    3361 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(&quot;Invalid parameter, position too large: %d&quot;, pos));</span></a>
<a name="3362"><span class="lineNum">    3362 </span>        [<span class="branchCov" title="Branch 0 was taken 71 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         71 :         setSubtractFeeFromOutputs.insert(pos);</span></a>
<a name="3363"><span class="lineNum">    3363 </span>                :            :     }</a>
<a name="3364"><span class="lineNum">    3364 </span>                :            : </a>
<a name="3365"><span class="lineNum">    3365 </span>                :            :     // Fetch specified UTXOs from the UTXO set to get the scriptPubKeys and values of the outputs being selected</a>
<a name="3366"><span class="lineNum">    3366 </span>                :            :     // and to match with the given solving_data. Only used for non-wallet outputs.</a>
<a name="3367"><span class="lineNum">    3367 </span>                :<span class="lineCov">        924 :     std::map&lt;COutPoint, Coin&gt; coins;</span></a>
<a name="3368"><span class="lineNum">    3368 </span>        [<span class="branchCov" title="Branch 0 was taken 247 times"> + </span><span class="branchCov" title="Branch 1 was taken 462 times"> + </span>]:<span class="lineCov">        709 :     for (const CTxIn&amp; txin : tx.vin) {</span></a>
<a name="3369"><span class="lineNum">    3369 </span>        [<span class="branchCov" title="Branch 0 was taken 247 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        247 :         coins[txin.prevout]; // Create empty map entry keyed by prevout.</span></a>
<a name="3370"><span class="lineNum">    3370 </span>                :            :     }</a>
<a name="3371"><span class="lineNum">    3371 </span>        [<span class="branchCov" title="Branch 0 was taken 462 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        462 :     wallet.chain().findCoins(coins);</span></a>
<a name="3372"><span class="lineNum">    3372 </span>        [<span class="branchCov" title="Branch 0 was taken 247 times"> + </span><span class="branchCov" title="Branch 1 was taken 462 times"> + </span>]:<span class="lineCov">        709 :     for (const auto&amp; coin : coins) {</span></a>
<a name="3373"><span class="lineNum">    3373 </span>        [<span class="branchCov" title="Branch 0 was taken 245 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">        247 :         if (!coin.second.out.IsNull()) {</span></a>
<a name="3374"><span class="lineNum">    3374 </span>        [<span class="branchCov" title="Branch 0 was taken 245 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        245 :             coinControl.SelectExternal(coin.first, coin.second.out);</span></a>
<a name="3375"><span class="lineNum">    3375 </span>                :            :         }</a>
<a name="3376"><span class="lineNum">    3376 </span>                :            :     }</a>
<a name="3377"><span class="lineNum">    3377 </span>                :            : </a>
<a name="3378"><span class="lineNum">    3378 </span>        [<span class="branchCov" title="Branch 0 was taken 462 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        924 :     bilingual_str error;</span></a>
<a name="3379"><span class="lineNum">    3379 </span>                :            : </a>
<a name="3380"><span class="lineNum">    3380 </span>  [<span class="branchCov" title="Branch 0 was taken 462 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 462 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        462 :     if (!FundTransaction(wallet, tx, fee_out, change_position, error, lockUnspents, setSubtractFeeFromOutputs, coinControl)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 93 times"> + </span><span class="branchCov" title="Branch 5 was taken 369 times"> + </span>]
<a name="3381"><span class="lineNum">    3381 </span>        [<span class="branchCov" title="Branch 0 was taken 93 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         93 :         throw JSONRPCError(RPC_WALLET_ERROR, error.original);</span></a>
<a name="3382"><span class="lineNum">    3382 </span>                :            :     }</a>
<a name="3383"><span class="lineNum">    3383 </span>                :<span class="lineCov">        369 : }</span></a>
<a name="3384"><span class="lineNum">    3384 </span>                :            : </a>
<a name="3385"><span class="lineNum">    3385 </span>                :<span class="lineCov">       1797 : static RPCHelpMan fundrawtransaction()</span></a>
<a name="3386"><span class="lineNum">    3386 </span>                :            : {</a>
<a name="3387"><span class="lineNum">    3387 </span>                :<span class="lineCov">       1797 :     return RPCHelpMan{&quot;fundrawtransaction&quot;,</span></a>
<a name="3388"><span class="lineNum">    3388 </span>                :            :                 &quot;\nIf the transaction has no inputs, they will be automatically selected to meet its out value.\n&quot;</a>
<a name="3389"><span class="lineNum">    3389 </span>                :            :                 &quot;It will add at most one change output to the outputs.\n&quot;</a>
<a name="3390"><span class="lineNum">    3390 </span>                :            :                 &quot;No existing outputs will be modified unless \&quot;subtractFeeFromOutputs\&quot; is specified.\n&quot;</a>
<a name="3391"><span class="lineNum">    3391 </span>                :            :                 &quot;Note that inputs which were signed may need to be resigned after completion since in/outputs have been added.\n&quot;</a>
<a name="3392"><span class="lineNum">    3392 </span>                :            :                 &quot;The inputs added will not be signed, use signrawtransactionwithkey\n&quot;</a>
<a name="3393"><span class="lineNum">    3393 </span>                :            :                 &quot;or signrawtransactionwithwallet for that.\n&quot;</a>
<a name="3394"><span class="lineNum">    3394 </span>                :            :                 &quot;All existing inputs must either have their previous output transaction be in the wallet\n&quot;</a>
<a name="3395"><span class="lineNum">    3395 </span>                :            :                 &quot;or be in the UTXO set. Solving data must be provided for non-wallet inputs.\n&quot;</a>
<a name="3396"><span class="lineNum">    3396 </span>                :            :                 &quot;Note that all inputs selected must be of standard form and P2SH scripts must be\n&quot;</a>
<a name="3397"><span class="lineNum">    3397 </span>                :            :                 &quot;in the wallet using importaddress or addmultisigaddress (to calculate fees).\n&quot;</a>
<a name="3398"><span class="lineNum">    3398 </span>                :            :                 &quot;You can see whether this is the case by checking the \&quot;solvable\&quot; field in the listunspent output.\n&quot;</a>
<a name="3399"><span class="lineNum">    3399 </span>                :            :                 &quot;Only pay-to-pubkey, multisig, and P2SH versions thereof are currently supported for watch-only\n&quot;,</a>
<a name="3400"><span class="lineNum">    3400 </span>                :            :                 {</a>
<a name="3401"><span class="lineNum">    3401 </span>                :<span class="lineCov">       1797 :                     {&quot;hexstring&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The hex string of the raw transaction&quot;},</span></a>
<a name="3402"><span class="lineNum">    3402 </span>                :<span class="lineCov">       1797 :                     {&quot;options&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;for backward compatibility: passing in a true instead of an object will result in {\&quot;includeWatching\&quot;:true}&quot;,</span></a>
<a name="3403"><span class="lineNum">    3403 </span>                :<span class="lineCov">       1797 :                         Cat&lt;std::vector&lt;RPCArg&gt;&gt;(</span></a>
<a name="3404"><span class="lineNum">    3404 </span>                :            :                         {</a>
<a name="3405"><span class="lineNum">    3405 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;add_inputs&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;For a transaction with existing inputs, automatically include more if they are not enough.&quot;},</span></a>
<a name="3406"><span class="lineNum">    3406 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;include_unsafe&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Include inputs that are not safe to spend (unconfirmed transactions from outside keys and unconfirmed replacement transactions).\n&quot;</span></a>
<a name="3407"><span class="lineNum">    3407 </span>                :            :                                                           &quot;Warning: the resulting transaction may become invalid if one of the unsafe inputs disappears.\n&quot;</a>
<a name="3408"><span class="lineNum">    3408 </span>                :            :                                                           &quot;If that happens, you will need to fund the transaction with different inputs and republish it.&quot;},</a>
<a name="3409"><span class="lineNum">    3409 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;changeAddress&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;pool address&quot;}, &quot;The bitcoin address to receive the change&quot;},</span></a>
<a name="3410"><span class="lineNum">    3410 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;changePosition&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;random&quot;}, &quot;The index of the change output&quot;},</span></a>
<a name="3411"><span class="lineNum">    3411 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;change_type&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;set by -changetype&quot;}, &quot;The output type to use. Only valid if changeAddress is not specified. Options are \&quot;legacy\&quot;, \&quot;p2sh-segwit\&quot;, and \&quot;bech32\&quot;.&quot;},</span></a>
<a name="3412"><span class="lineNum">    3412 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;includeWatching&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Also select inputs which are watch only.\n&quot;</span></a>
<a name="3413"><span class="lineNum">    3413 </span>                :            :                                                           &quot;Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\n&quot;</a>
<a name="3414"><span class="lineNum">    3414 </span>                :            :                                                           &quot;e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.&quot;},</a>
<a name="3415"><span class="lineNum">    3415 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;lockUnspents&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Lock selected unspent outputs&quot;},</span></a>
<a name="3416"><span class="lineNum">    3416 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7188 :                             {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3417"><span class="lineNum">    3417 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7188 :                             {&quot;feeRate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_UNIT + &quot;/kvB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3418"><span class="lineNum">    3418 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3594 :                             {&quot;subtractFeeFromOutputs&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;The integers.\n&quot;</span></a>
<a name="3419"><span class="lineNum">    3419 </span>                :            :                                                           &quot;The fee will be equally deducted from the amount of each specified output.\n&quot;</a>
<a name="3420"><span class="lineNum">    3420 </span>                :            :                                                           &quot;Those recipients will receive less bitcoins than you enter in their corresponding amount field.\n&quot;</a>
<a name="3421"><span class="lineNum">    3421 </span>                :            :                                                           &quot;If no outputs are specified here, the sender pays the fee.&quot;,</a>
<a name="3422"><span class="lineNum">    3422 </span>                :            :                                 {</a>
<a name="3423"><span class="lineNum">    3423 </span>                :<span class="lineCov">       1797 :                                     {&quot;vout_index&quot;, RPCArg::Type::NUM, RPCArg::Optional::OMITTED, &quot;The zero-based output index, before a change output is added.&quot;},</span></a>
<a name="3424"><span class="lineNum">    3424 </span>                :            :                                 },</a>
<a name="3425"><span class="lineNum">    3425 </span>                :            :                             },</a>
<a name="3426"><span class="lineNum">    3426 </span>                :            :                         },</a>
<a name="3427"><span class="lineNum">    3427 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      68286 :                         FundTxDoc()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 17970 times"> + </span><span class="branchCov" title="Branch 93 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 1797 times"> + </span><span class="branchCov" title="Branch 95 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 96 was not taken"> - </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 99 was not taken"> - </span>]
<a name="3428"><span class="lineNum">    3428 </span>                :            :                         &quot;options&quot;},</a>
<a name="3429"><span class="lineNum">    3429 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3594 :                     {&quot;iswitness&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;depends on heuristic tests&quot;}, &quot;Whether the transaction hex is a serialized witness transaction.\n&quot;</span></a>
<a name="3430"><span class="lineNum">    3430 </span>                :            :                         &quot;If iswitness is not present, heuristic tests will be used in decoding.\n&quot;</a>
<a name="3431"><span class="lineNum">    3431 </span>                :            :                         &quot;If true, only witness deserialization will be tried.\n&quot;</a>
<a name="3432"><span class="lineNum">    3432 </span>                :            :                         &quot;If false, only non-witness deserialization will be tried.\n&quot;</a>
<a name="3433"><span class="lineNum">    3433 </span>                :            :                         &quot;This boolean should reflect whether the transaction has inputs\n&quot;</a>
<a name="3434"><span class="lineNum">    3434 </span>                :            :                         &quot;(e.g. fully valid, or on-chain transactions), if known by the caller.&quot;</a>
<a name="3435"><span class="lineNum">    3435 </span>                :            :                     },</a>
<a name="3436"><span class="lineNum">    3436 </span>                :            :                 },</a>
<a name="3437"><span class="lineNum">    3437 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="3438"><span class="lineNum">    3438 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="3439"><span class="lineNum">    3439 </span>                :            :                     {</a>
<a name="3440"><span class="lineNum">    3440 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hex&quot;, &quot;The resulting raw transaction (hex-encoded string)&quot;},</a>
<a name="3441"><span class="lineNum">    3441 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3594 :                         {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, &quot;Fee in &quot; + CURRENCY_UNIT + &quot; the resulting transaction pays&quot;},</span></a>
<a name="3442"><span class="lineNum">    3442 </span>                :            :                         {RPCResult::Type::NUM, &quot;changepos&quot;, &quot;The position of the added change output, or -1&quot;},</a>
<a name="3443"><span class="lineNum">    3443 </span>                :            :                     }</a>
<a name="3444"><span class="lineNum">    3444 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      12579 :                                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 5391 times"> + </span><span class="branchCov" title="Branch 25 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="3445"><span class="lineNum">    3445 </span>                :<span class="lineCov">       1797 :                                 RPCExamples{</span></a>
<a name="3446"><span class="lineNum">    3446 </span>                :            :                             &quot;\nCreate a transaction with no inputs\n&quot;</a>
<a name="3447"><span class="lineNum">    3447 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3594 :                             + HelpExampleCli(&quot;createrawtransaction&quot;, &quot;\&quot;[]\&quot; \&quot;{\\\&quot;myaddress\\\&quot;:0.01}\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3448"><span class="lineNum">    3448 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1797 :                             &quot;\nAdd sufficient unsigned inputs to meet the output value\n&quot;</span></a>
<a name="3449"><span class="lineNum">    3449 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7188 :                             + HelpExampleCli(&quot;fundrawtransaction&quot;, &quot;\&quot;rawtransactionhex\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3450"><span class="lineNum">    3450 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1797 :                             &quot;\nSign the transaction\n&quot;</span></a>
<a name="3451"><span class="lineNum">    3451 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7188 :                             + HelpExampleCli(&quot;signrawtransactionwithwallet&quot;, &quot;\&quot;fundedtransactionhex\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3452"><span class="lineNum">    3452 </span>        [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1797 :                             &quot;\nSend the transaction\n&quot;</span></a>
<a name="3453"><span class="lineNum">    3453 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7188 :                             + HelpExampleCli(&quot;sendrawtransaction&quot;, &quot;\&quot;signedtransactionhex\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3454"><span class="lineNum">    3454 </span>                :<span class="lineCov">       1797 :                                 },</span></a>
<a name="3455"><span class="lineNum">    3455 </span>                :<span class="lineCov">        325 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="3456"><span class="lineNum">    3456 </span>                :            : {</a>
<a name="3457"><span class="lineNum">    3457 </span>                :<span class="lineCov">        498 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="3458"><span class="lineNum">    3458 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        325 :     if (!pwallet) return NullUniValue;</span></a>
<a name="3459"><span class="lineNum">    3459 </span>                :            : </a>
<a name="3460"><span class="lineNum">    3460 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        650 :     RPCTypeCheck(request.params, {UniValue::VSTR, UniValueType(), UniValue::VBOOL});</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3461"><span class="lineNum">    3461 </span>                :            : </a>
<a name="3462"><span class="lineNum">    3462 </span>                :            :     // parse hex string from parameter</a>
<a name="3463"><span class="lineNum">    3463 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        650 :     CMutableTransaction tx;</span></a>
<a name="3464"><span class="lineNum">    3464 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 325 times"> + </span> :<span class="lineCov">        325 :     bool try_witness = request.params[2].isNull() ? true : request.params[2].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3465"><span class="lineNum">    3465 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 325 times"> + </span> :<span class="lineCov">        325 :     bool try_no_witness = request.params[2].isNull() ? true : !request.params[2].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3466"><span class="lineNum">    3466 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        325 :     if (!DecodeHexTx(tx, request.params[0].get_str(), try_no_witness, try_witness)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 325 times"> + </span>]
<a name="3467"><span class="lineNum">    3467 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, &quot;TX decode failed&quot;);</span></a>
<a name="3468"><span class="lineNum">    3468 </span>                :            :     }</a>
<a name="3469"><span class="lineNum">    3469 </span>                :            : </a>
<a name="3470"><span class="lineNum">    3470 </span>                :<span class="lineCov">        325 :     CAmount fee;</span></a>
<a name="3471"><span class="lineNum">    3471 </span>                :<span class="lineCov">        325 :     int change_position;</span></a>
<a name="3472"><span class="lineNum">    3472 </span>        [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        650 :     CCoinControl coin_control;</span></a>
<a name="3473"><span class="lineNum">    3473 </span>                :            :     // Automatically select (additional) coins. Can be overridden by options.add_inputs.</a>
<a name="3474"><span class="lineNum">    3474 </span>                :<span class="lineCov">        325 :     coin_control.m_add_inputs = true;</span></a>
<a name="3475"><span class="lineNum">    3475 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 173 times"> + </span><span class="branchCov" title="Branch 3 was taken 152 times"> + </span>]:<span class="lineCov">        325 :     FundTransaction(*pwallet, tx, fee, change_position, request.params[1], coin_control, /* override_min_fee */ true);</span></a>
<a name="3476"><span class="lineNum">    3476 </span>                :            : </a>
<a name="3477"><span class="lineNum">    3477 </span>  [<span class="branchCov" title="Branch 0 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        346 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="3478"><span class="lineNum">    3478 </span>  [<span class="branchCov" title="Branch 0 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        346 :     result.pushKV(&quot;hex&quot;, EncodeHexTx(CTransaction(tx)));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3479"><span class="lineNum">    3479 </span>  [<span class="branchCov" title="Branch 0 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        346 :     result.pushKV(&quot;fee&quot;, ValueFromAmount(fee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3480"><span class="lineNum">    3480 </span>  [<span class="branchCov" title="Branch 0 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 173 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        346 :     result.pushKV(&quot;changepos&quot;, change_position);</span></a>
<a name="3481"><span class="lineNum">    3481 </span>                :            : </a>
<a name="3482"><span class="lineNum">    3482 </span>                :<span class="lineCov">        173 :     return result;</span></a>
<a name="3483"><span class="lineNum">    3483 </span>                :            : },</a>
<a name="3484"><span class="lineNum">    3484 </span>  [<span class="branchCov" title="Branch 0 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      26955 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1797 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1797 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 5391 times"> + </span><span class="branchCov" title="Branch 33 was taken 1797 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>]
<a name="3485"><span class="lineNum">    3485 </span>                :            : }</a>
<a name="3486"><span class="lineNum">    3486 </span>                :            : </a>
<a name="3487"><span class="lineNum">    3487 </span>                :<span class="lineCov">       2623 : RPCHelpMan signrawtransactionwithwallet()</span></a>
<a name="3488"><span class="lineNum">    3488 </span>                :            : {</a>
<a name="3489"><span class="lineNum">    3489 </span>                :<span class="lineCov">       2623 :     return RPCHelpMan{&quot;signrawtransactionwithwallet&quot;,</span></a>
<a name="3490"><span class="lineNum">    3490 </span>                :            :                 &quot;\nSign inputs for raw transaction (serialized, hex-encoded).\n&quot;</a>
<a name="3491"><span class="lineNum">    3491 </span>                :            :                 &quot;The second optional argument (may be null) is an array of previous transaction outputs that\n&quot;</a>
<a name="3492"><span class="lineNum">    3492 </span>                :<span class="lineCov">       2623 :                 &quot;this transaction depends on but may not yet be in the block chain.&quot; +</span></a>
<a name="3493"><span class="lineNum">    3493 </span>        [<span class="branchCov" title="Branch 0 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2623 :         HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="3494"><span class="lineNum">    3494 </span>                :            :                 {</a>
<a name="3495"><span class="lineNum">    3495 </span>                :<span class="lineCov">       2623 :                     {&quot;hexstring&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The transaction hex string&quot;},</span></a>
<a name="3496"><span class="lineNum">    3496 </span>                :<span class="lineCov">       2623 :                     {&quot;prevtxs&quot;, RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;The previous dependent transaction outputs&quot;,</span></a>
<a name="3497"><span class="lineNum">    3497 </span>                :            :                         {</a>
<a name="3498"><span class="lineNum">    3498 </span>                :<span class="lineCov">       2623 :                             {&quot;&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="3499"><span class="lineNum">    3499 </span>                :            :                                 {</a>
<a name="3500"><span class="lineNum">    3500 </span>                :<span class="lineCov">       2623 :                                     {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="3501"><span class="lineNum">    3501 </span>                :<span class="lineCov">       2623 :                                     {&quot;vout&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The output number&quot;},</span></a>
<a name="3502"><span class="lineNum">    3502 </span>                :<span class="lineCov">       2623 :                                     {&quot;scriptPubKey&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;script key&quot;},</span></a>
<a name="3503"><span class="lineNum">    3503 </span>                :<span class="lineCov">       2623 :                                     {&quot;redeemScript&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED, &quot;(required for P2SH) redeem script&quot;},</span></a>
<a name="3504"><span class="lineNum">    3504 </span>                :<span class="lineCov">       2623 :                                     {&quot;witnessScript&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED, &quot;(required for P2WSH or P2SH-P2WSH) witness script&quot;},</span></a>
<a name="3505"><span class="lineNum">    3505 </span>                :<span class="lineCov">       2623 :                                     {&quot;amount&quot;, RPCArg::Type::AMOUNT, RPCArg::Optional::OMITTED, &quot;(required for Segwit inputs) the amount spent&quot;},</span></a>
<a name="3506"><span class="lineNum">    3506 </span>                :            :                                 },</a>
<a name="3507"><span class="lineNum">    3507 </span>                :            :                             },</a>
<a name="3508"><span class="lineNum">    3508 </span>                :            :                         },</a>
<a name="3509"><span class="lineNum">    3509 </span>                :            :                     },</a>
<a name="3510"><span class="lineNum">    3510 </span>        [<span class="branchCov" title="Branch 0 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       5246 :                     {&quot;sighashtype&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;DEFAULT&quot;}, &quot;The signature hash type. Must be one of\n&quot;</span></a>
<a name="3511"><span class="lineNum">    3511 </span>                :            :             &quot;       \&quot;DEFAULT\&quot;\n&quot;</a>
<a name="3512"><span class="lineNum">    3512 </span>                :            :             &quot;       \&quot;ALL\&quot;\n&quot;</a>
<a name="3513"><span class="lineNum">    3513 </span>                :            :             &quot;       \&quot;NONE\&quot;\n&quot;</a>
<a name="3514"><span class="lineNum">    3514 </span>                :            :             &quot;       \&quot;SINGLE\&quot;\n&quot;</a>
<a name="3515"><span class="lineNum">    3515 </span>                :            :             &quot;       \&quot;ALL|ANYONECANPAY\&quot;\n&quot;</a>
<a name="3516"><span class="lineNum">    3516 </span>                :            :             &quot;       \&quot;NONE|ANYONECANPAY\&quot;\n&quot;</a>
<a name="3517"><span class="lineNum">    3517 </span>                :            :             &quot;       \&quot;SINGLE|ANYONECANPAY\&quot;&quot;},</a>
<a name="3518"><span class="lineNum">    3518 </span>                :            :                 },</a>
<a name="3519"><span class="lineNum">    3519 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="3520"><span class="lineNum">    3520 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="3521"><span class="lineNum">    3521 </span>                :            :                     {</a>
<a name="3522"><span class="lineNum">    3522 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hex&quot;, &quot;The hex-encoded raw transaction with signature(s)&quot;},</a>
<a name="3523"><span class="lineNum">    3523 </span>                :            :                         {RPCResult::Type::BOOL, &quot;complete&quot;, &quot;If the transaction has a complete set of signatures&quot;},</a>
<a name="3524"><span class="lineNum">    3524 </span>                :            :                         {RPCResult::Type::ARR, &quot;errors&quot;, /* optional */ true, &quot;Script verification errors (if there are any)&quot;,</a>
<a name="3525"><span class="lineNum">    3525 </span>                :            :                         {</a>
<a name="3526"><span class="lineNum">    3526 </span>                :            :                             {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="3527"><span class="lineNum">    3527 </span>                :            :                             {</a>
<a name="3528"><span class="lineNum">    3528 </span>                :            :                                 {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The hash of the referenced, previous transaction&quot;},</a>
<a name="3529"><span class="lineNum">    3529 </span>                :            :                                 {RPCResult::Type::NUM, &quot;vout&quot;, &quot;The index of the output to spent and used as input&quot;},</a>
<a name="3530"><span class="lineNum">    3530 </span>                :            :                                 {RPCResult::Type::ARR, &quot;witness&quot;, &quot;&quot;,</a>
<a name="3531"><span class="lineNum">    3531 </span>                :            :                                 {</a>
<a name="3532"><span class="lineNum">    3532 </span>                :            :                                     {RPCResult::Type::STR_HEX, &quot;witness&quot;, &quot;&quot;},</a>
<a name="3533"><span class="lineNum">    3533 </span>                :            :                                 }},</a>
<a name="3534"><span class="lineNum">    3534 </span>                :            :                                 {RPCResult::Type::STR_HEX, &quot;scriptSig&quot;, &quot;The hex-encoded signature script&quot;},</a>
<a name="3535"><span class="lineNum">    3535 </span>                :            :                                 {RPCResult::Type::NUM, &quot;sequence&quot;, &quot;Script sequence number&quot;},</a>
<a name="3536"><span class="lineNum">    3536 </span>                :            :                                 {RPCResult::Type::STR, &quot;error&quot;, &quot;Verification or signing error related to the input&quot;},</a>
<a name="3537"><span class="lineNum">    3537 </span>                :            :                             }},</a>
<a name="3538"><span class="lineNum">    3538 </span>                :            :                         }},</a>
<a name="3539"><span class="lineNum">    3539 </span>                :            :                     }</a>
<a name="3540"><span class="lineNum">    3540 </span>  [<span class="branchCov" title="Branch 0 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      34099 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 7869 times"> + </span><span class="branchCov" title="Branch 81 was taken 2623 times"> + </span><span class="branchCov" title="Branch 82 was taken 2623 times"> + </span><span class="branchCov" title="Branch 83 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 15738 times"> + </span><span class="branchCov" title="Branch 85 was taken 2623 times"> + </span><span class="branchCov" title="Branch 86 was taken 2623 times"> + </span><span class="branchCov" title="Branch 87 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 88 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchNoCov" title="Branch 90 was not taken"> - </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 94 was not taken"> - </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span>]
<a name="3541"><span class="lineNum">    3541 </span>                :<span class="lineCov">       2623 :                 RPCExamples{</span></a>
<a name="3542"><span class="lineNum">    3542 </span>  [<span class="branchCov" title="Branch 0 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5246 :                     HelpExampleCli(&quot;signrawtransactionwithwallet&quot;, &quot;\&quot;myhex\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3543"><span class="lineNum">    3543 </span>  [<span class="branchCov" title="Branch 0 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10492 :             + HelpExampleRpc(&quot;signrawtransactionwithwallet&quot;, &quot;\&quot;myhex\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3544"><span class="lineNum">    3544 </span>                :<span class="lineCov">       2623 :                 },</span></a>
<a name="3545"><span class="lineNum">    3545 </span>                :<span class="lineCov">       1151 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="3546"><span class="lineNum">    3546 </span>                :            : {</a>
<a name="3547"><span class="lineNum">    3547 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1151 times"> + </span>]:<span class="lineCov">       2278 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="3548"><span class="lineNum">    3548 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1151 :     if (!pwallet) return NullUniValue;</span></a>
<a name="3549"><span class="lineNum">    3549 </span>                :            : </a>
<a name="3550"><span class="lineNum">    3550 </span>  [<span class="branchCov" title="Branch 0 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2302 :     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VARR, UniValue::VSTR}, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3551"><span class="lineNum">    3551 </span>                :            : </a>
<a name="3552"><span class="lineNum">    3552 </span>  [<span class="branchCov" title="Branch 0 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1127 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2302 :     CMutableTransaction mtx;</span></a>
<a name="3553"><span class="lineNum">    3553 </span>  [<span class="branchCov" title="Branch 0 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1151 :     if (!DecodeHexTx(mtx, request.params[0].get_str())) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 1151 times"> + </span>]
<a name="3554"><span class="lineNum">    3554 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, &quot;TX decode failed. Make sure the tx has at least one input.&quot;);</span></a>
<a name="3555"><span class="lineNum">    3555 </span>                :            :     }</a>
<a name="3556"><span class="lineNum">    3556 </span>                :            : </a>
<a name="3557"><span class="lineNum">    3557 </span>                :            :     // Sign the transaction</a>
<a name="3558"><span class="lineNum">    3558 </span>        [<span class="branchCov" title="Branch 0 was taken 1151 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2302 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="3559"><span class="lineNum">    3559 </span>        [<span class="branchCov" title="Branch 0 was taken 1149 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">       1151 :     EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="3560"><span class="lineNum">    3560 </span>                :            : </a>
<a name="3561"><span class="lineNum">    3561 </span>                :            :     // Fetch previous transactions (inputs):</a>
<a name="3562"><span class="lineNum">    3562 </span>        [<span class="branchCov" title="Branch 0 was taken 1127 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2298 :     std::map&lt;COutPoint, Coin&gt; coins;</span></a>
<a name="3563"><span class="lineNum">    3563 </span>        [<span class="branchCov" title="Branch 0 was taken 8550 times"> + </span><span class="branchCov" title="Branch 1 was taken 1149 times"> + </span>]:<span class="lineCov">       9699 :     for (const CTxIn&amp; txin : mtx.vin) {</span></a>
<a name="3564"><span class="lineNum">    3564 </span>        [<span class="branchCov" title="Branch 0 was taken 8550 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       8550 :         coins[txin.prevout]; // Create empty map entry keyed by prevout.</span></a>
<a name="3565"><span class="lineNum">    3565 </span>                :            :     }</a>
<a name="3566"><span class="lineNum">    3566 </span>        [<span class="branchCov" title="Branch 0 was taken 1149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1149 :     pwallet-&gt;chain().findCoins(coins);</span></a>
<a name="3567"><span class="lineNum">    3567 </span>                :            : </a>
<a name="3568"><span class="lineNum">    3568 </span>                :            :     // Parse the prevtxs array</a>
<a name="3569"><span class="lineNum">    3569 </span>  [<span class="branchCov" title="Branch 0 was taken 1149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1131 times"> + </span><span class="branchCov" title="Branch 3 was taken 18 times"> + </span>]:<span class="lineCov">       1149 :     ParsePrevouts(request.params[1], nullptr, coins);</span></a>
<a name="3570"><span class="lineNum">    3570 </span>                :            : </a>
<a name="3571"><span class="lineNum">    3571 </span>  [<span class="branchCov" title="Branch 0 was taken 1131 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1131 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1131 :     int nHashType = ParseSighashString(request.params[2]);</span></a>
<a name="3572"><span class="lineNum">    3572 </span>                :            : </a>
<a name="3573"><span class="lineNum">    3573 </span>                :            :     // Script verification errors</a>
<a name="3574"><span class="lineNum">    3574 </span>        [<span class="branchCov" title="Branch 0 was taken 1131 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2262 :     std::map&lt;int, bilingual_str&gt; input_errors;</span></a>
<a name="3575"><span class="lineNum">    3575 </span>                :            : </a>
<a name="3576"><span class="lineNum">    3576 </span>        [<span class="branchCov" title="Branch 0 was taken 1131 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1131 :     bool complete = pwallet-&gt;SignTransaction(mtx, coins, nHashType, input_errors);</span></a>
<a name="3577"><span class="lineNum">    3577 </span>  [<span class="branchCov" title="Branch 0 was taken 1131 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1131 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2262 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="3578"><span class="lineNum">    3578 </span>        [<span class="branchCov" title="Branch 0 was taken 1127 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">       1131 :     SignTransactionResultToJSON(mtx, complete, coins, input_errors, result);</span></a>
<a name="3579"><span class="lineNum">    3579 </span>                :<span class="lineCov">       1127 :     return result;</span></a>
<a name="3580"><span class="lineNum">    3580 </span>                :            : },</a>
<a name="3581"><span class="lineNum">    3581 </span>  [<span class="branchCov" title="Branch 0 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      76067 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 7869 times"> + </span><span class="branchCov" title="Branch 91 was taken 2623 times"> + </span><span class="branchCov" title="Branch 92 was taken 2623 times"> + </span><span class="branchCov" title="Branch 93 was taken 2623 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 15738 times"> + </span><span class="branchCov" title="Branch 95 was taken 2623 times"> + </span><span class="branchNoCov" title="Branch 96 was not taken"> - </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchNoCov" title="Branch 100 was not taken"> - </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span>]
<a name="3582"><span class="lineNum">    3582 </span>                :            : }</a>
<a name="3583"><span class="lineNum">    3583 </span>                :            : </a>
<a name="3584"><span class="lineNum">    3584 </span>                :<span class="lineCov">       3183 : static RPCHelpMan bumpfee_helper(std::string method_name)</span></a>
<a name="3585"><span class="lineNum">    3585 </span>                :            : {</a>
<a name="3586"><span class="lineNum">    3586 </span>                :<span class="lineCov">       3183 :     const bool want_psbt = method_name == &quot;psbtbumpfee&quot;;</span></a>
<a name="3587"><span class="lineNum">    3587 </span>                :<span class="lineCov">       3183 :     const std::string incremental_fee{CFeeRate(DEFAULT_INCREMENTAL_RELAY_FEE).ToString(FeeEstimateMode::SAT_VB)};</span></a>
<a name="3588"><span class="lineNum">    3588 </span>                :            : </a>
<a name="3589"><span class="lineNum">    3589 </span>                :<span class="lineCov">       3183 :     return RPCHelpMan{method_name,</span></a>
<a name="3590"><span class="lineNum">    3590 </span>                :            :         &quot;\nBumps the fee of an opt-in-RBF transaction T, replacing it with a new transaction B.\n&quot;</a>
<a name="3591"><span class="lineNum">    3591 </span>  [<span class="branchCov" title="Branch 0 was taken 1705 times"> + </span><span class="branchCov" title="Branch 1 was taken 1478 times"> + </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8071 :         + std::string(want_psbt ? &quot;Returns a PSBT instead of creating and signing a new transaction.\n&quot; : &quot;&quot;) +</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3592"><span class="lineNum">    3592 </span>                :            :         &quot;An opt-in RBF transaction with the given txid must be in the wallet.\n&quot;</a>
<a name="3593"><span class="lineNum">    3593 </span>                :            :         &quot;The command will pay the additional fee by reducing change outputs or adding inputs when necessary.\n&quot;</a>
<a name="3594"><span class="lineNum">    3594 </span>                :            :         &quot;It may add a new change output if one does not already exist.\n&quot;</a>
<a name="3595"><span class="lineNum">    3595 </span>                :            :         &quot;All inputs in the original transaction will be included in the replacement transaction.\n&quot;</a>
<a name="3596"><span class="lineNum">    3596 </span>                :            :         &quot;The command will fail if the wallet or mempool contains a transaction that spends one of T's outputs.\n&quot;</a>
<a name="3597"><span class="lineNum">    3597 </span>                :            :         &quot;By default, the new fee will be calculated automatically using the estimatesmartfee RPC.\n&quot;</a>
<a name="3598"><span class="lineNum">    3598 </span>                :            :         &quot;The user can specify a confirmation target for estimatesmartfee.\n&quot;</a>
<a name="3599"><span class="lineNum">    3599 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6366 :         &quot;Alternatively, the user can specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB for the new transaction.\n&quot;</span></a>
<a name="3600"><span class="lineNum">    3600 </span>                :            :         &quot;At a minimum, the new fee rate must be high enough to pay an additional new relay fee (incrementalfee\n&quot;</a>
<a name="3601"><span class="lineNum">    3601 </span>                :            :         &quot;returned by getnetworkinfo) to enter the node's mempool.\n&quot;</a>
<a name="3602"><span class="lineNum">    3602 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6366 :         &quot;* WARNING: before version 0.21, fee_rate was in &quot; + CURRENCY_UNIT + &quot;/kvB. As of 0.21, fee_rate is in &quot; + CURRENCY_ATOM + &quot;/vB. *\n&quot;,</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3183 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="3603"><span class="lineNum">    3603 </span>                :            :         {</a>
<a name="3604"><span class="lineNum">    3604 </span>                :<span class="lineCov">       3183 :             {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The txid to be bumped&quot;},</span></a>
<a name="3605"><span class="lineNum">    3605 </span>                :<span class="lineCov">       3183 :             {&quot;options&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;&quot;,</span></a>
<a name="3606"><span class="lineNum">    3606 </span>                :            :                 {</a>
<a name="3607"><span class="lineNum">    3607 </span>        [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       6366 :                     {&quot;conf_target&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;wallet -txconfirmtarget&quot;}, &quot;Confirmation target in blocks\n&quot;},</span></a>
<a name="3608"><span class="lineNum">    3608 </span>        [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       6366 :                     {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;},</span></a>
<a name="3609"><span class="lineNum">    3609 </span>        [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       6366 :                              &quot;\nSpecify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB instead of relying on the built-in fee estimator.\n&quot;</span></a>
<a name="3610"><span class="lineNum">    3610 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       6366 :                              &quot;Must be at least &quot; + incremental_fee + &quot; higher than the current transaction fee rate.\n&quot;</span></a>
<a name="3611"><span class="lineNum">    3611 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6366 :                              &quot;WARNING: before version 0.21, fee_rate was in &quot; + CURRENCY_UNIT + &quot;/kvB. As of 0.21, fee_rate is in &quot; + CURRENCY_ATOM + &quot;/vB.\n&quot;},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3183 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="3612"><span class="lineNum">    3612 </span>        [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       6366 :                     {&quot;replaceable&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Whether the new transaction should still be\n&quot;</span></a>
<a name="3613"><span class="lineNum">    3613 </span>                :            :                              &quot;marked bip-125 replaceable. If true, the sequence numbers in the transaction will\n&quot;</a>
<a name="3614"><span class="lineNum">    3614 </span>                :            :                              &quot;be left unchanged from the original. If false, any input sequence numbers in the\n&quot;</a>
<a name="3615"><span class="lineNum">    3615 </span>                :            :                              &quot;original transaction that were less than 0xfffffffe will be increased to 0xfffffffe\n&quot;</a>
<a name="3616"><span class="lineNum">    3616 </span>                :            :                              &quot;so the new transaction will not be explicitly bip-125 replaceable (though it may\n&quot;</a>
<a name="3617"><span class="lineNum">    3617 </span>                :            :                              &quot;still be replaceable in practice, for example if it has unconfirmed ancestors which\n&quot;</a>
<a name="3618"><span class="lineNum">    3618 </span>                :            :                              &quot;are replaceable).\n&quot;},</a>
<a name="3619"><span class="lineNum">    3619 </span>        [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       6366 :                     {&quot;estimate_mode&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;unset&quot;}, &quot;The fee estimate mode, must be one of (case insensitive):\n&quot;</span></a>
<a name="3620"><span class="lineNum">    3620 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6366 :                              &quot;\&quot;&quot; + FeeModes(&quot;\&quot;\n\&quot;&quot;) + &quot;\&quot;&quot;},</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3621"><span class="lineNum">    3621 </span>                :            :                 },</a>
<a name="3622"><span class="lineNum">    3622 </span>                :            :                 &quot;options&quot;},</a>
<a name="3623"><span class="lineNum">    3623 </span>                :            :         },</a>
<a name="3624"><span class="lineNum">    3624 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="3625"><span class="lineNum">    3625 </span>                :<span class="lineCov">       3183 :             RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(</span></a>
<a name="3626"><span class="lineNum">    3626 </span>  [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchCov" title="Branch 1 was taken 1705 times"> + </span><span class="branchCov" title="Branch 2 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      19098 :                 want_psbt ?</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1705 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1705 times"> + </span><span class="branchCov" title="Branch 15 was taken 1478 times"> + </span><span class="branchCov" title="Branch 16 was taken 1705 times"> + </span><span class="branchCov" title="Branch 17 was taken 1705 times"> + </span><span class="branchCov" title="Branch 18 was taken 1478 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 19 was taken 1705 times"> + </span><span class="branchCov" title="Branch 20 was taken 1478 times"> + </span><span class="branchCov" title="Branch 21 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<a name="3627"><span class="lineNum">    3627 </span>  [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9095 :                 std::vector&lt;RPCResult&gt;{{RPCResult::Type::STR, &quot;psbt&quot;, &quot;The base64-encoded unsigned PSBT of the new transaction.&quot;}} :</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1478 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 9 was taken 1705 times"> + </span><span class="branchCov" title="Branch 10 was taken 1478 times"> + </span><span class="branchCov" title="Branch 11 was taken 1705 times"> + </span><span class="branchCov" title="Branch 12 was taken 1478 times"> + </span><span class="branchCov" title="Branch 13 was taken 1705 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 14 was not taken"> - </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3628"><span class="lineNum">    3628 </span>  [<span class="branchCov" title="Branch 0 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10003 :                 std::vector&lt;RPCResult&gt;{{RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The id of the new transaction.&quot;}},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1705 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 9 was taken 1478 times"> + </span><span class="branchCov" title="Branch 10 was taken 1705 times"> + </span><span class="branchCov" title="Branch 11 was taken 1478 times"> + </span><span class="branchCov" title="Branch 12 was taken 1705 times"> + </span><span class="branchCov" title="Branch 13 was taken 1478 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1478 times"> + </span><span class="branchCov" title="Branch 15 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<a name="3629"><span class="lineNum">    3629 </span>                :            :             {</a>
<a name="3630"><span class="lineNum">    3630 </span>                :            :                 {RPCResult::Type::STR_AMOUNT, &quot;origfee&quot;, &quot;The fee of the replaced transaction.&quot;},</a>
<a name="3631"><span class="lineNum">    3631 </span>                :            :                 {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, &quot;The fee of the new transaction.&quot;},</a>
<a name="3632"><span class="lineNum">    3632 </span>                :            :                 {RPCResult::Type::ARR, &quot;errors&quot;, &quot;Errors encountered during processing (may be empty).&quot;,</a>
<a name="3633"><span class="lineNum">    3633 </span>                :            :                 {</a>
<a name="3634"><span class="lineNum">    3634 </span>                :            :                     {RPCResult::Type::STR, &quot;&quot;, &quot;&quot;},</a>
<a name="3635"><span class="lineNum">    3635 </span>                :            :                 }},</a>
<a name="3636"><span class="lineNum">    3636 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      22281 :             })</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 9549 times"> + </span><span class="branchCov" title="Branch 31 was taken 3183 times"> + </span><span class="branchCov" title="Branch 32 was taken 3183 times"> + </span><span class="branchCov" title="Branch 33 was taken 3183 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchNoCov" title="Branch 36 was not taken"> - </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span>]
<a name="3637"><span class="lineNum">    3637 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9549 :         },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3638"><span class="lineNum">    3638 </span>                :<span class="lineCov">       3183 :         RPCExamples{</span></a>
<a name="3639"><span class="lineNum">    3639 </span>  [<span class="branchCov" title="Branch 0 was taken 1705 times"> + </span><span class="branchCov" title="Branch 1 was taken 1478 times"> + </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8071 :     &quot;\nBump the fee, get the new transaction\'s &quot; + std::string(want_psbt ? &quot;psbt&quot; : &quot;txid&quot;) + &quot;\n&quot; +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3640"><span class="lineNum">    3640 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9549 :             HelpExampleCli(method_name, &quot;&lt;txid&gt;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3641"><span class="lineNum">    3641 </span>                :<span class="lineCov">       3183 :         },</span></a>
<a name="3642"><span class="lineNum">    3642 </span>                :<span class="lineCov">        390 :         [want_psbt](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="3643"><span class="lineNum">    3643 </span>                :            : {</a>
<a name="3644"><span class="lineNum">    3644 </span>                :<span class="lineCov">        386 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="3645"><span class="lineNum">    3645 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 239 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        239 :     if (!pwallet) return NullUniValue;</span></a>
<a name="3646"><span class="lineNum">    3646 </span>                :            : </a>
<a name="3647"><span class="lineNum">    3647 </span>  [<span class="branchCov" title="Branch 0 was taken 239 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 235 times"> + </span> :<span class="lineCov">        239 :     if (pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS) &amp;&amp; !want_psbt) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 2 times"> + </span>]
<a name="3648"><span class="lineNum">    3648 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;bumpfee is not available with wallets that have private keys disabled. Use psbtbumpfee instead.&quot;);</span></a>
<a name="3649"><span class="lineNum">    3649 </span>                :            :     }</a>
<a name="3650"><span class="lineNum">    3650 </span>                :            : </a>
<a name="3651"><span class="lineNum">    3651 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        474 :     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VOBJ});</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3652"><span class="lineNum">    3652 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        474 :     uint256 hash(ParseHashV(request.params[0], &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3653"><span class="lineNum">    3653 </span>                :            : </a>
<a name="3654"><span class="lineNum">    3654 </span>        [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        327 :     CCoinControl coin_control;</span></a>
<a name="3655"><span class="lineNum">    3655 </span>        [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        237 :     coin_control.fAllowWatchOnly = pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS);</span></a>
<a name="3656"><span class="lineNum">    3656 </span>                :            :     // optional parameters</a>
<a name="3657"><span class="lineNum">    3657 </span>                :<span class="lineCov">        237 :     coin_control.m_signal_bip125_rbf = true;</span></a>
<a name="3658"><span class="lineNum">    3658 </span>                :            : </a>
<a name="3659"><span class="lineNum">    3659 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 92 times"> + </span><span class="branchCov" title="Branch 3 was taken 145 times"> + </span>]:<span class="lineCov">        237 :     if (!request.params[1].isNull()) {</span></a>
<a name="3660"><span class="lineNum">    3660 </span>  [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        184 :         UniValue options = request.params[1];</span></a>
<a name="3661"><span class="lineNum">    3661 </span>  [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 84 times"> + </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span>]:<span class="lineCov">        184 :         RPCTypeCheckObj(options,</span></a>
<a name="3662"><span class="lineNum">    3662 </span>                :            :             {</a>
<a name="3663"><span class="lineNum">    3663 </span>        [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         92 :                 {&quot;confTarget&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3664"><span class="lineNum">    3664 </span>        [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         92 :                 {&quot;conf_target&quot;, UniValueType(UniValue::VNUM)},</span></a>
<a name="3665"><span class="lineNum">    3665 </span>        [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         92 :                 {&quot;fee_rate&quot;, UniValueType()}, // will be checked by AmountFromValue() in SetFeeEstimateMode()</span></a>
<a name="3666"><span class="lineNum">    3666 </span>        [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         92 :                 {&quot;replaceable&quot;, UniValueType(UniValue::VBOOL)},</span></a>
<a name="3667"><span class="lineNum">    3667 </span>        [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         92 :                 {&quot;estimate_mode&quot;, UniValueType(UniValue::VSTR)},</span></a>
<a name="3668"><span class="lineNum">    3668 </span>                :            :             },</a>
<a name="3669"><span class="lineNum">    3669 </span>  [<span class="branchCov" title="Branch 0 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1112 :             true, true);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 92 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 92 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 420 times"> + </span><span class="branchCov" title="Branch 11 was taken 84 times"> + </span><span class="branchCov" title="Branch 12 was taken 40 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 13 was taken 8 times"> + </span>]
<a name="3670"><span class="lineNum">    3670 </span>                :            : </a>
<a name="3671"><span class="lineNum">    3671 </span>  [<span class="branchCov" title="Branch 0 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 84 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         86 :         if (options.exists(&quot;confTarget&quot;) &amp;&amp; options.exists(&quot;conf_target&quot;)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 82 times"> + </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchNoCov" title="Branch 10 was not taken"> - </span><span class="branchCov" title="Branch 11 was taken 2 times"> + </span><span class="branchCov" title="Branch 12 was taken 2 times"> + </span><span class="branchCov" title="Branch 13 was taken 82 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2 times"> + </span><span class="branchCov" title="Branch 15 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="3672"><span class="lineNum">    3672 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;confTarget and conf_target options should not both be set. Use conf_target (confTarget is deprecated).&quot;);</span></a>
<a name="3673"><span class="lineNum">    3673 </span>                :            :         }</a>
<a name="3674"><span class="lineNum">    3674 </span>                :            : </a>
<a name="3675"><span class="lineNum">    3675 </span>  [<span class="branchCov" title="Branch 0 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 82 times"> + </span> :<span class="lineCov">        328 :         auto conf_target = options.exists(&quot;confTarget&quot;) ? options[&quot;confTarget&quot;] : options[&quot;conf_target&quot;];</span></a>
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 82 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchCov" title="Branch 17 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<a name="3676"><span class="lineNum">    3676 </span>                :            : </a>
<a name="3677"><span class="lineNum">    3677 </span>  [<span class="branchCov" title="Branch 0 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 80 times"> + </span>]:<span class="lineCov">        164 :         if (options.exists(&quot;replaceable&quot;)) {</span></a>
<a name="3678"><span class="lineNum">    3678 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         84 :             coin_control.m_signal_bip125_rbf = options[&quot;replaceable&quot;].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3679"><span class="lineNum">    3679 </span>                :            :         }</a>
<a name="3680"><span class="lineNum">    3680 </span>  [<span class="branchCov" title="Branch 0 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        210 :         SetFeeEstimateMode(*pwallet, coin_control, conf_target, options[&quot;estimate_mode&quot;], options[&quot;fee_rate&quot;], /* override_min_fee */ false);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 82 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 36 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 46 times"> + </span>]
<a name="3681"><span class="lineNum">    3681 </span>                :            :     }</a>
<a name="3682"><span class="lineNum">    3682 </span>                :            : </a>
<a name="3683"><span class="lineNum">    3683 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="3684"><span class="lineNum">    3684 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="3685"><span class="lineNum">    3685 </span>        [<span class="branchCov" title="Branch 0 was taken 181 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        181 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="3686"><span class="lineNum">    3686 </span>                :            : </a>
<a name="3687"><span class="lineNum">    3687 </span>        [<span class="branchCov" title="Branch 0 was taken 181 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        362 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="3688"><span class="lineNum">    3688 </span>                :            : </a>
<a name="3689"><span class="lineNum">    3689 </span>        [<span class="branchCov" title="Branch 0 was taken 179 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">        181 :     EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="3690"><span class="lineNum">    3690 </span>                :            : </a>
<a name="3691"><span class="lineNum">    3691 </span>                :            : </a>
<a name="3692"><span class="lineNum">    3692 </span>  [<span class="branchCov" title="Branch 0 was taken 179 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        358 :     std::vector&lt;bilingual_str&gt; errors;</span></a>
<a name="3693"><span class="lineNum">    3693 </span>                :<span class="lineCov">        179 :     CAmount old_fee;</span></a>
<a name="3694"><span class="lineNum">    3694 </span>                :<span class="lineCov">        179 :     CAmount new_fee;</span></a>
<a name="3695"><span class="lineNum">    3695 </span>        [<span class="branchCov" title="Branch 0 was taken 179 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        358 :     CMutableTransaction mtx;</span></a>
<a name="3696"><span class="lineNum">    3696 </span>                :<span class="lineCov">        179 :     feebumper::Result res;</span></a>
<a name="3697"><span class="lineNum">    3697 </span>                :            :     // Targeting feerate bump.</a>
<a name="3698"><span class="lineNum">    3698 </span>        [<span class="branchCov" title="Branch 0 was taken 179 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        179 :     res = feebumper::CreateRateBumpTransaction(*pwallet, hash, coin_control, errors, old_fee, new_fee, mtx);</span></a>
<a name="3699"><span class="lineNum">    3699 </span>        [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchCov" title="Branch 1 was taken 147 times"> + </span>]:<span class="lineCov">        179 :     if (res != feebumper::Result::OK) {</span></a>
<a name="3700"><span class="lineNum">    3700 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchCov" title="Branch 3 was taken 14 times"> + </span> :<span class="lineCov">         32 :         switch(res) {</span></a>
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 4 was not taken"> - </span>]
<a name="3701"><span class="lineNum">    3701 </span>                :<span class="lineNoCov">          0 :             case feebumper::Result::INVALID_ADDRESS_OR_KEY:</span></a>
<a name="3702"><span class="lineNum">    3702 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errors[0].original);</span></a>
<a name="3703"><span class="lineNum">    3703 </span>                :<span class="lineNoCov">          0 :                 break;</span></a>
<a name="3704"><span class="lineNum">    3704 </span>                :<span class="lineNoCov">          0 :             case feebumper::Result::INVALID_REQUEST:</span></a>
<a name="3705"><span class="lineNum">    3705 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_REQUEST, errors[0].original);</span></a>
<a name="3706"><span class="lineNum">    3706 </span>                :<span class="lineCov">         18 :                 break;</span></a>
<a name="3707"><span class="lineNum">    3707 </span>                :<span class="lineCov">         18 :             case feebumper::Result::INVALID_PARAMETER:</span></a>
<a name="3708"><span class="lineNum">    3708 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         18 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, errors[0].original);</span></a>
<a name="3709"><span class="lineNum">    3709 </span>                :<span class="lineCov">         14 :                 break;</span></a>
<a name="3710"><span class="lineNum">    3710 </span>                :<span class="lineCov">         14 :             case feebumper::Result::WALLET_ERROR:</span></a>
<a name="3711"><span class="lineNum">    3711 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :                 throw JSONRPCError(RPC_WALLET_ERROR, errors[0].original);</span></a>
<a name="3712"><span class="lineNum">    3712 </span>                :<span class="lineNoCov">          0 :                 break;</span></a>
<a name="3713"><span class="lineNum">    3713 </span>                :<span class="lineNoCov">          0 :             default:</span></a>
<a name="3714"><span class="lineNum">    3714 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_MISC_ERROR, errors[0].original);</span></a>
<a name="3715"><span class="lineNum">    3715 </span>                :<span class="lineCov">        147 :                 break;</span></a>
<a name="3716"><span class="lineNum">    3716 </span>                :            :         }</a>
<a name="3717"><span class="lineNum">    3717 </span>                :            :     }</a>
<a name="3718"><span class="lineNum">    3718 </span>                :            : </a>
<a name="3719"><span class="lineNum">    3719 </span>  [<span class="branchCov" title="Branch 0 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        294 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="3720"><span class="lineNum">    3720 </span>                :            : </a>
<a name="3721"><span class="lineNum">    3721 </span>                :            :     // For bumpfee, return the new transaction id.</a>
<a name="3722"><span class="lineNum">    3722 </span>                :            :     // For psbtbumpfee, return the base64-encoded unsigned PSBT of the new transaction.</a>
<a name="3723"><span class="lineNum">    3723 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">        147 :     if (!want_psbt) {</span></a>
<a name="3724"><span class="lineNum">    3724 </span>  [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 141 times"> + </span>]:<span class="lineCov">        141 :         if (!feebumper::SignTransaction(*pwallet, mtx)) {</span></a>
<a name="3725"><span class="lineNum">    3725 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;Can't sign transaction.&quot;);</span></a>
<a name="3726"><span class="lineNum">    3726 </span>                :            :         }</a>
<a name="3727"><span class="lineNum">    3727 </span>                :            : </a>
<a name="3728"><span class="lineNum">    3728 </span>                :<span class="lineCov">        141 :         uint256 txid;</span></a>
<a name="3729"><span class="lineNum">    3729 </span>  [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 141 times"> + </span>]:<span class="lineCov">        141 :         if (feebumper::CommitTransaction(*pwallet, hash, std::move(mtx), errors, txid) != feebumper::Result::OK) {</span></a>
<a name="3730"><span class="lineNum">    3730 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_WALLET_ERROR, errors[0].original);</span></a>
<a name="3731"><span class="lineNum">    3731 </span>                :            :         }</a>
<a name="3732"><span class="lineNum">    3732 </span>                :            : </a>
<a name="3733"><span class="lineNum">    3733 </span>  [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        282 :         result.pushKV(&quot;txid&quot;, txid.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3734"><span class="lineNum">    3734 </span>                :            :     } else {</a>
<a name="3735"><span class="lineNum">    3735 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :         PartiallySignedTransaction psbtx(mtx);</span></a>
<a name="3736"><span class="lineNum">    3736 </span>                :<span class="lineCov">          6 :         bool complete = false;</span></a>
<a name="3737"><span class="lineNum">    3737 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :         const TransactionError err = pwallet-&gt;FillPSBT(psbtx, complete, SIGHASH_DEFAULT, false /* sign */, true /* bip32derivs */);</span></a>
<a name="3738"><span class="lineNum">    3738 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         CHECK_NONFATAL(err == TransactionError::OK);</span></a>
<a name="3739"><span class="lineNum">    3739 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         CHECK_NONFATAL(!complete);</span></a>
<a name="3740"><span class="lineNum">    3740 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :         CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);</span></a>
<a name="3741"><span class="lineNum">    3741 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :         ssTx &lt;&lt; psbtx;</span></a>
<a name="3742"><span class="lineNum">    3742 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         12 :         result.pushKV(&quot;psbt&quot;, EncodeBase64(ssTx.str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3743"><span class="lineNum">    3743 </span>                :            :     }</a>
<a name="3744"><span class="lineNum">    3744 </span>                :            : </a>
<a name="3745"><span class="lineNum">    3745 </span>  [<span class="branchCov" title="Branch 0 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        294 :     result.pushKV(&quot;origfee&quot;, ValueFromAmount(old_fee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3746"><span class="lineNum">    3746 </span>  [<span class="branchCov" title="Branch 0 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        294 :     result.pushKV(&quot;fee&quot;, ValueFromAmount(new_fee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3747"><span class="lineNum">    3747 </span>  [<span class="branchCov" title="Branch 0 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        294 :     UniValue result_errors(UniValue::VARR);</span></a>
<a name="3748"><span class="lineNum">    3748 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 147 times"> + </span>]:<span class="lineCov">        147 :     for (const bilingual_str&amp; error : errors) {</span></a>
<a name="3749"><span class="lineNum">    3749 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :         result_errors.push_back(error.original);</span></a>
<a name="3750"><span class="lineNum">    3750 </span>                :            :     }</a>
<a name="3751"><span class="lineNum">    3751 </span>  [<span class="branchCov" title="Branch 0 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 147 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        294 :     result.pushKV(&quot;errors&quot;, result_errors);</span></a>
<a name="3752"><span class="lineNum">    3752 </span>                :            : </a>
<a name="3753"><span class="lineNum">    3753 </span>                :<span class="lineCov">        147 :     return result;</span></a>
<a name="3754"><span class="lineNum">    3754 </span>                :            : },</a>
<a name="3755"><span class="lineNum">    3755 </span>  [<span class="branchCov" title="Branch 0 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      89124 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 3183 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 6366 times"> + </span><span class="branchCov" title="Branch 57 was taken 3183 times"> + </span><span class="branchCov" title="Branch 58 was taken 12732 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 59 was taken 3183 times"> + </span><span class="branchNoCov" title="Branch 60 was not taken"> - </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchNoCov" title="Branch 62 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 63 was not taken"> - </span>]
<a name="3756"><span class="lineNum">    3756 </span>                :            : }</a>
<a name="3757"><span class="lineNum">    3757 </span>                :            : </a>
<a name="3758"><span class="lineNum">    3758 </span>        [<span class="branchCov" title="Branch 0 was taken 1705 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3410 : static RPCHelpMan bumpfee() { return bumpfee_helper(&quot;bumpfee&quot;); }</span></a>
<a name="3759"><span class="lineNum">    3759 </span>        [<span class="branchCov" title="Branch 0 was taken 1478 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2956 : static RPCHelpMan psbtbumpfee() { return bumpfee_helper(&quot;psbtbumpfee&quot;); }</span></a>
<a name="3760"><span class="lineNum">    3760 </span>                :            : </a>
<a name="3761"><span class="lineNum">    3761 </span>                :<span class="lineCov">       1484 : static RPCHelpMan rescanblockchain()</span></a>
<a name="3762"><span class="lineNum">    3762 </span>                :            : {</a>
<a name="3763"><span class="lineNum">    3763 </span>                :<span class="lineCov">       1484 :     return RPCHelpMan{&quot;rescanblockchain&quot;,</span></a>
<a name="3764"><span class="lineNum">    3764 </span>                :            :                 &quot;\nRescan the local blockchain for wallet related transactions.\n&quot;</a>
<a name="3765"><span class="lineNum">    3765 </span>                :            :                 &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="3766"><span class="lineNum">    3766 </span>                :            :                 {</a>
<a name="3767"><span class="lineNum">    3767 </span>        [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2968 :                     {&quot;start_height&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;block height where the rescan should start&quot;},</span></a>
<a name="3768"><span class="lineNum">    3768 </span>                :<span class="lineCov">       1484 :                     {&quot;stop_height&quot;, RPCArg::Type::NUM, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;the last block height that should be scanned. If none is provided it will rescan up to the tip at return time of this call.&quot;},</span></a>
<a name="3769"><span class="lineNum">    3769 </span>                :            :                 },</a>
<a name="3770"><span class="lineNum">    3770 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="3771"><span class="lineNum">    3771 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="3772"><span class="lineNum">    3772 </span>                :            :                     {</a>
<a name="3773"><span class="lineNum">    3773 </span>                :            :                         {RPCResult::Type::NUM, &quot;start_height&quot;, &quot;The block height where the rescan started (the requested height or 0)&quot;},</a>
<a name="3774"><span class="lineNum">    3774 </span>                :            :                         {RPCResult::Type::NUM, &quot;stop_height&quot;, &quot;The height of the last rescanned block. May be null in rare cases if there was a reorg and the call didn't scan any blocks because they were already scanned in the background.&quot;},</a>
<a name="3775"><span class="lineNum">    3775 </span>                :            :                     }</a>
<a name="3776"><span class="lineNum">    3776 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5936 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1484 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2968 times"> + </span><span class="branchCov" title="Branch 21 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="3777"><span class="lineNum">    3777 </span>                :<span class="lineCov">       1484 :                 RPCExamples{</span></a>
<a name="3778"><span class="lineNum">    3778 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2968 :                     HelpExampleCli(&quot;rescanblockchain&quot;, &quot;100000 120000&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3779"><span class="lineNum">    3779 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5936 :             + HelpExampleRpc(&quot;rescanblockchain&quot;, &quot;100000, 120000&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3780"><span class="lineNum">    3780 </span>                :<span class="lineCov">       1484 :                 },</span></a>
<a name="3781"><span class="lineNum">    3781 </span>                :<span class="lineCov">         12 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="3782"><span class="lineNum">    3782 </span>                :            : {</a>
<a name="3783"><span class="lineNum">    3783 </span>                :<span class="lineCov">         24 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="3784"><span class="lineNum">    3784 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :     if (!pwallet) return NullUniValue;</span></a>
<a name="3785"><span class="lineNum">    3785 </span>                :            : </a>
<a name="3786"><span class="lineNum">    3786 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         24 :     WalletRescanReserver reserver(*pwallet);</span></a>
<a name="3787"><span class="lineNum">    3787 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 12 times"> + </span>]:<span class="lineCov">         12 :     if (!reserver.reserve()) {</span></a>
<a name="3788"><span class="lineNum">    3788 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<a name="3789"><span class="lineNum">    3789 </span>                :            :     }</a>
<a name="3790"><span class="lineNum">    3790 </span>                :            : </a>
<a name="3791"><span class="lineNum">    3791 </span>                :<span class="lineCov">         12 :     int start_height = 0;</span></a>
<a name="3792"><span class="lineNum">    3792 </span>                :<span class="lineCov">         12 :     std::optional&lt;int&gt; stop_height;</span></a>
<a name="3793"><span class="lineNum">    3793 </span>                :<span class="lineCov">         12 :     uint256 start_block;</span></a>
<a name="3794"><span class="lineNum">    3794 </span>                :<span class="lineCov">         12 :     {</span></a>
<a name="3795"><span class="lineNum">    3795 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="3796"><span class="lineNum">    3796 </span>                :<span class="lineCov">         12 :         int tip_height = pwallet-&gt;GetLastBlockHeight();</span></a>
<a name="3797"><span class="lineNum">    3797 </span>                :            : </a>
<a name="3798"><span class="lineNum">    3798 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchCov" title="Branch 3 was taken 9 times"> + </span>]:<span class="lineCov">         12 :         if (!request.params[0].isNull()) {</span></a>
<a name="3799"><span class="lineNum">    3799 </span>  [<span class="branchCov" title="Branch 0 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          3 :             start_height = request.params[0].get_int();</span></a>
<a name="3800"><span class="lineNum">    3800 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 3 times"> + </span>]:<span class="lineCov">          3 :             if (start_height &lt; 0 || start_height &gt; tip_height) {</span></a>
<a name="3801"><span class="lineNum">    3801 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid start_height&quot;);</span></a>
<a name="3802"><span class="lineNum">    3802 </span>                :            :             }</a>
<a name="3803"><span class="lineNum">    3803 </span>                :            :         }</a>
<a name="3804"><span class="lineNum">    3804 </span>                :            : </a>
<a name="3805"><span class="lineNum">    3805 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 10 times"> + </span>]:<span class="lineCov">         12 :         if (!request.params[1].isNull()) {</span></a>
<a name="3806"><span class="lineNum">    3806 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :             stop_height = request.params[1].get_int();</span></a>
<a name="3807"><span class="lineNum">    3807 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          2 :             if (*stop_height &lt; 0 || *stop_height &gt; tip_height) {</span></a>
<a name="3808"><span class="lineNum">    3808 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid stop_height&quot;);</span></a>
<a name="3809"><span class="lineNum">    3809 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">          2 :             } else if (*stop_height &lt; start_height) {</span></a>
<a name="3810"><span class="lineNum">    3810 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;stop_height must be greater than start_height&quot;);</span></a>
<a name="3811"><span class="lineNum">    3811 </span>                :            :             }</a>
<a name="3812"><span class="lineNum">    3812 </span>                :            :         }</a>
<a name="3813"><span class="lineNum">    3813 </span>                :            : </a>
<a name="3814"><span class="lineNum">    3814 </span>                :            :         // We can't rescan beyond non-pruned blocks, stop and throw an error</a>
<a name="3815"><span class="lineNum">    3815 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 12 times"> + </span>]:<span class="lineCov">         12 :         if (!pwallet-&gt;chain().hasBlocks(pwallet-&gt;GetLastBlockHash(), start_height, stop_height)) {</span></a>
<a name="3816"><span class="lineNum">    3816 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_MISC_ERROR, &quot;Can't rescan beyond pruned data. Use RPC call getblockchaininfo to determine your pruned height.&quot;);</span></a>
<a name="3817"><span class="lineNum">    3817 </span>                :            :         }</a>
<a name="3818"><span class="lineNum">    3818 </span>                :            : </a>
<a name="3819"><span class="lineNum">    3819 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 12 times"> + </span> :<span class="lineCov">         12 :         CHECK_NONFATAL(pwallet-&gt;chain().findAncestorByHeight(pwallet-&gt;GetLastBlockHash(), start_height, FoundBlock().hash(start_block)));</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3820"><span class="lineNum">    3820 </span>                :            :     }</a>
<a name="3821"><span class="lineNum">    3821 </span>                :            : </a>
<a name="3822"><span class="lineNum">    3822 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :     CWallet::ScanResult result =</span></a>
<a name="3823"><span class="lineNum">    3823 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         12 :         pwallet-&gt;ScanForWalletTransactions(start_block, start_height, stop_height, reserver, true /* fUpdate */);</span></a>
<a name="3824"><span class="lineNum">    3824 </span>     [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span>]:<span class="lineCov">         12 :     switch (result.status) {</span></a>
<a name="3825"><span class="lineNum">    3825 </span>                :            :     case CWallet::ScanResult::SUCCESS:</a>
<a name="3826"><span class="lineNum">    3826 </span>                :            :         break;</a>
<a name="3827"><span class="lineNum">    3827 </span>                :<span class="lineNoCov">          0 :     case CWallet::ScanResult::FAILURE:</span></a>
<a name="3828"><span class="lineNum">    3828 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_MISC_ERROR, &quot;Rescan failed. Potentially corrupted data files.&quot;);</span></a>
<a name="3829"><span class="lineNum">    3829 </span>                :<span class="lineNoCov">          0 :     case CWallet::ScanResult::USER_ABORT:</span></a>
<a name="3830"><span class="lineNum">    3830 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_MISC_ERROR, &quot;Rescan aborted.&quot;);</span></a>
<a name="3831"><span class="lineNum">    3831 </span>                :            :         // no default case, so the compiler can warn about missing cases</a>
<a name="3832"><span class="lineNum">    3832 </span>                :            :     }</a>
<a name="3833"><span class="lineNum">    3833 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         24 :     UniValue response(UniValue::VOBJ);</span></a>
<a name="3834"><span class="lineNum">    3834 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         24 :     response.pushKV(&quot;start_height&quot;, start_height);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3835"><span class="lineNum">    3835 </span>  [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         24 :     response.pushKV(&quot;stop_height&quot;, result.last_scanned_height ? *result.last_scanned_height : UniValue());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 12 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3836"><span class="lineNum">    3836 </span>                :<span class="lineCov">         12 :     return response;</span></a>
<a name="3837"><span class="lineNum">    3837 </span>                :            : },</a>
<a name="3838"><span class="lineNum">    3838 </span>  [<span class="branchCov" title="Branch 0 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      16324 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1484 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 2968 times"> + </span><span class="branchCov" title="Branch 25 was taken 1484 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="3839"><span class="lineNum">    3839 </span>                :            : }</a>
<a name="3840"><span class="lineNum">    3840 </span>                :            : </a>
<a name="3841"><span class="lineNum">    3841 </span>                :            : class DescribeWalletAddressVisitor</a>
<a name="3842"><span class="lineNum">    3842 </span>                :            : {</a>
<a name="3843"><span class="lineNum">    3843 </span>                :            : public:</a>
<a name="3844"><span class="lineNum">    3844 </span>                :            :     const SigningProvider * const provider;</a>
<a name="3845"><span class="lineNum">    3845 </span>                :            : </a>
<a name="3846"><span class="lineNum">    3846 </span>                :<span class="lineCov">        392 :     void ProcessSubScript(const CScript&amp; subscript, UniValue&amp; obj) const</span></a>
<a name="3847"><span class="lineNum">    3847 </span>                :            :     {</a>
<a name="3848"><span class="lineNum">    3848 </span>                :            :         // Always present: script type and redeemscript</a>
<a name="3849"><span class="lineNum">    3849 </span>        [<span class="branchCov" title="Branch 0 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        784 :         std::vector&lt;std::vector&lt;unsigned char&gt;&gt; solutions_data;</span></a>
<a name="3850"><span class="lineNum">    3850 </span>        [<span class="branchCov" title="Branch 0 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        392 :         TxoutType which_type = Solver(subscript, solutions_data);</span></a>
<a name="3851"><span class="lineNum">    3851 </span>  [<span class="branchCov" title="Branch 0 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        784 :         obj.pushKV(&quot;script&quot;, GetTxnOutputType(which_type));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3852"><span class="lineNum">    3852 </span>  [<span class="branchCov" title="Branch 0 was taken 208 times"> + </span><span class="branchCov" title="Branch 1 was taken 184 times"> + </span><span class="branchCov" title="Branch 2 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1176 :         obj.pushKV(&quot;hex&quot;, HexStr(subscript));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3853"><span class="lineNum">    3853 </span>                :            : </a>
<a name="3854"><span class="lineNum">    3854 </span>                :<span class="lineCov">        392 :         CTxDestination embedded;</span></a>
<a name="3855"><span class="lineNum">    3855 </span>  [<span class="branchCov" title="Branch 0 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 243 times"> + </span><span class="branchCov" title="Branch 3 was taken 149 times"> + </span>]:<span class="lineCov">        392 :         if (ExtractDestination(subscript, embedded)) {</span></a>
<a name="3856"><span class="lineNum">    3856 </span>                :            :             // Only when the script corresponds to an address.</a>
<a name="3857"><span class="lineNum">    3857 </span>  [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        486 :             UniValue subobj(UniValue::VOBJ);</span></a>
<a name="3858"><span class="lineNum">    3858 </span>        [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        486 :             UniValue detail = DescribeAddress(embedded);</span></a>
<a name="3859"><span class="lineNum">    3859 </span>        [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        243 :             subobj.pushKVs(detail);</span></a>
<a name="3860"><span class="lineNum">    3860 </span>        [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        486 :             UniValue wallet_detail = std::visit(*this, embedded);</span></a>
<a name="3861"><span class="lineNum">    3861 </span>        [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        243 :             subobj.pushKVs(wallet_detail);</span></a>
<a name="3862"><span class="lineNum">    3862 </span>  [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        486 :             subobj.pushKV(&quot;address&quot;, EncodeDestination(embedded));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3863"><span class="lineNum">    3863 </span>  [<span class="branchCov" title="Branch 0 was taken 208 times"> + </span><span class="branchCov" title="Branch 1 was taken 35 times"> + </span><span class="branchCov" title="Branch 2 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        729 :             subobj.pushKV(&quot;scriptPubKey&quot;, HexStr(subscript));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="3864"><span class="lineNum">    3864 </span>                :            :             // Always report the pubkey at the top level, so that `getnewaddress()['pubkey']` always works.</a>
<a name="3865"><span class="lineNum">    3865 </span>  [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 208 times"> + </span><span class="branchCov" title="Branch 3 was taken 35 times"> + </span> :<span class="lineCov">        902 :             if (subobj.exists(&quot;pubkey&quot;)) obj.pushKV(&quot;pubkey&quot;, subobj[&quot;pubkey&quot;]);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 208 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 208 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 208 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 208 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 243 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="3866"><span class="lineNum">    3866 </span>  [<span class="branchCov" title="Branch 0 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 243 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        486 :             obj.pushKV(&quot;embedded&quot;, std::move(subobj));</span></a>
<a name="3867"><span class="lineNum">    3867 </span>        [<span class="branchCov" title="Branch 0 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        149 :         } else if (which_type == TxoutType::MULTISIG) {</span></a>
<a name="3868"><span class="lineNum">    3868 </span>                :            :             // Also report some information on multisig scripts (which do not have a corresponding address).</a>
<a name="3869"><span class="lineNum">    3869 </span>  [<span class="branchCov" title="Branch 0 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        298 :             obj.pushKV(&quot;sigsrequired&quot;, solutions_data[0][0]);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3870"><span class="lineNum">    3870 </span>  [<span class="branchCov" title="Branch 0 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        298 :             UniValue pubkeys(UniValue::VARR);</span></a>
<a name="3871"><span class="lineNum">    3871 </span>        [<span class="branchCov" title="Branch 0 was taken 346 times"> + </span><span class="branchCov" title="Branch 1 was taken 149 times"> + </span>]:<span class="lineCov">        495 :             for (size_t i = 1; i &lt; solutions_data.size() - 1; ++i) {</span></a>
<a name="3872"><span class="lineNum">    3872 </span>                :<span class="lineCov">        346 :                 CPubKey key(solutions_data[i].begin(), solutions_data[i].end());</span></a>
<a name="3873"><span class="lineNum">    3873 </span>  [<span class="branchCov" title="Branch 0 was taken 346 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 346 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        692 :                 pubkeys.push_back(HexStr(key));</span></a>
<a name="3874"><span class="lineNum">    3874 </span>                :            :             }</a>
<a name="3875"><span class="lineNum">    3875 </span>  [<span class="branchCov" title="Branch 0 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 149 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        298 :             obj.pushKV(&quot;pubkeys&quot;, std::move(pubkeys));</span></a>
<a name="3876"><span class="lineNum">    3876 </span>                :            :         }</a>
<a name="3877"><span class="lineNum">    3877 </span>                :<span class="lineCov">        392 :     }</span></a>
<a name="3878"><span class="lineNum">    3878 </span>                :            : </a>
<a name="3879"><span class="lineNum">    3879 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     explicit DescribeWalletAddressVisitor(const SigningProvider* _provider) : provider(_provider) {}</span></a>
<a name="3880"><span class="lineNum">    3880 </span>                :            : </a>
<a name="3881"><span class="lineNum">    3881 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     UniValue operator()(const CNoDestination&amp; dest) const { return UniValue(UniValue::VOBJ); }</span></a>
<a name="3882"><span class="lineNum">    3882 </span>                :            : </a>
<a name="3883"><span class="lineNum">    3883 </span>                :<span class="lineCov">        256 :     UniValue operator()(const PKHash&amp; pkhash) const</span></a>
<a name="3884"><span class="lineNum">    3884 </span>                :            :     {</a>
<a name="3885"><span class="lineNum">    3885 </span>                :<span class="lineCov">        256 :         CKeyID keyID{ToKeyID(pkhash)};</span></a>
<a name="3886"><span class="lineNum">    3886 </span>        [<span class="branchCov" title="Branch 0 was taken 256 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        256 :         UniValue obj(UniValue::VOBJ);</span></a>
<a name="3887"><span class="lineNum">    3887 </span>        [<span class="branchCov" title="Branch 0 was taken 245 times"> + </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span>]:<span class="lineCov">        256 :         CPubKey vchPubKey;</span></a>
<a name="3888"><span class="lineNum">    3888 </span>  [<span class="branchCov" title="Branch 0 was taken 245 times"> + </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span><span class="branchCov" title="Branch 2 was taken 245 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        256 :         if (provider &amp;&amp; provider-&gt;GetPubKey(keyID, vchPubKey)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 237 times"> + </span><span class="branchCov" title="Branch 5 was taken 8 times"> + </span>]
<a name="3889"><span class="lineNum">    3889 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        474 :             obj.pushKV(&quot;pubkey&quot;, HexStr(vchPubKey));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3890"><span class="lineNum">    3890 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        493 :             obj.pushKV(&quot;iscompressed&quot;, vchPubKey.IsCompressed());</span></a>
<a name="3891"><span class="lineNum">    3891 </span>                :            :         }</a>
<a name="3892"><span class="lineNum">    3892 </span>                :<span class="lineCov">        256 :         return obj;</span></a>
<a name="3893"><span class="lineNum">    3893 </span>                :            :     }</a>
<a name="3894"><span class="lineNum">    3894 </span>                :            : </a>
<a name="3895"><span class="lineNum">    3895 </span>                :<span class="lineCov">        301 :     UniValue operator()(const ScriptHash&amp; scripthash) const</span></a>
<a name="3896"><span class="lineNum">    3896 </span>                :            :     {</a>
<a name="3897"><span class="lineNum">    3897 </span>                :<span class="lineCov">        301 :         CScriptID scriptID(scripthash);</span></a>
<a name="3898"><span class="lineNum">    3898 </span>        [<span class="branchCov" title="Branch 0 was taken 301 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        301 :         UniValue obj(UniValue::VOBJ);</span></a>
<a name="3899"><span class="lineNum">    3899 </span>        [<span class="branchCov" title="Branch 0 was taken 297 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">        301 :         CScript subscript;</span></a>
<a name="3900"><span class="lineNum">    3900 </span>  [<span class="branchCov" title="Branch 0 was taken 297 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span><span class="branchCov" title="Branch 2 was taken 297 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        301 :         if (provider &amp;&amp; provider-&gt;GetCScript(scriptID, subscript)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 294 times"> + </span><span class="branchCov" title="Branch 5 was taken 3 times"> + </span>]
<a name="3901"><span class="lineNum">    3901 </span>        [<span class="branchCov" title="Branch 0 was taken 294 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        294 :             ProcessSubScript(subscript, obj);</span></a>
<a name="3902"><span class="lineNum">    3902 </span>                :            :         }</a>
<a name="3903"><span class="lineNum">    3903 </span>                :<span class="lineCov">        301 :         return obj;</span></a>
<a name="3904"><span class="lineNum">    3904 </span>                :            :     }</a>
<a name="3905"><span class="lineNum">    3905 </span>                :            : </a>
<a name="3906"><span class="lineNum">    3906 </span>                :<span class="lineCov">        794 :     UniValue operator()(const WitnessV0KeyHash&amp; id) const</span></a>
<a name="3907"><span class="lineNum">    3907 </span>                :            :     {</a>
<a name="3908"><span class="lineNum">    3908 </span>        [<span class="branchCov" title="Branch 0 was taken 794 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        794 :         UniValue obj(UniValue::VOBJ);</span></a>
<a name="3909"><span class="lineNum">    3909 </span>        [<span class="branchCov" title="Branch 0 was taken 722 times"> + </span><span class="branchCov" title="Branch 1 was taken 72 times"> + </span>]:<span class="lineCov">        794 :         CPubKey pubkey;</span></a>
<a name="3910"><span class="lineNum">    3910 </span>  [<span class="branchCov" title="Branch 0 was taken 722 times"> + </span><span class="branchCov" title="Branch 1 was taken 72 times"> + </span><span class="branchCov" title="Branch 2 was taken 722 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        794 :         if (provider &amp;&amp; provider-&gt;GetPubKey(ToKeyID(id), pubkey)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 722 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 715 times"> + </span><span class="branchCov" title="Branch 7 was taken 7 times"> + </span>]
<a name="3911"><span class="lineNum">    3911 </span>  [<span class="branchCov" title="Branch 0 was taken 715 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 715 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1430 :             obj.pushKV(&quot;pubkey&quot;, HexStr(pubkey));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 715 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3912"><span class="lineNum">    3912 </span>                :            :         }</a>
<a name="3913"><span class="lineNum">    3913 </span>                :<span class="lineCov">        794 :         return obj;</span></a>
<a name="3914"><span class="lineNum">    3914 </span>                :            :     }</a>
<a name="3915"><span class="lineNum">    3915 </span>                :            : </a>
<a name="3916"><span class="lineNum">    3916 </span>                :<span class="lineCov">        138 :     UniValue operator()(const WitnessV0ScriptHash&amp; id) const</span></a>
<a name="3917"><span class="lineNum">    3917 </span>                :            :     {</a>
<a name="3918"><span class="lineNum">    3918 </span>        [<span class="branchCov" title="Branch 0 was taken 138 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        138 :         UniValue obj(UniValue::VOBJ);</span></a>
<a name="3919"><span class="lineNum">    3919 </span>        [<span class="branchCov" title="Branch 0 was taken 138 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        138 :         CScript subscript;</span></a>
<a name="3920"><span class="lineNum">    3920 </span>        [<span class="branchCov" title="Branch 0 was taken 138 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        138 :         CRIPEMD160 hasher;</span></a>
<a name="3921"><span class="lineNum">    3921 </span>                :<span class="lineCov">        138 :         uint160 hash;</span></a>
<a name="3922"><span class="lineNum">    3922 </span>  [<span class="branchCov" title="Branch 0 was taken 138 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 138 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        138 :         hasher.Write(id.begin(), 32).Finalize(hash.begin());</span></a>
<a name="3923"><span class="lineNum">    3923 </span>  [<span class="branchCov" title="Branch 0 was taken 98 times"> + </span><span class="branchCov" title="Branch 1 was taken 40 times"> + </span><span class="branchCov" title="Branch 2 was taken 98 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        138 :         if (provider &amp;&amp; provider-&gt;GetCScript(CScriptID(hash), subscript)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 98 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3924"><span class="lineNum">    3924 </span>        [<span class="branchCov" title="Branch 0 was taken 98 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         98 :             ProcessSubScript(subscript, obj);</span></a>
<a name="3925"><span class="lineNum">    3925 </span>                :            :         }</a>
<a name="3926"><span class="lineNum">    3926 </span>                :<span class="lineCov">        138 :         return obj;</span></a>
<a name="3927"><span class="lineNum">    3927 </span>                :            :     }</a>
<a name="3928"><span class="lineNum">    3928 </span>                :            : </a>
<a name="3929"><span class="lineNum">    3929 </span>        [<span class="branchCov" title="Branch 0 was taken 47 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         94 :     UniValue operator()(const WitnessV1Taproot&amp; id) const { return UniValue(UniValue::VOBJ); }</span></a>
<a name="3930"><span class="lineNum">    3930 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     UniValue operator()(const WitnessUnknown&amp; id) const { return UniValue(UniValue::VOBJ); }</span></a>
<a name="3931"><span class="lineNum">    3931 </span>                :            : };</a>
<a name="3932"><span class="lineNum">    3932 </span>                :            : </a>
<a name="3933"><span class="lineNum">    3933 </span>                :<span class="lineCov">       1293 : static UniValue DescribeWalletAddress(const CWallet&amp; wallet, const CTxDestination&amp; dest)</span></a>
<a name="3934"><span class="lineNum">    3934 </span>                :            : {</a>
<a name="3935"><span class="lineNum">    3935 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     UniValue ret(UniValue::VOBJ);</span></a>
<a name="3936"><span class="lineNum">    3936 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     UniValue detail = DescribeAddress(dest);</span></a>
<a name="3937"><span class="lineNum">    3937 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     CScript script = GetScriptForDestination(dest);</span></a>
<a name="3938"><span class="lineNum">    3938 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     std::unique_ptr&lt;SigningProvider&gt; provider = nullptr;</span></a>
<a name="3939"><span class="lineNum">    3939 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     provider = wallet.GetSolvingProvider(script);</span></a>
<a name="3940"><span class="lineNum">    3940 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     ret.pushKVs(detail);</span></a>
<a name="3941"><span class="lineNum">    3941 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2586 :     ret.pushKVs(std::visit(DescribeWalletAddressVisitor(provider.get()), dest));</span></a>
<a name="3942"><span class="lineNum">    3942 </span>                :<span class="lineCov">       2586 :     return ret;</span></a>
<a name="3943"><span class="lineNum">    3943 </span>                :            : }</a>
<a name="3944"><span class="lineNum">    3944 </span>                :            : </a>
<a name="3945"><span class="lineNum">    3945 </span>                :            : /** Convert CAddressBookData to JSON record.  */</a>
<a name="3946"><span class="lineNum">    3946 </span>                :<span class="lineCov">        141 : static UniValue AddressBookDataToJSON(const CAddressBookData&amp; data, const bool verbose)</span></a>
<a name="3947"><span class="lineNum">    3947 </span>                :            : {</a>
<a name="3948"><span class="lineNum">    3948 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        141 :     UniValue ret(UniValue::VOBJ);</span></a>
<a name="3949"><span class="lineNum">    3949 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 141 times"> + </span>]:<span class="lineCov">        141 :     if (verbose) {</span></a>
<a name="3950"><span class="lineNum">    3950 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        141 :         ret.pushKV(&quot;name&quot;, data.GetLabel());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="3951"><span class="lineNum">    3951 </span>                :            :     }</a>
<a name="3952"><span class="lineNum">    3952 </span>  [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        282 :     ret.pushKV(&quot;purpose&quot;, data.purpose);</span></a>
<a name="3953"><span class="lineNum">    3953 </span>                :<span class="lineCov">        141 :     return ret;</span></a>
<a name="3954"><span class="lineNum">    3954 </span>                :            : }</a>
<a name="3955"><span class="lineNum">    3955 </span>                :            : </a>
<a name="3956"><span class="lineNum">    3956 </span>                :<span class="lineCov">       2771 : RPCHelpMan getaddressinfo()</span></a>
<a name="3957"><span class="lineNum">    3957 </span>                :            : {</a>
<a name="3958"><span class="lineNum">    3958 </span>                :<span class="lineCov">       2771 :     return RPCHelpMan{&quot;getaddressinfo&quot;,</span></a>
<a name="3959"><span class="lineNum">    3959 </span>                :            :                 &quot;\nReturn information about the given bitcoin address.\n&quot;</a>
<a name="3960"><span class="lineNum">    3960 </span>                :            :                 &quot;Some of the information will only be present if the address is in the active wallet.\n&quot;,</a>
<a name="3961"><span class="lineNum">    3961 </span>                :            :                 {</a>
<a name="3962"><span class="lineNum">    3962 </span>                :<span class="lineCov">       2771 :                     {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The bitcoin address for which to get information.&quot;},</span></a>
<a name="3963"><span class="lineNum">    3963 </span>                :            :                 },</a>
<a name="3964"><span class="lineNum">    3964 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="3965"><span class="lineNum">    3965 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="3966"><span class="lineNum">    3966 </span>                :            :                     {</a>
<a name="3967"><span class="lineNum">    3967 </span>                :            :                         {RPCResult::Type::STR, &quot;address&quot;, &quot;The bitcoin address validated.&quot;},</a>
<a name="3968"><span class="lineNum">    3968 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;scriptPubKey&quot;, &quot;The hex-encoded scriptPubKey generated by the address.&quot;},</a>
<a name="3969"><span class="lineNum">    3969 </span>                :            :                         {RPCResult::Type::BOOL, &quot;ismine&quot;, &quot;If the address is yours.&quot;},</a>
<a name="3970"><span class="lineNum">    3970 </span>                :            :                         {RPCResult::Type::BOOL, &quot;iswatchonly&quot;, &quot;If the address is watchonly.&quot;},</a>
<a name="3971"><span class="lineNum">    3971 </span>                :            :                         {RPCResult::Type::BOOL, &quot;solvable&quot;, &quot;If we know how to spend coins sent to this address, ignoring the possible lack of private keys.&quot;},</a>
<a name="3972"><span class="lineNum">    3972 </span>                :            :                         {RPCResult::Type::STR, &quot;desc&quot;, /* optional */ true, &quot;A descriptor for spending coins sent to this address (only when solvable).&quot;},</a>
<a name="3973"><span class="lineNum">    3973 </span>                :            :                         {RPCResult::Type::STR, &quot;parent_desc&quot;, /* optional */ true, &quot;The descriptor used to derive this address if this is a descriptor wallet&quot;},</a>
<a name="3974"><span class="lineNum">    3974 </span>                :            :                         {RPCResult::Type::BOOL, &quot;isscript&quot;, &quot;If the key is a script.&quot;},</a>
<a name="3975"><span class="lineNum">    3975 </span>                :            :                         {RPCResult::Type::BOOL, &quot;ischange&quot;, &quot;If the address was used for change output.&quot;},</a>
<a name="3976"><span class="lineNum">    3976 </span>                :            :                         {RPCResult::Type::BOOL, &quot;iswitness&quot;, &quot;If the address is a witness address.&quot;},</a>
<a name="3977"><span class="lineNum">    3977 </span>                :            :                         {RPCResult::Type::NUM, &quot;witness_version&quot;, /* optional */ true, &quot;The version number of the witness program.&quot;},</a>
<a name="3978"><span class="lineNum">    3978 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;witness_program&quot;, /* optional */ true, &quot;The hex value of the witness program.&quot;},</a>
<a name="3979"><span class="lineNum">    3979 </span>                :            :                         {RPCResult::Type::STR, &quot;script&quot;, /* optional */ true, &quot;The output script type. Only if isscript is true and the redeemscript is known. Possible\n&quot;</a>
<a name="3980"><span class="lineNum">    3980 </span>                :            :                                                                      &quot;types: nonstandard, pubkey, pubkeyhash, scripthash, multisig, nulldata, witness_v0_keyhash,\n&quot;</a>
<a name="3981"><span class="lineNum">    3981 </span>                :            :                             &quot;witness_v0_scripthash, witness_unknown.&quot;},</a>
<a name="3982"><span class="lineNum">    3982 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hex&quot;, /* optional */ true, &quot;The redeemscript for the p2sh address.&quot;},</a>
<a name="3983"><span class="lineNum">    3983 </span>                :            :                         {RPCResult::Type::ARR, &quot;pubkeys&quot;, /* optional */ true, &quot;Array of pubkeys associated with the known redeemscript (only if script is multisig).&quot;,</a>
<a name="3984"><span class="lineNum">    3984 </span>                :            :                         {</a>
<a name="3985"><span class="lineNum">    3985 </span>                :            :                             {RPCResult::Type::STR, &quot;pubkey&quot;, &quot;&quot;},</a>
<a name="3986"><span class="lineNum">    3986 </span>                :            :                         }},</a>
<a name="3987"><span class="lineNum">    3987 </span>                :            :                         {RPCResult::Type::NUM, &quot;sigsrequired&quot;, /* optional */ true, &quot;The number of signatures required to spend multisig output (only if script is multisig).&quot;},</a>
<a name="3988"><span class="lineNum">    3988 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;pubkey&quot;, /* optional */ true, &quot;The hex value of the raw public key for single-key addresses (possibly embedded in P2SH or P2WSH).&quot;},</a>
<a name="3989"><span class="lineNum">    3989 </span>                :            :                         {RPCResult::Type::OBJ, &quot;embedded&quot;, /* optional */ true, &quot;Information about the address embedded in P2SH or P2WSH, if relevant and known.&quot;,</a>
<a name="3990"><span class="lineNum">    3990 </span>                :            :                         {</a>
<a name="3991"><span class="lineNum">    3991 </span>                :            :                             {RPCResult::Type::ELISION, &quot;&quot;, &quot;Includes all getaddressinfo output fields for the embedded address, excluding metadata (timestamp, hdkeypath, hdseedid)\n&quot;</a>
<a name="3992"><span class="lineNum">    3992 </span>                :            :                             &quot;and relation to the wallet (ismine, iswatchonly).&quot;},</a>
<a name="3993"><span class="lineNum">    3993 </span>                :            :                         }},</a>
<a name="3994"><span class="lineNum">    3994 </span>                :            :                         {RPCResult::Type::BOOL, &quot;iscompressed&quot;, /* optional */ true, &quot;If the pubkey is compressed.&quot;},</a>
<a name="3995"><span class="lineNum">    3995 </span>  [<span class="branchCov" title="Branch 0 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       5542 :                         {RPCResult::Type::NUM_TIME, &quot;timestamp&quot;, /* optional */ true, &quot;The creation time of the key, if available, expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="3996"><span class="lineNum">    3996 </span>                :            :                         {RPCResult::Type::STR, &quot;hdkeypath&quot;, /* optional */ true, &quot;The HD keypath, if the key is HD and available.&quot;},</a>
<a name="3997"><span class="lineNum">    3997 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hdseedid&quot;, /* optional */ true, &quot;The Hash160 of the HD seed.&quot;},</a>
<a name="3998"><span class="lineNum">    3998 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hdmasterfingerprint&quot;, /* optional */ true, &quot;The fingerprint of the master key.&quot;},</a>
<a name="3999"><span class="lineNum">    3999 </span>                :            :                         {RPCResult::Type::ARR, &quot;labels&quot;, &quot;Array of labels associated with the address. Currently limited to one label but returned\n&quot;</a>
<a name="4000"><span class="lineNum">    4000 </span>                :            :                             &quot;as an array to keep the API stable if multiple labels are enabled in the future.&quot;,</a>
<a name="4001"><span class="lineNum">    4001 </span>                :            :                         {</a>
<a name="4002"><span class="lineNum">    4002 </span>                :            :                             {RPCResult::Type::STR, &quot;label name&quot;, &quot;Label name (defaults to \&quot;\&quot;).&quot;},</a>
<a name="4003"><span class="lineNum">    4003 </span>                :            :                         }},</a>
<a name="4004"><span class="lineNum">    4004 </span>                :            :                     }</a>
<a name="4005"><span class="lineNum">    4005 </span>  [<span class="branchCov" title="Branch 0 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      85901 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchCov" title="Branch 116 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span><span class="branchCov" title="Branch 118 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchCov" title="Branch 120 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span><span class="branchCov" title="Branch 122 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 123 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 124 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span><span class="branchCov" title="Branch 126 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 127 was not taken"> - </span><span class="branchCov" title="Branch 128 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 129 was not taken"> - </span><span class="branchCov" title="Branch 130 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 131 was not taken"> - </span><span class="branchCov" title="Branch 132 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 133 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 134 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 135 was not taken"> - </span><span class="branchCov" title="Branch 136 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 137 was not taken"> - </span><span class="branchCov" title="Branch 138 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 139 was not taken"> - </span><span class="branchCov" title="Branch 140 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 141 was not taken"> - </span><span class="branchCov" title="Branch 142 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 143 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 144 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 145 was not taken"> - </span><span class="branchCov" title="Branch 146 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 147 was not taken"> - </span><span class="branchCov" title="Branch 148 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 149 was not taken"> - </span><span class="branchCov" title="Branch 150 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 151 was not taken"> - </span><span class="branchCov" title="Branch 152 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 153 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 154 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 155 was not taken"> - </span><span class="branchCov" title="Branch 156 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 157 was not taken"> - </span><span class="branchCov" title="Branch 158 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 159 was not taken"> - </span><span class="branchCov" title="Branch 160 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 161 was not taken"> - </span><span class="branchCov" title="Branch 162 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 163 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 164 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 165 was not taken"> - </span><span class="branchCov" title="Branch 166 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 167 was not taken"> - </span><span class="branchCov" title="Branch 168 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 169 was not taken"> - </span><span class="branchCov" title="Branch 170 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 171 was not taken"> - </span><span class="branchCov" title="Branch 172 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 173 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 174 was taken 66504 times"> + </span><span class="branchCov" title="Branch 175 was taken 2771 times"> + </span><span class="branchCov" title="Branch 176 was taken 2771 times"> + </span><span class="branchCov" title="Branch 177 was taken 2771 times"> + </span><span class="branchCov" title="Branch 178 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 179 was taken 2771 times"> + </span><span class="branchCov" title="Branch 180 was taken 2771 times"> + </span><span class="branchCov" title="Branch 181 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 182 was not taken"> - </span><span class="branchNoCov" title="Branch 183 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 184 was not taken"> - </span><span class="branchNoCov" title="Branch 185 was not taken"> - </span><span class="branchNoCov" title="Branch 186 was not taken"> - </span><span class="branchNoCov" title="Branch 187 was not taken"> - </span><span class="branchNoCov" title="Branch 188 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 189 was not taken"> - </span>]
<a name="4006"><span class="lineNum">    4006 </span>                :<span class="lineCov">       2771 :                 RPCExamples{</span></a>
<a name="4007"><span class="lineNum">    4007 </span>  [<span class="branchCov" title="Branch 0 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5542 :                     HelpExampleCli(&quot;getaddressinfo&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4008"><span class="lineNum">    4008 </span>  [<span class="branchCov" title="Branch 0 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8313 :                     HelpExampleRpc(&quot;getaddressinfo&quot;, &quot;\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2771 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4009"><span class="lineNum">    4009 </span>                :<span class="lineCov">       2771 :                 },</span></a>
<a name="4010"><span class="lineNum">    4010 </span>                :<span class="lineCov">       1299 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4011"><span class="lineNum">    4011 </span>                :            : {</a>
<a name="4012"><span class="lineNum">    4012 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1299 times"> + </span>]:<span class="lineCov">       2592 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4013"><span class="lineNum">    4013 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1299 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4014"><span class="lineNum">    4014 </span>                :            : </a>
<a name="4015"><span class="lineNum">    4015 </span>  [<span class="branchCov" title="Branch 0 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2598 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="4016"><span class="lineNum">    4016 </span>                :            : </a>
<a name="4017"><span class="lineNum">    4017 </span>  [<span class="branchCov" title="Branch 0 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2598 :     std::string error_msg;</span></a>
<a name="4018"><span class="lineNum">    4018 </span>  [<span class="branchCov" title="Branch 0 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1299 :     CTxDestination dest = DecodeDestination(request.params[0].get_str(), error_msg);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4019"><span class="lineNum">    4019 </span>                :            : </a>
<a name="4020"><span class="lineNum">    4020 </span>                :            :     // Make sure the destination is valid</a>
<a name="4021"><span class="lineNum">    4021 </span>  [<span class="branchCov" title="Branch 0 was taken 1299 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 1293 times"> + </span>]:<span class="lineCov">       1299 :     if (!IsValidDestination(dest)) {</span></a>
<a name="4022"><span class="lineNum">    4022 </span>                :            :         // Set generic error message in case 'DecodeDestination' didn't set it</a>
<a name="4023"><span class="lineNum">    4023 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         if (error_msg.empty()) error_msg = &quot;Invalid address&quot;;</span></a>
<a name="4024"><span class="lineNum">    4024 </span>                :            : </a>
<a name="4025"><span class="lineNum">    4025 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, error_msg);</span></a>
<a name="4026"><span class="lineNum">    4026 </span>                :            :     }</a>
<a name="4027"><span class="lineNum">    4027 </span>                :            : </a>
<a name="4028"><span class="lineNum">    4028 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2586 :     UniValue ret(UniValue::VOBJ);</span></a>
<a name="4029"><span class="lineNum">    4029 </span>                :            : </a>
<a name="4030"><span class="lineNum">    4030 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     std::string currentAddress = EncodeDestination(dest);</span></a>
<a name="4031"><span class="lineNum">    4031 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2586 :     ret.pushKV(&quot;address&quot;, currentAddress);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4032"><span class="lineNum">    4032 </span>                :            : </a>
<a name="4033"><span class="lineNum">    4033 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     CScript scriptPubKey = GetScriptForDestination(dest);</span></a>
<a name="4034"><span class="lineNum">    4034 </span>  [<span class="branchCov" title="Branch 0 was taken 150 times"> + </span><span class="branchCov" title="Branch 1 was taken 1143 times"> + </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3879 :     ret.pushKV(&quot;scriptPubKey&quot;, HexStr(scriptPubKey));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4035"><span class="lineNum">    4035 </span>                :            : </a>
<a name="4036"><span class="lineNum">    4036 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     std::unique_ptr&lt;SigningProvider&gt; provider = pwallet-&gt;GetSolvingProvider(scriptPubKey);</span></a>
<a name="4037"><span class="lineNum">    4037 </span>                :            : </a>
<a name="4038"><span class="lineNum">    4038 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     isminetype mine = pwallet-&gt;IsMine(dest);</span></a>
<a name="4039"><span class="lineNum">    4039 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2586 :     ret.pushKV(&quot;ismine&quot;, bool(mine &amp; ISMINE_SPENDABLE));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1166 times"> + </span><span class="branchCov" title="Branch 5 was taken 127 times"> + </span>]
<a name="4040"><span class="lineNum">    4040 </span>                :            : </a>
<a name="4041"><span class="lineNum">    4041 </span>        [<span class="branchCov" title="Branch 0 was taken 1166 times"> + </span><span class="branchCov" title="Branch 1 was taken 127 times"> + </span>]:<span class="lineCov">       1293 :     if (provider) {</span></a>
<a name="4042"><span class="lineNum">    4042 </span>        [<span class="branchCov" title="Branch 0 was taken 1166 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1166 :         auto inferred = InferDescriptor(scriptPubKey, *provider);</span></a>
<a name="4043"><span class="lineNum">    4043 </span>  [<span class="branchCov" title="Branch 0 was taken 1166 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchCov" title="Branch 3 was taken 1148 times"> + </span> :<span class="lineCov">       1166 :         bool solvable = inferred-&gt;IsSolvable() || IsSolvable(*provider, scriptPubKey);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 18 times"> + </span>]
<a name="4044"><span class="lineNum">    4044 </span>  [<span class="branchCov" title="Branch 0 was taken 1166 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1166 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2332 :         ret.pushKV(&quot;solvable&quot;, solvable);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1148 times"> + </span><span class="branchCov" title="Branch 5 was taken 18 times"> + </span>]
<a name="4045"><span class="lineNum">    4045 </span>        [<span class="branchCov" title="Branch 0 was taken 1148 times"> + </span><span class="branchCov" title="Branch 1 was taken 18 times"> + </span>]:<span class="lineCov">       1166 :         if (solvable) {</span></a>
<a name="4046"><span class="lineNum">    4046 </span>  [<span class="branchCov" title="Branch 0 was taken 1148 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1148 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3462 :             ret.pushKV(&quot;desc&quot;, inferred-&gt;ToString());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1148 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4047"><span class="lineNum">    4047 </span>                :            :         }</a>
<a name="4048"><span class="lineNum">    4048 </span>                :            :     } else {</a>
<a name="4049"><span class="lineNum">    4049 </span>  [<span class="branchCov" title="Branch 0 was taken 127 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 127 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1420 :         ret.pushKV(&quot;solvable&quot;, false);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4050"><span class="lineNum">    4050 </span>                :            :     }</a>
<a name="4051"><span class="lineNum">    4051 </span>                :            : </a>
<a name="4052"><span class="lineNum">    4052 </span>                :            : </a>
<a name="4053"><span class="lineNum">    4053 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1166 times"> + </span><span class="branchCov" title="Branch 3 was taken 127 times"> + </span>]:<span class="lineCov">       1293 :     DescriptorScriptPubKeyMan* desc_spk_man = dynamic_cast&lt;DescriptorScriptPubKeyMan*&gt;(pwallet-&gt;GetScriptPubKeyMan(scriptPubKey));</span></a>
<a name="4054"><span class="lineNum">    4054 </span>        [<span class="branchCov" title="Branch 0 was taken 383 times"> + </span><span class="branchCov" title="Branch 1 was taken 783 times"> + </span>]:<span class="lineCov">       1166 :     if (desc_spk_man) {</span></a>
<a name="4055"><span class="lineNum">    4055 </span>        [<span class="branchCov" title="Branch 0 was taken 383 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        383 :         std::string desc_str;</span></a>
<a name="4056"><span class="lineNum">    4056 </span>  [<span class="branchCov" title="Branch 0 was taken 383 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 383 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        383 :         if (desc_spk_man-&gt;GetDescriptorString(desc_str, /* priv */ false)) {</span></a>
<a name="4057"><span class="lineNum">    4057 </span>  [<span class="branchCov" title="Branch 0 was taken 383 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 383 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        766 :             ret.pushKV(&quot;parent_desc&quot;, desc_str);</span></a>
<a name="4058"><span class="lineNum">    4058 </span>                :            :         }</a>
<a name="4059"><span class="lineNum">    4059 </span>                :            :     }</a>
<a name="4060"><span class="lineNum">    4060 </span>                :            : </a>
<a name="4061"><span class="lineNum">    4061 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2586 :     ret.pushKV(&quot;iswatchonly&quot;, bool(mine &amp; ISMINE_WATCH_ONLY));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4062"><span class="lineNum">    4062 </span>                :            : </a>
<a name="4063"><span class="lineNum">    4063 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2586 :     UniValue detail = DescribeWalletAddress(*pwallet, dest);</span></a>
<a name="4064"><span class="lineNum">    4064 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     ret.pushKVs(detail);</span></a>
<a name="4065"><span class="lineNum">    4065 </span>                :            : </a>
<a name="4066"><span class="lineNum">    4066 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2586 :     ret.pushKV(&quot;ischange&quot;, ScriptIsChange(*pwallet, scriptPubKey));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4067"><span class="lineNum">    4067 </span>                :            : </a>
<a name="4068"><span class="lineNum">    4068 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     ScriptPubKeyMan* spk_man = pwallet-&gt;GetScriptPubKeyMan(scriptPubKey);</span></a>
<a name="4069"><span class="lineNum">    4069 </span>        [<span class="branchCov" title="Branch 0 was taken 1166 times"> + </span><span class="branchCov" title="Branch 1 was taken 127 times"> + </span>]:<span class="lineCov">       1293 :     if (spk_man) {</span></a>
<a name="4070"><span class="lineNum">    4070 </span>  [<span class="branchCov" title="Branch 0 was taken 1166 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 998 times"> + </span><span class="branchCov" title="Branch 3 was taken 168 times"> + </span>]:<span class="lineCov">       1166 :         if (const std::unique_ptr&lt;CKeyMetadata&gt; meta = spk_man-&gt;GetMetadata(dest)) {</span></a>
<a name="4071"><span class="lineNum">    4071 </span>  [<span class="branchCov" title="Branch 0 was taken 998 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 998 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1996 :             ret.pushKV(&quot;timestamp&quot;, meta-&gt;nCreateTime);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 928 times"> + </span><span class="branchCov" title="Branch 5 was taken 70 times"> + </span>]
<a name="4072"><span class="lineNum">    4072 </span>        [<span class="branchCov" title="Branch 0 was taken 928 times"> + </span><span class="branchCov" title="Branch 1 was taken 70 times"> + </span>]:<span class="lineCov">        998 :             if (meta-&gt;has_key_origin) {</span></a>
<a name="4073"><span class="lineNum">    4073 </span>  [<span class="branchCov" title="Branch 0 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1856 :                 ret.pushKV(&quot;hdkeypath&quot;, WriteHDKeypath(meta-&gt;key_origin.path));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4074"><span class="lineNum">    4074 </span>  [<span class="branchCov" title="Branch 0 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1856 :                 ret.pushKV(&quot;hdseedid&quot;, meta-&gt;hd_seed_id.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4075"><span class="lineNum">    4075 </span>  [<span class="branchCov" title="Branch 0 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3022 :                 ret.pushKV(&quot;hdmasterfingerprint&quot;, HexStr(meta-&gt;key_origin.fingerprint));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 928 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4076"><span class="lineNum">    4076 </span>                :            :             }</a>
<a name="4077"><span class="lineNum">    4077 </span>                :            :         }</a>
<a name="4078"><span class="lineNum">    4078 </span>                :            :     }</a>
<a name="4079"><span class="lineNum">    4079 </span>                :            : </a>
<a name="4080"><span class="lineNum">    4080 </span>                :            :     // Return a `labels` array containing the label associated with the address,</a>
<a name="4081"><span class="lineNum">    4081 </span>                :            :     // equivalent to the `label` field above. Currently only one label can be</a>
<a name="4082"><span class="lineNum">    4082 </span>                :            :     // associated with an address, but we return an array so the API remains</a>
<a name="4083"><span class="lineNum">    4083 </span>                :            :     // stable if we allow multiple labels to be associated with an address in</a>
<a name="4084"><span class="lineNum">    4084 </span>                :            :     // the future.</a>
<a name="4085"><span class="lineNum">    4085 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2586 :     UniValue labels(UniValue::VARR);</span></a>
<a name="4086"><span class="lineNum">    4086 </span>        [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1293 :     const auto* address_book_entry = pwallet-&gt;FindAddressBookEntry(dest);</span></a>
<a name="4087"><span class="lineNum">    4087 </span>        [<span class="branchCov" title="Branch 0 was taken 1005 times"> + </span><span class="branchCov" title="Branch 1 was taken 288 times"> + </span>]:<span class="lineCov">       1293 :     if (address_book_entry) {</span></a>
<a name="4088"><span class="lineNum">    4088 </span>        [<span class="branchCov" title="Branch 0 was taken 1005 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1005 :         labels.push_back(address_book_entry-&gt;GetLabel());</span></a>
<a name="4089"><span class="lineNum">    4089 </span>                :            :     }</a>
<a name="4090"><span class="lineNum">    4090 </span>  [<span class="branchCov" title="Branch 0 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1293 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2586 :     ret.pushKV(&quot;labels&quot;, std::move(labels));</span></a>
<a name="4091"><span class="lineNum">    4091 </span>                :            : </a>
<a name="4092"><span class="lineNum">    4092 </span>                :<span class="lineCov">       1293 :     return ret;</span></a>
<a name="4093"><span class="lineNum">    4093 </span>                :            : },</a>
<a name="4094"><span class="lineNum">    4094 </span>  [<span class="branchCov" title="Branch 0 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      22168 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2771 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2771 times"> + </span><span class="branchCov" title="Branch 17 was taken 2771 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="4095"><span class="lineNum">    4095 </span>                :            : }</a>
<a name="4096"><span class="lineNum">    4096 </span>                :            : </a>
<a name="4097"><span class="lineNum">    4097 </span>                :<span class="lineCov">       1548 : static RPCHelpMan getaddressesbylabel()</span></a>
<a name="4098"><span class="lineNum">    4098 </span>                :            : {</a>
<a name="4099"><span class="lineNum">    4099 </span>                :<span class="lineCov">       1548 :     return RPCHelpMan{&quot;getaddressesbylabel&quot;,</span></a>
<a name="4100"><span class="lineNum">    4100 </span>                :            :                 &quot;\nReturns the list of addresses assigned the specified label.\n&quot;,</a>
<a name="4101"><span class="lineNum">    4101 </span>                :            :                 {</a>
<a name="4102"><span class="lineNum">    4102 </span>                :<span class="lineCov">       1548 :                     {&quot;label&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The label.&quot;},</span></a>
<a name="4103"><span class="lineNum">    4103 </span>                :            :                 },</a>
<a name="4104"><span class="lineNum">    4104 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="4105"><span class="lineNum">    4105 </span>                :            :                     RPCResult::Type::OBJ_DYN, &quot;&quot;, &quot;json object with addresses as keys&quot;,</a>
<a name="4106"><span class="lineNum">    4106 </span>                :            :                     {</a>
<a name="4107"><span class="lineNum">    4107 </span>                :            :                         {RPCResult::Type::OBJ, &quot;address&quot;, &quot;json object with information about address&quot;,</a>
<a name="4108"><span class="lineNum">    4108 </span>                :            :                         {</a>
<a name="4109"><span class="lineNum">    4109 </span>                :            :                             {RPCResult::Type::STR, &quot;purpose&quot;, &quot;Purpose of address (\&quot;send\&quot; for sending address, \&quot;receive\&quot; for receiving address)&quot;},</a>
<a name="4110"><span class="lineNum">    4110 </span>                :            :                         }},</a>
<a name="4111"><span class="lineNum">    4111 </span>                :            :                     }</a>
<a name="4112"><span class="lineNum">    4112 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6192 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1548 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1548 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1548 times"> + </span><span class="branchCov" title="Branch 23 was taken 1548 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1548 times"> + </span><span class="branchCov" title="Branch 25 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 29 was not taken"> - </span>]
<a name="4113"><span class="lineNum">    4113 </span>                :<span class="lineCov">       1548 :                 RPCExamples{</span></a>
<a name="4114"><span class="lineNum">    4114 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3096 :                     HelpExampleCli(&quot;getaddressesbylabel&quot;, &quot;\&quot;tabby\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4115"><span class="lineNum">    4115 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6192 :             + HelpExampleRpc(&quot;getaddressesbylabel&quot;, &quot;\&quot;tabby\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4116"><span class="lineNum">    4116 </span>                :<span class="lineCov">       1548 :                 },</span></a>
<a name="4117"><span class="lineNum">    4117 </span>                :<span class="lineCov">         76 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4118"><span class="lineNum">    4118 </span>                :            : {</a>
<a name="4119"><span class="lineNum">    4119 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 76 times"> + </span>]:<span class="lineCov">        142 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4120"><span class="lineNum">    4120 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         76 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4121"><span class="lineNum">    4121 </span>                :            : </a>
<a name="4122"><span class="lineNum">    4122 </span>  [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        152 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="4123"><span class="lineNum">    4123 </span>                :            : </a>
<a name="4124"><span class="lineNum">    4124 </span>  [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        152 :     std::string label = LabelFromValue(request.params[0]);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4125"><span class="lineNum">    4125 </span>                :            : </a>
<a name="4126"><span class="lineNum">    4126 </span>                :            :     // Find all addresses that have the given label</a>
<a name="4127"><span class="lineNum">    4127 </span>  [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 76 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        152 :     UniValue ret(UniValue::VOBJ);</span></a>
<a name="4128"><span class="lineNum">    4128 </span>                :<span class="lineCov">        152 :     std::set&lt;std::string&gt; addresses;</span></a>
<a name="4129"><span class="lineNum">    4129 </span>        [<span class="branchCov" title="Branch 0 was taken 1383 times"> + </span><span class="branchCov" title="Branch 1 was taken 76 times"> + </span>]:<span class="lineCov">       1459 :     for (const std::pair&lt;const CTxDestination, CAddressBookData&gt;&amp; item : pwallet-&gt;m_address_book) {</span></a>
<a name="4130"><span class="lineNum">    4130 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1383 times"> + </span>]:<span class="lineCov">       1383 :         if (item.second.IsChange()) continue;</span></a>
<a name="4131"><span class="lineNum">    4131 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchCov" title="Branch 1 was taken 1242 times"> + </span>]:<span class="lineCov">       1383 :         if (item.second.GetLabel() == label) {</span></a>
<a name="4132"><span class="lineNum">    4132 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1524 :             std::string address = EncodeDestination(item.first);</span></a>
<a name="4133"><span class="lineNum">    4133 </span>                :            :             // CWallet::m_address_book is not expected to contain duplicate</a>
<a name="4134"><span class="lineNum">    4134 </span>                :            :             // address strings, but build a separate set as a precaution just in</a>
<a name="4135"><span class="lineNum">    4135 </span>                :            :             // case it does.</a>
<a name="4136"><span class="lineNum">    4136 </span>        [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        141 :             bool unique = addresses.emplace(address).second;</span></a>
<a name="4137"><span class="lineNum">    4137 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        141 :             CHECK_NONFATAL(unique);</span></a>
<a name="4138"><span class="lineNum">    4138 </span>                :            :             // UniValue::pushKV checks if the key exists in O(N)</a>
<a name="4139"><span class="lineNum">    4139 </span>                :            :             // and since duplicate addresses are unexpected (checked with</a>
<a name="4140"><span class="lineNum">    4140 </span>                :            :             // std::set in O(log(N))), UniValue::__pushKV is used instead,</a>
<a name="4141"><span class="lineNum">    4141 </span>                :            :             // which currently is O(1).</a>
<a name="4142"><span class="lineNum">    4142 </span>  [<span class="branchCov" title="Branch 0 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 141 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        141 :             ret.__pushKV(address, AddressBookDataToJSON(item.second, false));</span></a>
<a name="4143"><span class="lineNum">    4143 </span>                :            :         }</a>
<a name="4144"><span class="lineNum">    4144 </span>                :            :     }</a>
<a name="4145"><span class="lineNum">    4145 </span>                :            : </a>
<a name="4146"><span class="lineNum">    4146 </span>        [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchCov" title="Branch 1 was taken 66 times"> + </span>]:<span class="lineCov">         76 :     if (ret.empty()) {</span></a>
<a name="4147"><span class="lineNum">    4147 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         20 :         throw JSONRPCError(RPC_WALLET_INVALID_LABEL_NAME, std::string(&quot;No addresses with label &quot; + label));</span></a>
<a name="4148"><span class="lineNum">    4148 </span>                :            :     }</a>
<a name="4149"><span class="lineNum">    4149 </span>                :            : </a>
<a name="4150"><span class="lineNum">    4150 </span>                :<span class="lineCov">         66 :     return ret;</span></a>
<a name="4151"><span class="lineNum">    4151 </span>                :            : },</a>
<a name="4152"><span class="lineNum">    4152 </span>  [<span class="branchCov" title="Branch 0 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      12384 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1548 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1548 times"> + </span><span class="branchCov" title="Branch 17 was taken 1548 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="4153"><span class="lineNum">    4153 </span>                :            : }</a>
<a name="4154"><span class="lineNum">    4154 </span>                :            : </a>
<a name="4155"><span class="lineNum">    4155 </span>                :<span class="lineCov">       1545 : static RPCHelpMan listlabels()</span></a>
<a name="4156"><span class="lineNum">    4156 </span>                :            : {</a>
<a name="4157"><span class="lineNum">    4157 </span>                :<span class="lineCov">       1545 :     return RPCHelpMan{&quot;listlabels&quot;,</span></a>
<a name="4158"><span class="lineNum">    4158 </span>                :            :                 &quot;\nReturns the list of all labels, or labels that are assigned to addresses with a specific purpose.\n&quot;,</a>
<a name="4159"><span class="lineNum">    4159 </span>                :            :                 {</a>
<a name="4160"><span class="lineNum">    4160 </span>                :<span class="lineCov">       1545 :                     {&quot;purpose&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Address purpose to list labels for ('send','receive'). An empty string is the same as not providing this argument.&quot;},</span></a>
<a name="4161"><span class="lineNum">    4161 </span>                :            :                 },</a>
<a name="4162"><span class="lineNum">    4162 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="4163"><span class="lineNum">    4163 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="4164"><span class="lineNum">    4164 </span>                :            :                     {</a>
<a name="4165"><span class="lineNum">    4165 </span>                :            :                         {RPCResult::Type::STR, &quot;label&quot;, &quot;Label name&quot;},</a>
<a name="4166"><span class="lineNum">    4166 </span>                :            :                     }</a>
<a name="4167"><span class="lineNum">    4167 </span>  [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4635 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1545 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1545 times"> + </span><span class="branchCov" title="Branch 15 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="4168"><span class="lineNum">    4168 </span>                :<span class="lineCov">       1545 :                 RPCExamples{</span></a>
<a name="4169"><span class="lineNum">    4169 </span>                :            :             &quot;\nList all labels\n&quot;</a>
<a name="4170"><span class="lineNum">    4170 </span>  [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3090 :             + HelpExampleCli(&quot;listlabels&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4171"><span class="lineNum">    4171 </span>        [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1545 :             &quot;\nList labels that have receiving addresses\n&quot;</span></a>
<a name="4172"><span class="lineNum">    4172 </span>  [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6180 :             + HelpExampleCli(&quot;listlabels&quot;, &quot;receive&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4173"><span class="lineNum">    4173 </span>        [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1545 :             &quot;\nList labels that have sending addresses\n&quot;</span></a>
<a name="4174"><span class="lineNum">    4174 </span>  [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6180 :             + HelpExampleCli(&quot;listlabels&quot;, &quot;send&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4175"><span class="lineNum">    4175 </span>        [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1545 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="4176"><span class="lineNum">    4176 </span>  [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6180 :             + HelpExampleRpc(&quot;listlabels&quot;, &quot;receive&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4177"><span class="lineNum">    4177 </span>                :<span class="lineCov">       1545 :                 },</span></a>
<a name="4178"><span class="lineNum">    4178 </span>                :<span class="lineCov">         73 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4179"><span class="lineNum">    4179 </span>                :            : {</a>
<a name="4180"><span class="lineNum">    4180 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 73 times"> + </span>]:<span class="lineCov">        146 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4181"><span class="lineNum">    4181 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         73 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4182"><span class="lineNum">    4182 </span>                :            : </a>
<a name="4183"><span class="lineNum">    4183 </span>  [<span class="branchCov" title="Branch 0 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        146 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="4184"><span class="lineNum">    4184 </span>                :            : </a>
<a name="4185"><span class="lineNum">    4185 </span>  [<span class="branchCov" title="Branch 0 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        146 :     std::string purpose;</span></a>
<a name="4186"><span class="lineNum">    4186 </span>  [<span class="branchCov" title="Branch 0 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 73 times"> + </span>]:<span class="lineCov">         73 :     if (!request.params[0].isNull()) {</span></a>
<a name="4187"><span class="lineNum">    4187 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :         purpose = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="4188"><span class="lineNum">    4188 </span>                :            :     }</a>
<a name="4189"><span class="lineNum">    4189 </span>                :            : </a>
<a name="4190"><span class="lineNum">    4190 </span>                :            :     // Add to a set to sort by label name, then insert into Univalue array</a>
<a name="4191"><span class="lineNum">    4191 </span>                :<span class="lineCov">        146 :     std::set&lt;std::string&gt; label_set;</span></a>
<a name="4192"><span class="lineNum">    4192 </span>        [<span class="branchCov" title="Branch 0 was taken 1277 times"> + </span><span class="branchCov" title="Branch 1 was taken 73 times"> + </span>]:<span class="lineCov">       1350 :     for (const std::pair&lt;const CTxDestination, CAddressBookData&gt;&amp; entry : pwallet-&gt;m_address_book) {</span></a>
<a name="4193"><span class="lineNum">    4193 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1277 times"> + </span>]:<span class="lineCov">       1277 :         if (entry.second.IsChange()) continue;</span></a>
<a name="4194"><span class="lineNum">    4194 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1277 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1277 :         if (purpose.empty() || entry.second.purpose == purpose) {</span></a>
<a name="4195"><span class="lineNum">    4195 </span>        [<span class="branchCov" title="Branch 0 was taken 1277 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1277 :             label_set.insert(entry.second.GetLabel());</span></a>
<a name="4196"><span class="lineNum">    4196 </span>                :            :         }</a>
<a name="4197"><span class="lineNum">    4197 </span>                :            :     }</a>
<a name="4198"><span class="lineNum">    4198 </span>                :            : </a>
<a name="4199"><span class="lineNum">    4199 </span>  [<span class="branchCov" title="Branch 0 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 73 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        146 :     UniValue ret(UniValue::VARR);</span></a>
<a name="4200"><span class="lineNum">    4200 </span>        [<span class="branchCov" title="Branch 0 was taken 417 times"> + </span><span class="branchCov" title="Branch 1 was taken 73 times"> + </span>]:<span class="lineCov">        490 :     for (const std::string&amp; name : label_set) {</span></a>
<a name="4201"><span class="lineNum">    4201 </span>        [<span class="branchCov" title="Branch 0 was taken 417 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        417 :         ret.push_back(name);</span></a>
<a name="4202"><span class="lineNum">    4202 </span>                :            :     }</a>
<a name="4203"><span class="lineNum">    4203 </span>                :            : </a>
<a name="4204"><span class="lineNum">    4204 </span>                :<span class="lineCov">         73 :     return ret;</span></a>
<a name="4205"><span class="lineNum">    4205 </span>                :            : },</a>
<a name="4206"><span class="lineNum">    4206 </span>  [<span class="branchCov" title="Branch 0 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      12360 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1545 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1545 times"> + </span><span class="branchCov" title="Branch 17 was taken 1545 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="4207"><span class="lineNum">    4207 </span>                :            : }</a>
<a name="4208"><span class="lineNum">    4208 </span>                :            : </a>
<a name="4209"><span class="lineNum">    4209 </span>                :<span class="lineCov">       1709 : static RPCHelpMan send()</span></a>
<a name="4210"><span class="lineNum">    4210 </span>                :            : {</a>
<a name="4211"><span class="lineNum">    4211 </span>                :<span class="lineCov">       1709 :     return RPCHelpMan{&quot;send&quot;,</span></a>
<a name="4212"><span class="lineNum">    4212 </span>                :            :         &quot;\nEXPERIMENTAL warning: this call may be changed in future releases.\n&quot;</a>
<a name="4213"><span class="lineNum">    4213 </span>                :            :         &quot;\nSend a transaction.\n&quot;,</a>
<a name="4214"><span class="lineNum">    4214 </span>                :            :         {</a>
<a name="4215"><span class="lineNum">    4215 </span>                :<span class="lineCov">       1709 :             {&quot;outputs&quot;, RPCArg::Type::ARR, RPCArg::Optional::NO, &quot;The outputs (key-value pairs), where none of the keys are duplicated.\n&quot;</span></a>
<a name="4216"><span class="lineNum">    4216 </span>                :            :                     &quot;That is, each address can only appear once and there can only be one 'data' object.\n&quot;</a>
<a name="4217"><span class="lineNum">    4217 </span>                :            :                     &quot;For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.&quot;,</a>
<a name="4218"><span class="lineNum">    4218 </span>                :            :                 {</a>
<a name="4219"><span class="lineNum">    4219 </span>                :<span class="lineCov">       1709 :                     {&quot;&quot;, RPCArg::Type::OBJ_USER_KEYS, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="4220"><span class="lineNum">    4220 </span>                :            :                         {</a>
<a name="4221"><span class="lineNum">    4221 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       5127 :                             {&quot;address&quot;, RPCArg::Type::AMOUNT, RPCArg::Optional::NO, &quot;A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in &quot; + CURRENCY_UNIT + &quot;&quot;},</span></a>
<a name="4222"><span class="lineNum">    4222 </span>                :            :                         },</a>
<a name="4223"><span class="lineNum">    4223 </span>                :            :                         },</a>
<a name="4224"><span class="lineNum">    4224 </span>                :<span class="lineCov">       1709 :                     {&quot;&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="4225"><span class="lineNum">    4225 </span>                :            :                         {</a>
<a name="4226"><span class="lineNum">    4226 </span>                :<span class="lineCov">       1709 :                             {&quot;data&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;A key-value pair. The key must be \&quot;data\&quot;, the value is hex-encoded data&quot;},</span></a>
<a name="4227"><span class="lineNum">    4227 </span>                :            :                         },</a>
<a name="4228"><span class="lineNum">    4228 </span>                :            :                     },</a>
<a name="4229"><span class="lineNum">    4229 </span>                :            :                 },</a>
<a name="4230"><span class="lineNum">    4230 </span>                :            :             },</a>
<a name="4231"><span class="lineNum">    4231 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :             {&quot;conf_target&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;wallet -txconfirmtarget&quot;}, &quot;Confirmation target in blocks&quot;},</span></a>
<a name="4232"><span class="lineNum">    4232 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       5127 :             {&quot;estimate_mode&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;unset&quot;}, std::string() + &quot;The fee estimate mode, must be one of (case insensitive):\n&quot;</span></a>
<a name="4233"><span class="lineNum">    4233 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5127 :                         &quot;       \&quot;&quot; + FeeModes(&quot;\&quot;\n\&quot;&quot;) + &quot;\&quot;&quot;},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4234"><span class="lineNum">    4234 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6836 :             {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4235"><span class="lineNum">    4235 </span>                :<span class="lineCov">       1709 :             {&quot;options&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;&quot;,</span></a>
<a name="4236"><span class="lineNum">    4236 </span>                :<span class="lineCov">       1709 :                 Cat&lt;std::vector&lt;RPCArg&gt;&gt;(</span></a>
<a name="4237"><span class="lineNum">    4237 </span>                :            :                 {</a>
<a name="4238"><span class="lineNum">    4238 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;add_inputs&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;If inputs are specified, automatically include more if they are not enough.&quot;},</span></a>
<a name="4239"><span class="lineNum">    4239 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;include_unsafe&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Include inputs that are not safe to spend (unconfirmed transactions from outside keys and unconfirmed replacement transactions).\n&quot;</span></a>
<a name="4240"><span class="lineNum">    4240 </span>                :            :                                                           &quot;Warning: the resulting transaction may become invalid if one of the unsafe inputs disappears.\n&quot;</a>
<a name="4241"><span class="lineNum">    4241 </span>                :            :                                                           &quot;If that happens, you will need to fund the transaction with different inputs and republish it.&quot;},</a>
<a name="4242"><span class="lineNum">    4242 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;add_to_wallet&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;When false, returns a serialized transaction which will not be added to the wallet or broadcast&quot;},</span></a>
<a name="4243"><span class="lineNum">    4243 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;change_address&quot;, RPCArg::Type::STR_HEX, RPCArg::DefaultHint{&quot;pool address&quot;}, &quot;The bitcoin address to receive the change&quot;},</span></a>
<a name="4244"><span class="lineNum">    4244 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;change_position&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;random&quot;}, &quot;The index of the change output&quot;},</span></a>
<a name="4245"><span class="lineNum">    4245 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;change_type&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;set by -changetype&quot;}, &quot;The output type to use. Only valid if change_address is not specified. Options are \&quot;legacy\&quot;, \&quot;p2sh-segwit\&quot;, and \&quot;bech32\&quot;.&quot;},</span></a>
<a name="4246"><span class="lineNum">    4246 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6836 :                     {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4247"><span class="lineNum">    4247 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;include_watching&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Also select inputs which are watch only.\n&quot;</span></a>
<a name="4248"><span class="lineNum">    4248 </span>                :            :                                           &quot;Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\n&quot;</a>
<a name="4249"><span class="lineNum">    4249 </span>                :            :                                           &quot;e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.&quot;},</a>
<a name="4250"><span class="lineNum">    4250 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;inputs&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;Specify inputs instead of adding them automatically. A JSON array of JSON objects&quot;,</span></a>
<a name="4251"><span class="lineNum">    4251 </span>                :            :                         {</a>
<a name="4252"><span class="lineNum">    4252 </span>                :<span class="lineCov">       1709 :                             {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="4253"><span class="lineNum">    4253 </span>                :<span class="lineCov">       1709 :                             {&quot;vout&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The output number&quot;},</span></a>
<a name="4254"><span class="lineNum">    4254 </span>                :<span class="lineCov">       1709 :                             {&quot;sequence&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The sequence number&quot;},</span></a>
<a name="4255"><span class="lineNum">    4255 </span>                :            :                         },</a>
<a name="4256"><span class="lineNum">    4256 </span>                :            :                     },</a>
<a name="4257"><span class="lineNum">    4257 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;locktime&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;Raw locktime. Non-0 value also locktime-activates inputs&quot;},</span></a>
<a name="4258"><span class="lineNum">    4258 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;lock_unspents&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Lock selected unspent outputs&quot;},</span></a>
<a name="4259"><span class="lineNum">    4259 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;psbt&quot;, RPCArg::Type::BOOL,  RPCArg::DefaultHint{&quot;automatic&quot;}, &quot;Always return a PSBT, implies add_to_wallet=false.&quot;},</span></a>
<a name="4260"><span class="lineNum">    4260 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3418 :                     {&quot;subtract_fee_from_outputs&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;Outputs to subtract the fee from, specified as integer indices.\n&quot;</span></a>
<a name="4261"><span class="lineNum">    4261 </span>                :            :                     &quot;The fee will be equally deducted from the amount of each specified output.\n&quot;</a>
<a name="4262"><span class="lineNum">    4262 </span>                :            :                     &quot;Those recipients will receive less bitcoins than you enter in their corresponding amount field.\n&quot;</a>
<a name="4263"><span class="lineNum">    4263 </span>                :            :                     &quot;If no outputs are specified here, the sender pays the fee.&quot;,</a>
<a name="4264"><span class="lineNum">    4264 </span>                :            :                         {</a>
<a name="4265"><span class="lineNum">    4265 </span>                :<span class="lineCov">       1709 :                             {&quot;vout_index&quot;, RPCArg::Type::NUM, RPCArg::Optional::OMITTED, &quot;The zero-based output index, before a change output is added.&quot;},</span></a>
<a name="4266"><span class="lineNum">    4266 </span>                :            :                         },</a>
<a name="4267"><span class="lineNum">    4267 </span>                :            :                     },</a>
<a name="4268"><span class="lineNum">    4268 </span>                :            :                 },</a>
<a name="4269"><span class="lineNum">    4269 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      87159 :                 FundTxDoc()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchCov" title="Branch 116 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span><span class="branchCov" title="Branch 118 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchCov" title="Branch 120 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span><span class="branchCov" title="Branch 122 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 123 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 124 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span><span class="branchCov" title="Branch 126 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 127 was not taken"> - </span><span class="branchCov" title="Branch 128 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 129 was not taken"> - </span><span class="branchCov" title="Branch 130 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 131 was not taken"> - </span><span class="branchCov" title="Branch 132 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 133 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 134 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 135 was not taken"> - </span><span class="branchCov" title="Branch 136 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 137 was not taken"> - </span><span class="branchCov" title="Branch 138 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 139 was not taken"> - </span><span class="branchCov" title="Branch 140 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 141 was not taken"> - </span><span class="branchCov" title="Branch 142 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 143 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 144 was taken 22217 times"> + </span><span class="branchCov" title="Branch 145 was taken 1709 times"> + </span><span class="branchCov" title="Branch 146 was taken 1709 times"> + </span><span class="branchCov" title="Branch 147 was taken 1709 times"> + </span><span class="branchCov" title="Branch 148 was taken 5127 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 149 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 150 was not taken"> - </span><span class="branchNoCov" title="Branch 151 was not taken"> - </span><span class="branchNoCov" title="Branch 152 was not taken"> - </span><span class="branchNoCov" title="Branch 153 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 154 was not taken"> - </span><span class="branchNoCov" title="Branch 155 was not taken"> - </span>]
<a name="4270"><span class="lineNum">    4270 </span>                :            :                 &quot;options&quot;},</a>
<a name="4271"><span class="lineNum">    4271 </span>                :            :         },</a>
<a name="4272"><span class="lineNum">    4272 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="4273"><span class="lineNum">    4273 </span>                :            :             RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="4274"><span class="lineNum">    4274 </span>                :            :                 {</a>
<a name="4275"><span class="lineNum">    4275 </span>                :            :                     {RPCResult::Type::BOOL, &quot;complete&quot;, &quot;If the transaction has a complete set of signatures&quot;},</a>
<a name="4276"><span class="lineNum">    4276 </span>                :            :                     {RPCResult::Type::STR_HEX, &quot;txid&quot;, /* optional */ true, &quot;The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.&quot;},</a>
<a name="4277"><span class="lineNum">    4277 </span>                :            :                     {RPCResult::Type::STR_HEX, &quot;hex&quot;, /* optional */ true, &quot;If add_to_wallet is false, the hex-encoded raw transaction with signature(s)&quot;},</a>
<a name="4278"><span class="lineNum">    4278 </span>                :            :                     {RPCResult::Type::STR, &quot;psbt&quot;, /* optional */ true, &quot;If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction&quot;}</a>
<a name="4279"><span class="lineNum">    4279 </span>                :            :                 }</a>
<a name="4280"><span class="lineNum">    4280 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10254 :         },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 6836 times"> + </span><span class="branchCov" title="Branch 33 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 34 was not taken"> - </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span>]
<a name="4281"><span class="lineNum">    4281 </span>                :<span class="lineCov">       1709 :         RPCExamples{&quot;&quot;</span></a>
<a name="4282"><span class="lineNum">    4282 </span>                :            :         &quot;\nSend 0.1 BTC with a confirmation target of 6 blocks in economical fee estimate mode\n&quot;</a>
<a name="4283"><span class="lineNum">    4283 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3418 :         + HelpExampleCli(&quot;send&quot;, &quot;'{\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;: 0.1}' 6 economical\n&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4284"><span class="lineNum">    4284 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3418 :         &quot;Send 0.2 BTC with a fee rate of 1.1 &quot; + CURRENCY_ATOM + &quot;/vB using positional arguments\n&quot;</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4285"><span class="lineNum">    4285 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6836 :         + HelpExampleCli(&quot;send&quot;, &quot;'{\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;: 0.2}' null \&quot;unset\&quot; 1.1\n&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4286"><span class="lineNum">    4286 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3418 :         &quot;Send 0.2 BTC with a fee rate of 1 &quot; + CURRENCY_ATOM + &quot;/vB using the options argument\n&quot;</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4287"><span class="lineNum">    4287 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6836 :         + HelpExampleCli(&quot;send&quot;, &quot;'{\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;: 0.2}' null \&quot;unset\&quot; null '{\&quot;fee_rate\&quot;: 1}'\n&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4288"><span class="lineNum">    4288 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3418 :         &quot;Send 0.3 BTC with a fee rate of 25 &quot; + CURRENCY_ATOM + &quot;/vB using named arguments\n&quot;</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4289"><span class="lineNum">    4289 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6836 :         + HelpExampleCli(&quot;-named send&quot;, &quot;outputs='{\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;: 0.3}' fee_rate=25\n&quot;) +</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4290"><span class="lineNum">    4290 </span>        [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1709 :         &quot;Create a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\n&quot;</span></a>
<a name="4291"><span class="lineNum">    4291 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6836 :         + HelpExampleCli(&quot;send&quot;, &quot;'{\&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;: 0.1}' 1 economical '{\&quot;add_to_wallet\&quot;: false, \&quot;inputs\&quot;: [{\&quot;txid\&quot;:\&quot;a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\&quot;, \&quot;vout\&quot;:1}]}'&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4292"><span class="lineNum">    4292 </span>                :<span class="lineCov">       1709 :         },</span></a>
<a name="4293"><span class="lineNum">    4293 </span>                :<span class="lineCov">        237 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4294"><span class="lineNum">    4294 </span>                :            :         {</a>
<a name="4295"><span class="lineNum">    4295 </span>        [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        237 :             RPCTypeCheck(request.params, {</span></a>
<a name="4296"><span class="lineNum">    4296 </span>                :            :                 UniValueType(), // outputs (ARR or OBJ, checked later)</a>
<a name="4297"><span class="lineNum">    4297 </span>                :            :                 UniValue::VNUM, // conf_target</a>
<a name="4298"><span class="lineNum">    4298 </span>                :            :                 UniValue::VSTR, // estimate_mode</a>
<a name="4299"><span class="lineNum">    4299 </span>                :            :                 UniValueType(), // fee_rate, will be checked by AmountFromValue() in SetFeeEstimateMode()</a>
<a name="4300"><span class="lineNum">    4300 </span>                :            :                 UniValue::VOBJ, // options</a>
<a name="4301"><span class="lineNum">    4301 </span>                :            :                 }, true</a>
<a name="4302"><span class="lineNum">    4302 </span>                :<span class="lineCov">        474 :             );</span></a>
<a name="4303"><span class="lineNum">    4303 </span>                :            : </a>
<a name="4304"><span class="lineNum">    4304 </span>                :<span class="lineCov">        303 :             std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4305"><span class="lineNum">    4305 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        237 :             if (!pwallet) return NullUniValue;</span></a>
<a name="4306"><span class="lineNum">    4306 </span>                :            : </a>
<a name="4307"><span class="lineNum">    4307 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 77 times"> + </span><span class="branchCov" title="Branch 3 was taken 160 times"> + </span> :<span class="lineCov">        408 :             UniValue options{request.params[4].isNull() ? UniValue::VOBJ : request.params[4]};</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 77 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 160 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 160 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span>]
<a name="4308"><span class="lineNum">    4308 </span>  [<span class="branchCov" title="Branch 0 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 237 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        430 :             if (options.exists(&quot;conf_target&quot;) || options.exists(&quot;estimate_mode&quot;)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 191 times"> + </span><span class="branchCov" title="Branch 5 was taken 46 times"> + </span><span class="branchCov" title="Branch 6 was taken 191 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 191 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 2 times"> + </span><span class="branchCov" title="Branch 11 was taken 189 times"> + </span><span class="branchCov" title="Branch 12 was taken 191 times"> + </span><span class="branchCov" title="Branch 13 was taken 46 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 48 times"> + </span><span class="branchCov" title="Branch 15 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="4309"><span class="lineNum">    4309 </span>  [<span class="branchCov" title="Branch 0 was taken 48 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span> :<span class="lineCov">         48 :                 if (!request.params[1].isNull() || !request.params[2].isNull()) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 42 times"> + </span>]
<a name="4310"><span class="lineNum">    4310 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         12 :                     throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Pass conf_target and estimate_mode either as arguments or in the options object, but not both&quot;);</span></a>
<a name="4311"><span class="lineNum">    4311 </span>                :            :                 }</a>
<a name="4312"><span class="lineNum">    4312 </span>                :            :             } else {</a>
<a name="4313"><span class="lineNum">    4313 </span>  [<span class="branchCov" title="Branch 0 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        378 :                 options.pushKV(&quot;conf_target&quot;, request.params[1]);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4314"><span class="lineNum">    4314 </span>  [<span class="branchCov" title="Branch 0 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        420 :                 options.pushKV(&quot;estimate_mode&quot;, request.params[2]);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 189 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 231 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4315"><span class="lineNum">    4315 </span>                :            :             }</a>
<a name="4316"><span class="lineNum">    4316 </span>  [<span class="branchCov" title="Branch 0 was taken 231 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 56 times"> + </span><span class="branchCov" title="Branch 3 was taken 175 times"> + </span>]:<span class="lineCov">        462 :             if (options.exists(&quot;fee_rate&quot;)) {</span></a>
<a name="4317"><span class="lineNum">    4317 </span>  [<span class="branchCov" title="Branch 0 was taken 56 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 54 times"> + </span>]:<span class="lineCov">         56 :                 if (!request.params[3].isNull()) {</span></a>
<a name="4318"><span class="lineNum">    4318 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                     throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Pass the fee_rate either as an argument, or in the options object, but not both&quot;);</span></a>
<a name="4319"><span class="lineNum">    4319 </span>                :            :                 }</a>
<a name="4320"><span class="lineNum">    4320 </span>                :            :             } else {</a>
<a name="4321"><span class="lineNum">    4321 </span>  [<span class="branchCov" title="Branch 0 was taken 175 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 175 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        404 :                 options.pushKV(&quot;fee_rate&quot;, request.params[3]);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 175 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 229 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4322"><span class="lineNum">    4322 </span>                :            :             }</a>
<a name="4323"><span class="lineNum">    4323 </span>  [<span class="branchCov" title="Branch 0 was taken 229 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 229 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        345 :             if (!options[&quot;conf_target&quot;].isNull() &amp;&amp; (options[&quot;estimate_mode&quot;].isNull() || (options[&quot;estimate_mode&quot;].get_str() == &quot;unset&quot;))) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 58 times"> + </span><span class="branchCov" title="Branch 5 was taken 171 times"> + </span><span class="branchCov" title="Branch 6 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 58 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 58 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 19 was taken 58 times"> + </span><span class="branchCov" title="Branch 20 was taken 58 times"> + </span><span class="branchCov" title="Branch 21 was taken 171 times"> + </span><span class="branchCov" title="Branch 22 was taken 58 times"> + </span><span class="branchCov" title="Branch 23 was taken 171 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchCov" title="Branch 25 was taken 229 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchNoCov" title="Branch 28 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchNoCov" title="Branch 30 was not taken"> - </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span>]
<a name="4324"><span class="lineNum">    4324 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Specify estimate_mode&quot;);</span></a>
<a name="4325"><span class="lineNum">    4325 </span>                :            :             }</a>
<a name="4326"><span class="lineNum">    4326 </span>  [<span class="branchCov" title="Branch 0 was taken 229 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 227 times"> + </span>]:<span class="lineCov">        458 :             if (options.exists(&quot;feeRate&quot;)) {</span></a>
<a name="4327"><span class="lineNum">    4327 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Use fee_rate (&quot; + CURRENCY_ATOM + &quot;/vB) instead of feeRate&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4328"><span class="lineNum">    4328 </span>                :            :             }</a>
<a name="4329"><span class="lineNum">    4329 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 227 times"> + </span>]:<span class="lineCov">        454 :             if (options.exists(&quot;changeAddress&quot;)) {</span></a>
<a name="4330"><span class="lineNum">    4330 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Use change_address&quot;);</span></a>
<a name="4331"><span class="lineNum">    4331 </span>                :            :             }</a>
<a name="4332"><span class="lineNum">    4332 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 227 times"> + </span>]:<span class="lineCov">        454 :             if (options.exists(&quot;changePosition&quot;)) {</span></a>
<a name="4333"><span class="lineNum">    4333 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Use change_position&quot;);</span></a>
<a name="4334"><span class="lineNum">    4334 </span>                :            :             }</a>
<a name="4335"><span class="lineNum">    4335 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 227 times"> + </span>]:<span class="lineCov">        454 :             if (options.exists(&quot;includeWatching&quot;)) {</span></a>
<a name="4336"><span class="lineNum">    4336 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Use include_watching&quot;);</span></a>
<a name="4337"><span class="lineNum">    4337 </span>                :            :             }</a>
<a name="4338"><span class="lineNum">    4338 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 227 times"> + </span>]:<span class="lineCov">        454 :             if (options.exists(&quot;lockUnspents&quot;)) {</span></a>
<a name="4339"><span class="lineNum">    4339 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Use lock_unspents&quot;);</span></a>
<a name="4340"><span class="lineNum">    4340 </span>                :            :             }</a>
<a name="4341"><span class="lineNum">    4341 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 227 times"> + </span>]:<span class="lineCov">        454 :             if (options.exists(&quot;subtractFeeFromOutputs&quot;)) {</span></a>
<a name="4342"><span class="lineNum">    4342 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Use subtract_fee_from_outputs&quot;);</span></a>
<a name="4343"><span class="lineNum">    4343 </span>                :            :             }</a>
<a name="4344"><span class="lineNum">    4344 </span>                :            : </a>
<a name="4345"><span class="lineNum">    4345 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        235 :             const bool psbt_opt_in = options.exists(&quot;psbt&quot;) &amp;&amp; options[&quot;psbt&quot;].get_bool();</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchCov" title="Branch 5 was taken 219 times"> + </span><span class="branchCov" title="Branch 6 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 8 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span><span class="branchCov" title="Branch 13 was taken 8 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 8 times"> + </span><span class="branchCov" title="Branch 15 was taken 219 times"> + </span><span class="branchCov" title="Branch 16 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<a name="4346"><span class="lineNum">    4346 </span>                :            : </a>
<a name="4347"><span class="lineNum">    4347 </span>                :<span class="lineCov">        227 :             CAmount fee;</span></a>
<a name="4348"><span class="lineNum">    4348 </span>                :<span class="lineCov">        227 :             int change_position;</span></a>
<a name="4349"><span class="lineNum">    4349 </span>        [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        227 :             bool rbf = pwallet-&gt;m_signal_rbf;</span></a>
<a name="4350"><span class="lineNum">    4350 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 223 times"> + </span>]:<span class="lineCov">        454 :             if (options.exists(&quot;replaceable&quot;)) {</span></a>
<a name="4351"><span class="lineNum">    4351 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        231 :                 rbf = options[&quot;replaceable&quot;].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4352"><span class="lineNum">    4352 </span>                :            :             }</a>
<a name="4353"><span class="lineNum">    4353 </span>  [<span class="branchCov" title="Branch 0 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        452 :             CMutableTransaction rawTx = ConstructTransaction(options[&quot;inputs&quot;], request.params[0], options[&quot;locktime&quot;], rbf);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 227 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 227 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 225 times"> + </span><span class="branchCov" title="Branch 11 was taken 2 times"> + </span>]
<a name="4354"><span class="lineNum">    4354 </span>        [<span class="branchCov" title="Branch 0 was taken 225 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        450 :             CCoinControl coin_control;</span></a>
<a name="4355"><span class="lineNum">    4355 </span>                :            :             // Automatically select coins, unless at least one is manually selected. Can</a>
<a name="4356"><span class="lineNum">    4356 </span>                :            :             // be overridden by options.add_inputs.</a>
<a name="4357"><span class="lineNum">    4357 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchCov" title="Branch 1 was taken 159 times"> + </span>]:<span class="lineCov">        225 :             coin_control.m_add_inputs = rawTx.vin.size() == 0;</span></a>
<a name="4358"><span class="lineNum">    4358 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchCov" title="Branch 1 was taken 159 times"> + </span>]:<span class="lineCov">        225 :             FundTransaction(*pwallet, rawTx, fee, change_position, options, coin_control, /* override_min_fee */ false);</span></a>
<a name="4359"><span class="lineNum">    4359 </span>                :            : </a>
<a name="4360"><span class="lineNum">    4360 </span>                :<span class="lineCov">         66 :             bool add_to_wallet = true;</span></a>
<a name="4361"><span class="lineNum">    4361 </span>  [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchCov" title="Branch 3 was taken 24 times"> + </span>]:<span class="lineCov">        132 :             if (options.exists(&quot;add_to_wallet&quot;)) {</span></a>
<a name="4362"><span class="lineNum">    4362 </span>  [<span class="branchCov" title="Branch 0 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        108 :                 add_to_wallet = options[&quot;add_to_wallet&quot;].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 42 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4363"><span class="lineNum">    4363 </span>                :            :             }</a>
<a name="4364"><span class="lineNum">    4364 </span>                :            : </a>
<a name="4365"><span class="lineNum">    4365 </span>                :            :             // Make a blank psbt</a>
<a name="4366"><span class="lineNum">    4366 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         66 :             PartiallySignedTransaction psbtx(rawTx);</span></a>
<a name="4367"><span class="lineNum">    4367 </span>                :            : </a>
<a name="4368"><span class="lineNum">    4368 </span>                :            :             // First fill transaction with our data without signing,</a>
<a name="4369"><span class="lineNum">    4369 </span>                :            :             // so external signers are not asked sign more than once.</a>
<a name="4370"><span class="lineNum">    4370 </span>                :<span class="lineCov">         66 :             bool complete;</span></a>
<a name="4371"><span class="lineNum">    4371 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         66 :             pwallet-&gt;FillPSBT(psbtx, complete, SIGHASH_DEFAULT, false, true);</span></a>
<a name="4372"><span class="lineNum">    4372 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         66 :             const TransactionError err = pwallet-&gt;FillPSBT(psbtx, complete, SIGHASH_DEFAULT, true, false);</span></a>
<a name="4373"><span class="lineNum">    4373 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 66 times"> + </span>]:<span class="lineCov">         66 :             if (err != TransactionError::OK) {</span></a>
<a name="4374"><span class="lineNum">    4374 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCTransactionError(err);</span></a>
<a name="4375"><span class="lineNum">    4375 </span>                :            :             }</a>
<a name="4376"><span class="lineNum">    4376 </span>                :            : </a>
<a name="4377"><span class="lineNum">    4377 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        132 :             CMutableTransaction mtx;</span></a>
<a name="4378"><span class="lineNum">    4378 </span>        [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         66 :             complete = FinalizeAndExtractPSBT(psbtx, mtx);</span></a>
<a name="4379"><span class="lineNum">    4379 </span>                :            : </a>
<a name="4380"><span class="lineNum">    4380 </span>  [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        132 :             UniValue result(UniValue::VOBJ);</span></a>
<a name="4381"><span class="lineNum">    4381 </span>                :            : </a>
<a name="4382"><span class="lineNum">    4382 </span>  [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span><span class="branchCov" title="Branch 2 was taken 55 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span> :<span class="lineCov">         66 :             if (psbt_opt_in || !complete || !add_to_wallet) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 35 times"> + </span><span class="branchCov" title="Branch 5 was taken 20 times"> + </span>]
<a name="4383"><span class="lineNum">    4383 </span>                :            :                 // Serialize the PSBT</a>
<a name="4384"><span class="lineNum">    4384 </span>        [<span class="branchCov" title="Branch 0 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         46 :                 CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);</span></a>
<a name="4385"><span class="lineNum">    4385 </span>        [<span class="branchCov" title="Branch 0 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         46 :                 ssTx &lt;&lt; psbtx;</span></a>
<a name="4386"><span class="lineNum">    4386 </span>  [<span class="branchCov" title="Branch 0 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         92 :                 result.pushKV(&quot;psbt&quot;, EncodeBase64(ssTx.str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 46 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4387"><span class="lineNum">    4387 </span>                :            :             }</a>
<a name="4388"><span class="lineNum">    4388 </span>                :            : </a>
<a name="4389"><span class="lineNum">    4389 </span>        [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchCov" title="Branch 1 was taken 9 times"> + </span>]:<span class="lineCov">         66 :             if (complete) {</span></a>
<a name="4390"><span class="lineNum">    4390 </span>        [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         57 :                 std::string err_string;</span></a>
<a name="4391"><span class="lineNum">    4391 </span>  [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        114 :                 std::string hex = EncodeHexTx(CTransaction(mtx));</span></a>
<a name="4392"><span class="lineNum">    4392 </span>        [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        114 :                 CTransactionRef tx(MakeTransactionRef(std::move(mtx)));</span></a>
<a name="4393"><span class="lineNum">    4393 </span>  [<span class="branchCov" title="Branch 0 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        114 :                 result.pushKV(&quot;txid&quot;, tx-&gt;GetHash().GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4394"><span class="lineNum">    4394 </span>        [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchCov" title="Branch 1 was taken 37 times"> + </span>]:<span class="lineCov">         57 :                 if (add_to_wallet &amp;&amp; !psbt_opt_in) {</span></a>
<a name="4395"><span class="lineNum">    4395 </span>  [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         60 :                     pwallet-&gt;CommitTransaction(tx, {}, {} /* orderForm */);</span></a>
<a name="4396"><span class="lineNum">    4396 </span>                :            :                 } else {</a>
<a name="4397"><span class="lineNum">    4397 </span>  [<span class="branchCov" title="Branch 0 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 37 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         94 :                     result.pushKV(&quot;hex&quot;, hex);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 57 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4398"><span class="lineNum">    4398 </span>                :            :                 }</a>
<a name="4399"><span class="lineNum">    4399 </span>                :            :             }</a>
<a name="4400"><span class="lineNum">    4400 </span>  [<span class="branchCov" title="Branch 0 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 66 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        132 :             result.pushKV(&quot;complete&quot;, complete);</span></a>
<a name="4401"><span class="lineNum">    4401 </span>                :            : </a>
<a name="4402"><span class="lineNum">    4402 </span>                :<span class="lineCov">         66 :             return result;</span></a>
<a name="4403"><span class="lineNum">    4403 </span>                :            :         }</a>
<a name="4404"><span class="lineNum">    4404 </span>  [<span class="branchCov" title="Branch 0 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      59815 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 8545 times"> + </span><span class="branchCov" title="Branch 85 was taken 1709 times"> + </span><span class="branchCov" title="Branch 86 was taken 3418 times"> + </span><span class="branchCov" title="Branch 87 was taken 1709 times"> + </span><span class="branchCov" title="Branch 88 was taken 1709 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 89 was taken 1709 times"> + </span><span class="branchCov" title="Branch 90 was taken 1709 times"> + </span><span class="branchCov" title="Branch 91 was taken 1709 times"> + </span><span class="branchNoCov" title="Branch 92 was not taken"> - </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 94 was not taken"> - </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchNoCov" title="Branch 96 was not taken"> - </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 99 was not taken"> - </span>]
<a name="4405"><span class="lineNum">    4405 </span>                :            : }</a>
<a name="4406"><span class="lineNum">    4406 </span>                :            : </a>
<a name="4407"><span class="lineNum">    4407 </span>                :<span class="lineCov">       1493 : static RPCHelpMan sethdseed()</span></a>
<a name="4408"><span class="lineNum">    4408 </span>                :            : {</a>
<a name="4409"><span class="lineNum">    4409 </span>                :<span class="lineCov">       1493 :     return RPCHelpMan{&quot;sethdseed&quot;,</span></a>
<a name="4410"><span class="lineNum">    4410 </span>                :            :                 &quot;\nSet or generate a new HD wallet seed. Non-HD wallets will not be upgraded to being a HD wallet. Wallets that are already\n&quot;</a>
<a name="4411"><span class="lineNum">    4411 </span>                :            :                 &quot;HD will have a new HD seed set so that new keys added to the keypool will be derived from this new seed.\n&quot;</a>
<a name="4412"><span class="lineNum">    4412 </span>                :<span class="lineCov">       1493 :                 &quot;\nNote that you will need to MAKE A NEW BACKUP of your wallet after setting the HD wallet seed.&quot; +</span></a>
<a name="4413"><span class="lineNum">    4413 </span>        [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1493 :         HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="4414"><span class="lineNum">    4414 </span>                :            :                 {</a>
<a name="4415"><span class="lineNum">    4415 </span>        [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2986 :                     {&quot;newkeypool&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Whether to flush old unused addresses, including change addresses, from the keypool and regenerate it.\n&quot;</span></a>
<a name="4416"><span class="lineNum">    4416 </span>                :            :                                          &quot;If true, the next address from getnewaddress and change address from getrawchangeaddress will be from this new seed.\n&quot;</a>
<a name="4417"><span class="lineNum">    4417 </span>                :            :                                          &quot;If false, addresses (including change addresses if the wallet already had HD Chain Split enabled) from the existing\n&quot;</a>
<a name="4418"><span class="lineNum">    4418 </span>                :            :                                          &quot;keypool will be used until it has been depleted.&quot;},</a>
<a name="4419"><span class="lineNum">    4419 </span>        [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2986 :                     {&quot;seed&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;random seed&quot;}, &quot;The WIF private key to use as the new HD seed.\n&quot;</span></a>
<a name="4420"><span class="lineNum">    4420 </span>                :            :                                          &quot;The seed value can be retrieved using the dumpwallet command. It is the private key marked hdseed=1&quot;},</a>
<a name="4421"><span class="lineNum">    4421 </span>                :            :                 },</a>
<a name="4422"><span class="lineNum">    4422 </span>  [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2986 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4423"><span class="lineNum">    4423 </span>                :<span class="lineCov">       1493 :                 RPCExamples{</span></a>
<a name="4424"><span class="lineNum">    4424 </span>  [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2986 :                     HelpExampleCli(&quot;sethdseed&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4425"><span class="lineNum">    4425 </span>  [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5972 :             + HelpExampleCli(&quot;sethdseed&quot;, &quot;false&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4426"><span class="lineNum">    4426 </span>  [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5972 :             + HelpExampleCli(&quot;sethdseed&quot;, &quot;true \&quot;wifkey\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4427"><span class="lineNum">    4427 </span>  [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5972 :             + HelpExampleRpc(&quot;sethdseed&quot;, &quot;true, \&quot;wifkey\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4428"><span class="lineNum">    4428 </span>                :<span class="lineCov">       1493 :                 },</span></a>
<a name="4429"><span class="lineNum">    4429 </span>                :<span class="lineCov">         20 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4430"><span class="lineNum">    4430 </span>                :            : {</a>
<a name="4431"><span class="lineNum">    4431 </span>                :<span class="lineCov">         34 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4432"><span class="lineNum">    4432 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         20 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4433"><span class="lineNum">    4433 </span>                :            : </a>
<a name="4434"><span class="lineNum">    4434 </span>        [<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">         20 :     LegacyScriptPubKeyMan&amp; spk_man = EnsureLegacyScriptPubKeyMan(*pwallet, true);</span></a>
<a name="4435"><span class="lineNum">    4435 </span>                :            : </a>
<a name="4436"><span class="lineNum">    4436 </span>  [<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 19 times"> + </span>]:<span class="lineCov">         19 :     if (pwallet-&gt;IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {</span></a>
<a name="4437"><span class="lineNum">    4437 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Cannot set a HD seed to a wallet with private keys disabled&quot;);</span></a>
<a name="4438"><span class="lineNum">    4438 </span>                :            :     }</a>
<a name="4439"><span class="lineNum">    4439 </span>                :            : </a>
<a name="4440"><span class="lineNum">    4440 </span>  [<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         57 :     LOCK2(pwallet-&gt;cs_wallet, spk_man.cs_KeyStore);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4441"><span class="lineNum">    4441 </span>                :            : </a>
<a name="4442"><span class="lineNum">    4442 </span>                :            :     // Do not do anything to non-HD wallets</a>
<a name="4443"><span class="lineNum">    4443 </span>  [<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 19 times"> + </span>]:<span class="lineCov">         19 :     if (!pwallet-&gt;CanSupportFeature(FEATURE_HD)) {</span></a>
<a name="4444"><span class="lineNum">    4444 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Cannot set an HD seed on a non-HD wallet. Use the upgradewallet RPC in order to upgrade a non-HD wallet to HD&quot;);</span></a>
<a name="4445"><span class="lineNum">    4445 </span>                :            :     }</a>
<a name="4446"><span class="lineNum">    4446 </span>                :            : </a>
<a name="4447"><span class="lineNum">    4447 </span>        [<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         19 :     EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="4448"><span class="lineNum">    4448 </span>                :            : </a>
<a name="4449"><span class="lineNum">    4449 </span>                :<span class="lineCov">         19 :     bool flush_key_pool = true;</span></a>
<a name="4450"><span class="lineNum">    4450 </span>  [<span class="branchCov" title="Branch 0 was taken 19 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchCov" title="Branch 3 was taken 5 times"> + </span>]:<span class="lineCov">         19 :     if (!request.params[0].isNull()) {</span></a>
<a name="4451"><span class="lineNum">    4451 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchCov" title="Branch 3 was taken 1 time"> + </span>]:<span class="lineCov">         14 :         flush_key_pool = request.params[0].get_bool();</span></a>
<a name="4452"><span class="lineNum">    4452 </span>                :            :     }</a>
<a name="4453"><span class="lineNum">    4453 </span>                :            : </a>
<a name="4454"><span class="lineNum">    4454 </span>        [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         18 :     CPubKey master_pub_key;</span></a>
<a name="4455"><span class="lineNum">    4455 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchCov" title="Branch 3 was taken 10 times"> + </span>]:<span class="lineCov">         18 :     if (request.params[1].isNull()) {</span></a>
<a name="4456"><span class="lineNum">    4456 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          8 :         master_pub_key = spk_man.GenerateNewSeed();</span></a>
<a name="4457"><span class="lineNum">    4457 </span>                :            :     } else {</a>
<a name="4458"><span class="lineNum">    4458 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 9 times"> + </span><span class="branchCov" title="Branch 3 was taken 1 time"> + </span> :<span class="lineCov">         13 :         CKey key = DecodeSecret(request.params[1].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 9 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4459"><span class="lineNum">    4459 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 8 times"> + </span>]:<span class="lineCov">          9 :         if (!key.IsValid()) {</span></a>
<a name="4460"><span class="lineNum">    4460 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid private key&quot;);</span></a>
<a name="4461"><span class="lineNum">    4461 </span>                :            :         }</a>
<a name="4462"><span class="lineNum">    4462 </span>                :            : </a>
<a name="4463"><span class="lineNum">    4463 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 6 times"> + </span>]:<span class="lineCov">          8 :         if (HaveKey(spk_man, key)) {</span></a>
<a name="4464"><span class="lineNum">    4464 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Already have this key (either as an HD seed or as a loose private key)&quot;);</span></a>
<a name="4465"><span class="lineNum">    4465 </span>                :            :         }</a>
<a name="4466"><span class="lineNum">    4466 </span>                :            : </a>
<a name="4467"><span class="lineNum">    4467 </span>        [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          6 :         master_pub_key = spk_man.DeriveNewSeed(key);</span></a>
<a name="4468"><span class="lineNum">    4468 </span>                :            :     }</a>
<a name="4469"><span class="lineNum">    4469 </span>                :            : </a>
<a name="4470"><span class="lineNum">    4470 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :     spk_man.SetHDSeed(master_pub_key);</span></a>
<a name="4471"><span class="lineNum">    4471 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         14 :     if (flush_key_pool) spk_man.NewKeyPool();</span></a>
<a name="4472"><span class="lineNum">    4472 </span>                :            : </a>
<a name="4473"><span class="lineNum">    4473 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :     return NullUniValue;</span></a>
<a name="4474"><span class="lineNum">    4474 </span>                :            : },</a>
<a name="4475"><span class="lineNum">    4475 </span>  [<span class="branchCov" title="Branch 0 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      20902 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1493 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1493 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1493 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 2986 times"> + </span><span class="branchCov" title="Branch 23 was taken 1493 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 24 was not taken"> - </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span>]
<a name="4476"><span class="lineNum">    4476 </span>                :            : }</a>
<a name="4477"><span class="lineNum">    4477 </span>                :            : </a>
<a name="4478"><span class="lineNum">    4478 </span>                :<span class="lineCov">       1737 : static RPCHelpMan walletprocesspsbt()</span></a>
<a name="4479"><span class="lineNum">    4479 </span>                :            : {</a>
<a name="4480"><span class="lineNum">    4480 </span>                :<span class="lineCov">       1737 :     return RPCHelpMan{&quot;walletprocesspsbt&quot;,</span></a>
<a name="4481"><span class="lineNum">    4481 </span>                :            :                 &quot;\nUpdate a PSBT with input information from our wallet and then sign inputs\n&quot;</a>
<a name="4482"><span class="lineNum">    4482 </span>                :<span class="lineCov">       1737 :                 &quot;that we can sign for.&quot; +</span></a>
<a name="4483"><span class="lineNum">    4483 </span>        [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1737 :         HELP_REQUIRING_PASSPHRASE,</span></a>
<a name="4484"><span class="lineNum">    4484 </span>                :            :                 {</a>
<a name="4485"><span class="lineNum">    4485 </span>                :<span class="lineCov">       1737 :                     {&quot;psbt&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The transaction base64 string&quot;},</span></a>
<a name="4486"><span class="lineNum">    4486 </span>        [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3474 :                     {&quot;sign&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Also sign the transaction when updating (requires wallet to be unlocked)&quot;},</span></a>
<a name="4487"><span class="lineNum">    4487 </span>        [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3474 :                     {&quot;sighashtype&quot;, RPCArg::Type::STR, RPCArg::Default{&quot;DEFAULT&quot;}, &quot;The signature hash type to sign with if not specified by the PSBT. Must be one of\n&quot;</span></a>
<a name="4488"><span class="lineNum">    4488 </span>                :            :             &quot;       \&quot;DEFAULT\&quot;\n&quot;</a>
<a name="4489"><span class="lineNum">    4489 </span>                :            :             &quot;       \&quot;ALL\&quot;\n&quot;</a>
<a name="4490"><span class="lineNum">    4490 </span>                :            :             &quot;       \&quot;NONE\&quot;\n&quot;</a>
<a name="4491"><span class="lineNum">    4491 </span>                :            :             &quot;       \&quot;SINGLE\&quot;\n&quot;</a>
<a name="4492"><span class="lineNum">    4492 </span>                :            :             &quot;       \&quot;ALL|ANYONECANPAY\&quot;\n&quot;</a>
<a name="4493"><span class="lineNum">    4493 </span>                :            :             &quot;       \&quot;NONE|ANYONECANPAY\&quot;\n&quot;</a>
<a name="4494"><span class="lineNum">    4494 </span>                :            :             &quot;       \&quot;SINGLE|ANYONECANPAY\&quot;&quot;},</a>
<a name="4495"><span class="lineNum">    4495 </span>        [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3474 :                     {&quot;bip32derivs&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Include BIP 32 derivation paths for public keys if we know them&quot;},</span></a>
<a name="4496"><span class="lineNum">    4496 </span>        [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3474 :                     {&quot;finalize&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Also finalize inputs if possible&quot;},</span></a>
<a name="4497"><span class="lineNum">    4497 </span>                :            :                 },</a>
<a name="4498"><span class="lineNum">    4498 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="4499"><span class="lineNum">    4499 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="4500"><span class="lineNum">    4500 </span>                :            :                     {</a>
<a name="4501"><span class="lineNum">    4501 </span>                :            :                         {RPCResult::Type::STR, &quot;psbt&quot;, &quot;The base64-encoded partially signed transaction&quot;},</a>
<a name="4502"><span class="lineNum">    4502 </span>                :            :                         {RPCResult::Type::BOOL, &quot;complete&quot;, &quot;If the transaction has a complete set of signatures&quot;},</a>
<a name="4503"><span class="lineNum">    4503 </span>                :            :                     }</a>
<a name="4504"><span class="lineNum">    4504 </span>  [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6948 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1737 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1737 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 3474 times"> + </span><span class="branchCov" title="Branch 21 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="4505"><span class="lineNum">    4505 </span>                :<span class="lineCov">       1737 :                 RPCExamples{</span></a>
<a name="4506"><span class="lineNum">    4506 </span>  [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3474 :                     HelpExampleCli(&quot;walletprocesspsbt&quot;, &quot;\&quot;psbt\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4507"><span class="lineNum">    4507 </span>                :<span class="lineCov">       1737 :                 },</span></a>
<a name="4508"><span class="lineNum">    4508 </span>                :<span class="lineCov">        265 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4509"><span class="lineNum">    4509 </span>                :            : {</a>
<a name="4510"><span class="lineNum">    4510 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 265 times"> + </span>]:<span class="lineCov">        524 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4511"><span class="lineNum">    4511 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        265 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4512"><span class="lineNum">    4512 </span>                :            : </a>
<a name="4513"><span class="lineNum">    4513 </span>        [<span class="branchCov" title="Branch 0 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        265 :     const CWallet&amp; wallet{*pwallet};</span></a>
<a name="4514"><span class="lineNum">    4514 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="4515"><span class="lineNum">    4515 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="4516"><span class="lineNum">    4516 </span>        [<span class="branchCov" title="Branch 0 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        265 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="4517"><span class="lineNum">    4517 </span>                :            : </a>
<a name="4518"><span class="lineNum">    4518 </span>  [<span class="branchCov" title="Branch 0 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        530 :     RPCTypeCheck(request.params, {UniValue::VSTR});</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4519"><span class="lineNum">    4519 </span>                :            : </a>
<a name="4520"><span class="lineNum">    4520 </span>                :            :     // Unserialize the transaction</a>
<a name="4521"><span class="lineNum">    4521 </span>        [<span class="branchCov" title="Branch 0 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        271 :     PartiallySignedTransaction psbtx;</span></a>
<a name="4522"><span class="lineNum">    4522 </span>        [<span class="branchCov" title="Branch 0 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        530 :     std::string error;</span></a>
<a name="4523"><span class="lineNum">    4523 </span>  [<span class="branchCov" title="Branch 0 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        265 :     if (!DecodeBase64PSBT(psbtx, request.params[0].get_str(), error)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 265 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchCov" title="Branch 7 was taken 263 times"> + </span>]
<a name="4524"><span class="lineNum">    4524 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, strprintf(&quot;TX decode failed %s&quot;, error));</span></a>
<a name="4525"><span class="lineNum">    4525 </span>                :            :     }</a>
<a name="4526"><span class="lineNum">    4526 </span>                :            : </a>
<a name="4527"><span class="lineNum">    4527 </span>                :            :     // Get the sighash type</a>
<a name="4528"><span class="lineNum">    4528 </span>  [<span class="branchCov" title="Branch 0 was taken 263 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 263 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        263 :     int nHashType = ParseSighashString(request.params[2]);</span></a>
<a name="4529"><span class="lineNum">    4529 </span>                :            : </a>
<a name="4530"><span class="lineNum">    4530 </span>                :            :     // Fill transaction with our data and also sign</a>
<a name="4531"><span class="lineNum">    4531 </span>  [<span class="branchCov" title="Branch 0 was taken 263 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 109 times"> + </span><span class="branchCov" title="Branch 3 was taken 154 times"> + </span> :<span class="lineCov">        263 :     bool sign = request.params[1].isNull() ? true : request.params[1].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 109 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 109 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4532"><span class="lineNum">    4532 </span>  [<span class="branchCov" title="Branch 0 was taken 263 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 105 times"> + </span><span class="branchCov" title="Branch 3 was taken 158 times"> + </span> :<span class="lineCov">        263 :     bool bip32derivs = request.params[3].isNull() ? true : request.params[3].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 105 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 105 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4533"><span class="lineNum">    4533 </span>  [<span class="branchCov" title="Branch 0 was taken 263 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 259 times"> + </span> :<span class="lineCov">        263 :     bool finalize = request.params[4].isNull() ? true : request.params[4].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4534"><span class="lineNum">    4534 </span>                :<span class="lineCov">        263 :     bool complete = true;</span></a>
<a name="4535"><span class="lineNum">    4535 </span>                :            : </a>
<a name="4536"><span class="lineNum">    4536 </span>  [<span class="branchCov" title="Branch 0 was taken 159 times"> + </span><span class="branchCov" title="Branch 1 was taken 104 times"> + </span><span class="branchCov" title="Branch 2 was taken 157 times"> + </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">        263 :     if (sign) EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="4537"><span class="lineNum">    4537 </span>                :            : </a>
<a name="4538"><span class="lineNum">    4538 </span>        [<span class="branchCov" title="Branch 0 was taken 261 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        261 :     const TransactionError err{wallet.FillPSBT(psbtx, complete, nHashType, sign, bip32derivs, nullptr, finalize)};</span></a>
<a name="4539"><span class="lineNum">    4539 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 259 times"> + </span>]:<span class="lineCov">        261 :     if (err != TransactionError::OK) {</span></a>
<a name="4540"><span class="lineNum">    4540 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCTransactionError(err);</span></a>
<a name="4541"><span class="lineNum">    4541 </span>                :            :     }</a>
<a name="4542"><span class="lineNum">    4542 </span>                :            : </a>
<a name="4543"><span class="lineNum">    4543 </span>  [<span class="branchCov" title="Branch 0 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        518 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="4544"><span class="lineNum">    4544 </span>        [<span class="branchCov" title="Branch 0 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        518 :     CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);</span></a>
<a name="4545"><span class="lineNum">    4545 </span>        [<span class="branchCov" title="Branch 0 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        259 :     ssTx &lt;&lt; psbtx;</span></a>
<a name="4546"><span class="lineNum">    4546 </span>  [<span class="branchCov" title="Branch 0 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        518 :     result.pushKV(&quot;psbt&quot;, EncodeBase64(ssTx.str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4547"><span class="lineNum">    4547 </span>  [<span class="branchCov" title="Branch 0 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 259 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        518 :     result.pushKV(&quot;complete&quot;, complete);</span></a>
<a name="4548"><span class="lineNum">    4548 </span>                :            : </a>
<a name="4549"><span class="lineNum">    4549 </span>                :<span class="lineCov">        259 :     return result;</span></a>
<a name="4550"><span class="lineNum">    4550 </span>                :            : },</a>
<a name="4551"><span class="lineNum">    4551 </span>  [<span class="branchCov" title="Branch 0 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      38214 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1737 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1737 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1737 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1737 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 8685 times"> + </span><span class="branchCov" title="Branch 47 was taken 1737 times"> + </span><span class="branchNoCov" title="Branch 48 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 49 was not taken"> - </span>]
<a name="4552"><span class="lineNum">    4552 </span>                :            : }</a>
<a name="4553"><span class="lineNum">    4553 </span>                :            : </a>
<a name="4554"><span class="lineNum">    4554 </span>                :<span class="lineCov">       1724 : static RPCHelpMan walletcreatefundedpsbt()</span></a>
<a name="4555"><span class="lineNum">    4555 </span>                :            : {</a>
<a name="4556"><span class="lineNum">    4556 </span>                :<span class="lineCov">       1724 :     return RPCHelpMan{&quot;walletcreatefundedpsbt&quot;,</span></a>
<a name="4557"><span class="lineNum">    4557 </span>                :            :                 &quot;\nCreates and funds a transaction in the Partially Signed Transaction format.\n&quot;</a>
<a name="4558"><span class="lineNum">    4558 </span>                :            :                 &quot;Implements the Creator and Updater roles.\n&quot;</a>
<a name="4559"><span class="lineNum">    4559 </span>                :            :                 &quot;All existing inputs must either have their previous output transaction be in the wallet\n&quot;</a>
<a name="4560"><span class="lineNum">    4560 </span>                :            :                 &quot;or be in the UTXO set. Solving data must be provided for non-wallet inputs.\n&quot;,</a>
<a name="4561"><span class="lineNum">    4561 </span>                :            :                 {</a>
<a name="4562"><span class="lineNum">    4562 </span>                :<span class="lineCov">       1724 :                     {&quot;inputs&quot;, RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Leave empty to add inputs automatically. See add_inputs option.&quot;,</span></a>
<a name="4563"><span class="lineNum">    4563 </span>                :            :                         {</a>
<a name="4564"><span class="lineNum">    4564 </span>                :<span class="lineCov">       1724 :                             {&quot;&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="4565"><span class="lineNum">    4565 </span>                :            :                                 {</a>
<a name="4566"><span class="lineNum">    4566 </span>                :<span class="lineCov">       1724 :                                     {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="4567"><span class="lineNum">    4567 </span>                :<span class="lineCov">       1724 :                                     {&quot;vout&quot;, RPCArg::Type::NUM, RPCArg::Optional::NO, &quot;The output number&quot;},</span></a>
<a name="4568"><span class="lineNum">    4568 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                                     {&quot;sequence&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;depends on the value of the 'locktime' and 'options.replaceable' arguments&quot;}, &quot;The sequence number&quot;},</span></a>
<a name="4569"><span class="lineNum">    4569 </span>                :            :                                 },</a>
<a name="4570"><span class="lineNum">    4570 </span>                :            :                             },</a>
<a name="4571"><span class="lineNum">    4571 </span>                :            :                         },</a>
<a name="4572"><span class="lineNum">    4572 </span>                :            :                         },</a>
<a name="4573"><span class="lineNum">    4573 </span>                :<span class="lineCov">       1724 :                     {&quot;outputs&quot;, RPCArg::Type::ARR, RPCArg::Optional::NO, &quot;The outputs (key-value pairs), where none of the keys are duplicated.\n&quot;</span></a>
<a name="4574"><span class="lineNum">    4574 </span>                :            :                             &quot;That is, each address can only appear once and there can only be one 'data' object.\n&quot;</a>
<a name="4575"><span class="lineNum">    4575 </span>                :            :                             &quot;For compatibility reasons, a dictionary, which holds the key-value pairs directly, is also\n&quot;</a>
<a name="4576"><span class="lineNum">    4576 </span>                :            :                             &quot;accepted as second parameter.&quot;,</a>
<a name="4577"><span class="lineNum">    4577 </span>                :            :                         {</a>
<a name="4578"><span class="lineNum">    4578 </span>                :<span class="lineCov">       1724 :                             {&quot;&quot;, RPCArg::Type::OBJ_USER_KEYS, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="4579"><span class="lineNum">    4579 </span>                :            :                                 {</a>
<a name="4580"><span class="lineNum">    4580 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       5172 :                                     {&quot;address&quot;, RPCArg::Type::AMOUNT, RPCArg::Optional::NO, &quot;A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in &quot; + CURRENCY_UNIT + &quot;&quot;},</span></a>
<a name="4581"><span class="lineNum">    4581 </span>                :            :                                 },</a>
<a name="4582"><span class="lineNum">    4582 </span>                :            :                                 },</a>
<a name="4583"><span class="lineNum">    4583 </span>                :<span class="lineCov">       1724 :                             {&quot;&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, &quot;&quot;,</span></a>
<a name="4584"><span class="lineNum">    4584 </span>                :            :                                 {</a>
<a name="4585"><span class="lineNum">    4585 </span>                :<span class="lineCov">       1724 :                                     {&quot;data&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;A key-value pair. The key must be \&quot;data\&quot;, the value is hex-encoded data&quot;},</span></a>
<a name="4586"><span class="lineNum">    4586 </span>                :            :                                 },</a>
<a name="4587"><span class="lineNum">    4587 </span>                :            :                             },</a>
<a name="4588"><span class="lineNum">    4588 </span>                :            :                         },</a>
<a name="4589"><span class="lineNum">    4589 </span>                :            :                     },</a>
<a name="4590"><span class="lineNum">    4590 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                     {&quot;locktime&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;Raw locktime. Non-0 value also locktime-activates inputs&quot;},</span></a>
<a name="4591"><span class="lineNum">    4591 </span>                :<span class="lineCov">       1724 :                     {&quot;options&quot;, RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;&quot;,</span></a>
<a name="4592"><span class="lineNum">    4592 </span>                :<span class="lineCov">       1724 :                         Cat&lt;std::vector&lt;RPCArg&gt;&gt;(</span></a>
<a name="4593"><span class="lineNum">    4593 </span>                :            :                         {</a>
<a name="4594"><span class="lineNum">    4594 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;add_inputs&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;If inputs are specified, automatically include more if they are not enough.&quot;},</span></a>
<a name="4595"><span class="lineNum">    4595 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;include_unsafe&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Include inputs that are not safe to spend (unconfirmed transactions from outside keys and unconfirmed replacement transactions).\n&quot;</span></a>
<a name="4596"><span class="lineNum">    4596 </span>                :            :                                                           &quot;Warning: the resulting transaction may become invalid if one of the unsafe inputs disappears.\n&quot;</a>
<a name="4597"><span class="lineNum">    4597 </span>                :            :                                                           &quot;If that happens, you will need to fund the transaction with different inputs and republish it.&quot;},</a>
<a name="4598"><span class="lineNum">    4598 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;changeAddress&quot;, RPCArg::Type::STR_HEX, RPCArg::DefaultHint{&quot;pool address&quot;}, &quot;The bitcoin address to receive the change&quot;},</span></a>
<a name="4599"><span class="lineNum">    4599 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;changePosition&quot;, RPCArg::Type::NUM, RPCArg::DefaultHint{&quot;random&quot;}, &quot;The index of the change output&quot;},</span></a>
<a name="4600"><span class="lineNum">    4600 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;change_type&quot;, RPCArg::Type::STR, RPCArg::DefaultHint{&quot;set by -changetype&quot;}, &quot;The output type to use. Only valid if changeAddress is not specified. Options are \&quot;legacy\&quot;, \&quot;p2sh-segwit\&quot;, and \&quot;bech32\&quot;.&quot;},</span></a>
<a name="4601"><span class="lineNum">    4601 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;includeWatching&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Also select inputs which are watch only&quot;},</span></a>
<a name="4602"><span class="lineNum">    4602 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;lockUnspents&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Lock selected unspent outputs&quot;},</span></a>
<a name="4603"><span class="lineNum">    4603 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6896 :                             {&quot;fee_rate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_ATOM + &quot;/vB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4604"><span class="lineNum">    4604 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6896 :                             {&quot;feeRate&quot;, RPCArg::Type::AMOUNT, RPCArg::DefaultHint{&quot;not set, fall back to wallet fee estimation&quot;}, &quot;Specify a fee rate in &quot; + CURRENCY_UNIT + &quot;/kvB.&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4605"><span class="lineNum">    4605 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3448 :                             {&quot;subtractFeeFromOutputs&quot;, RPCArg::Type::ARR, RPCArg::Default{UniValue::VARR}, &quot;The outputs to subtract the fee from.\n&quot;</span></a>
<a name="4606"><span class="lineNum">    4606 </span>                :            :                                                           &quot;The fee will be equally deducted from the amount of each specified output.\n&quot;</a>
<a name="4607"><span class="lineNum">    4607 </span>                :            :                                                           &quot;Those recipients will receive less bitcoins than you enter in their corresponding amount field.\n&quot;</a>
<a name="4608"><span class="lineNum">    4608 </span>                :            :                                                           &quot;If no outputs are specified here, the sender pays the fee.&quot;,</a>
<a name="4609"><span class="lineNum">    4609 </span>                :            :                                 {</a>
<a name="4610"><span class="lineNum">    4610 </span>                :<span class="lineCov">       1724 :                                     {&quot;vout_index&quot;, RPCArg::Type::NUM, RPCArg::Optional::OMITTED, &quot;The zero-based output index, before a change output is added.&quot;},</span></a>
<a name="4611"><span class="lineNum">    4611 </span>                :            :                                 },</a>
<a name="4612"><span class="lineNum">    4612 </span>                :            :                             },</a>
<a name="4613"><span class="lineNum">    4613 </span>                :            :                         },</a>
<a name="4614"><span class="lineNum">    4614 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      65512 :                         FundTxDoc()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 17240 times"> + </span><span class="branchCov" title="Branch 93 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 1724 times"> + </span><span class="branchCov" title="Branch 95 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 96 was not taken"> - </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchNoCov" title="Branch 98 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 99 was not taken"> - </span>]
<a name="4615"><span class="lineNum">    4615 </span>                :            :                         &quot;options&quot;},</a>
<a name="4616"><span class="lineNum">    4616 </span>        [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3448 :                     {&quot;bip32derivs&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Include BIP 32 derivation paths for public keys if we know them&quot;},</span></a>
<a name="4617"><span class="lineNum">    4617 </span>                :            :                 },</a>
<a name="4618"><span class="lineNum">    4618 </span>                :<span class="lineNoCov">          0 :                 RPCResult{</span></a>
<a name="4619"><span class="lineNum">    4619 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="4620"><span class="lineNum">    4620 </span>                :            :                     {</a>
<a name="4621"><span class="lineNum">    4621 </span>                :            :                         {RPCResult::Type::STR, &quot;psbt&quot;, &quot;The resulting raw transaction (base64-encoded string)&quot;},</a>
<a name="4622"><span class="lineNum">    4622 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3448 :                         {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, &quot;Fee in &quot; + CURRENCY_UNIT + &quot; the resulting transaction pays&quot;},</span></a>
<a name="4623"><span class="lineNum">    4623 </span>                :            :                         {RPCResult::Type::NUM, &quot;changepos&quot;, &quot;The position of the added change output, or -1&quot;},</a>
<a name="4624"><span class="lineNum">    4624 </span>                :            :                     }</a>
<a name="4625"><span class="lineNum">    4625 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      12068 :                                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 5172 times"> + </span><span class="branchCov" title="Branch 25 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="4626"><span class="lineNum">    4626 </span>                :<span class="lineCov">       1724 :                                 RPCExamples{</span></a>
<a name="4627"><span class="lineNum">    4627 </span>                :            :                             &quot;\nCreate a transaction with no inputs\n&quot;</a>
<a name="4628"><span class="lineNum">    4628 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3448 :                             + HelpExampleCli(&quot;walletcreatefundedpsbt&quot;, &quot;\&quot;[{\\\&quot;txid\\\&quot;:\\\&quot;myid\\\&quot;,\\\&quot;vout\\\&quot;:0}]\&quot; \&quot;[{\\\&quot;data\\\&quot;:\\\&quot;00010203\\\&quot;}]\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4629"><span class="lineNum">    4629 </span>                :<span class="lineCov">       1724 :                                 },</span></a>
<a name="4630"><span class="lineNum">    4630 </span>                :<span class="lineCov">        252 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4631"><span class="lineNum">    4631 </span>                :            : {</a>
<a name="4632"><span class="lineNum">    4632 </span>                :<span class="lineCov">        382 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4633"><span class="lineNum">    4633 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        252 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4634"><span class="lineNum">    4634 </span>                :            : </a>
<a name="4635"><span class="lineNum">    4635 </span>        [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        252 :     CWallet&amp; wallet{*pwallet};</span></a>
<a name="4636"><span class="lineNum">    4636 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="4637"><span class="lineNum">    4637 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="4638"><span class="lineNum">    4638 </span>        [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        252 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="4639"><span class="lineNum">    4639 </span>                :            : </a>
<a name="4640"><span class="lineNum">    4640 </span>  [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        252 :     RPCTypeCheck(request.params, {</span></a>
<a name="4641"><span class="lineNum">    4641 </span>                :            :         UniValue::VARR,</a>
<a name="4642"><span class="lineNum">    4642 </span>                :            :         UniValueType(), // ARR or OBJ, checked later</a>
<a name="4643"><span class="lineNum">    4643 </span>                :            :         UniValue::VNUM,</a>
<a name="4644"><span class="lineNum">    4644 </span>                :            :         UniValue::VOBJ,</a>
<a name="4645"><span class="lineNum">    4645 </span>                :            :         UniValue::VBOOL</a>
<a name="4646"><span class="lineNum">    4646 </span>                :            :         }, true</a>
<a name="4647"><span class="lineNum">    4647 </span>  [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        504 :     );</span></a>
<a name="4648"><span class="lineNum">    4648 </span>                :            : </a>
<a name="4649"><span class="lineNum">    4649 </span>                :<span class="lineCov">        252 :     CAmount fee;</span></a>
<a name="4650"><span class="lineNum">    4650 </span>                :<span class="lineCov">        252 :     int change_position;</span></a>
<a name="4651"><span class="lineNum">    4651 </span>                :<span class="lineCov">        252 :     bool rbf{wallet.m_signal_rbf};</span></a>
<a name="4652"><span class="lineNum">    4652 </span>  [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        252 :     const UniValue &amp;replaceable_arg = request.params[3][&quot;replaceable&quot;];</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchCov" title="Branch 7 was taken 248 times"> + </span>]
<a name="4653"><span class="lineNum">    4653 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 248 times"> + </span>]:<span class="lineCov">        252 :     if (!replaceable_arg.isNull()) {</span></a>
<a name="4654"><span class="lineNum">    4654 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :         RPCTypeCheckArgument(replaceable_arg, UniValue::VBOOL);</span></a>
<a name="4655"><span class="lineNum">    4655 </span>                :<span class="lineCov">          4 :         rbf = replaceable_arg.isTrue();</span></a>
<a name="4656"><span class="lineNum">    4656 </span>                :            :     }</a>
<a name="4657"><span class="lineNum">    4657 </span>  [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        504 :     CMutableTransaction rawTx = ConstructTransaction(request.params[0], request.params[1], request.params[2], rbf);</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 130 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="4658"><span class="lineNum">    4658 </span>        [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        504 :     CCoinControl coin_control;</span></a>
<a name="4659"><span class="lineNum">    4659 </span>                :            :     // Automatically select coins, unless at least one is manually selected. Can</a>
<a name="4660"><span class="lineNum">    4660 </span>                :            :     // be overridden by options.add_inputs.</a>
<a name="4661"><span class="lineNum">    4661 </span>        [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        252 :     coin_control.m_add_inputs = rawTx.vin.size() == 0;</span></a>
<a name="4662"><span class="lineNum">    4662 </span>  [<span class="branchCov" title="Branch 0 was taken 252 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 130 times"> + </span><span class="branchCov" title="Branch 3 was taken 122 times"> + </span>]:<span class="lineCov">        252 :     FundTransaction(wallet, rawTx, fee, change_position, request.params[3], coin_control, /* override_min_fee */ true);</span></a>
<a name="4663"><span class="lineNum">    4663 </span>                :            : </a>
<a name="4664"><span class="lineNum">    4664 </span>                :            :     // Make a blank psbt</a>
<a name="4665"><span class="lineNum">    4665 </span>        [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        130 :     PartiallySignedTransaction psbtx(rawTx);</span></a>
<a name="4666"><span class="lineNum">    4666 </span>                :            : </a>
<a name="4667"><span class="lineNum">    4667 </span>                :            :     // Fill transaction with out data but don't sign</a>
<a name="4668"><span class="lineNum">    4668 </span>  [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 11 times"> + </span><span class="branchCov" title="Branch 3 was taken 119 times"> + </span> :<span class="lineCov">        130 :     bool bip32derivs = request.params[4].isNull() ? true : request.params[4].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4669"><span class="lineNum">    4669 </span>                :<span class="lineCov">        130 :     bool complete = true;</span></a>
<a name="4670"><span class="lineNum">    4670 </span>        [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        130 :     const TransactionError err{wallet.FillPSBT(psbtx, complete, 1, false, bip32derivs)};</span></a>
<a name="4671"><span class="lineNum">    4671 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 130 times"> + </span>]:<span class="lineCov">        130 :     if (err != TransactionError::OK) {</span></a>
<a name="4672"><span class="lineNum">    4672 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCTransactionError(err);</span></a>
<a name="4673"><span class="lineNum">    4673 </span>                :            :     }</a>
<a name="4674"><span class="lineNum">    4674 </span>                :            : </a>
<a name="4675"><span class="lineNum">    4675 </span>                :            :     // Serialize the PSBT</a>
<a name="4676"><span class="lineNum">    4676 </span>        [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        260 :     CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);</span></a>
<a name="4677"><span class="lineNum">    4677 </span>        [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        130 :     ssTx &lt;&lt; psbtx;</span></a>
<a name="4678"><span class="lineNum">    4678 </span>                :            : </a>
<a name="4679"><span class="lineNum">    4679 </span>  [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        260 :     UniValue result(UniValue::VOBJ);</span></a>
<a name="4680"><span class="lineNum">    4680 </span>  [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        260 :     result.pushKV(&quot;psbt&quot;, EncodeBase64(ssTx.str()));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4681"><span class="lineNum">    4681 </span>  [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        260 :     result.pushKV(&quot;fee&quot;, ValueFromAmount(fee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4682"><span class="lineNum">    4682 </span>  [<span class="branchCov" title="Branch 0 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 130 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        260 :     result.pushKV(&quot;changepos&quot;, change_position);</span></a>
<a name="4683"><span class="lineNum">    4683 </span>                :<span class="lineCov">        130 :     return result;</span></a>
<a name="4684"><span class="lineNum">    4684 </span>                :            : },</a>
<a name="4685"><span class="lineNum">    4685 </span>  [<span class="branchCov" title="Branch 0 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      67236 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchCov" title="Branch 116 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span><span class="branchCov" title="Branch 118 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchCov" title="Branch 120 was taken 1724 times"> + </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span><span class="branchCov" title="Branch 122 was taken 8620 times"> + </span><span class="branchCov" title="Branch 123 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 124 was taken 3448 times"> + </span><span class="branchCov" title="Branch 125 was taken 1724 times"> + </span><span class="branchCov" title="Branch 126 was taken 1724 times"> + </span><span class="branchCov" title="Branch 127 was taken 1724 times"> + </span><span class="branchCov" title="Branch 128 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 129 was taken 1724 times"> + </span><span class="branchCov" title="Branch 130 was taken 1724 times"> + </span><span class="branchCov" title="Branch 131 was taken 1724 times"> + </span><span class="branchCov" title="Branch 132 was taken 5172 times"> + </span><span class="branchCov" title="Branch 133 was taken 1724 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 134 was not taken"> - </span><span class="branchNoCov" title="Branch 135 was not taken"> - </span><span class="branchNoCov" title="Branch 136 was not taken"> - </span><span class="branchNoCov" title="Branch 137 was not taken"> - </span><span class="branchNoCov" title="Branch 138 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 139 was not taken"> - </span><span class="branchNoCov" title="Branch 140 was not taken"> - </span><span class="branchNoCov" title="Branch 141 was not taken"> - </span><span class="branchNoCov" title="Branch 142 was not taken"> - </span><span class="branchNoCov" title="Branch 143 was not taken"> - </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 144 was not taken"> - </span><span class="branchNoCov" title="Branch 145 was not taken"> - </span>]
<a name="4686"><span class="lineNum">    4686 </span>                :            : }</a>
<a name="4687"><span class="lineNum">    4687 </span>                :            : </a>
<a name="4688"><span class="lineNum">    4688 </span>                :<span class="lineCov">       1472 : static RPCHelpMan upgradewallet()</span></a>
<a name="4689"><span class="lineNum">    4689 </span>                :            : {</a>
<a name="4690"><span class="lineNum">    4690 </span>                :<span class="lineCov">       1472 :     return RPCHelpMan{&quot;upgradewallet&quot;,</span></a>
<a name="4691"><span class="lineNum">    4691 </span>                :            :         &quot;\nUpgrade the wallet. Upgrades to the latest version if no version number is specified.\n&quot;</a>
<a name="4692"><span class="lineNum">    4692 </span>                :            :         &quot;New keys may be generated and a new wallet backup will need to be made.&quot;,</a>
<a name="4693"><span class="lineNum">    4693 </span>                :            :         {</a>
<a name="4694"><span class="lineNum">    4694 </span>        [<span class="branchCov" title="Branch 0 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2944 :             {&quot;version&quot;, RPCArg::Type::NUM, RPCArg::Default{FEATURE_LATEST}, &quot;The version number to upgrade to. Default is the latest wallet version.&quot;}</span></a>
<a name="4695"><span class="lineNum">    4695 </span>                :            :         },</a>
<a name="4696"><span class="lineNum">    4696 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="4697"><span class="lineNum">    4697 </span>                :            :             RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="4698"><span class="lineNum">    4698 </span>                :            :             {</a>
<a name="4699"><span class="lineNum">    4699 </span>                :            :                 {RPCResult::Type::STR, &quot;wallet_name&quot;, &quot;Name of wallet this operation was performed on&quot;},</a>
<a name="4700"><span class="lineNum">    4700 </span>                :            :                 {RPCResult::Type::NUM, &quot;previous_version&quot;, &quot;Version of wallet before this operation&quot;},</a>
<a name="4701"><span class="lineNum">    4701 </span>                :            :                 {RPCResult::Type::NUM, &quot;current_version&quot;, &quot;Version of wallet after this operation&quot;},</a>
<a name="4702"><span class="lineNum">    4702 </span>                :            :                 {RPCResult::Type::STR, &quot;result&quot;, /* optional */ true, &quot;Description of result, if no error&quot;},</a>
<a name="4703"><span class="lineNum">    4703 </span>                :            :                 {RPCResult::Type::STR, &quot;error&quot;, /* optional */ true, &quot;Error message (if there is one)&quot;}</a>
<a name="4704"><span class="lineNum">    4704 </span>                :            :             },</a>
<a name="4705"><span class="lineNum">    4705 </span>  [<span class="branchCov" title="Branch 0 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10304 :         },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1472 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1472 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1472 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 7360 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 39 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>]
<a name="4706"><span class="lineNum">    4706 </span>                :<span class="lineCov">       1472 :         RPCExamples{</span></a>
<a name="4707"><span class="lineNum">    4707 </span>  [<span class="branchCov" title="Branch 0 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2944 :             HelpExampleCli(&quot;upgradewallet&quot;, &quot;169900&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4708"><span class="lineNum">    4708 </span>  [<span class="branchCov" title="Branch 0 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5888 :             + HelpExampleRpc(&quot;upgradewallet&quot;, &quot;169900&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4709"><span class="lineNum">    4709 </span>                :<span class="lineCov">       1472 :         },</span></a>
<a name="4710"><span class="lineNum">    4710 </span>                :<span class="lineNoCov">          0 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4711"><span class="lineNum">    4711 </span>                :            : {</a>
<a name="4712"><span class="lineNum">    4712 </span>                :<span class="lineNoCov">          0 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4713"><span class="lineNum">    4713 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :     if (!pwallet) return NullUniValue;</span></a>
<a name="4714"><span class="lineNum">    4714 </span>                :            : </a>
<a name="4715"><span class="lineNum">    4715 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :     RPCTypeCheck(request.params, {UniValue::VNUM}, true);</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="4716"><span class="lineNum">    4716 </span>                :            : </a>
<a name="4717"><span class="lineNum">    4717 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     EnsureWalletIsUnlocked(*pwallet);</span></a>
<a name="4718"><span class="lineNum">    4718 </span>                :            : </a>
<a name="4719"><span class="lineNum">    4719 </span>                :<span class="lineNoCov">          0 :     int version = 0;</span></a>
<a name="4720"><span class="lineNum">    4720 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :     if (!request.params[0].isNull()) {</span></a>
<a name="4721"><span class="lineNum">    4721 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         version = request.params[0].get_int();</span></a>
<a name="4722"><span class="lineNum">    4722 </span>                :            :     }</a>
<a name="4723"><span class="lineNum">    4723 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :     bilingual_str error;</span></a>
<a name="4724"><span class="lineNum">    4724 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     const int previous_version{pwallet-&gt;GetVersion()};</span></a>
<a name="4725"><span class="lineNum">    4725 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     const bool wallet_upgraded{pwallet-&gt;UpgradeWallet(version, error)};</span></a>
<a name="4726"><span class="lineNum">    4726 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     const int current_version{pwallet-&gt;GetVersion()};</span></a>
<a name="4727"><span class="lineNum">    4727 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     std::string result;</span></a>
<a name="4728"><span class="lineNum">    4728 </span>                :            : </a>
<a name="4729"><span class="lineNum">    4729 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     if (wallet_upgraded) {</span></a>
<a name="4730"><span class="lineNum">    4730 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :         if (previous_version == current_version) {</span></a>
<a name="4731"><span class="lineNum">    4731 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :             result = &quot;Already at latest version. Wallet version unchanged.&quot;;</span></a>
<a name="4732"><span class="lineNum">    4732 </span>                :            :         } else {</a>
<a name="4733"><span class="lineNum">    4733 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :             result = strprintf(&quot;Wallet upgraded successfully from version %i to version %i.&quot;, previous_version, current_version);</span></a>
<a name="4734"><span class="lineNum">    4734 </span>                :            :         }</a>
<a name="4735"><span class="lineNum">    4735 </span>                :            :     }</a>
<a name="4736"><span class="lineNum">    4736 </span>                :            : </a>
<a name="4737"><span class="lineNum">    4737 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :     UniValue obj(UniValue::VOBJ);</span></a>
<a name="4738"><span class="lineNum">    4738 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :     obj.pushKV(&quot;wallet_name&quot;, pwallet-&gt;GetName());</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="4739"><span class="lineNum">    4739 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :     obj.pushKV(&quot;previous_version&quot;, previous_version);</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="4740"><span class="lineNum">    4740 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :     obj.pushKV(&quot;current_version&quot;, current_version);</span></a>
<span class="lineNum">         </span>         <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span>]
<a name="4741"><span class="lineNum">    4741 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     if (!result.empty()) {</span></a>
<a name="4742"><span class="lineNum">    4742 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         obj.pushKV(&quot;result&quot;, result);</span></a>
<a name="4743"><span class="lineNum">    4743 </span>                :            :     } else {</a>
<a name="4744"><span class="lineNum">    4744 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         CHECK_NONFATAL(!error.empty());</span></a>
<a name="4745"><span class="lineNum">    4745 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         obj.pushKV(&quot;error&quot;, error.original);</span></a>
<a name="4746"><span class="lineNum">    4746 </span>                :            :     }</a>
<a name="4747"><span class="lineNum">    4747 </span>                :<span class="lineNoCov">          0 :     return obj;</span></a>
<a name="4748"><span class="lineNum">    4748 </span>                :            : },</a>
<a name="4749"><span class="lineNum">    4749 </span>  [<span class="branchCov" title="Branch 0 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      13248 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1472 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1472 times"> + </span><span class="branchCov" title="Branch 17 was taken 1472 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="4750"><span class="lineNum">    4750 </span>                :            : }</a>
<a name="4751"><span class="lineNum">    4751 </span>                :            : </a>
<a name="4752"><span class="lineNum">    4752 </span>                :            : #ifdef ENABLE_EXTERNAL_SIGNER</a>
<a name="4753"><span class="lineNum">    4753 </span>                :<span class="lineCov">       1474 : static RPCHelpMan walletdisplayaddress()</span></a>
<a name="4754"><span class="lineNum">    4754 </span>                :            : {</a>
<a name="4755"><span class="lineNum">    4755 </span>                :<span class="lineCov">       1474 :     return RPCHelpMan{</span></a>
<a name="4756"><span class="lineNum">    4756 </span>                :            :         &quot;walletdisplayaddress&quot;,</a>
<a name="4757"><span class="lineNum">    4757 </span>                :            :         &quot;Display address on an external signer for verification.&quot;,</a>
<a name="4758"><span class="lineNum">    4758 </span>                :            :         {</a>
<a name="4759"><span class="lineNum">    4759 </span>                :<span class="lineCov">       1474 :             {&quot;address&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;bitcoin address to display&quot;},</span></a>
<a name="4760"><span class="lineNum">    4760 </span>                :            :         },</a>
<a name="4761"><span class="lineNum">    4761 </span>                :<span class="lineNoCov">          0 :         RPCResult{</span></a>
<a name="4762"><span class="lineNum">    4762 </span>                :            :             RPCResult::Type::OBJ,&quot;&quot;,&quot;&quot;,</a>
<a name="4763"><span class="lineNum">    4763 </span>                :            :             {</a>
<a name="4764"><span class="lineNum">    4764 </span>                :            :                 {RPCResult::Type::STR, &quot;address&quot;, &quot;The address as confirmed by the signer&quot;},</a>
<a name="4765"><span class="lineNum">    4765 </span>                :            :             }</a>
<a name="4766"><span class="lineNum">    4766 </span>  [<span class="branchCov" title="Branch 0 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4422 :         },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1474 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1474 times"> + </span><span class="branchCov" title="Branch 15 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="4767"><span class="lineNum">    4767 </span>        [<span class="branchCov" title="Branch 0 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2948 :         RPCExamples{&quot;&quot;},</span></a>
<a name="4768"><span class="lineNum">    4768 </span>                :<span class="lineCov">          2 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="4769"><span class="lineNum">    4769 </span>                :            :         {</a>
<a name="4770"><span class="lineNum">    4770 </span>                :<span class="lineCov">          3 :             std::shared_ptr&lt;CWallet&gt; const wallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="4771"><span class="lineNum">    4771 </span>  [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          2 :             if (!wallet) return NullUniValue;</span></a>
<a name="4772"><span class="lineNum">    4772 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          2 :             CWallet* const pwallet = wallet.get();</span></a>
<a name="4773"><span class="lineNum">    4773 </span>                :            : </a>
<a name="4774"><span class="lineNum">    4774 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="4775"><span class="lineNum">    4775 </span>                :            : </a>
<a name="4776"><span class="lineNum">    4776 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          2 :             CTxDestination dest = DecodeDestination(request.params[0].get_str());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4777"><span class="lineNum">    4777 </span>                :            : </a>
<a name="4778"><span class="lineNum">    4778 </span>                :            :             // Make sure the destination is valid</a>
<a name="4779"><span class="lineNum">    4779 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 2 times"> + </span>]:<span class="lineCov">          2 :             if (!IsValidDestination(dest)) {</span></a>
<a name="4780"><span class="lineNum">    4780 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid address&quot;);</span></a>
<a name="4781"><span class="lineNum">    4781 </span>                :            :             }</a>
<a name="4782"><span class="lineNum">    4782 </span>                :            : </a>
<a name="4783"><span class="lineNum">    4783 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 1 time"> + </span>]:<span class="lineCov">          2 :             if (!pwallet-&gt;DisplayAddress(dest)) {</span></a>
<a name="4784"><span class="lineNum">    4784 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :                 throw JSONRPCError(RPC_MISC_ERROR, &quot;Failed to display address&quot;);</span></a>
<a name="4785"><span class="lineNum">    4785 </span>                :            :             }</a>
<a name="4786"><span class="lineNum">    4786 </span>                :            : </a>
<a name="4787"><span class="lineNum">    4787 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          2 :             UniValue result(UniValue::VOBJ);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="4788"><span class="lineNum">    4788 </span>  [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          2 :             result.pushKV(&quot;address&quot;, request.params[0].get_str());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1 time"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="4789"><span class="lineNum">    4789 </span>                :<span class="lineCov">          1 :             return result;</span></a>
<a name="4790"><span class="lineNum">    4790 </span>                :            :         }</a>
<a name="4791"><span class="lineNum">    4791 </span>  [<span class="branchCov" title="Branch 0 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      11792 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1474 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1474 times"> + </span><span class="branchCov" title="Branch 17 was taken 1474 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="4792"><span class="lineNum">    4792 </span>                :            : }</a>
<a name="4793"><span class="lineNum">    4793 </span>                :            : #endif // ENABLE_EXTERNAL_SIGNER</a>
<a name="4794"><span class="lineNum">    4794 </span>                :            : </a>
<a name="4795"><span class="lineNum">    4795 </span>                :            : RPCHelpMan abortrescan();</a>
<a name="4796"><span class="lineNum">    4796 </span>                :            : RPCHelpMan dumpprivkey();</a>
<a name="4797"><span class="lineNum">    4797 </span>                :            : RPCHelpMan importprivkey();</a>
<a name="4798"><span class="lineNum">    4798 </span>                :            : RPCHelpMan importaddress();</a>
<a name="4799"><span class="lineNum">    4799 </span>                :            : RPCHelpMan importpubkey();</a>
<a name="4800"><span class="lineNum">    4800 </span>                :            : RPCHelpMan dumpwallet();</a>
<a name="4801"><span class="lineNum">    4801 </span>                :            : RPCHelpMan importwallet();</a>
<a name="4802"><span class="lineNum">    4802 </span>                :            : RPCHelpMan importprunedfunds();</a>
<a name="4803"><span class="lineNum">    4803 </span>                :            : RPCHelpMan removeprunedfunds();</a>
<a name="4804"><span class="lineNum">    4804 </span>                :            : RPCHelpMan importmulti();</a>
<a name="4805"><span class="lineNum">    4805 </span>                :            : RPCHelpMan importdescriptors();</a>
<a name="4806"><span class="lineNum">    4806 </span>                :            : RPCHelpMan listdescriptors();</a>
<a name="4807"><span class="lineNum">    4807 </span>                :            : RPCHelpMan signmessage();</a>
<a name="4808"><span class="lineNum">    4808 </span>                :            : </a>
<a name="4809"><span class="lineNum">    4809 </span>                :<span class="lineCov">        740 : Span&lt;const CRPCCommand&gt; GetWalletRPCCommands()</span></a>
<a name="4810"><span class="lineNum">    4810 </span>                :            : {</a>
<a name="4811"><span class="lineNum">    4811 </span>                :            : // clang-format off</a>
<a name="4812"><span class="lineNum">    4812 </span>                :<span class="lineCov">        740 : static const CRPCCommand commands[] =</span></a>
<a name="4813"><span class="lineNum">    4813 </span>                :            : { //  category              actor (function)</a>
<a name="4814"><span class="lineNum">    4814 </span>                :            :   //  ------------------    ------------------------</a>
<a name="4815"><span class="lineNum">    4815 </span>                :            :     { &quot;rawtransactions&quot;,    &amp;fundrawtransaction,             },</a>
<a name="4816"><span class="lineNum">    4816 </span>                :            :     { &quot;wallet&quot;,             &amp;abandontransaction,             },</a>
<a name="4817"><span class="lineNum">    4817 </span>                :            :     { &quot;wallet&quot;,             &amp;abortrescan,                    },</a>
<a name="4818"><span class="lineNum">    4818 </span>                :            :     { &quot;wallet&quot;,             &amp;addmultisigaddress,             },</a>
<a name="4819"><span class="lineNum">    4819 </span>                :            :     { &quot;wallet&quot;,             &amp;backupwallet,                   },</a>
<a name="4820"><span class="lineNum">    4820 </span>                :            :     { &quot;wallet&quot;,             &amp;bumpfee,                        },</a>
<a name="4821"><span class="lineNum">    4821 </span>                :            :     { &quot;wallet&quot;,             &amp;psbtbumpfee,                    },</a>
<a name="4822"><span class="lineNum">    4822 </span>                :            :     { &quot;wallet&quot;,             &amp;createwallet,                   },</a>
<a name="4823"><span class="lineNum">    4823 </span>                :            :     { &quot;wallet&quot;,             &amp;restorewallet,                  },</a>
<a name="4824"><span class="lineNum">    4824 </span>                :            :     { &quot;wallet&quot;,             &amp;dumpprivkey,                    },</a>
<a name="4825"><span class="lineNum">    4825 </span>                :            :     { &quot;wallet&quot;,             &amp;dumpwallet,                     },</a>
<a name="4826"><span class="lineNum">    4826 </span>                :            :     { &quot;wallet&quot;,             &amp;encryptwallet,                  },</a>
<a name="4827"><span class="lineNum">    4827 </span>                :            :     { &quot;wallet&quot;,             &amp;getaddressesbylabel,            },</a>
<a name="4828"><span class="lineNum">    4828 </span>                :            :     { &quot;wallet&quot;,             &amp;getaddressinfo,                 },</a>
<a name="4829"><span class="lineNum">    4829 </span>                :            :     { &quot;wallet&quot;,             &amp;getbalance,                     },</a>
<a name="4830"><span class="lineNum">    4830 </span>                :            :     { &quot;wallet&quot;,             &amp;getnewaddress,                  },</a>
<a name="4831"><span class="lineNum">    4831 </span>                :            :     { &quot;wallet&quot;,             &amp;getrawchangeaddress,            },</a>
<a name="4832"><span class="lineNum">    4832 </span>                :            :     { &quot;wallet&quot;,             &amp;getreceivedbyaddress,           },</a>
<a name="4833"><span class="lineNum">    4833 </span>                :            :     { &quot;wallet&quot;,             &amp;getreceivedbylabel,             },</a>
<a name="4834"><span class="lineNum">    4834 </span>                :            :     { &quot;wallet&quot;,             &amp;gettransaction,                 },</a>
<a name="4835"><span class="lineNum">    4835 </span>                :            :     { &quot;wallet&quot;,             &amp;getunconfirmedbalance,          },</a>
<a name="4836"><span class="lineNum">    4836 </span>                :            :     { &quot;wallet&quot;,             &amp;getbalances,                    },</a>
<a name="4837"><span class="lineNum">    4837 </span>                :            :     { &quot;wallet&quot;,             &amp;getwalletinfo,                  },</a>
<a name="4838"><span class="lineNum">    4838 </span>                :            :     { &quot;wallet&quot;,             &amp;importaddress,                  },</a>
<a name="4839"><span class="lineNum">    4839 </span>                :            :     { &quot;wallet&quot;,             &amp;importdescriptors,              },</a>
<a name="4840"><span class="lineNum">    4840 </span>                :            :     { &quot;wallet&quot;,             &amp;importmulti,                    },</a>
<a name="4841"><span class="lineNum">    4841 </span>                :            :     { &quot;wallet&quot;,             &amp;importprivkey,                  },</a>
<a name="4842"><span class="lineNum">    4842 </span>                :            :     { &quot;wallet&quot;,             &amp;importprunedfunds,              },</a>
<a name="4843"><span class="lineNum">    4843 </span>                :            :     { &quot;wallet&quot;,             &amp;importpubkey,                   },</a>
<a name="4844"><span class="lineNum">    4844 </span>                :            :     { &quot;wallet&quot;,             &amp;importwallet,                   },</a>
<a name="4845"><span class="lineNum">    4845 </span>                :            :     { &quot;wallet&quot;,             &amp;keypoolrefill,                  },</a>
<a name="4846"><span class="lineNum">    4846 </span>                :            :     { &quot;wallet&quot;,             &amp;listaddressgroupings,           },</a>
<a name="4847"><span class="lineNum">    4847 </span>                :            :     { &quot;wallet&quot;,             &amp;listdescriptors,                },</a>
<a name="4848"><span class="lineNum">    4848 </span>                :            :     { &quot;wallet&quot;,             &amp;listlabels,                     },</a>
<a name="4849"><span class="lineNum">    4849 </span>                :            :     { &quot;wallet&quot;,             &amp;listlockunspent,                },</a>
<a name="4850"><span class="lineNum">    4850 </span>                :            :     { &quot;wallet&quot;,             &amp;listreceivedbyaddress,          },</a>
<a name="4851"><span class="lineNum">    4851 </span>                :            :     { &quot;wallet&quot;,             &amp;listreceivedbylabel,            },</a>
<a name="4852"><span class="lineNum">    4852 </span>                :            :     { &quot;wallet&quot;,             &amp;listsinceblock,                 },</a>
<a name="4853"><span class="lineNum">    4853 </span>                :            :     { &quot;wallet&quot;,             &amp;listtransactions,               },</a>
<a name="4854"><span class="lineNum">    4854 </span>                :            :     { &quot;wallet&quot;,             &amp;listunspent,                    },</a>
<a name="4855"><span class="lineNum">    4855 </span>                :            :     { &quot;wallet&quot;,             &amp;listwalletdir,                  },</a>
<a name="4856"><span class="lineNum">    4856 </span>                :            :     { &quot;wallet&quot;,             &amp;listwallets,                    },</a>
<a name="4857"><span class="lineNum">    4857 </span>                :            :     { &quot;wallet&quot;,             &amp;loadwallet,                     },</a>
<a name="4858"><span class="lineNum">    4858 </span>                :            :     { &quot;wallet&quot;,             &amp;lockunspent,                    },</a>
<a name="4859"><span class="lineNum">    4859 </span>                :            :     { &quot;wallet&quot;,             &amp;newkeypool,                     },</a>
<a name="4860"><span class="lineNum">    4860 </span>                :            :     { &quot;wallet&quot;,             &amp;removeprunedfunds,              },</a>
<a name="4861"><span class="lineNum">    4861 </span>                :            :     { &quot;wallet&quot;,             &amp;rescanblockchain,               },</a>
<a name="4862"><span class="lineNum">    4862 </span>                :            :     { &quot;wallet&quot;,             &amp;send,                           },</a>
<a name="4863"><span class="lineNum">    4863 </span>                :            :     { &quot;wallet&quot;,             &amp;sendmany,                       },</a>
<a name="4864"><span class="lineNum">    4864 </span>                :            :     { &quot;wallet&quot;,             &amp;sendtoaddress,                  },</a>
<a name="4865"><span class="lineNum">    4865 </span>                :            :     { &quot;wallet&quot;,             &amp;sethdseed,                      },</a>
<a name="4866"><span class="lineNum">    4866 </span>                :            :     { &quot;wallet&quot;,             &amp;setlabel,                       },</a>
<a name="4867"><span class="lineNum">    4867 </span>                :            :     { &quot;wallet&quot;,             &amp;settxfee,                       },</a>
<a name="4868"><span class="lineNum">    4868 </span>                :            :     { &quot;wallet&quot;,             &amp;setwalletflag,                  },</a>
<a name="4869"><span class="lineNum">    4869 </span>                :            :     { &quot;wallet&quot;,             &amp;signmessage,                    },</a>
<a name="4870"><span class="lineNum">    4870 </span>                :            :     { &quot;wallet&quot;,             &amp;signrawtransactionwithwallet,   },</a>
<a name="4871"><span class="lineNum">    4871 </span>                :            :     { &quot;wallet&quot;,             &amp;unloadwallet,                   },</a>
<a name="4872"><span class="lineNum">    4872 </span>                :            :     { &quot;wallet&quot;,             &amp;upgradewallet,                  },</a>
<a name="4873"><span class="lineNum">    4873 </span>                :            :     { &quot;wallet&quot;,             &amp;walletcreatefundedpsbt,         },</a>
<a name="4874"><span class="lineNum">    4874 </span>                :            : #ifdef ENABLE_EXTERNAL_SIGNER</a>
<a name="4875"><span class="lineNum">    4875 </span>                :            :     { &quot;wallet&quot;,             &amp;walletdisplayaddress,           },</a>
<a name="4876"><span class="lineNum">    4876 </span>                :            : #endif // ENABLE_EXTERNAL_SIGNER</a>
<a name="4877"><span class="lineNum">    4877 </span>                :            :     { &quot;wallet&quot;,             &amp;walletlock,                     },</a>
<a name="4878"><span class="lineNum">    4878 </span>                :            :     { &quot;wallet&quot;,             &amp;walletpassphrase,               },</a>
<a name="4879"><span class="lineNum">    4879 </span>                :            :     { &quot;wallet&quot;,             &amp;walletpassphrasechange,         },</a>
<a name="4880"><span class="lineNum">    4880 </span>                :            :     { &quot;wallet&quot;,             &amp;walletprocesspsbt,              },</a>
<a name="4881"><span class="lineNum">    4881 </span>  [<span class="branchCov" title="Branch 0 was taken 733 times"> + </span><span class="branchCov" title="Branch 1 was taken 7 times"> + </span><span class="branchCov" title="Branch 2 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      47652 : };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchCov" title="Branch 116 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span><span class="branchCov" title="Branch 118 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchCov" title="Branch 120 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span><span class="branchCov" title="Branch 122 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 123 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 124 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span><span class="branchCov" title="Branch 126 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 127 was not taken"> - </span><span class="branchCov" title="Branch 128 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 129 was not taken"> - </span><span class="branchCov" title="Branch 130 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 131 was not taken"> - </span><span class="branchCov" title="Branch 132 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 133 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 134 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 135 was not taken"> - </span><span class="branchCov" title="Branch 136 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 137 was not taken"> - </span><span class="branchCov" title="Branch 138 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 139 was not taken"> - </span><span class="branchCov" title="Branch 140 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 141 was not taken"> - </span><span class="branchCov" title="Branch 142 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 143 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 144 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 145 was not taken"> - </span><span class="branchCov" title="Branch 146 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 147 was not taken"> - </span><span class="branchCov" title="Branch 148 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 149 was not taken"> - </span><span class="branchCov" title="Branch 150 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 151 was not taken"> - </span><span class="branchCov" title="Branch 152 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 153 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 154 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 155 was not taken"> - </span><span class="branchCov" title="Branch 156 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 157 was not taken"> - </span><span class="branchCov" title="Branch 158 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 159 was not taken"> - </span><span class="branchCov" title="Branch 160 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 161 was not taken"> - </span><span class="branchCov" title="Branch 162 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 163 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 164 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 165 was not taken"> - </span><span class="branchCov" title="Branch 166 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 167 was not taken"> - </span><span class="branchCov" title="Branch 168 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 169 was not taken"> - </span><span class="branchCov" title="Branch 170 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 171 was not taken"> - </span><span class="branchCov" title="Branch 172 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 173 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 174 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 175 was not taken"> - </span><span class="branchCov" title="Branch 176 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 177 was not taken"> - </span><span class="branchCov" title="Branch 178 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 179 was not taken"> - </span><span class="branchCov" title="Branch 180 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 181 was not taken"> - </span><span class="branchCov" title="Branch 182 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 183 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 184 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 185 was not taken"> - </span><span class="branchCov" title="Branch 186 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 187 was not taken"> - </span><span class="branchCov" title="Branch 188 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 189 was not taken"> - </span><span class="branchCov" title="Branch 190 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 191 was not taken"> - </span><span class="branchCov" title="Branch 192 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 193 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 194 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 195 was not taken"> - </span><span class="branchCov" title="Branch 196 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 197 was not taken"> - </span><span class="branchCov" title="Branch 198 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 199 was not taken"> - </span><span class="branchCov" title="Branch 200 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 201 was not taken"> - </span><span class="branchCov" title="Branch 202 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 203 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 204 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 205 was not taken"> - </span><span class="branchCov" title="Branch 206 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 207 was not taken"> - </span><span class="branchCov" title="Branch 208 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 209 was not taken"> - </span><span class="branchCov" title="Branch 210 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 211 was not taken"> - </span><span class="branchCov" title="Branch 212 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 213 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 214 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 215 was not taken"> - </span><span class="branchCov" title="Branch 216 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 217 was not taken"> - </span><span class="branchCov" title="Branch 218 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 219 was not taken"> - </span><span class="branchCov" title="Branch 220 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 221 was not taken"> - </span><span class="branchCov" title="Branch 222 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 223 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 224 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 225 was not taken"> - </span><span class="branchCov" title="Branch 226 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 227 was not taken"> - </span><span class="branchCov" title="Branch 228 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 229 was not taken"> - </span><span class="branchCov" title="Branch 230 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 231 was not taken"> - </span><span class="branchCov" title="Branch 232 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 233 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 234 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 235 was not taken"> - </span><span class="branchCov" title="Branch 236 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 237 was not taken"> - </span><span class="branchCov" title="Branch 238 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 239 was not taken"> - </span><span class="branchCov" title="Branch 240 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 241 was not taken"> - </span><span class="branchCov" title="Branch 242 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 243 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 244 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 245 was not taken"> - </span><span class="branchCov" title="Branch 246 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 247 was not taken"> - </span><span class="branchCov" title="Branch 248 was taken 733 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 249 was not taken"> - </span><span class="branchCov" title="Branch 250 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 251 was not taken"> - </span><span class="branchCov" title="Branch 252 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 253 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 254 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 255 was not taken"> - </span><span class="branchCov" title="Branch 256 was taken 733 times"> + </span><span class="branchNoCov" title="Branch 257 was not taken"> - </span><span class="branchCov" title="Branch 258 was taken 733 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 259 was not taken"> - </span>]
<a name="4882"><span class="lineNum">    4882 </span>                :            : // clang-format on</a>
<a name="4883"><span class="lineNum">    4883 </span>                :<span class="lineCov">        740 :     return MakeSpan(commands);</span></a>
<a name="4884"><span class="lineNum">    4884 </span>                :            : }</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
